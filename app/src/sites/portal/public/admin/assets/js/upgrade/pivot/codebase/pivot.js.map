{"version":3,"file":"pivot.js","sources":["../sources/operations/filters.js","../sources/locale.js","../sources/popups/menu.js","../sources/operations/popup_clicks.js","../sources/operations/set_structure.js","../sources/structures/templates.js","../sources/data/helpers.js","../sources/structures/tablepopup.js","../sources/operations/freeze_totals.js","../sources/data/total_columns.js","../sources/popups/commonpopup.js","../sources/popups/tablepopup.js","../sources/data/header.js","../sources/data/footer.js","../sources/data/item_values.js","../sources/data/filters.js","../sources/data/data.js","../sources/data/operations.js","../sources/data/core.js","../sources/config/pivottable.js","../sources/operations/columns.js","../sources/operations/external_processing.js","../sources/structures/filters.js","../sources/pivottable.js","../sources/structures/chartpopup.js","../sources/popups/chartpopup.js","../sources/config/pivotchart.js","../sources/pivotchart.js"],"sourcesContent":["export function formatFilterValues(filters) {\n\tfilters = filters || [];\n\tfor (var i = 0; i < filters.length; i++)\n\t\tfilters[i].fvalue = getFormattedValue(filters[i].value);\n}\n\nfunction getFormattedValue(value){\n\tvalue = value || \"\";\n\tif (webix.isDate(value)) {\n\t\tvalue = value.valueOf().toString();\n\t}\n\telse if (typeof value == \"string\") {\n\t\tif (value.trim)\n\t\t\tvalue = value.trim();\n\t}\n\treturn value;\n}\n\nexport function processFilters(view) {\n\tvar i, f,\n\t\tconfig = view.config,\n\t\tfilters = config.structure.filters || [],\n\t\titem, items = [],\n\t\tindexes = {};\n\tfor (i = 0; i < filters.length; i++) {\n\t\tf = filters[i];\n\t\tif(webix.isUndefined(indexes[f.type]))\n\t\t\tindexes[f.type] = [];\n\t\tindexes[f.type].push(i);\n\t\tvar type = f.type === \"multiselect\"?\"multicombo\":f.type === \"select\"?\"richselect\":f.type;\n\t\titem = {\n\t\t\tvalue: (webix.isUndefined(f.value)?\"\":f.value), point: false, field: f.name, view: type,\n\t\t\tminWidth: config.filterMinWidth, maxWidth: config.filterWidth\n\t\t};\n\n\t\t//placeholder API\n\t\tif (config.filterPlaceholder){\n\t\t\tif (typeof config.filterPlaceholder === \"boolean\"){\n\t\t\t\titem.placeholder = item.label;\n\t\t\t\titem.label = \"\";\n\t\t\t}\n\t\t\telse\n\t\t\t\titem.placeholder = config.filterPlaceholder;\n\t\t}\n\n\t\tif(f.type == \"multicombo\")\n\t\t\titem.tagMode = false;\n\n\t\tif (view.filters.isSelect(f.type)){\n\t\t\titem.options = {};\n\t\t\titem.options.data = distinctValues(view, f.name, f.type.indexOf(\"multi\") == -1);\n\t\t\titem.options.point = false;\n\n\t\t\tif(type == \"richselect\")\n\t\t\t\titem.options.css = \"webix_pivot_richselect_suggest\";\n\t\t\tif(type == \"multicombo\")\n\t\t\t\titem.options.css = \"webix_pivot_multicombo_suggest\";\n\t\t}\n\n\t\tif(!config.separateLabel) {\n\t\t\titem.label = view._applyMap(f.name);\n\t\t\titem.labelAlign = config.filterLabelAlign;\n\t\t\titem.labelWidth = config.filterLabelWidth;\n\t\t}\n\n\t\tif (view.callEvent(\"onFilterCreate\", [f, item])){\n\t\t\tif(config.separateLabel) {\n\t\t\t\tconst label = view._applyMap(f.name);\n\t\t\t\titems.push({\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{ view:\"label\", autowidth:true, label }, { width:10}, item, {width:18}\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\titems.push(item);\n\t\t\t}\n\t\t}\n\t}\n\treturn items;\n}\n\nfunction distinctValues(view, field, empty) {\n\tvar value, values = [],\n\t\tdata = view.data.pull,\n\t\thash = {};\n\n\tif(empty)\n\t\tvalues.push({value:\"\",id:\"\", $empty:true });\n\n\tif(view._pivotOptions && view._pivotOptions[field])\n\t\treturn values.concat(view._pivotOptions[field]);\n\n\tfor (let obj in data) {\n\t\tvalue = data[obj][field];\n\t\tif (!webix.isUndefined(value)){\n\t\t\tif ((value || value === 0) && !hash[value]) {\n\t\t\t\tvalues.push({ value:value.toString(), id:value.toString() });\n\t\t\t\thash[value] = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tvar isNumeric = function(n){\n\t\treturn  !isNaN(parseFloat(n));\n\t};\n\tvalues.sort(function(a,b) {\n\t\tvar val1 = a.value;\n\t\tvar val2 = b.value;\n\t\tif (!val2) return 1;\n\t\tif (!val1) return -1;\n\t\tif(!isNumeric(val1) || !isNumeric(val2) ){\n\t\t\tval1 = val1.toString().toLowerCase();\n\t\t\tval2=val2.toString().toLowerCase();\n\t\t}\n\t\treturn val1>val2?1:(val1<val2?-1:0);\n\t});\n\treturn values;\n}\n\nexport function showFilters(view, filters){\n\tsetEvents(view, filters);\n\tvar config = {elements: filters};\n\tview.callEvent(\"onViewInit\", [\"filters\", config]);\n\tif (config.elements && view.getFilterView()){\n\t\tif (filters.length > 0) {\n\t\t\tview.getFilterView().show();\n\t\t\twebix.ui(filters,view.getFilterView());\n\t\t} else {\n\t\t\tview.getFilterView().hide();\n\t\t}\n\t}\n}\n\n\nfunction setEvents(view, filters){\n\tfor (var i = 0; i < filters.length; i++) {\n\t\tlet event,\n\t\t\tfilter = filters[i];\n\t\tif (filter.cols)\n\t\t\tfilter = filter.cols[2];\n\n\t\tevent = (filter.view == \"text\"?\"onTimedKeyPress\":\"onChange\");\n\t\tfilter.on = {};\n\t\tfilter.on[event] = function(){\n\t\t\tvar value = this.getValue();\n\t\t\tif (value && this.config.separator && !this.format_setter)\n\t\t\t\tvalue = value.split(this.config.separator);\n\t\t\tchangeFilterValue(view, this.config.field, value);\n\t\t};\n\t}\n}\n\nfunction changeFilterValue(view, field, value){\n\tvar filters = view.config.structure.filters;\n\tfor (var i = 0; i < filters.length; i++)\n\t\tif (filters[i].name == field) {\n\t\t\tfilters[i].value = value;\n\t\t\tview.callEvent(\"onFilterChange\", [field, value]);\n\t\t\treturn true;\n\t\t}\n\treturn false;\n}\n\n\n","webix.i18n.pivot = webix.extend((webix.i18n.pivot||{}),{\n\tapply: \"Apply\",\n\tbar: \"Bar\",\n\tcancel: \"Cancel\",\n\tchart: \"Chart\",\n\tchartType: \"Chart type\",\n\tcolumns: \"Columns\",\n\tcount: \"count\",\n\tdate: \"date\",\n\tdatepicker: \"datepicker\",\n\tfields: \"Fields\",\n\tfilters: \"Filters\",\n\tgroupBy: \"Group By\",\n\tline: \"Line\",\n\tlogScale: \"Logarithmic scale\",\n\tmax: \"max\",\n\tmin: \"min\",\n\tmulticombo: \"multi-select\",\n\toperationNotDefined: \"Operation is not defined\",\n\tlayoutIncorrect: \"pivotLayout should be an Array instance\",\n\tpivotMessage: \"Click to configure\",\n\tpopupHeader: \"Pivot Settings\",\n\tradar: \"Radar\",\n\tradarArea: \"Area Radar\",\n\trows: \"Rows\",\n\tselect: \"select\",\n\tsettings: \"Settings\",\n\tstackedBar: \"Stacked Bar\",\n\tsum: \"sum\",\n\ttext: \"text\",\n\ttotal: \"Total\",\n\tvalues: \"Values\",\n\tvaluesNotDefined: \"Values or Group field are not defined\",\n\twindowTitle: \"Pivot Configuration\",\n\twindowMessage: \"move fields here\"\n});\n\n\n\n","webix.protoUI({\n\tname:\"webix_pivot_popup\",\n\t_selected: null,\n\tdefaults:{\n\t\tautoheight: true,\n\t\tpadding:0\n\t},\n\t$init: function(config) {\n\t\twebix.extend(config, this._get_ui(config));\n\t\tthis.$ready.push(this._after_init);\n\t},\n\t_get_ui: function(config) {\n\t\treturn {\n\t\t\tbody: {\n\t\t\t\tid:\"list\", view:\"list\", borderless: true, autoheight: true, template:\"#title#\", data: config.data\n\t\t\t}\n\t\t};\n\t},\n\t_after_init: function() {\n\t\tthis.attachEvent(\"onItemClick\", function(id){\n\t\t\tthis._selected = this.$eventSource.getItem(id);\n\t\t\tthis.hide();\n\t\t});\n\t},\n\tgetSelected: function() {\n\t\treturn this._selected;\n\t}\n}, webix.ui.popup, webix.IdSpace);","export const clickHandlers = {\n\t\"add\": function(e,id) {\n\t\tconst pivot = webix.$$(this.config.pivot);\n\t\tvar item = this.$$(\"values\").getItem(id);\n\t\titem.operation.push(pivot.config.defaultOperation);\n\t\tthis.$$(\"values\").updateItem(id);\n\n\t\twebix.delay(function(){\n\t\t\tvar index = item.operation.length-1;\n\t\t\tvar els = this.$$(\"values\").getItemNode(id).childNodes;\n\t\t\tvar el = null;\n\t\t\tfor (var i = 0; i < els.length; i++) {\n\t\t\t\tel = els[i];\n\t\t\t\tif (!el.getAttribute)\n\t\t\t\t\tcontinue;\n\t\t\t\tvar op = el.getAttribute(\"webix_operation\");\n\t\t\t\tif (!webix.isUndefined(op) && op == index) break;\n\t\t\t}\n\t\t\tif (el!==null)\n\t\t\t\tclickHandlers.selector.call(this, el, id, el);\n\t\t}, this);\n\t},\n\t\"filter-selector\": function(e,id,el) {\n\t\tvar popup,\n\t\t\tpivot = webix.$$(this.config.pivot),\n\t\t\tselector = {\n\t\t\t\tview: \"webix_pivot_popup\", css: \"webix_pivot_popup\", autofit:true,\n\t\t\t\tautoheight: true, width: 150,\n\t\t\t\tdata: getFilterOptions(pivot.filters.get(), pivot._applyLocale)\n\t\t\t};\n\t\tpopup = webix.ui(selector);\n\t\tpopup.show(el);\n\t\tpopup.attachEvent(\"onHide\", webix.bind(function() {\n\t\t\tvar sel = popup.getSelected();\n\t\t\tif (sel !== null) {\n\t\t\t\tvar item = this.$$(\"filters\").getItem(id);\n\t\t\t\titem.type = sel.name;\n\t\t\t\titem.value = \"\";\n\t\t\t\tthis.$$(\"filters\").updateItem(id);\n\t\t\t}\n\n\t\t\tpopup.close();\n\t\t}, this));\n\t},\n\t\"chart-selector\": function(e,id,el) {\n\t\tvar popup,\n\t\t\tpivot = webix.$$(this.config.pivot),\n\t\t\tselector = {\n\t\t\t\tview: \"webix_pivot_popup\", css: \"webix_pivot_popup\", autofit:true,\n\t\t\t\tautoheight: true, width: 150,\n\t\t\t\tdata: getFilterOptions(pivot.filters.get(), pivot._applyLocale)\n\t\t\t};\n\t\tpopup = webix.ui(selector);\n\t\tpopup.show(el);\n\t\tpopup.attachEvent(\"onHide\", webix.bind(function() {\n\t\t\tvar sel = popup.getSelected();\n\t\t\tif (sel !== null) {\n\t\t\t\tvar item = this.$$(\"filters\").getItem(id);\n\t\t\t\titem.type = sel.name;\n\t\t\t\titem.value = \"\";\n\t\t\t\tthis.$$(\"filters\").updateItem(id);\n\t\t\t}\n\n\t\t\tpopup.close();\n\t\t}, this));\n\t},\n\t\"selector\": function(e,id,el) {\n\t\tvar func_selector = {\n\t\t\tview: \"webix_pivot_popup\", css: \"webix_pivot_popup\", autofit:true,\n\t\t\twidth: 150,\n\t\t\tdata: this.config.operations||[]\n\t\t};\n\t\tvar p = webix.ui(func_selector);\n\t\tp.show(el);\n\t\tp.attachEvent(\"onHide\", webix.bind(function() {\n\t\t\tvar index = webix.html.locate(e, \"webix_operation\");\n\t\t\tvar sel = p.getSelected();\n\t\t\tif (sel !== null) {\n\t\t\t\tthis.$$(\"values\").getItem(id).operation[index] = sel.name;\n\t\t\t\tthis.$$(\"values\").updateItem(id);\n\t\t\t}\n\n\t\t\tp.close();\n\t\t}, this));\n\t},\n\t\"remove\": function(e, id) {\n\t\tvar list = webix.$$(e);\n\t\tvar listId = this.innerId(list.config.id);\n\t\tvar item = this.$$(listId).getItem(id);\n\t\tif(listId == \"values\"){\n\t\t\tlet index = webix.html.locate(e, \"webix_operation\");\n\t\t\tif (item.operation.length > 1) {\n\t\t\t\titem.operation.splice(index, 1);\n\t\t\t\tthis.$$(\"values\").updateItem(id);\n\t\t\t} else {\n\t\t\t\tthis._removeListField(\"values\", item);\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tthis._removeListField(listId, item);\n\t\t}\n\t\treturn false;\n\t}\n};\n\n\nfunction getFilterOptions(filters, process){\n\tvar i, name, items = [];\n\tfor(i =0; i < filters.length; i++){\n\t\tname = filters[i];\n\t\titems.push({name: name, title: process(name)});\n\t}\n\treturn items;\n}","export function setStructure(view, baseName, structure, config){\n\n\tvar uiArrays = [\"rows\", \"cols\"],\n\t\tuiViews = [\"head\", \"body\"],\n\t\tpopup = view,\n\t\teventH = config.on?config.on.onViewInit:null;\n\n\tvar checkStructure = function(id,obj){\n\t\tvar i, j, name;\n\n\t\tfor(i =0; i < uiViews.length;i++ ){\n\t\t\tname = null;\n\t\t\tif(obj[uiViews[i]]){\n\t\t\t\tif(typeof obj[uiViews[i]] == \"string\"){\n\t\t\t\t\tname = obj[uiViews[i]];\n\t\t\t\t\tobj[uiViews[i]] = structure[name];\n\t\t\t\t}\n\t\t\t\tcheckStructure(name, obj[uiViews[i]]);\n\t\t\t}\n\t\t}\n\t\tfor(i =0; i < uiArrays.length;i++ ){\n\t\t\tif(obj[uiArrays[i]]){\n\t\t\t\tlet elements = obj[uiArrays[i]];\n\t\t\t\tfor(j=0; j < elements.length;j++){\n\t\t\t\t\tname = null;\n\t\t\t\t\tif(typeof elements[j] == \"string\"){\n\t\t\t\t\t\tname = elements[j];\n\t\t\t\t\t\tobj[uiArrays[i]][j] = structure[name];\n\t\t\t\t\t}\n\t\t\t\t\tcheckStructure(name, obj[uiArrays[i]][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(id && id!=baseName && !obj.id)\n\t\t\tobj.id = id;\n\t\tif(id){\n\t\t\tif(eventH)\n\t\t\t\teventH.apply(popup,[id,obj]);\n\t\t}\n\t};\n\tcheckStructure(baseName,structure[baseName]);\n\treturn structure[baseName];\n\n}","export const popupTemplates = {\n\theader: function(obj){\n\t\treturn webix.i18n.pivot[obj.value];\n\t},\n\ticonHeader: function(obj){\n\t\tif(obj.icon)\n\t\t\treturn \"<span class='webix_pivot_header_icon webix_pivot_icon pt-\"+obj.icon+\"'></span>\"+webix.i18n.pivot[obj.value];\n\t\telse\n\t\t\treturn \"<span class='webix_pivot_header_icon'>\"+obj.iconContent+\"</span>\"+webix.i18n.pivot[obj.value];\n\t},\n\ttableValues: function (obj) {\n\t\tconst pivot = webix.$$(this.config.pivot);\n\t\tobj.operation = obj.operation || [pivot.config.defaultOperation];\n\t\tif (!webix.isArray(obj.operation))\n\t\t\tobj.operation = [obj.operation];\n\n\t\tvar ops = [];\n\t\tvar locale = pivot._applyLocale;\n\t\tfor (var i = 0; i < obj.operation.length; i++) {\n\t\t\tvar op = \"<div class='webix_pivot_link' webix_operation='\" + i + \"'>\";\n\t\t\top += \"<span>\" + obj.text + \"</span>\";\n\t\t\top += \"<span class='webix_link_selection'>\" + locale(obj.operation[i]) + \"</span>\";\n\t\t\top += \"<span class='webix_pivot_minus webix_icon webix_pivot_close'>&#10005;</span>\";\n\t\t\top += \"</div>\";\n\t\t\tops.push(op);\n\t\t}\n\t\treturn ops.join(\" \");\n\t},\n\tchartValues: function (obj) {\n\t\tconst pivot = webix.$$(this.config.pivot);\n\n\t\tobj.operation = obj.operation || [pivot.config.defaultOperation];\n\t\tobj.color = obj.color || [];\n\n\t\tif (!webix.isArray(obj.operation))\n\t\t\tobj.operation = [obj.operation];\n\n\t\tvar ops = [];\n\t\tvar locale = pivot._applyLocale;\n\n\t\tfor (var i = 0; i < obj.operation.length; i++) {\n\t\t\tif(!obj.color || !obj.color[i]){\n\t\t\t\tobj.color[i] = pivot._getColor(this._valueLength);\n\t\t\t\tthis._valueLength++;\n\t\t\t}\n\t\t\tvar op = \"<div class='webix_pivot_link' webix_operation='\" + i + \"'>\";\n\t\t\top += \"<div class='webix_color_selection'><div style='background-color:\"+locale(obj.color[i])+\"'></div></div>\";\n\t\t\top += \"<div class='webix_link_title'>\" + obj.text + \"</div>\";\n\t\t\top += \"<div class='webix_link_selection'>\" + locale(obj.operation[i]) + \"</div>\";\n\t\t\top += \"<span class='webix_pivot_minus webix_icon webix_pivot_close'>&#10005;</span>\";\n\t\t\top += \"</div>\";\n\t\t\tops.push(op);\n\t\t}\n\t\treturn ops.join(\" \");\n\t},\n\tfilters: function (obj) {\n\t\tvar pivot = webix.$$(this.config.pivot);\n\t\tobj.type = obj.type || pivot.filters.getDefault();\n\t\tvar html = \"<a class='webix_pivot_link'>\" + obj.text;\n\t\thtml += \"<span class='webix_link_selection'>\" + pivot._applyLocale(obj.type) + \"</span>\";\n\t\thtml += \"</a> \";\n\t\thtml += \"<span class='webix_pivot_minus webix_icon webix_pivot_close'>&#10005;</span>\";\n\t\treturn html;\n\t},\n\trows: function (obj) {\n\t\tvar html = \"<a class='webix_pivot_link'>\" + obj.text;\n\t\thtml += \"</a> \";\n\t\thtml += \"<span class='webix_pivot_minus webix_icon webix_pivot_close'>&#10005;</span>\";\n\t\treturn html;\n\t},\n\tcolumns: function (obj) {\n\t\tvar html = \"<a class='webix_pivot_link'>\" + obj.text;\n\t\thtml += \"</a> \";\n\t\thtml += \"<span class='webix_pivot_minus webix_icon webix_pivot_close'>&#10005;</span>\";\n\t\treturn html;\n\t},\n\tgroupBy: function (obj) {\n\t\tvar html = \"<a class='webix_pivot_link'>\" + obj.text;\n\t\thtml += \"</a> \";\n\t\thtml += \"<span class='webix_pivot_minus webix_icon webix_pivot_close'>&#10005;</span>\";\n\t\treturn html;\n\t},\n\tlistDrag: function(obj){\n\t\treturn \"<a class='webix_pivot_link'>\" + obj.text+\"</a> \";\n\t}\n};","export function isArray(obj) {\n\treturn Array.isArray?Array.isArray(obj):(Object.prototype.toString.call(obj) === \"[object Array]\");\n}\n\nexport function isUndefined(a){\n\treturn typeof a == \"undefined\";\n}\n\nexport function extend(base, source, force){\n\t//copy methods, overwrite existing ones in case of conflict\n\tfor (var method in source)\n\t\tif (!base[method] || force)\n\t\t\tbase[method] = source[method];\n\treturn base;\n}\n\nvar seed;\n\nexport function uid(){\n\tif (!seed)\n\t\tseed=(new Date()).valueOf();\n\tseed++;\n\treturn seed;\n}\n\n","import * as clc from \"../operations/popup_clicks.js\";\nimport {popupTemplates} from \"./templates.js\";\n\nexport function getStructureMap(view, config) {\n\treturn {\n\t\t\"popup\": {\n\t\t\twidth: config.popupWidth,\n\t\t\thead: \"toolbar\",\n\t\t\tbody: \"body\"\n\t\t},\n\t\t\"toolbar\": {\n\t\t\tview: \"toolbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: 10,\n\t\t\tcols: [\n\t\t\t\t\"configTitle\",\n\t\t\t\t{\n\t\t\t\t\tmargin: 6,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t\"cancel\",\n\t\t\t\t\t\t\"apply\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t\"configTitle\": {id: \"configTitle\", view: \"label\", label: webix.i18n.pivot.windowTitle || \"\"},\n\t\t\"cancel\": {view: \"button\", id: \"cancel\", label: webix.i18n.pivot.cancel, width: config.cancelButtonWidth},\n\t\t\"apply\": {view: \"button\", id: \"apply\", type: \"form\", label: webix.i18n.pivot.apply, width: config.applyButtonWidth},\n\t\t\"body\": {\n\t\t\ttype: \"wide\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tcss: \"webix_pivot_fields_layout\",\n\t\t\t\t\ttype: \"space\",\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t\"fieldsLayout\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: \"wide\",\n\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttype: \"wide\",\n\t\t\t\t\t\t\t\t\tcss: \"webix_pivot_configuration\",\n\t\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttype: \"wide\",\n\t\t\t\t\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t\t\t\t\t\"filtersLayout\",\n\t\t\t\t\t\t\t\t\t\t\t\t\"columnsLayout\"\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttype: \"wide\",\n\t\t\t\t\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t\t\t\t\t\"rowsLayout\",\n\t\t\t\t\t\t\t\t\t\t\t\t\"valuesLayout\"\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t\"fieldsLayout\": {\n\t\t\twidth: config.fieldsColumnWidth,\n\t\t\trows: [\n\t\t\t\t\"fieldsHeader\",\n\t\t\t\t\"fields\"\n\t\t\t]\n\t\t},\n\t\t\"filtersLayout\": {\n\t\t\trows: [\n\t\t\t\t\"filtersHeader\",\n\t\t\t\t\"filters\"\n\t\t\t]\n\t\t},\n\t\t\"columnsLayout\": {\n\t\t\trows: [\n\t\t\t\t\"columnsHeader\",\n\t\t\t\t\"columns\"\n\t\t\t]\n\t\t},\n\t\t\"rowsLayout\": {\n\t\t\trows: [\n\t\t\t\t\"rowsHeader\",\n\t\t\t\t\"rows\"\n\t\t\t]\n\t\t},\n\t\t\"valuesLayout\": {\n\t\t\trows: [\n\t\t\t\t\"valuesHeader\",\n\t\t\t\t\"values\"\n\t\t\t]\n\t\t},\n\t\t\"fieldsHeader\": {\n\t\t\tid: \"fieldsHeader\", data: {value: \"fields\"}, css: \"webix_pivot_header_fields\",\n\t\t\ttemplate: popupTemplates.header, height: 40\n\t\t},\n\t\t\"fields\": {\n\t\t\tid: \"fields\", css: \"webix_pivot_fields\", view: \"list\", scroll: \"auto\",\n\t\t\ttype: {height: \"auto\"}, drag: true, template: \"<span class='webix_pivot_list_marker'></span>#text#<span class='webix_pivot_icon pt-list-drag'></span>\",\n\t\t\ton: view._getListEvents()\n\t\t},\n\t\t\"filtersHeader\": {\n\t\t\tid: \"filtersHeader\", data: {value: \"filters\", icon: \"filter\"},\n\t\t\ttemplate: popupTemplates.iconHeader, css: \"webix_pivot_popup_title\", height: 40\n\t\t},\n\t\t\"filters\": {\n\t\t\tid: \"filters\", view: \"list\", drag: true, scroll: \"auto\",\n\t\t\ttemplate: webix.bind(popupTemplates.filters, view),\n\t\t\ttype: {height: \"auto\"},\n\t\t\tonClick: {\n\t\t\t\t\"webix_link_selection\": webix.bind(clc.clickHandlers[\"filter-selector\"], view),\n\t\t\t\t\"webix_pivot_minus\": webix.bind(clc.clickHandlers.remove, view)\n\t\t\t},\n\t\t\ton: view._getListEvents()\n\t\t},\n\t\t\"columnsHeader\": {\n\t\t\tid: \"columnsHeader\", data: {value: \"columns\", icon: \"columns\"},\n\t\t\ttemplate: popupTemplates.iconHeader, css: \"webix_pivot_popup_title\", height: 40\n\t\t},\n\t\t\"columns\": {\n\t\t\tid: \"columns\", view: \"list\", drag: true, scroll: \"auto\", type: {height: \"auto\"}, \n\t\t\ttemplate: webix.bind(popupTemplates.columns, view),\n\t\t\ton: view._getListEvents(),\n\t\t\tonClick: {\n\t\t\t\t\"webix_pivot_minus\": webix.bind(clc.clickHandlers.remove, view)\n\t\t\t}\n\t\t},\n\t\t\"rowsHeader\": {\n\t\t\tid: \"rowsHeader\", data: {value: \"rows\", icon: \"list\"},\n\t\t\ttemplate: popupTemplates.iconHeader, css: \"webix_pivot_popup_title\", height: 40\n\t\t},\n\t\t\"rows\": {\n\t\t\tid: \"rows\",\n\t\t\tview: \"list\",\n\t\t\tdrag: true, scroll: \"auto\",\n\t\t\ttemplate: webix.bind(popupTemplates.rows, view),\n\t\t\ttype: {height: \"auto\"},\n\t\t\ton: view._getListEvents(),\n\t\t\tonClick: {\n\t\t\t\t\"webix_pivot_minus\": webix.bind(clc.clickHandlers.remove, view)\n\t\t\t}\n\t\t},\n\t\t\"valuesHeader\": {\n\t\t\tid: \"valuesHeader\", data: {value: \"values\", icon:\"values\"},\n\t\t\ttemplate: popupTemplates.iconHeader, css: \"webix_pivot_popup_title\", height: 40\n\t\t},\n\t\t\"values\": {\n\t\t\tid: \"values\", view: \"list\", scroll: \"auto\", drag: true, css: \"webix_pivot_values\", type: {height: \"auto\"},\n\t\t\ttemplate: webix.bind(popupTemplates.tableValues, view),\n\t\t\tonClick: {\n\t\t\t\t\"webix_link_selection\": webix.bind(clc.clickHandlers.selector, view),\n\t\t\t\t\"webix_pivot_plus\": webix.bind(clc.clickHandlers.add, view),\n\t\t\t\t\"webix_pivot_minus\": webix.bind(clc.clickHandlers.remove, view)\n\t\t\t},\n\t\t\ton: view._getListEvents()\n\t\t}\n\t};\n}\n\n","export function freezeTotals(view){\n\tif(view.config.freezeTotal){\n\t\tvar i, columns = view.$$(\"data\").config.columns;\n\t\tlet width = getWidth(columns);\n\t\tlet totalCount = getTotalCount(columns);\n\n\t\tfor( i =0; i < view.$$(\"data\").config.leftSplit;i++)\n\t\t\twidth -= columns[i].width;\n\n\t\tfor( i =columns.length-1; i > columns.length-totalCount;i--)\n\t\t\twidth -=columns[i].width;\n\n\t\tif(width > 100){\n\t\t\tview.$$(\"data\").config.rightSplit = totalCount;\n\t\t\tview.$$(\"data\").refreshColumns();\n\t\t}\n\t}\n}\n\nfunction getTotalCount(columns){\n\tvar count = 0;\n\tfor(var i=columns.length-1; !count &&i >=0; i--){\n\t\tif(columns[i].header[0] && columns[i].header[0].name == \"total\")\n\t\t\tcount = columns.length-i;\n\t}\n\treturn count;\n}\n\nfunction getWidth(columns){\n\tvar i, width =0;\n\tfor( i =0; i < columns.length;i++ )\n\t\twidth +=columns[i].width;\n\treturn width;\n}","function getTotalColumnId(master, name){\n\treturn \"$webixtotal\" + master.$divider + name;\n}\n\nfunction getValues(item, ids){\n\tvar i, value, values = [];\n\tfor(i=0; i< ids.length;i++){\n\t\tvalue = item[ids[i]];\n\t\tif(!isNaN(parseFloat(value)))\n\t\t\tvalues.push(value);\n\t}\n\treturn values;\n}\n\nexport function addTotalColumns(master, header){\n\tvar groups, groupData, groupName, h, i,\n\t\thRowCount, parts,\n\t\ttotalCols = [];\n\n\n\thRowCount = header[0].header.length;\n\t// if no selected columns\n\tif(hRowCount < 2)\n\t\treturn header;\n\n\tgroupData = getTotalGroups(master, header);\n\tgroups = groupData.groups;\n\tmaster._pivotColumnGroups = groups;\n\tfor( groupName in groups){\n\t\t// column config\n\t\th = {\n\t\t\tid: getTotalColumnId(master, groupName),\n\t\t\theader:[],\n\t\t\tsort:\"int\",\n\t\t\twidth: master.config.columnWidth,\n\t\t\tformat: master.config.format\n\t\t};\n\n\t\t// set top headers\n\t\tfor( i =0; i < hRowCount-1; i++){\n\t\t\tif(!i && !totalCols.length){\n\t\t\t\th.header.push({\n\t\t\t\t\tname: \"total\",\n\t\t\t\t\trowspan: hRowCount-1,\n\t\t\t\t\tcolspan: groupData.count\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t\th.header.push(\"\");\n\t\t}\n\n\t\t// set bottom header\n\t\tparts = groupName.split(master.$divider);\n\t\th.header.push({\n\t\t\tname:groupName,\n\t\t\toperation: parts[0],\n\t\t\ttext: parts[1]\n\t\t});\n\n\t\ttotalCols.push(h);\n\t}\n\n\treturn header.concat(totalCols);\n}\n\nfunction getTotalGroups(master, header){\n\tvar groupName, i, name, operation, parts,\n\t\tgroups = {},\n\t\tgroupCount = 0;\n\n\tfor(i = 0; i< header.length; i++) {\n\t\tparts = header[i].id.split(master.$divider);\n\t\tname = parts.pop();\n\t\toperation = parts.pop();\n\t\tif (operation == \"sum\" || master.config.totalColumn != \"sumOnly\") {\n\t\t\tgroupName = operation + master.$divider + name;\n\t\t\tif (!groups[groupName]){\n\t\t\t\tgroupCount++;\n\t\t\t\tgroups[groupName] = {\n\t\t\t\t\toperation: operation,\n\t\t\t\t\tids:[],\n\t\t\t\t\tformat: header.format\n\t\t\t\t};\n\t\t\t}\n\t\t\tgroups[groupName].ids.push(header[i].id);\n\t\t}\n\t}\n\treturn {groups: groups, count: groupCount};\n}\n\n\nexport function addTotalData(master, items){\n\tvar groups = master._pivotColumnGroups;\n\tif(groups){\n\t\tlet group, i, ids, name;\n\t\tfor(name in groups){\n\t\t\tgroup = groups[name];\n\t\t\tids = group.ids;\n\n\t\t\tfor(i =0; i < items.length; i++){\n\t\t\t\tlet operation,\n\t\t\t\t\tcolumnId = getTotalColumnId(master, name),\n\t\t\t\t\tresult = \"\",\n\t\t\t\t\tvalues = getValues(items[i], ids);\n\t\t\t\tif(values.length){\n\t\t\t\t\tif((operation = master._pivotOperations.getTotal(name.split(master.$divider)[0])))\n\t\t\t\t\t\tresult = operation.call(master, values, columnId, items[i]);\n\t\t\t\t}\n\n\t\t\t\titems[i][columnId] = result;\n\t\t\t\tif(items[i].data)\n\t\t\t\t\titems[i].data = addTotalData(master, items[i].data);\n\t\t\t}\n\t\t}\n\t}\n\treturn items;\n}","import * as clc from \"../operations/popup_clicks.js\";\nimport {setStructure} from \"../operations/set_structure.js\";\nimport {popupTemplates} from \"../structures/templates.js\";\n\nwebix.protoUI({\n\tname: \"webix_pivot_config_common\",\n\t$init: function(config) {\n\t\twebix.extend(config,this.defaults);\n\t\twebix.extend(config, this._getUI(config), true);\n\t\tthis.$ready.push(this._afterInit);\n\t},\n\tdefaults:{\n\t\tpadding:8,\n\t\theight: 500,\n\t\twidth: 700,\n\t\tcancelButtonWidth: 100,\n\t\tapplyButtonWidth: 85,\n\t\thead: false,\n\t\tmodal:true,\n\t\tmove: true\n\t},\n\t_getUI: function() {\n\t\treturn {};\n\t},\n\t_afterInit: function() {},\n\tsetStructure: function(config){\n\t\tthis.define(\"structure\", config);\n\t\tthis.render();\n\t},\n\tgetStructure: function() {\n\t\treturn {};\n\t},\n\t_lists:[],\n\t_dndCorrection:{},\n\tdata_setter: function(value) {\n\t\tvalue = webix.copy(value);\n\n\t\tvar data, i,\n\t\t\tfields = value.fields,\n\t\t\tlists = this._lists;\n\n\t\tfields.forEach(function(field){\n\t\t\tlists.forEach(function(listName){\n\t\t\t\tdata = value[listName];\n\t\t\t\tdata.forEach(function(item){\n\t\t\t\t\tif(item.name == field.name)\n\t\t\t\t\t\tfield.$css = \" webix_pivot_field_selected\";\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\tthis.$$(\"fields\").clearAll();\n\t\tthis.$$(\"fields\").parse(fields);\n\t\t\n\t\tfor( i=0; i < lists.length; i++){\n\t\t\tthis.$$(lists[i]).clearAll();\n\t\t\tthis.$$(lists[i]).parse(value[lists[i]]);\n\t\t}\n\t},\n\t_dropField: function(ctx){\n\t\tvar item,\n\t\t\tfrom = ctx.from,\n\t\t\tto = ctx.to;\n\t\tif(to && to != from){\n\t\t\titem = webix.copy(from.getItem(ctx.start));\n\t\t\tif(to == this.$$(\"fields\"))\n\t\t\t\tthis._removeListField(this.innerId(from.config.id),item);\n\t\t\telse\n\t\t\t\tthis._addListField(this.innerId(to.config.id), item, ctx.index);\n\t\t\treturn false;\n\t\t}\n\t},\n\t_addListField: function(list, item, index){\n\t\tthis._handlers[list].call(this, list, item, index);\n\t},\n\t_removeListField: function(list, item){\n\t\tthis.$$(list).remove(item.id);\n\t\tvar lists = this._lists;\n\t\tvar found = false;\n\t\tfor(var i =0; !found && i < lists.length;i++){\n\t\t\tthis.$$(lists[i]).data.each(function(field){\n\t\t\t\tif(field.name == item.name)\n\t\t\t\t\tfound = field;\n\t\t\t});\n\t\t}\n\t\tif(!found)\n\t\t\tthis._setPivotFieldCss(item.name,\"\");\n\t},\n\t_setPivotFieldCss: function(name, css){\n\t\tthis.$$(\"fields\").data.each(function(item){\n\t\t\tif(item.name == name){\n\t\t\t\titem.$css = \" \"+css;\n\t\t\t\tthis.refresh(item.id);\n\t\t\t}\n\t\t});\n\t},\n\t_handlers: {\n\t\t\"filters\": function(listName, item){\n\t\t\tvar found = false,\n\t\t\t\tname = item.name,\n\t\t\t\tlist = this.$$(listName);\n\n\t\t\tlist.data.each(function(field){\n\t\t\t\tif(field.name == name){\n\t\t\t\t\tfound = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif(!found){\n\t\t\t\tdelete item.id;\n\t\t\t\tlist.add(item);\n\t\t\t\tthis._setPivotFieldCss(name,\"webix_pivot_field_selected\");\n\t\t\t\tthis._correctLists(name, listName);\n\t\t\t}\n\t\t},\n\t\t\"rows\": function(listName, item){\n\t\t\tvar found = false,\n\t\t\t\tname = item.name,\n\t\t\t\tlist = this.$$(listName);\n\n\t\t\tlist.data.each(function(field){\n\t\t\t\tif(field.name == name){\n\t\t\t\t\tfound = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif(!found){\n\t\t\t\tdelete item.id;\n\t\t\t\tlist.add(item);\n\t\t\t\tthis._setPivotFieldCss(name,\"webix_pivot_field_selected\");\n\t\t\t\tthis._correctLists(name, listName);\n\t\t\t}\n\t\t},\n\t\t\"columns\": function(listName, item){\n\t\t\tthis._handlers.rows.call(this,listName, item);\n\t\t},\n\t\t\"values\": function(listName, item, index){\n\t\t\tvar targetItem = null,\n\t\t\t\tlist = this.$$(listName);\n\t\t\tlist.data.each(function(field){\n\t\t\t\tif(field.name == item.name){\n\t\t\t\t\ttargetItem = field;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tif(targetItem){\n\t\t\t\tclc.clickHandlers.add.call(this,{},targetItem.id);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis._setPivotFieldCss(item.name,\"webix_pivot_field_selected\");\n\t\t\t\tlist.add(webix.copy(item),index);\n\t\t\t}\n\t\t\tthis._correctLists(item.name, listName);\n\t\t},\n\t\t\"groupBy\": function(listName, item){\n\t\t\tif(this.$$(listName).data.order.length){\n\t\t\t\tvar id = this.$$(listName).getFirstId();\n\t\t\t\tthis._removeListField(listName, this.$$(\"groupBy\").getItem(id));\n\t\t\t}\n\t\t\tthis._setPivotFieldCss(item.name,\"webix_pivot_field_selected\");\n\t\t\tdelete item.id;\n\t\t\tthis.$$(listName).add(item);\n\t\t\tthis._correctLists(item.name, listName);\n\t\t}\n\t},\n\t_correctLists: function(name, listName){\n\t\tvar i, res,\n\t\t\tlists = this._dndCorrection[listName];\n\t\tfor( i=0; lists && i< lists.length; i++ ){\n\t\t\tres = null;\n\t\t\tthis.$$(lists[i]).data.each(function(item){\n\t\t\t\tif(item.name == name)\n\t\t\t\t\tres = item;\n\t\t\t});\n\t\t\tif(res)\n\t\t\t\tthis.$$(lists[i]).remove(res.id);\n\t\t}\n\t},\n\t_setStructure: function(structure, config){\n\t\treturn setStructure(this,\"popup\",structure, config);\n\t},\n\t_listDragHTML: function(context){\n\t\tif(context.start){\n\t\t\tvar item = this.getItem(context.start);\n\t\t\tcontext.html = this.type.templateStart(item,this.type)+popupTemplates.listDrag(item)+this.type.templateEnd(item, this.type);\n\n\t\t}\n\t},\n\t_getListEvents: function(){\n\t\treturn {\n\t\t\tonBeforeDrop: webix.bind(this._dropField,this),\n\t\t\tonBeforeDrag: this._listDragHTML,\n\t\t\tonBeforeDragIn: function(){\n\t\t\t\twebix.html.addCss(webix.DragControl.getNode(),\"webix_pivot_drag_zone\",true);\n\t\t\t}\n\t\t};\n\t}\n}, webix.ui.window, webix.IdSpace);","import \"./commonpopup.js\";\nimport {getStructureMap} from \"../structures/tablepopup.js\";\n\n\nwebix.protoUI({\n\tname: \"webix_pivot_config\",\n\tdefaults:{\n\t\tfieldsColumnWidth: 230,\n\t\tpopupWidth: 890\n\t},\n\t$init: function() {\n\t\tthis.$view.className += \" webix_popup webix_pivot\";\n\t},\n\t_getUI: function(config) {\n\t\tvar structure = webix.copy(getStructureMap(this, config));\n\t\treturn this._setStructure(structure, config);\n\t},\n\t_lists:[\"filters\",\"columns\",\"rows\",\"values\"],\n\t_dndCorrection: {\n\t\t\"rows\": [\"columns\",\"values\"],\n\t\t\"columns\": [\"rows\"],\n\t\t\"values\": [\"rows\"]\n\t},\n\t_afterInit: function() {\n\t\tthis.attachEvent(\"onItemClick\", function(id){\n\t\t\tvar innerId = this.innerId(id);\n\t\t\tif (innerId == \"cancel\" || innerId == \"apply\"){\n\t\t\t\t//transform button clicks to events\n\t\t\t\tvar structure = this.getStructure();\n\n\t\t\t\tif(webix.$$(this.config.pivot).callEvent(\"onBefore\"+innerId, [structure])){\n\t\t\t\t\tthis.callEvent(\"on\"+innerId, [structure]);\n\t\t\t\t\tthis.hide();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tvar popupBlocks = this.$view.querySelectorAll(\".webix_pivot_configuration .webix_list\");\n\t\tfor (var i = 0; i < popupBlocks.length; i++) {\n\t\t\tpopupBlocks[i].setAttribute(\"window-message\", webix.i18n.pivot.windowMessage);\n\t\t}\n\t},\n\tgetStructure: function() {\n\t\tvar structure = { rows:[], columns:[],values:[],filters:[] };\n\n\t\tvar rows = this.$$(\"rows\");\n\t\trows.data.each(function(obj){\n\t\t\tstructure.rows.push(obj.name); });\n\n\t\tvar columns = this.$$(\"columns\");\n\t\tcolumns.data.each(function(obj){\n\t\t\tstructure.columns.push(obj.name); });\n\n\n\t\tvar values = this.$$(\"values\");\n\t\tvalues.data.each(function(obj){\n\t\t\tstructure.values.push(obj); });\n\n\t\tvar filters = this.$$(\"filters\");\n\t\tfilters.data.each(function(obj){\n\t\t\tstructure.filters.push(obj);\n\t\t});\n\n\t\tvar pivot = webix.$$(this.config.pivot);\n\n\t\tif(pivot.config.structure.columnSort)\n\t\t\tstructure.columnSort = pivot.config.structure.columnSort;\n\n\t\treturn structure;\n\t}\n}, webix.ui.webix_pivot_config_common);","import * as hlp from \"./helpers.js\";\nimport {addTotalColumns} from \"./total_columns.js\";\n\n\n// default sorting properties\nvar sortConfig = {\n\tdir: 1,\n\tas: function(a,b){\n\t\tif(isNum(a) && isNum(b))\n\t\t\treturn sorting.int(a,b);\n\t\treturn sorting.string(a,b);\n\t}\n};\n\nvar sorting = {\n\t\"date\":function(a,b){\n\t\ta=a-0; b=b-0;\n\t\treturn a>b?1:(a<b?-1:0);\n\t},\n\t\"int\":function(a,b){\n\t\ta = a*1; b=b*1;\n\t\treturn a>b?1:(a<b?-1:0);\n\t},\n\t\"string\":function(a,b){\n\t\tif (!b) return 1;\n\t\tif (!a) return -1;\n\t\ta = a.toString().toLowerCase(); b=b.toString().toLowerCase();\n\t\treturn a>b?1:(a<b?-1:0);\n\t}\n};\n\nexport function processHeader(master, header) {\n\tvar i, j, p, text0, vConfig,\n\t\tvaluesConfig = master.config.structure.values;\n\n\theader = sortHeader(master.config.structure, header);\n\n\theader = getHeader(master, header);\n\n\tfor (i = 0; i < header.length; i++) {\n\t\tvar parts = [];\n\t\tfor (j = 0; j < header[i].length; j++)\n\t\t\tparts.push(header[i][j].name);\n\n\t\t// find value configuration\n\t\tvConfig = null;\n\t\tvar tmp = parts[parts.length-1].split(master.$divider);\n\t\tfor(j =0; j < valuesConfig.length && !vConfig; j++){\n\t\t\tif(valuesConfig[j].operation)\n\t\t\t\tfor(p =0; p< valuesConfig[j].operation.length; p++){\n\t\t\t\t\tif(valuesConfig[j].name == tmp[1] && valuesConfig[j].operation[p] == tmp[0]){\n\t\t\t\t\t\tvConfig = valuesConfig[j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\n\t\theader[i] = {id: parts.join(master.$divider), header: header[i]};\n\t\theader[i].format = (vConfig && vConfig.format) ?\n\t\t\tvConfig.format :\n\t\t\t(tmp[0] != \"count\" ? master.config.format : null);\n\t}\n\n\tif(header.length && master.view && master.view.callEvent)\n\t\tmaster.view.callEvent(\"onHeaderInit\", [header]);\n\n\tif(master.config.totalColumn && header.length)\n\t\theader = addTotalColumns(master, header);\n\n\theader.splice(0, 0, {id:\"name\", template:\"{common.treetable()} #name#\", header:{ text:  text0}});\n\n\treturn header;\n}\n\nfunction isNum(value){\n\treturn !isNaN(value*1);\n}\n\n/*\n* get sort properties for a column\n* */\nfunction setSortConfig(config, column){\n\tvar sorting = sortConfig;\n\tif(config){\n\t\t// for a specific columns\n\t\tif(config[column])\n\t\t\tsorting = config[column];\n\t\t// for any other column\n\t\telse if(config.$default)\n\t\t\tsorting = config.$default;\n\n\t\tif(sorting.dir)\n\t\t\tsorting._dir = sorting.dir==\"desc\"?-1:1;\n\t\thlp.extend(sorting,sortConfig);\n\t}\n\treturn sorting;\n}\n\n\nfunction sortHeader(config, header,cIndex){\n\tvar column, i, key, keys, sorting,\n\t\tsorted = [];\n\n\tif(Object.keys && config.columnSort !== false){\n\t\tcIndex = cIndex||0;\n\n\t\tcolumn = config.columns[cIndex];\n\t\tsorting = setSortConfig(config.columnSort, column);\n\t\tkeys = Object.keys(header);\n\t\tif (cIndex < config.columns.length)\n\t\t\tkeys = keys.sort(function(a,b){\n\t\t\t\treturn sorting.as(a,b)*sorting._dir;\n\t\t\t});\n\t\tcIndex++;\n\n\t\tfor(i=0; i < keys.length; i++){\n\t\t\tkey = keys[i];\n\t\t\tsorted.push({\n\t\t\t\tkey: key,\n\t\t\t\tdata: sortHeader(config, header[key], cIndex)\n\t\t\t});\n\t\t}\n\t}\n\telse{\n\t\tfor(key in header){\n\t\t\tsorted.push({\n\t\t\t\tkey: key,\n\t\t\t\tdata: sortHeader(config, header[key])\n\t\t\t});\n\t\t}\n\t}\n\n\treturn sorted;\n}\n\nfunction getHeader(view, data) {\n\n\tvar first, i, item, j, h,\n\t\theader = [];\n\n\tfor (i =0; i < data.length; i++) {\n\t\titem = data[i];\n\n\t\tif (item.data.length) {\n\t\t\tlet result = getHeader(view, item.data);\n\t\t\tfirst = false;\n\t\t\tfor (j = 0; j < result.length; j++) {\n\t\t\t\th = result[j];\n\t\t\t\th.splice(0, 0, { name:item.key});\n\t\t\t\tif (!first) {\n\t\t\t\t\th[0].colspan = result.length;\n\t\t\t\t\tfirst = true;\n\t\t\t\t}\n\t\t\t\theader.push(h);\n\t\t\t}\n\t\t} else {\n\t\t\tlet keys = data[i].key.split(view.$divider);\n\t\t\theader.push([{ name: data[i].key, operation:keys[0], text:keys[1]}]);\n\t\t}\n\t}\n\treturn header;\n}","import * as hlp from \"./helpers.js\";\n\nexport function addFooter(master, columns, items){\n\tvar config, i, names, operation;\n\n\tfor(i=1; i < columns.length;i++){\n\t\tconfig = null;\n\t\tnames = columns[i].id.split(master.$divider);\n\t\toperation = names[names.length-2];\n\t\tif(master.config.footer == \"sumOnly\"){\n\t\t\tif(operation != \"sum\")\n\t\t\t\tconfig = \" \";\n\t\t}\n\t\tlet totalMethod = master._pivotOperations.getTotal(operation);\n\t\tif(!config && totalMethod){\n\t\t\tlet options = master._pivotOperations.getTotalOptions(operation);\n\t\t\tlet result = calculateColumn(items, columns[i].id, totalMethod, options&&options.leavesOnly);\n\t\t\tconfig = {\n\t\t\t\t$pivotValue: result,\n\t\t\t\t$pivotOperation: operation\n\t\t\t};\n\t\t}\n\t\telse\n\t\t\tconfig = \" \";\n\t\tcolumns[i].footer = config;\n\n\t\tif(typeof master.config.footer == \"object\"){\n\t\t\thlp.extend(columns[i].footer, master.config.footer, true);\n\t\t}\n\t}\n}\n\nfunction calculateColumn(items, columnId, totalMethod, leaves){\n\tvar i, fItems= [], value, values = [];\n\t// filter items\n\titems = filterItems(items, leaves);\n\t// get column values\n\tfor(i=0; i< items.length; i++){\n\t\tvalue = items[i][columnId];\n\t\tif (!isNaN(parseFloat(value))){\n\t\t\tvalues.push(value*1);\n\t\t\tfItems.push(items[i]);\n\t\t}\n\t}\n\treturn totalMethod(values, columnId, fItems);\n}\n\nfunction filterItems(items, leaves, selectedItems){\n\tif(!selectedItems)\n\t\tselectedItems = [];\n\tfor(var i=0; i < items.length;i++){\n\t\tif(leaves && items[i].data)\n\t\t\tfilterItems(items[i].data, leaves, selectedItems);\n\t\telse\n\t\t\tselectedItems.push(items[i]);\n\t}\n\treturn selectedItems;\n}\n\n","export function calculateItem(item, config, master) {\n\tvar i, isIds, key, leaves, operation, tmp, values,\n\t\theader = config.header;\n\n\tfor (i = 0; i < header.length; i++) {\n\t\tkey = header[i];\n\t\ttmp = key.split(config.divider);\n\t\toperation = tmp[tmp.length-2];\n\n\t\tvalues = item[key];\n\n\t\tleaves = config.operations.getOption(operation,\"leavesOnly\");\n\t\tisIds = config.operations.getOption(operation,\"ids\");\n\t\tif(leaves && item.data){\n\t\t\tvalues = [];\n\t\t\tgetKeyLeaves(item.data,key,values);\n\t\t}\n\t\tif (values){\n\t\t\tvar data = [];\n\t\t\tvar ids = [];\n\t\t\tfor(var j=0; j < values.length;j++){\n\t\t\t\tlet value = values[j];\n\t\t\t\tlet id = null;\n\t\t\t\tif (typeof value == \"object\") {\n\t\t\t\t\tvalue = value.value;\n\t\t\t\t\tid = values[j].id;\n\t\t\t\t}\n\t\t\t\tif (value || value == \"0\") {\n\t\t\t\t\tdata.push(value);\n\t\t\t\t\tif (id) ids.push(id);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(data.length)\n\t\t\t\titem[key] = config.operations.get(operation)(data, key, item, isIds?ids:null);\n\t\t\telse\n\t\t\t\titem[key] = \"\";\n\t\t}\n\t\telse\n\t\t\titem[key] = \"\";\n\n\n\t\t//watchdog\n\t\tmaster.count++;\n\t}\n\treturn item;\n}\n\nfunction getKeyLeaves(data, key, result){\n\tvar i;\n\n\tfor(i=0; i < data.length;i++){\n\t\tif(data[i].data)\n\t\t\tgetKeyLeaves(data[i].data,key,result);\n\t\telse\n\t\t\tresult.push(data[i][key]);\n\t}\n}\n\nexport function setMinMax(item, config) {\n\tvar i, j, key,\n\t\tmaxArr, maxValue, minArr, minValue,\n\t\tvalue,\n\t\theader = config.header,\n\t\tmax = config.max,\n\t\tmin = config.min,\n\t\tvalues = config.values;\n\n\t// nothing to do\n\tif (!min && !max)\n\t\treturn item;\n\n\t//values = structure.values;\n\tif (!item.$cellCss) item.$cellCss = {};\n\n\t// calculating for each value\n\tfor (i = 0; i < values.length; i++) {\n\t\tvalue = values[i];\n\t\tmaxArr=[];\n\t\tmaxValue=-99999999;\n\t\tminArr=[];\n\t\tminValue=99999999;\n\n\t\tfor (j = 0; j < header.length; j++) {\n\t\t\tkey = header[j];\n\t\t\tif (isNaN(item[key])) continue;\n\t\t\t// it's a another value\n\t\t\tif (key.indexOf(value.name) === -1) continue;\n\n\t\t\tif (max && item[key] > maxValue) {\n\t\t\t\tmaxArr = [ key ];\n\t\t\t\tmaxValue = item[key];\n\t\t\t} else if (item[key] == maxValue) {\n\t\t\t\tmaxArr.push(key);\n\t\t\t}\n\t\t\tif (min && item[key] < minValue) {\n\t\t\t\tminArr = [ key ];\n\t\t\t\tminValue = item[key];\n\t\t\t} else if (item[key] == minValue) {\n\t\t\t\tminArr.push(key);\n\t\t\t}\n\t\t}\n\n\t\tfor (j = 0; j < minArr.length; j++) {\n\t\t\titem.$cellCss[minArr[j]] = \"webix_min\";\n\t\t}\n\t\tfor (j = 0; j < maxArr.length; j++) {\n\t\t\titem.$cellCss[maxArr[j]] = \"webix_max\";\n\t\t}\n\t}\n\treturn item;\n}\n","import * as hlp from \"./helpers.js\";\nfunction numHelper(fvalue, value, func) {\n\tif(typeof fvalue == \"object\"){\n\t\tfor(var i=0; i < fvalue.length; i++){\n\t\t\tfvalue[i] = parseFloat(fvalue[i]);\n\t\t\tif (isNaN(fvalue[i])) return true;\n\t\t}\n\t}\n\telse{\n\t\tfvalue = parseFloat(fvalue);\n\t\t// if filter value is not a number then ignore such filter\n\t\tif (isNaN(fvalue)) return true;\n\t}\n\t// if row value is not a number then don't show this row\n\tif (isNaN(value)) return false;\n\treturn func(fvalue, value);\n}\n\nexport const rules = {\n\tcontains: function(fvalue, value) {\n\t\treturn value.toLowerCase().indexOf(fvalue.toString().toLowerCase()) >= 0;\n\t},\n\tequal: function(fvalue, value) {\n\t\treturn numHelper(fvalue, value, function(fvalue, value) {\n\t\t\treturn (fvalue == value);\n\t\t});\n\t},\n\tnot_equal: function(fvalue, value) {\n\t\treturn numHelper(fvalue, value, function(fvalue, value) {\n\t\t\treturn (fvalue != value);\n\t\t});\n\t},\n\tless: function(fvalue, value) {\n\t\treturn numHelper(fvalue, value, function(fvalue, value) {\n\t\t\treturn (value < fvalue);\n\t\t});\n\t},\n\tless_equal: function(fvalue, value) {\n\t\treturn numHelper(fvalue, value, function(fvalue, value) {\n\t\t\treturn (value <= fvalue);\n\t\t});\n\t},\n\tmore: function(fvalue, value) {\n\t\treturn numHelper(fvalue, value, function(fvalue, value) {\n\t\t\treturn (value > fvalue);\n\t\t});\n\t},\n\tmore_equal: function(fvalue, value) {\n\t\treturn numHelper(fvalue, value, function(fvalue, value) {\n\t\t\treturn (value >= fvalue);\n\t\t});\n\t},\n\tmulti: function(fvalues, value){\n\t\tif (typeof fvalues === \"string\")\n\t\t\tfvalues = fvalues.split(\",\");\n\n\t\tfor(var i=0; i < fvalues.length; i++){\n\t\t\tif (value == fvalues[i])\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\trange: function(fvalue, value){\n\t\treturn numHelper(fvalue, value, function(fvalue, value) {\n\t\t\treturn (value < fvalue[1] && value >= fvalue[0]);\n\t\t});\n\t},\n\trange_inc: function(fvalue, value){\n\t\treturn numHelper(fvalue, value, function(fvalue, value) {\n\t\t\treturn (value <= fvalue[1] && value >= fvalue[0]);\n\t\t});\n\t}\n};\n\nexport function setFilterValues(filters){\n\tfilters = filters || [];\n\n\tfor (var i = 0; i < filters.length; i++) {\n\t\tlet f = filters[i],\n\t\t\tfvalue = f.fvalue;\n\t\tif(typeof fvalue == \"function\"){\n\t\t\tf.func = fvalue;\n\t\t}  else if(f.type == \"select\" || f.type == \"richselect\"){\n\t\t\tf.func = function(fvalue, value) {\n\t\t\t\treturn fvalue == value;\n\t\t\t};\n\t\t\tfvalue = (fvalue||\"\");\n\t\t} else if(f.type.indexOf(\"multi\") >-1){\n\t\t\tf.func = rules.multi;\n\t\t} else if (typeof fvalue === \"object\") {\n\t\t\tf.func = rules.range;\n\t\t} else if (fvalue.substr(0,1) == \"=\") {\n\t\t\tf.func = rules.equal;\n\t\t\tfvalue = fvalue.substr(1);\n\t\t} else if (fvalue.substr(0,2) == \"<>\") {\n\t\t\tf.func = rules.not_equal;\n\t\t\tfvalue = fvalue.substr(2);\n\t\t} else if (fvalue.substr(0,2) == \">=\") {\n\t\t\tf.func = rules.more_equal;\n\t\t\tfvalue = fvalue.substr(2);\n\t\t} else if (fvalue.substr(0,1) == \">\") {\n\t\t\tf.func = rules.more;\n\t\t\tfvalue = fvalue.substr(1);\n\t\t} else if (fvalue.substr(0,2) == \"<=\") {\n\t\t\tf.func = rules.less_equal;\n\t\t\tfvalue = fvalue.substr(2);\n\t\t} else if (fvalue.substr(0,1) == \"<\") {\n\t\t\tf.func = rules.less;\n\t\t\tfvalue = fvalue.substr(1);\n\t\t}else if (fvalue.indexOf(\"...\") > 0) {\n\t\t\tf.func = rules.range;\n\t\t\tfvalue = fvalue.split(\"...\");\n\t\t}else if (fvalue.indexOf(\"..\") > 0) {\n\t\t\tf.func = rules.range_inc;\n\t\t\tfvalue = fvalue.split(\"..\");\n\t\t} else if(f.type == \"datepicker\"){\n\t\t\tf.func = function(fvalue, value) {\n\t\t\t\treturn fvalue == value;\n\t\t\t};\n\t\t}else\n\t\t\tf.func = rules.contains;\n\n\t\tf.fvalue = fvalue;\n\t}\n}\n\nexport function formatFilterValues(filters) {\n\tvar i, fvalue;\n\tfilters = filters || [];\n\tfor (i = 0; i < filters.length; i++) {\n\t\tfvalue = (filters[i].fvalue || filters[i].value || \"\");\n\t\tif (typeof fvalue == \"string\") {\n\t\t\tif (fvalue.trim)\n\t\t\t\tfvalue = fvalue.trim();\n\t\t}\n\t\tfilters[i].fvalue = fvalue;\n\t}\n}\n\nexport function filterItem(filters, item, map){\n\tif(filters){\n\t\tlet i, f;\n\t\tfor (i = 0; i < filters.length; i++) {\n\t\t\tf = filters[i];\n\t\t\tif (f.fvalue){\n\t\t\t\tlet field = map && map[f.name]?map[f.name]:f.name;\n\t\t\t\tif (hlp.isUndefined(item[field]))\n\t\t\t\t\treturn false;\n\n\t\t\t\tvar raw = item[field];\n\t\t\t\tif (!raw !== 0 && !raw) return false;\n\n\t\t\t\tvar value = raw.toString();\n\t\t\t\tvar result = f.func(f.fvalue, value);\n\n\t\t\t\tif (!result)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}","import * as hlp from \"./helpers.js\";\nimport {processHeader} from \"./header.js\";\nimport {addTotalData} from \"./total_columns.js\";\nimport {addFooter} from \"./footer.js\";\nimport * as itm from \"./item_values.js\";\nimport * as flt from \"./filters.js\";\n\nexport class Data{\n\tconstructor(master, config){\n\t\tthis.master = master;\n\t\tthis.config = config;\n\t\tthis.count = 0;\n\t}\n\n\tget operations(){\n\t\treturn this.master._pivotOperations;\n\t}\n\n\tget divider(){\n\t\treturn this.master.$divider;\n\t}\n\tget structure(){\n\t\treturn this.config.structure;\n\t}\n\n\tprocess(data, order){\n\t\tthis.watch = new Date();\n\t\tvar columns, fields, header, i, items;\n\n\t\tvar structure = this.structure;\n\t\tstructure._header = [];\n\t\tstructure._header_hash = {};\n\n\t\tflt.formatFilterValues(structure.filters);\n\t\tflt.setFilterValues(structure.filters);\n\n\t\tfor (i = 0; i < structure.values.length; i++) {\n\t\t\tstructure.values[i].operation = structure.values[i].operation || [this.config.defaultOperation];\n\t\t\tif (!hlp.isArray(structure.values[i].operation))\n\t\t\t\tstructure.values[i].operation = [structure.values[i].operation];\n\t\t}\n\n\t\tcolumns = [];\n\t\tfor(i=0;i< structure.columns.length; i++){\n\t\t\tcolumns[i] = (typeof structure.columns[i] == \"object\"?(structure.columns[i].id||i):structure.columns[i]);\n\t\t}\n\n\t\tfields = structure.rows.concat(columns);\n\t\titems = this.group(data, order, fields);\n\n\t\theader = {};\n\t\tif (structure.rows.length > 0)\n\t\t\titems = this.processRows(items, structure.rows, structure, header, \"\");\n\t\telse {\n\t\t\t// there are no rows in structure, only columns and values\n\t\t\tthis.processColumns(items, columns, structure, header);\n\t\t\titems = [];\n\t\t}\n\n\t\theader = processHeader(this.master, header);\n\n\t\titems = addTotalData(this.master, items);\n\n\t\tif(this.config.footer)\n\t\t\taddFooter(this.master, header, items);\n\n\t\tdelete structure._header;\n\t\tdelete structure._header_hash;\n\n\t\treturn { header: header, data: items };\n\t}\n\n\tprocessColumns(data, columns, structure, header, item, name) {\n\t\tvar vname;\n\n\t\titem = item || { $source: [] };\n\t\tif (columns.length > 0) {\n\t\t\tname = name || \"\";\n\t\t\tfor (let i in data) {\n\t\t\t\tif(!header[i])\n\t\t\t\t\theader[i] = {};\n\t\t\t\tdata[i] = this.processColumns(data[i], columns.slice(1), structure, header[i], item, (name.length>0 ? (name + this.divider) :\"\") + i);\n\t\t\t}\n\t\t} else {\n\t\t\tvar values = structure.values;\n\t\t\tfor (var id in data) {\n\t\t\t\titem.$source.push(id);\n\t\t\t\tfor (let i = 0; i < values.length; i++) {\n\t\t\t\t\tfor (var j = 0; j < values[i].operation.length; j++) {\n\t\t\t\t\t\tif(typeof name !== \"undefined\")\n\t\t\t\t\t\t\tvname = name + this.divider + values[i].operation[j] + this.divider + values[i].name;\n\t\t\t\t\t\telse // if no columns\n\t\t\t\t\t\t\tvname = values[i].operation[j] + this.divider + values[i].name;\n\t\t\t\t\t\tif (!structure._header_hash[vname]) {\n\t\t\t\t\t\t\tstructure._header.push(vname);\n\t\t\t\t\t\t\tstructure._header_hash[vname] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (hlp.isUndefined(item[vname])) {\n\t\t\t\t\t\t\titem[vname] = [];\n\t\t\t\t\t\t\theader[values[i].operation[j] + this.divider + values[i].name] = {};\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\titem[vname].push({value:data[id][values[i].name],id: id});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn item;\n\t}\n\n\tprocessRows(data, rows, structure, header, prefix) {\n\t\tvar i, item, j, k, value,\n\t\t\titems = [];\n\t\tif (rows.length > 1) {\n\t\t\tfor (i in data)\n\t\t\t\tdata[i] = this.processRows(data[i], rows.slice(1), structure, header, prefix+\"_\"+i);\n\n\t\t\tvar values = structure._header;\n\n\t\t\tfor (i in data) {\n\t\t\t\titem = { data: data[i] };\n\t\t\t\tfor (j = 0; j < item.data.length; j++) {\n\t\t\t\t\tfor (k = 0; k < values.length; k++) {\n\t\t\t\t\t\tvalue = values[k];\n\t\t\t\t\t\tif (hlp.isUndefined(item[value]))\n\t\t\t\t\t\t\titem[value] = [];\n\t\t\t\t\t\titem[value].push(item.data[j][value]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.setItemValues(item);\n\t\t\t\tif (this.master.config.stableRowId)\n\t\t\t\t\titem.id = prefix + \"_\" + i;\n\n\t\t\t\titem.name = i;\n\t\t\t\titem.open = true;\n\t\t\t\titems.push(item);\n\t\t\t}\n\t\t} else {\n\t\t\tfor (i in data) {\n\t\t\t\titem = this.processColumns(data[i], structure.columns, structure, header);\n\t\t\t\titem.name = i;\n\n\t\t\t\tif (this.master.config.stableRowId)\n\t\t\t\t\titem.id = prefix + \"_\" + i;\n\n\t\t\t\tthis.setItemValues(item);\n\t\t\t\titems.push(item);\n\t\t\t}\n\t\t}\n\t\treturn items;\n\t}\n\n\tsetItemValues(item){\n\t\titem = itm.calculateItem(item, {\n\t\t\theader: this.structure._header,\n\t\t\tdivider: this.divider,\n\t\t\toperations: this.operations\n\t\t}, this);\n\t\titem = itm.setMinMax(item,{\n\t\t\theader: this.structure._header,\n\t\t\tmax: this.config.max,\n\t\t\tmin: this.config.min,\n\t\t\tvalues: this.structure.values\n\t\t});\n\n\t\t//watchdog\n\t\tif (this.count > 50000){\n\t\t\tthis.count = 0;\n\t\t\tif (this.config.ping)\n\t\t\t\tthis.config.ping.call(this, this.watch);\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tgroup(data, order, fields ){\n\t\tvar i, id, item,\n\t\t\thash = {};\n\n\t\tfor (i = 0; i < order.length; i++) {\n\t\t\tid = order[i];\n\t\t\titem = data[id];\n\t\t\tif (item && flt.filterItem(this.structure.filters, item, this.config.filterMap)){\n\t\t\t\tthis.groupItem(hash, item, fields );\n\t\t\t}\n\t\t}\n\t\treturn hash;\n\t}\n\n\tgroupItem(hash, item, fields ){\n\t\tif(fields.length){\n\t\t\tvar value = item[fields[0]];\n\t\t\tif (typeof value === \"undefined\") return null;\n\n\t\t\tif(hlp.isUndefined(hash[value]))\n\t\t\t\thash[value] = {};\n\t\t\tthis.groupItem(hash[value], item, fields.slice(1));\n\t\t}\n\t\telse\n\t\t\thash[item.id] = item;\n\t}\n\n\tfilterItem(item){\n\t\tvar filters = this.structure.filters || [];\n\t\tfor (var i = 0; i < filters.length; i++) {\n\t\t\tvar f = filters[i];\n\t\t\tif (f.fvalue){\n\t\t\t\tif (hlp.isUndefined(item[f.name]))\n\t\t\t\t\treturn false;\n\n\t\t\t\tvar value = item[f.name].toString().toLowerCase();\n\t\t\t\tvar result = f.func(f.fvalue, value);\n\n\t\t\t\tif (!result)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n}\n","import * as hlp from \"./helpers.js\";\n\nconst operations =  {\n\tsum: function(values) {\n\t\tvar sum = 0;\n\t\tfor (var i = 0; i < values.length; i++) {\n\t\t\tvar value = values[i];\n\t\t\tvalue = parseFloat(value, 10);\n\t\t\tif (!isNaN(value))\n\t\t\t\tsum += value;\n\t\t}\n\t\treturn sum;\n\t},\n\tcount: function(data, key, item) {\n\t\tvar count = 0;\n\t\tif(!item.data)\n\t\t\tcount = data.length;\n\t\telse{\n\t\t\tfor(var i=0; i < item.data.length; i++)\n\t\t\t\tcount += item.data[i][key]||0;\n\t\t}\n\t\treturn count;\n\t},\n\tmax: function(args) {\n\t\tif (args.length == 1) return args[0];\n\t\treturn Math.max.apply(this, args);\n\t},\n\tmin: function(args) {\n\t\tif (args.length == 1) return args[0];\n\t\treturn Math.min.apply(this, args);\n\t}\n};\n\nconst totalOperations = {\n\t\"sum\": function(values){\n\t\tvar i, sum = 0;\n\t\tfor (i = 0; i < values.length; i++)\n\t\t\tsum += values[i];\n\t\treturn sum;\n\t},\n\t\"min\": function(values){\n\t\tif (values.length == 1) return values[0];\n\t\treturn Math.min.apply(null,values);\n\t},\n\t\"max\": function(values){\n\t\tif (values.length == 1) return values[0];\n\t\treturn Math.max.apply(null,values);\n\t},\n\t\"count\": function(values){\n\t\tvar value = totalOperations.sum.call(this, values);\n\t\treturn value?parseInt(value,10):\"\";\n\t}\n};\n\nexport class Operations{\n\tconstructor() {\n\t\tthis.pull = hlp.extend({},operations);\n\t\tthis.options = {};\n\t\tthis.pullTotal = hlp.extend({},totalOperations);\n\t\tthis.totalOptions = {};\n\t}\n\n\tserialize() {\n\t\tvar str = {};\n\t\tfor (let key in this.pull)\n\t\t\tstr[key] = this.pull[key].toString();\n\t\treturn str;\n\t}\n\n\tparse(str){\n\t\tfor (var key in str){\n\t\t\teval(\"this.temp = \"+str[key]);\n\t\t\tthis.pull[key] = this.temp;\n\t\t}\n\t}\n\n\tadd(name, method, options){\n\t\tthis.pull[name] = method;\n\t\tif(options)\n\t\t\tthis.options[name] = options;\n\t}\n\n\taddTotal(name, method, options){\n\t\tthis.pullTotal[name] = method;\n\t\tif(options)\n\t\t\tthis.totalOptions[name] = options;\n\t}\n\n\tget(name){\n\t\treturn this.pull[name]||null;\n\t}\n\tgetOptions(name){\n\t\treturn this.options[name]||null;\n\t}\n\tgetOption(name,option){\n\t\treturn this.options[name]?this.options[name][option]:null;\n\t}\n\n\tgetTotal(name){\n\t\treturn this.pullTotal[name] || this.pull[name]||null;\n\t}\n\tgetTotalOptions(name){\n\t\treturn this.pullTotal[name]?(this.totalOptions[name])||null:(this.options[name]||null);\n\t}\n\tgetTotalOption(name,option){\n\t\tvar options = this.getTotalOptions(name);\n\t\treturn options?options[name][option]:null;\n\t}\n}\n\n","import {Data} from \"./data.js\";\nimport {Operations} from \"./operations.js\";\nimport * as hlp from \"./helpers.js\";\n\nconst divider = \"_'_\";\n\nexport function _Pivot(config, master){\n\tthis.$divider = divider;\n\tthis._initOperations();\n\tthis.config = config;\n\tthis.view = master;\n\n\tif (config.webWorker && !typeof(Worker) !== \"undefined\" && master){\n\t\tthis._initWorker(config, master);\n\t} else\n\t\tthis._pivotData = new Data(this, this.config);\n\n\tif (!this.config.structure)\n\t\tthis.config.structure = {};\n\thlp.extend(this.config.structure, { rows:[], columns:[], values:[], filters:[] });\n}\n\n_Pivot.prototype = {\n\t_initWorker(config, master){\n\t\tthis._result = null;\n\t\tthis._pivotWorker = new Worker(config.webWorker);\n\t\tthis._pivotWorker.onmessage = (e) => {\n\t\t\tif (e.data.type === \"ping\"){\n\t\t\t\tmaster._runPing(e.data.watch, master);\n\t\t\t} else if (master._result && !master.$destructed){\n\t\t\t\tmaster.callEvent(\"onWebWorkerEnd\", []);\n\t\t\t\tif (!e.data.id || e.data.id === master._result_id){\n\t\t\t\t\tmaster._result(e.data.data);\n\t\t\t\t\tmaster._result = null;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t},\n\t_runPing(watch, master){\n\t\ttry{\n\t\t\tthis.config.ping(watch);\n\t\t} catch(e){\n\t\t\tthis._pivotWorker.terminate();\n\t\t\tthis._initWorker(this.config, master);\n\t\t\tmaster.callEvent(\"onWebWorkerEnd\", []);\n\t\t}\n\t},\n\t_getPivotData(pull, order, next){\n\t\tif (this._pivotWorker){\n\t\t\tvar id = this._result_id = webix.uid();\n\t\t\tthis._result = next;\n\n\t\t\tvar data = [];\n\t\t\tvar structure = this.config.structure;\n\t\t\tvar footer = this.config.footer;\n\t\t\tvar operations = this._pivotOperations.serialize();\n\t\t\tif (structure && (structure.rows.length || structure.columns.length))\n\t\t\t\tfor (var i = order.length - 1; i >= 0; i--)\n\t\t\t\t\tdata[i] = pull[order[i]];\n\n\t\t\tthis.callEvent(\"onWebWorkerStart\", []);\n\n\t\t\tvar format = this.config.format;\n\t\t\tif (typeof format === \"function\"){\n\t\t\t\tvar t = \"x\"+webix.uid();\n\t\t\t\twebix.i18n[t] = format;\n\t\t\t\tformat = t;\n\t\t\t}\n\n\t\t\tconst ping = !!this.config.ping;\n\t\t\tthis._pivotWorker.postMessage({ \n\t\t\t\tfooter, structure, data, id, operations, ping, format\n\t\t\t});\n\t\t} else {\n\t\t\tvar result = this._pivotData.process(pull, order);\n\t\t\tif (next) next(result);\n\t\t\treturn result;\n\t\t}\n\t},\n\t_initOperations(){\n\t\tvar operations = this._pivotOperations = new Operations();\n\t\tthis.operations = operations.pull;\n\t},\n\n\taddOperation(name, method, options){\n\t\tthis._pivotOperations.add(name, method, options);\n\t},\n\taddTotalOperation(name, method, options){\n\t\tthis._pivotOperations.addTotal(name, method, options);\n\t}\n};\n\nexport function WebixPivot(config, master){\n\t_Pivot.call(this, config, master);\n}\n\nWebixPivot.prototype = hlp.extend({\n\tgetData(data){\n\t\tvar i, id, option,\n\t\t\tfield, fields = [], fieldsHash = {},\n\t\t\tfilters = this.config.structure.filters,\n\t\t\tpull = {},  options = {}, optionsHash = {},\n\t\t\toperations = this.operations,\n\t\t\torder = [],\n\t\t\tresult = {};\n\n\t\tfor(i=0; i < filters.length; i++){\n\t\t\tif(filters[i].type.indexOf(\"select\") != -1 ){\n\t\t\t\toptions[filters[i].name] = [];\n\t\t\t\toptionsHash[filters[i].name] = {};\n\t\t\t}\n\t\t}\n\n\t\tfor(i=0; i < data.length; i++){\n\t\t\tid = data[i].id = data[i].id ||hlp.uid();\n\t\t\tpull[id] = data[i];\n\t\t\torder.push(id);\n\n\t\t\tif(i < 5)\n\t\t\t\tfor (field in data[i])\n\t\t\t\t\tif (!fieldsHash[field]) {\n\t\t\t\t\t\tfields.push(field);\n\t\t\t\t\t\tfieldsHash[field] = hlp.uid();\n\t\t\t\t\t}\n\n\t\t\tfor(option in options){\n\t\t\t\tlet value = data[i][option];\n\t\t\t\tif(!hlp.isUndefined(value)){\n\t\t\t\t\tif(!optionsHash[option][value]){\n\t\t\t\t\t\toptionsHash[option][value]= 1;\n\t\t\t\t\t\toptions[option].push(value);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tresult.options = options;\n\t\tresult.fields = fields;\n\t\tresult.data = this._getPivotData(pull, order);\n\n\t\tresult.operations = [];\n\t\tfor(id in operations)\n\t\t\tresult.operations.push(id);\n\n\t\treturn result;\n\t}\n}, _Pivot.prototype);\n\n\n\n","export const defaults = {\n\tfieldMap: {},\n\tyScaleWidth: 300,\n\tcolumnWidth: 150,\n\tdefaultOperation: \"sum\",\n\tfilterLabelAlign: \"right\",\n\tfilterPlaceholder:false,\n\tfilterWidth: 200,\n\tfilterMinWidth: 150,\n\tfilterLabelWidth: 100,\n\tseparateLabel: true,\n\theaderTemplate: function(config){\n\t\treturn this._applyMap(config.text || config.name) + \"<span class='webix_pivot_operation'> \" + this._applyLocale(config.operation)+\"</span>\";\n\t},\n\tformat: function(value){\n\t\treturn (value&& value!=\"0\"?parseFloat(value).toFixed(3):value);\n\t}\n};","export function setColumns(master, columns){\n\tvar format = master.config.format;\n\tfor(var i =0; i < columns.length; i++){\n\t\tif(!i){\n\t\t\tsetFirstColumn(master, columns[i]);\n\t\t}\n\t\telse{\n\t\t\twebix.extend(columns[i],{\n\t\t\t\tformat: format,\n\t\t\t\tsort:\"int\",\n\t\t\t\twidth: master.config.columnWidth\n\t\t\t});\n\t\t\tvar header = columns[i].header;\n\n\t\t\tfor(let j=0; j < header.length; j++){\n\t\t\t\tlet h = header[j];\n\t\t\t\tif(h){\n\t\t\t\t\tif(!j && h.name == \"total\")\n\t\t\t\t\t\th.text = master._applyLocale(\"total\");\n\t\t\t\t\telse if(j == header.length-1){\n\t\t\t\t\t\th.text = master.config.headerTemplate.call(master,h);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\th.text = h.name;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar footer = columns[i].footer;\n\t\t\tvar footer_format = columns[i].format;\n\t\t\tif(footer){\n\t\t\t\tif (typeof footer === \"string\") footer = { text: footer };\n\t\t\t\tif (typeof footer_format == \"string\") //web worker\n\t\t\t\t\tfooter_format = webix.i18n[footer_format] || window[footer_format]; \n\n\t\t\t\tlet text = !webix.isUndefined(footer.$pivotValue)? footer.$pivotValue : footer.text;\n\t\t\t\t//format footer only when column specific format was defined\n\t\t\t\tfooter.text = footer_format && (footer.$pivotOperation != \"count\" || footer_format != format) ?footer_format(text):text;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction setFirstColumn(master, column){\n\tvar text = \"\";\n\tif(master.config.readonly)\n\t\ttext = master.config.readonlyTitle||\"\";\n\telse\n\t\ttext = \"<div class='webix_pivot_config_msg'><div class='webix_pivot_icon pt-settings'></div>\"+webix.i18n.pivot.pivotMessage+\"</div>\";\n\tcolumn.header = text;\n\tcolumn.width = master.config.yScaleWidth;\n\tcolumn.exportAsTree = true;\n\tif(master.config.footer)\n\t\tcolumn.footer = master._applyLocale(\"total\");\n}","import * as flt from \"./filters.js\";\n\nexport function init(view){\n\twebix.extend(view, extRender, true);\n\t// filtering\n\tview.attachEvent(\"onFilterChange\", function(){\n\t\tflt.formatFilterValues(this.config.structure.filters);\n\t\tthis._loadResults(true);\n\t});\n}\n\nconst extRender = {\n\trender: function(data){\n\t\tthis.data.silent(function(){\n\t\t\tvar url = this.url;\n\t\t\tthis.clearAll();\n\t\t\tthis.url = url;\n\t\t});\n\t\tflt.formatFilterValues(this.config.structure.filters);\n\t\tif(!data)\n\t\t\tthis._loadResults();\n\t\telse\n\t\t\tthis._setData(data);\n\t},\n\t$onLoad: function(data){\n\t\tif(data.fields)\n\t\t\tthis._pivotFields = data.fields;\n\t\tif(data.options)\n\t\t\tthis._pivotOptions = data.options;\n\t\tif(data.structure)\n\t\t\tthis.config.structure = data.structure;\n\n\t\tif(data.operations){\n\t\t\tthis.operations = {};\n\t\t\tfor(let i =0; i< data.operations.length;i++)\n\t\t\t\tthis.operations[data.operations[i]] = 1;\n\t\t}\n\t\tif(data.data.columns)\n\t\t\tdata.data.header = data.data.columns;\n\n\t\tif(data.data)\n\t\t\tthis.render(data.data);\n\t},\n\turl_setter:function(value){\n\t\tvar str = this.config.structure;\n\t\tif (str && (str.rows.length || str.columns.length)){\n\t\t\tthis.data.url = value;\n\t\t\tthis._loadResults();\n\t\t} else\n\t\t\treturn webix.AtomDataLoader.url_setter.call(this, value);\n\t},\n\t_loadResults: function(){\n\t\tvar structure = this.config.structure,\n\t\t\turl = this.data.url;\n\n\t\tif(url){\n\t\t\tif(url.load)\n\t\t\t\turl.load(this, {\n\t\t\t\t\tsuccess: function(data){\n\t\t\t\t\t\tthis.parse(JSON.parse(data));\n\t\t\t\t\t}\n\t\t\t\t}, { structure: structure});\n\t\t\telse if(typeof url == \"string\")\n\t\t\t\tthis.load(\"post->\"+url, \"json\", { structure: structure});\n\t\t}\n\n\t}\n};\n\n\n","\nexport class Filters{\n\tconstructor(){\n\t\tthis._filters = [ \"multicombo\", \"select\", \"text\", \"datepicker\" ];\n\t\tthis._selects = {\"multicombo\": 1, \"multiselect\": 1, \"select\": 1, \"richselect\": 1};\n\t}\n\n\tadd(name, isSelect){\n\t\tthis._filters.push(name);\n\t\tif(!webix.isUndefined(isSelect))\n\t\t\tthis._selects[name] = isSelect;\n\t}\n\n\tisSelect(name){\n\t\treturn this._selects[name];\n\t}\n\n\tclear(){\n\t\tthis._filters = [];\n\t}\n\n\tremove(name){\n\t\tvar i = this.getIndex(name);\n\t\tif(i>=0)\n\t\t\tthis._filters.splice(i,1);\n\t}\n\n\tgetIndex(name){\n\t\tfor(let i=0; i <this._filters.length;i++ )\n\t\t\tif(this._filters[i] == name)\n\t\t\t\treturn i;\n\t\treturn -1;\n\t}\n\n\tgetDefault(){\n\t\tif (this.getIndex(\"select\") != -1)\n\t\t\treturn \"select\";\n\t\treturn this._filters[0];\n\t}\n\n\tget(){\n\t\treturn this._filters;\n\t}\n\n}","import * as flt from \"./operations/filters.js\";\n\nimport \"./popups/tablepopup.js\";\nimport * as frz from \"./operations/freeze_totals.js\";\nimport * as cor from \"./data/core.js\";\nimport {defaults} from \"./config/pivottable.js\";\nimport {setColumns} from \"./operations/columns.js\";\nimport * as ext from \"./operations/external_processing.js\";\nimport {Filters} from \"./structures/filters.js\";\n\nwebix.protoUI({\n\tname:\"pivot\",\n\tversion:\"{{version}}\",\n\tdefaults: defaults,\n\t$init: function(config) {\n\t\tif (config.separateLabel === false){\n\t\t\tconfig.filterWidth = config.filterWidth || 300;\n\t\t}\n\n\t\tthis.$view.className +=\" webix_pivot\";\n\t\t// add DataStore API\n\t\tthis.data.provideApi(this, true);\n\t\t// add configuration properties\n\t\tthis._setConfig(config);\n\t\t// event event handlers\n\t\tthis._initDataStore(config);\n\t\t// alias for $separator\n\t\tthis.$separator = this.$divider;\n\n\t\tthis.filters = new Filters();\n\t},\n\t$divider: \"_'_\",\n\t_initDataStore: function(config){\n\t\tif(config.externalProcessing)\n\t\t\text.init(this,config);\n\t\telse{\n\t\t\t// render on data update\n\t\t\tthis.data.attachEvent(\"onStoreUpdated\", webix.bind(function() {\n\t\t\t\t// call render if pivot is initialized\n\t\t\t\tif (this.$$(\"data\")) this.render();\n\t\t\t}, this));\n\t\t\t// filtering\n\t\t\tthis.attachEvent(\"onFilterChange\", function(){\n\t\t\t\tthis.render(true);\n\t\t\t});\n\t\t\t// initial rendering\n\t\t\tthis.$ready.push(this.render);\n\t\t}\n\t},\n\t_setConfig: function(config){\n\t\tif (!config.structure)\n\t\t\tconfig.structure = {};\n\t\twebix.extend(config.structure, { rows:[], columns:[], values:[], filters:[] });\n\t\twebix.extend(config, this._getUI(config));\n\t},\n\n\t_getUI: function(config) {\n\t\tvar filters = { id:\"filters\", view:\"toolbar\", css:\"webix_pivot_configure_toolbar\", borderless: true, hidden:true, padding: 10, cols:[\n\t\t\t{  }\n\t\t]};\n\t\tvar active = webix.skin.$active;\n\t\tvar table = {\n\t\t\tview:\"treetable\",\n\t\t\tid:\"data\",\n\t\t\tcss:\"webix_data_border\",\n\t\t\tselect: \"row\",\n\t\t\tnavigation:true,\n\t\t\tleftSplit:1,\n\t\t\tresizeColumn:true,\n\t\t\trowHeight: active.rowHeight + 8,\n\t\t\trowLineHeight: active.rowHeight + 8,\n\t\t\theaderRowHeight: active.barHeight + 4,\n\t\t\ton:{\n\t\t\t\t\"onHeaderClick\": function(id){\n\t\t\t\t\tvar pivot = this.getTopParentView();\n\t\t\t\t\tif (this.getColumnIndex(id.column) === 0 && !pivot.config.readonly)\n\t\t\t\t\t\tpivot.configure();\n\t\t\t\t}\n\t\t\t},\n\t\t\tcolumns:[]\n\t\t};\n\n\t\tif(config.datatable && typeof config.datatable == \"object\" ){\n\t\t\tdelete config.datatable.id;\n\t\t\twebix.extend(table,config.datatable,true);\n\t\t}\n\n\t\treturn { rows: [ filters, table ] };\n\t},\n\t/*\n\t* Shows configuration popup\n\t* */\n\tconfigure: function() {\n\t\tif (!this._configPopup)\n\t\t\tthis._createPopup();\n\n\t\tvar functions = [];\n\t\tfor (var i in this.operations) functions.push({name: i, title: this._applyLocale(i)});\n\n\t\tthis._configPopup.define(\"operations\", functions);\n\t\tvar pos = webix.html.offset(this.$$(\"data\").getNode());\n\t\tthis._configPopup.setPosition(pos.x + 10, pos.y + 10);\n\t\tthis._configPopup.define(\"data\", this.getFields());\n\t\tthis._configPopup.show();\n\t},\n\t_createPopup: function(){\n\t\tvar config = { view:\"webix_pivot_config\", operations:[], pivot: this.config.id };\n\t\twebix.extend(config , this.config.popup||{});\n\t\tthis._configPopup = webix.ui(config);\n\t\tthis.callEvent(\"onPopup\",[this._configPopup]);\n\t\tthis._configPopup.attachEvent(\"onApply\", webix.bind(this.setStructure, this));\n\t},\n\tdestructor(){\n\t\tif (this._configPopup){\n\t\t\tthis._configPopup.destructor();\n\t\t\tthis._configPopup = null;\n\t\t}\n\t\twebix.Destruction.destructor.call(this);\n\t},\n\tgetFilterView: function(){\n\t\treturn this.$$(\"filters\");\n\t},\n\t/*\n\t * Renders Pivot\n\t * \n\t */\n\trender: function(skipFilters) {\t\t\n\t\tif (webix.debug_pivot)\n\t\t\twindow.console.time(\"pivot:full-processing\");\n\n\t\tif(!this._getPivotData){\n\t\t\tconst base = new cor._Pivot(this.config, this);\n\t\t\twebix.extend(this, base);\n\t\t}\n\t\tflt.formatFilterValues(this.config.structure.filters);\n\n\t\tthis._getPivotData(this.data.pull, this.data.order, (result) => {\n\t\t\tthis._setData(result, skipFilters);\n\n\t\t\tif (webix.debug_pivot)\n\t\t\t\twebix.delay(function(){\n\t\t\t\t\twindow.console.timeEnd(\"pivot:full-processing\");\n\t\t\t\t\twindow.console.timeEnd(\"pivot:rendering\");\n\t\t\t\t});\n\t\t});\n\t},\n\t_setData: function(data, skipFilters){\n\t\tsetColumns(this, data.header);\n\n\t\tif (!skipFilters)\n\t\t\tdata.filters = flt.processFilters(this);\n\n\t\tthis.callEvent(\"onBeforeRender\",[data]);\n\n\t\tif (data.filters)\n\t\t\tflt.showFilters(this, data.filters);\n\n\t\tif(this.config.readonly)\n\t\t\tthis.$$(\"data\").$view.className += \" webix_pivot_readonly\";\n\n\t\tif(this.config.totalColumn)\n\t\t\tthis.$$(\"data\").define(\"math\", true);\n\n\t\tif(this.config.footer)\n\t\t\tthis.$$(\"data\").define(\"footer\", true);\n\n\t\tif (webix.debug_pivot)\n\t\t\twindow.console.time(\"pivot:rendering\");\n\n\t\tthis.$$(\"data\").clearAll();\n\t\tthis.$$(\"data\").config.rightSplit = 0;\n\t\tthis.$$(\"data\").refreshColumns(data.header);\n\t\tthis.$$(\"data\").parse(data.data);\n\n\t\tfrz.freezeTotals(this);\t\t\n\t},\n\t$exportView:function(options){\n\t\tif (options.flatTree){\n\t\t\tif (typeof options.flatTree !== \"object\") \n\t\t\t\toptions.flatTree = {};\n\n\t\t\tvar flat = options.flatTree;\n\t\t\tflat.id = this.$$(\"data\").config.columns[0].id;\n\t\t\tif (!flat.columns){\n\t\t\t\tvar rows = this.config.structure.rows;\n\t\t\t\tflat.columns = [];\n\t\t\t\tfor (var i = 0; i < rows.length; i++)\n\t\t\t\t\tflat.columns.push({ header:this._applyMap(rows[i]) });\n\t\t\t}\n\t\t}\n\t\treturn this.$$(\"data\").$exportView(options);\n\t},\n\t_applyLocale: function(value){\n\t\treturn webix.i18n.pivot[value]||value;\n\t},\n\t_applyMap: function(value){\n\t\treturn this.config.fieldMap[value]||value;\n\t},\n\tgetFields: function() {\n\t\tvar i, field, item, text,\n\t\t\tfields = [],\n\t\t\tfieldsHash = {},\n\t\t\trowsHash = {},\n\t\t\tstr = this.config.structure,\n\t\t\tresult = { fields:[], rows:[], columns:[], values:[], filters:[] },\n\t\t\tvaluesHash = {};\n\n\t\tif(!this._pivotFields){\n\t\t\tfor (i = 0; i < Math.min(this.data.count() || 5); i++) {\n\t\t\t\titem = this.data.getItem(this.data.getIdByIndex(i));\n\t\t\t\tfor (field in item) {\n\t\t\t\t\tif (field !== \"id\" && field.indexOf(\"$\") !== 0 && !fieldsHash[field]){\n\t\t\t\t\t\tfields.push(field);\n\t\t\t\t\t\tfieldsHash[field] = webix.uid();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tfields = this._pivotFields;\n\t\t\tfor (i = 0; i < fields.length; i++)\n\t\t\t\tfieldsHash[fields[i]] = webix.uid();\n\t\t}\n\n\n\t\tfor (i = 0; i < (str.filters || []).length; i++) {\n\t\t\tfield = str.filters[i];\n\t\t\tif (!webix.isUndefined(fieldsHash[field.name])) {\n\t\t\t\ttext = this._applyMap(field.name);\n\t\t\t\tresult.filters.push({name: field.name, text: text, type:field.type, value:field.value, id: fieldsHash[field.name]});\n\t\t\t}\n\t\t}\n\t\tfor (i = 0; i < str.rows.length; i++) {\n\t\t\tfield = str.rows[i];\n\t\t\tif (!webix.isUndefined(fieldsHash[field])) {\n\t\t\t\tresult.rows.push({name: field, text: this._applyMap(field), id: fieldsHash[field]});\n\t\t\t\trowsHash[field] = true;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < str.columns.length; i++) {\n\t\t\tfield = (typeof str.columns[i] == \"object\"? (str.columns[i].id||i): str.columns[i]);\n\t\t\tif (!webix.isUndefined(fieldsHash[field]) && webix.isUndefined(rowsHash[field])) {\n\t\t\t\tresult.columns.push({name: field, text: this._applyMap(field), id: fieldsHash[field]});\n\t\t\t}\n\t\t}\n\n\n\t\tfor (i = 0; i < str.values.length; i++) {\n\t\t\tfield = str.values[i];\n\t\t\tif (!webix.isUndefined(fieldsHash[field.name])) {\n\t\t\t\tif(webix.isUndefined(valuesHash[field.name])){\n\t\t\t\t\tvaluesHash[field.name] = i;\n\t\t\t\t\ttext = this._applyMap(field.name);\n\t\t\t\t\tlet value = {\n\t\t\t\t\t\tname: field.name, text: text, id: fieldsHash[field.name],\n\t\t\t\t\t\toperation:webix.isArray(field.operation)?field.operation:[field.operation]\n\t\t\t\t\t};\n\t\t\t\t\tresult.values.push(value);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tlet index = valuesHash[field.name];\n\t\t\t\t\tresult.values[index].operation.push(field.operation);\n\t\t\t\t}\n\n\n\t\t\t}\n\t\t}\n\n\t\tfields.sort();\n\t\tfor (i = 0; i < fields.length; i++) {\n\t\t\tfield = fields[i];\n\t\t\tif (!webix.isUndefined(fieldsHash[field]))\n\t\t\t\tresult.fields.push({name:field, text: this._applyMap(field), id: fieldsHash[field]});\n\t\t}\n\n\t\treturn result;\n\t},\n\tsetStructure: function(config){\n\t\tthis.define(\"structure\", config);\n\t\tthis.render();\n\t},\n\tgetStructure: function() {\n\t\treturn this.config.structure;\n\t},\n\tgetConfigWindow: function(){\n\t\treturn this._configPopup;\n\t},\n\tprofile_setter:function(value){\n\t\tvar c = window.console;\n\t\tif (value){\n\t\t\tthis.attachEvent(\"onBeforeLoad\", function(){ c.time(\"data loading\");  });\n\t\t\tthis.data.attachEvent(\"onParse\", function(){ c.timeEnd(\"data loading\"); c.time(\"data parsing\");  });\n\t\t\tthis.data.attachEvent(\"onStoreLoad\", function(){ c.timeEnd(\"data parsing\"); c.time(\"data processing\");  });\n\t\t\tthis.$ready.push(function(){\n\t\t\t\tthis.$$(\"data\").attachEvent(\"onBeforeRender\", function(){ if (this.count()) { c.timeEnd(\"data processing\"); c.time(\"data rendering\"); } });\n\t\t\t\tthis.$$(\"data\").attachEvent(\"onAfterRender\", function(){ if (this.count()) webix.delay(function(){ c.timeEnd(\"data rendering\"); });  });\n\t\t\t});\n\t\t}\n\t}\n}, webix.IdSpace, webix.ui.layout, webix.DataLoader, webix.EventSystem, webix.Settings);\n\n","import * as clc from \"../operations/popup_clicks.js\";\nimport {popupTemplates} from \"./templates.js\";\n\nconst clickHandlers = webix.extend({\n\t\"color\": function(e,id,el) {\n\t\tvar colorboard = {\n\t\t\tview: \"colorboard\",\n\t\t\tborderless: true\n\n\t\t};\n\t\tif(webix.$$(this.config.pivot).config.colorboard){\n\t\t\twebix.extend(colorboard,webix.$$(this.config.pivot).config.colorboard);\n\t\t}\n\t\telse{\n\t\t\twebix.extend(colorboard,{\n\t\t\t\twidth:  150,\n\t\t\t\theight: 150,\n\t\t\t\tpalette: webix.$$(this.config.pivot).config.palette\n\t\t\t});\n\t\t}\n\n\t\tvar p = webix.ui({\n\t\t\tview:\"popup\",\n\t\t\tid: \"colorsPopup\",\n\t\t\tbody:colorboard\n\t\t});\n\t\tp.show(el);\n\t\tp.getBody().attachEvent(\"onSelect\",function(){\n\t\t\tp.hide();\n\t\t});\n\t\tp.attachEvent(\"onHide\", webix.bind(function() {\n\t\t\tvar index = webix.html.locate(e, \"webix_operation\");\n\t\t\tvar value = p.getBody().getValue();\n\t\t\tif (value) {\n\t\t\t\tthis.$$(\"values\").getItem(id).color[index] = value;\n\t\t\t\tthis.$$(\"values\").updateItem(id);\n\t\t\t}\n\t\t\tp.close();\n\t\t}, this));\n\t\treturn false;\n\t}\n},clc.clickHandlers);\n\nexport function getStructureMap(view, config) {\n\tvar chartTypes = [];\n\tvar pivot = webix.$$(config.pivot);\n\tvar types = pivot.chartMap;\n\tfor(var type in types){\n\t\tchartTypes.push({id: type, title: pivot._applyLocale(type).toLowerCase()});\n\t}\n\n\tvar chartType = pivot.config.chartType;\n\n\treturn {\n\t\t\"popup\": {\n\t\t\twidth: config.popupWidth,\n\t\t\thead: \"toolbar\",\n\t\t\tbody: \"body\"\n\t\t},\n\t\t\"toolbar\": {\n\t\t\tview: \"toolbar\",\n\t\t\tborderless: true,\n\t\t\tpadding: 10,\n\t\t\tcols: [\n\t\t\t\t\"configTitle\",\n\t\t\t\t{\n\t\t\t\t\tmargin: 6,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t\"cancel\",\n\t\t\t\t\t\t\"apply\"\n\t\t\t\t\t\t\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t\"configTitle\": { id: \"configTitle\",  view: \"label\", label: webix.i18n.pivot.windowTitle || \"\" },\n\t\t\"cancel\":{ view: \"button\", id: \"cancel\",  label: pivot._applyLocale(\"cancel\"), width: config.cancelButtonWidth },\n\t\t\"apply\":{ view: \"button\", id: \"apply\", type: \"form\", css:\"webix_pivot_apply\", label:pivot._applyLocale(\"apply\"), width:config.applyButtonWidth },\n\t\t\"body\": {\n\t\t\ttype: \"wide\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tcss: \"webix_pivot_fields_layout\",\n\t\t\t\t\ttype: \"space\",\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t\"fieldsLayout\",\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: \"wide\",\n\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttype: \"wide\",\n\t\t\t\t\t\t\t\t\tcss: \"webix_pivot_configuration\",\n\t\t\t\t\t\t\t\t\trows: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttype: \"wide\",\n\t\t\t\t\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t\t\t\t\t\"filtersLayout\",\n\t\t\t\t\t\t\t\t\t\t\t\t\"groupLayout\",\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttype: \"wide\",\n\t\t\t\t\t\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t\t\t\t\t\t\"valuesLayout\",\n\t\t\t\t\t\t\t\t\t\t\t\t\"chartLayout\"\n\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t\"fieldsLayout\":{\n\t\t\twidth: config.fieldsColumnWidth,\n\t\t\trows: [\n\t\t\t\t\"fieldsHeader\",\n\t\t\t\t\"fields\"\n\t\t\t]\n\t\t},\n\t\t\"fieldsHeader\": { id: \"fieldsHeader\", data: {value: \"fields\"}, css: \"webix_pivot_header_fields\",\n\t\t\ttemplate: popupTemplates.header, height: 40\n\t\t},\n\t\t\"fields\": {\n\t\t\tview: \"list\", type: {height: \"auto\"}, css: \"webix_pivot_fields\", drag: true, \n\t\t\ttemplate: \"<span class='webix_pivot_list_marker'></span>#text#<span class='webix_pivot_icon pt-list-drag'></span>\",\n\t\t\ton: view._getListEvents()\n\t\t},\n\t\t\"filtersLayout\": {\n\t\t\trows: [\n\t\t\t\t\"filtersHeader\",\n\t\t\t\t\"filters\"\n\t\t\t]\n\t\t},\n\t\t\"filtersHeader\": { data:{value: \"filters\", icon:\"filter\" }, template: popupTemplates.iconHeader, css: \"webix_pivot_popup_title\", height: 40 },\n\t\t\"filters\": {\n\t\t\tview: \"list\", scroll: \"auto\", type: {height: \"auto\"}, drag: true, \n\t\t\ttemplate: webix.bind(popupTemplates.filters, view),\n\t\t\tonClick: {\n\t\t\t\t\"webix_link_selection\": webix.bind(clickHandlers[\"filter-selector\"], view),\n\t\t\t\t\"webix_pivot_minus\": webix.bind(clc.clickHandlers.remove, view)\n\t\t\t},\n\t\t\ton: view._getListEvents()\n\t\t},\n\t\t\"valuesLayout\":{\n\t\t\trows:[\n\t\t\t\t\"valuesHeader\",\n\t\t\t\t\"values\"\n\t\t\t]\n\t\t},\n\t\t\"valuesHeader\":{id: \"valuesHeader\", data: {value: \"values\", icon:\"values-chart\"},\n\t\t\ttemplate: popupTemplates.iconHeader, css: \"webix_pivot_popup_title\", height: 40\n\t\t},\n\t\t\"values\":{\n\t\t\tview: \"list\", scroll: \"auto\", drag: true, css: \"webix_pivot_chart_values\", type: { height: \"auto\" },\n\t\t\ttemplate: webix.bind(popupTemplates.chartValues, view),\n\t\t\tonClick: {\n\t\t\t\t\"webix_link_title\": webix.bind(clickHandlers.selector, view),\n\t\t\t\t\"webix_link_selection\": webix.bind(clickHandlers.selector, view),\n\t\t\t\t\"webix_color_selection\": webix.bind(clickHandlers.color, view),\n\t\t\t\t\"webix_pivot_minus\": webix.bind(clickHandlers.remove, view)\n\t\t\t},\n\t\t\ton:view._getListEvents()\n\t\t},\n\t\t\"groupLayout\": {\n\t\t\trows:[\n\t\t\t\t\"groupHeader\",\n\t\t\t\t\"groupBy\"\n\t\t\t]\n\t\t},\n\t\t\"groupHeader\": { data:{value: \"groupBy\", icon:\"group\"},  template: popupTemplates.iconHeader, css: \"webix_pivot_popup_title\", height: 40},\n\t\t\"groupBy\": {\n\t\t\tview: \"list\", scroll: false, drag: true, type: {height: \"auto\"},\n\t\t\ttemplate: webix.bind(popupTemplates.groupBy, view),\n\t\t\ton:view._getListEvents(),\n\t\t\tonClick:{\n\t\t\t\t\"webix_pivot_minus\": webix.bind(clc.clickHandlers.remove, view)\n\t\t\t}\n\t\t},\n\t\t\"chartLayout\":{\n\t\t\tcss:\"webix_pivot_popup_chart\",\n\t\t\trows:[\n\t\t\t\t\"chartHeader\",\n\t\t\t\t\"chartBody\",\n\t\t\t\t// \"logScale\",\n\t\t\t\t// \"chart\"\n\t\t\t]\n\t\t},\n\t\t\"chartHeader\": { data:{value: \"chart\", icon:\"chart\"},  template: popupTemplates.iconHeader, css: \"webix_pivot_popup_title\", height: 40},\n\t\t\"chartBody\": {\n\t\t\tview: \"list\", scroll: false, drag: false,\n\t\t\ttype:{\n\t\t\t\theight: \"auto\",\n\t\t\t\tmarkCheckbox:function(obj){\n\t\t\t\t\tif(typeof obj.markCheckbox === \"undefined\") { //check for first init\n\t\t\t\t\t\t(pivot.config.chart.scale&&pivot.config.chart.scale == \"logarithmic\")?obj.markCheckbox=1:obj.markCheckbox=0;\n\t\t\t\t\t}\n\t\t\t\t\treturn \"<span class='webix_icon wxi-checkbox-\"+(obj.markCheckbox?\"marked\":\"blank\")+\"'></span>\";\n\t\t\t\t},\n\t\t\t\tgetType:function(obj) {\n\t\t\t\t\treturn obj.chartType = chartType;\n\t\t\t\t}\n\t\t\t},\n\t\t\tonClick:{\n\t\t\t\t\"webix_link_selection\": function(e, id, el) {\n\t\t\t\t\tvar popup,\n\t\t\t\t\t\tselector = {\n\t\t\t\t\t\t\tview: \"webix_pivot_popup\", css: \"webix_pivot_popup\", autofit:true,\n\t\t\t\t\t\t\tautoheight: true, width: 150,\n\t\t\t\t\t\t\tdata: chartTypes\n\t\t\t\t\t\t};\n\t\t\t\t\tpopup = webix.ui(selector);\n\t\t\t\t\tpopup.show(el);\n\t\t\t\t\tpopup.attachEvent(\"onHide\", webix.bind(function() {\n\t\t\t\t\t\tvar sel = popup.getSelected();\n\t\t\t\t\t\tif (sel !== null) {\n\t\t\t\t\t\t\tchartType = sel.id;\n\t\t\t\t\t\t\tthis.refresh();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t}, this));\n\t\t\t\t},\n\t\t\t\t\"webix_chart_checkbox\":function(e, id){\n\t\t\t\t\tvar item = this.getItem(id);\n\t\t\t\t\titem.markCheckbox = item.markCheckbox?0:1;\n\t\t\t\t\tthis.updateItem(id, item);\n\t\t\t\t}\n\t\t\t},\n\t\t\ttemplate:function(obj, common) {\n\t\t\t\tif(obj.id === \"logScale\") {\n\t\t\t\t\treturn \"<div class='webix_chart_checkbox'>\"+common.markCheckbox(obj, common)+\"<span>\"+ obj.title.toLowerCase() +\"</span></div>\";\n\t\t\t\t} else {\n\t\t\t\t\treturn \"<span class='webix_pivot_icon pt-bar-chart'></span><span>\"+webix.i18n.pivot.chartType.toLowerCase()+\"</span><span class='webix_link_selection'>\"+webix.i18n.pivot[common.getType(obj, common)]+ \"</span>\";\n\t\t\t\t}\n\t\t\t},\n\t\t\tdata:[{title:webix.i18n.pivot.logScale, id:\"logScale\"}, {title:webix.i18n.pivot.chartType, id:\"chartType\", chartType:chartType}]\n\t\t}\n\t};\n}","import \"./commonpopup.js\";\nimport {getStructureMap} from \"../structures/chartpopup.js\";\n\nwebix.protoUI({\n\tname: \"webix_pivot_chart_config\",\n\t$init: function() {\n\t\tthis.$view.className += \" webix_pivot_chart_popup webix_pivot\";\n\t},\n\tdefaults:{\n\t\tchartTypeLabelWidth: 100,\n\t\tchartTypeWidth: 302,\n\t\tlogScaleLabelWidth: 125,\n\t\tfieldsColumnWidth: 240,\n\t\tpopupWidth: 890\n\t},\n\t_getUI: function(config) {\n\t\tvar structure = webix.copy(getStructureMap(this, config));\n\t\treturn this._setStructure(structure, config);\n\t},\n\t_lists:[\"filters\",\"values\",\"groupBy\"],\n\t_dndCorrection: {\n\t\t\"values\": [\"groupBy\"],\n\t\t\"groupBy\": [\"values\"]\n\t},\n\t_hidePopups: function(){\n\t\twebix.callEvent(\"onClick\",[]);\n\t},\n\t_afterInit: function() {\n\t\tthis.attachEvent(\"onItemClick\", function(id){\n\t\t\tif (this.$eventSource.name == \"button\"){\n\t\t\t\t//transform button clicks to events\n\t\t\t\tvar innerId = this.innerId(id),\n\t\t\t\t\tstructure = this.getStructure();\n\n\t\t\t\tif(innerId == \"apply\" && (!structure.values.length || !structure.groupBy)){\n\t\t\t\t\twebix.alert(webix.i18n.pivot.valuesNotDefined);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif(webix.$$(this.config.pivot).callEvent(\"onBefore\"+innerId, [structure])) {\n\t\t\t\t\t\tthis.callEvent(\"on\" + innerId, [structure]);\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tvar popupBlocks = this.$view.querySelectorAll(\".webix_pivot_configuration .webix_list\");\n\t\tfor (var i = 0; i < popupBlocks.length; i++) {\n\t\t\tpopupBlocks[i].setAttribute(\"window-message\", webix.i18n.pivot.windowMessage);\n\t\t}\n\t},\n\tgetStructure: function() {\n\t\tvar structure = { groupBy:\"\",values:[],filters:[] };\n\n\t\tvar groupBy = this.$$(\"groupBy\");\n\t\tif(groupBy.count())\n\t\t\tstructure.groupBy = groupBy.getItem(groupBy.getFirstId()).name;\n\n\n\t\tvar values = this.$$(\"values\");\n\t\tvar temp;\n\t\tvalues.data.each(webix.bind(function(obj){\n\t\t\tfor(var j=0; j< obj.operation.length; j++){\n\t\t\t\ttemp = webix.copy(obj);\n\n\t\t\t\twebix.extend(temp,{operation: obj.operation[j],color:  obj.color[j]||webix.$$(this.config.pivot).config.color},true);\n\n\t\t\t\tstructure.values.push(temp);\n\t\t\t}\n\t\t},this));\n\n\t\tvar filters = this.$$(\"filters\");\n\t\tfilters.data.each(function(obj){\n\t\t\tstructure.filters.push(obj);\n\t\t});\n\n\t\treturn structure;\n\t}\n}, webix.ui.webix_pivot_config_common);","export const defaults = {\n\tfieldMap: {},\n\trows:[],\n\tdefaultOperation: \"sum\",\n\tfilterLabelAlign: \"right\",\n\tfilterWidth: 200,\n\tfilterMinWidth: 180,\n\teditButtonWidth: 110,\n\tfilterLabelWidth: 100,\n\tfilterPlaceholder:false,\n\tseparateLabel: true,\n\tchartType: \"bar\",\n\tcolor: \"#36abee\",\n\tchart:{},\n\tsingleLegendItem: 1,\n\tpalette: [\n\t\t[\"#e33fc7\",\"#a244ea\",\"#476cee\",\"#36abee\",\"#58dccd\",\"#a7ee70\"],\n\t\t[\"#d3ee36\",\"#eed236\",\"#ee9336\",\"#ee4339\",\"#595959\",\"#b85981\" ],\n\t\t[ \"#c670b8\",\"#9984ce\",\"#b9b9e2\",\"#b0cdfa\",\"#a0e4eb\",\"#7faf1b\" ],\n\t\t[ \"#b4d9a4\", \"#f2f79a\",\"#ffaa7d\", \"#d6806f\", \"#939393\", \"#d9b0d1\"],\n\t\t[\"#780e3b\",\"#684da9\",\"#242464\",\"#205793\",\"#5199a4\", \"#065c27\"],\n\t\t[\"#54b15a\",\"#ecf125\",\"#c65000\",\"#990001\",\"#363636\", \"#800f3e\"]\n\t]\n};","import * as flt from \"./operations/filters.js\";\nimport \"./popups/chartpopup.js\";\nimport {defaults} from \"./config/pivotchart.js\";\nimport {filterItem,setFilterValues} from \"./data/filters.js\";\nimport {Filters} from \"./structures/filters.js\";\n\nwebix.protoUI({\n\tname:\"pivot-chart\",\n\tversion:\"{{version}}\",\n\tdefaults: defaults,\n\ttemplates:{\n\t\tgroupNameToStr: function(name,operation){\n\t\t\treturn name+\"_\"+operation;\n\t\t},\n\t\tgroupNameToObject: function(name){\n\t\t\tvar arr = name.split(\"_\");\n\t\t\treturn {name:arr[0],operation:arr[1]};\n\t\t},\n\t\tseriesTitle: function(data,i){\n\t\t\tvar name = this.config.fieldMap[data.name]||this._capitalize(data.name);\n\t\t\tvar operation = (webix.isArray(data.operation)?data.operation[i]:data.operation);\n\t\t\treturn name+\" ( \"+(webix.i18n.pivot[operation]||operation)+\")\";\n\t\t}\n\t},\n\ttemplates_setter: function(obj){\n\t\tif(typeof obj == \"object\")\n\t\t\twebix.extend(this.templates,obj);\n\t},\n\tchartMap: {\n\t\tbar: function(color){\n\t\t\treturn {\n\t\t\t\tborder:0,\n\t\t\t\talpha:1,\n\t\t\t\tradius:0,\n\t\t\t\tcolor: color\n\t\t\t};\n\t\t},\n\t\tline: function(color){\n\t\t\treturn {\n\t\t\t\talpha:1,\n\t\t\t\titem:{\n\t\t\t\t\tborderColor: color,\n\t\t\t\t\tcolor: color\n\t\t\t\t},\n\t\t\t\tline:{\n\t\t\t\t\tcolor: color,\n\t\t\t\t\twidth:2\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tradar: function(color){\n\t\t\treturn {\n\t\t\t\talpha:1,\n\t\t\t\tfill: false,\n\t\t\t\tdisableItems: true,\n\t\t\t\titem:{\n\t\t\t\t\tborderColor: color,\n\t\t\t\t\tcolor: color\n\t\t\t\t},\n\t\t\t\tline:{\n\t\t\t\t\tcolor: color,\n\t\t\t\t\twidth:2\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t},\n\tchartMap_setter: function(obj){\n\t\tif(typeof obj == \"object\")\n\t\t\twebix.extend(this.chartMap,obj,true);\n\t},\n\t$init: function(config) {\n\t\tif (config.separateLabel === false){\n\t\t\tconfig.filterWidth = config.filterWidth || 300;\n\t\t}\n\n\t\tthis.data.provideApi(this, true);\n\t\tif (!config.structure)\n\t\t\tconfig.structure = {};\n\t\twebix.extend(config.structure, { groupBy:\"\", values:[], filters:[] });\n\n\t\tthis.$view.className +=\" webix_pivot webix_pivot_chart\";\n\t\twebix.extend(config, {editButtonWidth: this.defaults.editButtonWidth});\n\t\twebix.extend(config, this.getUI(config));\n\n\t\tthis.$ready.push(webix.bind(function(){\n\t\t\twebix.delay(this.render,this); // delay needed for correct legend rendering\n\t\t},this));\n\t\tthis.data.attachEvent(\"onStoreUpdated\", webix.bind(function() {\n\t\t\t// call render if pivot is initialized\n\t\t\tif (this.$$(\"chart\"))\n\t\t\t\tthis.render();\n\t\t}, this));\n\n\t\tthis.attachEvent(\"onFilterChange\", function(){\n\t\t\tthis.render(true);\n\t\t});\n\n\t\tthis.filters = new Filters();\n\t},\n\tgetUI: function() {\n\t\tvar filters = ({ \n\t\t\tview:\"toolbar\",\n\t\t\tid: \"filters\", hidden:true, paddingY: 10,\n\t\t\tpaddingX: 5,\n\t\t\tborderless: true,\n\t\t\tmargin: 10, cols:[] });\n\n\t\tvar chart = { id: \"bodyLayout\", type: \"line\", margin: 10, cols:[{id:\"chart\", view: \"chart\"}] };\n\t\treturn { rows: [ filters, chart ]};\n\t},\n\tconfigure: function() {\n\t\tif (!this._pivotPopup) {\n\t\t\tvar config = { view:\"webix_pivot_chart_config\", operations:[], pivot: this.config.id };\n\t\t\twebix.extend(config , this.config.popup||{});\n\n\t\t\tthis._pivotPopup = webix.ui(config);\n\t\t\tthis.callEvent(\"onPopup\",[this._pivotPopup]);\n\t\t\tthis._pivotPopup.attachEvent(\"onApply\", webix.bind(function(structure) {\n\t\t\t\tthis.config.chartType = this._pivotPopup.$$(\"chartBody\")?this._pivotPopup.$$(\"chartBody\").getItem(\"chartType\").chartType:\"bar\";\n\t\t\t\tthis.config.chart.scale = (this._pivotPopup.$$(\"chartBody\").getItem(\"logScale\").markCheckbox?\"logarithmic\":\"linear\");\n\t\t\t\twebix.extend(this.config.structure, structure, true);\n\t\t\t\tthis.render();\n\t\t\t}, this));\n\t\t}\n\n\t\tvar functions = [];\n\t\tfor (var i in this.operations) functions.push({name: i, title: this._applyLocale(i)});\n\t\tthis._pivotPopup._valueLength = this._valueLength || 0;\n\t\tthis._pivotPopup.define(\"operations\", functions);\n\t\tvar pos = webix.html.offset(this.$$(\"chart\").getNode());\n\t\tthis._pivotPopup.setPosition(pos.x + 10, pos.y + 10);\n\t\tthis._pivotPopup.define(\"data\", this.getFields());\n\t\tthis._pivotPopup.show();\n\t},\n\tdestructor(){\n\t\tif (this._pivotPopup){\n\t\t\tif(this._eventId) {\n\t\t\t\twebix.eventRemove(this._eventId);\n\t\t\t}\n\t\t\tthis._pivotPopup.destructor();\n\t\t\tthis._pivotPopup = null;\n\t\t}\n\t\twebix.Destruction.destructor.call(this);\n\t},\n\trender: function(withoutFilters) {\n\t\tif(!withoutFilters){\n\t\t\t// render filters\n\t\t\tvar filters = flt.processFilters(this);\n\t\t\tflt.showFilters(this, filters);\n\t\t}\n\t\tthis._valueLength = 0;\n\t\tvar struct = this.config.structure;\n\t\tif (struct && struct.groupBy && struct.values && struct.values.length){\n\t\t\tthis._setChartConfig();\n\t\t\tthis._loadFilteredData();\n\t\t} else {\n\t\t\tthis.config.structure = {\n\t\t\t\tvalues:[]\n\t\t\t};\n\t\t\tthis._setChartConfig();\n\t\t}\n\t},\n\t_setChartConfig: function() {\n\t\tvar config = this.config;\n\t\tvar values = config.structure.values;\n\n\t\tfor (var i = 0; i < values.length; i++) {\n\t\t\tvalues[i].operation = values[i].operation || [config.defaultOperation];\n\t\t\tif (!webix.isArray(values[i].operation))\n\t\t\t\tvalues[i].operation = [values[i].operation];\n\t\t}\n\n\t\tvar chartType = config.chartType||\"bar\";\n\t\tvar mapConfig = this.chartMap[chartType];\n\n\t\tvar chart = {\n\t\t\t\"type\":  (mapConfig&&mapConfig(\"\").type?mapConfig(\"\").type:chartType),\n\t\t\t\"xAxis\": webix.extend({template: \"#id#\"},config.chart.xAxis||{},true),\n\t\t\t\"yAxis\": webix.extend({},config.chart.yAxis||{})\n\t\t};\n\n\t\twebix.extend(chart,config.chart);\n\t\tif(!chart.padding){\n\t\t\tchart.padding = { top: 17};\n\t\t}\n\n\t\tvar result = this._getSeries();\n\n\t\tchart.series = result.series;\n\n\t\tchart.legend = false;\n\t\tif(config.singleLegendItem || this._valueLength>1){\n\t\t\tchart.legend = result.legend;\n\t\t}\n\n\t\tchart.scheme = {\n\t\t\t$group: this._pivot_group,\n\t\t\t$sort:{\n\t\t\t\tby: \"id\"\n\t\t\t}\n\t\t};\n\t\tthis.$$(\"chart\").removeAllSeries();\n\t\tfor(var c in chart){\n\t\t\tthis.$$(\"chart\").define(c,chart[c]);\n\t\t}\n\t\t\n\t\tif(this.$$(\"chart\") && !config.readonly){\n\t\t\tvar el = document.createElement(\"div\");\n\t\t\tel.className = \"webix_pivot_configure\";\n\t\t\tel.title = this._applyLocale(\"settings\");\n\t\t\tel.style.width = chart.legend.width +\"px\";\n\t\t\tel.style.top = chart.padding.top +\"px\";\n\t\t\tel.innerHTML = \"<span class='webix_pivot_icon pt-settings'></span><span class='webix_pivot_configure_label'>\"+webix.i18n.pivot.pivotMessage+\"</span>\";\n\t\t\tthis.$$(\"chart\").$view.insertBefore(el, this.$$(\"chart\").$view.querySelector(\"canvas\"));\n\t\t\tthis._eventId = webix.event(this.$$(\"chart\").$view.querySelector(\".webix_pivot_configure\"), \"click\", function(){\n\t\t\t\tthis.configure();\n\t\t\t}.bind(this));\n\t\t}\n\t},\n\t_applyLocale: function(value){\n\t\treturn webix.i18n.pivot[value]||value;\n\t},\n\t_capitalize: function(value){\n\t\treturn value.charAt(0).toUpperCase() + value.slice(1);\n\t},\n\t_applyMap: function(value, capitalize){\n\t\treturn this.config.fieldMap[value]||(capitalize?this._capitalize(value):value);\n\t},\n\t_loadFilteredData: function(){\n\t\tvar filters = this.config.structure.filters;\n\n\t\tflt.formatFilterValues(filters);\n\t\tsetFilterValues(filters);\n\n\t\tthis.data.silent(function(){\n\t\t\tthis.data.filter((item) => filterItem(filters,item, this.config.filterMap));\n\t\t},this);\n\t\tthis.$$(\"chart\").data.silent(function(){\n\t\t\tthis.$$(\"chart\").clearAll();\n\t\t},this);\n\t\tthis.$$(\"chart\").parse(this.data.getRange());\n\t\t// reset filtering\n\t\tthis.data.silent(function(){\n\t\t\tthis.data.filter(\"\");\n\t\t},this);\n\t},\n\tgroupNameToStr: function(obj){\n\t\treturn obj.name+\"_\"+obj.operation;\n\t},\n\tgroupNameToObject: function(name){\n\t\tvar arr = name.split(\"_\");\n\t\treturn {name:arr[0],operation:arr[1]};\n\t},\n\t_getSeries: function(){\n\t\tvar i, j, legend, map = {}, name, legendTitle, series = [],\n\t\t\tvalues = this.config.structure.values;\n\n\t\t// legend definition\n\t\tlegend = {\n\t\t\tvalign:\"middle\",\n\t\t\talign:\"right\",\n\t\t\twidth:220,\n\t\t\tlayout:\"y\"\n\t\t};\n\n\t\twebix.extend(legend,this.config.chart.legend||{},true);\n\t\tlegend.values = [];\n\t\tif(!legend.marker)\n\t\t\tlegend.marker = {};\n\t\tlegend.marker.type = (this.config.chartType==\"line\"?\"item\":\"s\");\n\n\t\tthis.series_names = [];\n\t\tthis._valueLength = 0;\n\n\t\tfor(i =0; i < values.length; i++){\n\t\t\tif(!webix.isArray(values[i].operation)){\n\t\t\t\tvalues[i].operation = [values[i].operation];\n\t\t\t}\n\t\t\tif(!webix.isArray(values[i].color)){\n\n\t\t\t\tvalues[i].color = [values[i].color||this._getColor(this._valueLength)];\n\t\t\t}\n\t\t\tfor(j=0;j<values[i].operation.length;j++){\n\n\t\t\t\tname = this.templates.groupNameToStr(values[i].name,values[i].operation[j]);\n\t\t\t\tthis.series_names.push(name);\n\t\t\t\tif(!values[i].color[j])\n\t\t\t\t\tvalues[i].color[j] = this._getColor(this._valueLength);\n\t\t\t\tvar color = values[i].color[j];\n\t\t\t\tvar sConfig = this.chartMap[this.config.chartType](color)||{};\n\t\t\t\tsConfig.value = \"#\"+name+\"#\";\n\t\t\t\tsConfig.tooltip = {\n\t\t\t\t\ttemplate: webix.bind(function(obj){\n\t\t\t\t\t\treturn obj[this].toFixed(3);\n\t\t\t\t\t},name)\n\t\t\t\t};\n\n\t\t\t\tseries.push(sConfig);\n\t\t\t\tlegendTitle = this.templates.seriesTitle.call(this,values[i],j);\n\t\t\t\tlegend.values.push({\n\t\t\t\t\ttext: legendTitle,\n\t\t\t\t\tcolor: color\n\t\t\t\t});\n\t\t\t\tmap[name]= [values[i].name,values[i].operation[j]];\n\t\t\t\tthis._valueLength++;\n\t\t\t}\n\t\t}\n\t\tthis._pivot_group = {};\n\t\tif(values.length)\n\t\t\tthis._pivot_group = webix.copy({\n\t\t\t\tby:  this.config.structure.groupBy,\n\t\t\t\tmap: map\n\t\t\t});\n\n\t\treturn {series: series,legend: legend};\n\t},\n\t_getColor:function(i){\n\t\tvar palette = this.config.palette;\n\t\tvar rowIndex = i/palette[0].length;\n\t\trowIndex = (rowIndex> palette.length?0:parseInt(rowIndex,10));\n\t\tvar columnIndex = i%palette[0].length;\n\t\treturn palette[rowIndex][columnIndex];\n\t},\n\toperations: { sum: 1, count:1, max: 1, min: 1},\n\taddGroupMethod: function(name, method){\n\t\tthis.operations[name] = 1;\n\t\tif(method)\n\t\t\twebix.GroupMethods[name] = method;\n\t},\n\tremoveGroupMethod: function(name){\n\t\tdelete this.operations[name];\n\t},\n\tgroupMethods_setter: function(obj){\n\t\tfor(var a in obj){\n\t\t\tif(obj.hasOwnProperty(a))\n\t\t\t\tthis.addGroupMethod(a, obj[a]);\n\t\t}\n\t},\n\t// fields for edit popup\n\tgetFields: function() {\n\t\tvar i,\n\t\t\tfields = [],\n\t\t\tfields_hash = {};\n\n\t\tfor (i = 0; i < Math.min(this.data.count() || 5); i++) {\n\t\t\tvar item = this.data.getItem(this.data.getIdByIndex(i));\n\t\t\tfor (var f in item) {\n\t\t\t\tif (!fields_hash[f]) {\n\t\t\t\t\tfields.push(f);\n\t\t\t\t\tfields_hash[f] = webix.uid();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar str = this.config.structure;\n\t\tvar result = { fields:[], groupBy:[], values:[], filters:[] };\n\n\t\tvar field = (typeof str.groupBy == \"object\"?str.groupBy[0]:str.groupBy);\n\t\tif (!webix.isUndefined(fields_hash[field])) {\n\t\t\tresult.groupBy.push({name: field, text: this._applyMap(field), id: fields_hash[field]});\n\t\t}\n\n\t\tvar valueNameHash = {};\n\t\tvar text;\n\t\tfor (i = 0; i < str.values.length; i++) {\n\t\t\tfield = str.values[i];\n\t\t\tif (!webix.isUndefined(fields_hash[field.name])) {\n\t\t\t\ttext = this._applyMap(field.name);\n\t\t\t\tif(webix.isUndefined(valueNameHash[field.name])){\n\t\t\t\t\tvalueNameHash[field.name] = result.values.length;\n\t\t\t\t\tresult.values.push({name: field.name, text: text, operation: field.operation, color: field.color||[this._getColor(i)], id: fields_hash[field.name]});\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tvar value = result.values[valueNameHash[field.name]];\n\t\t\t\t\tvalue.operation =value.operation.concat(field.operation);\n\t\t\t\t\tvalue.color =value.color.concat(field.color||[this._getColor(i)]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < (str.filters || []).length; i++) {\n\t\t\tfield = str.filters[i];\n\t\t\tif (!webix.isUndefined(fields_hash[field.name])) {\n\t\t\t\ttext = this._applyMap(field.name);\n\t\t\t\tresult.filters.push({name: field.name, text: text, type:field.type, value:field.value, id: fields_hash[field]});\n\t\t\t}\n\t\t}\n\n\t\tfields.sort();\n\n\t\tfor (i = 0; i < fields.length; i++) {\n\t\t\tfield = fields[i];\n\t\t\tif (!webix.isUndefined(fields_hash[field]))\n\t\t\t\tresult.fields.push({name:field, text: this._applyMap(field), id: fields_hash[field]});\n\t\t}\n\n\t\treturn result;\n\t},\n\tsetStructure: function(config){\n\t\tthis.define(\"structure\", config);\n\t\tthis.render();\n\t},\n\tgetStructure: function() {\n\t\treturn this.config.structure;\n\t},\n\tgetConfigWindow: function(){\n\t\treturn this._pivotPopup;\n\t},\n\tgetFilterView: function(){\n\t\treturn this.$$(\"filters\");\n\t},\n\t$exportView:function(options){\n\t\twebix.extend(options, {\n\t\t\tignore:{ $group:true, $row:true }\n\t\t});\n\t\treturn this.$$(\"chart\");\n\t}\n}, webix.IdSpace, webix.ui.layout, webix.DataLoader, webix.EventSystem, webix.Settings);"],"names":["formatFilterValues","filters","i","length","fvalue","getFormattedValue","value","webix","isDate","valueOf","toString","trim","processFilters","view","f","item","config","structure","items","indexes","isUndefined","type","push","point","field","name","minWidth","filterMinWidth","maxWidth","filterWidth","filterPlaceholder","placeholder","label","tagMode","isSelect","options","data","distinctValues","indexOf","css","separateLabel","_applyMap","labelAlign","filterLabelAlign","labelWidth","filterLabelWidth","callEvent","cols","autowidth","width","empty","values","pull","hash","id","$empty","_pivotOptions","concat","obj","isNumeric","n","isNaN","parseFloat","sort","a","b","val1","val2","toLowerCase","showFilters","setEvents","elements","getFilterView","show","ui","hide","event","filter","on","this","getValue","separator","format_setter","split","changeFilterValue","i18n","pivot","extend","apply","bar","cancel","chart","chartType","columns","count","date","datepicker","fields","groupBy","line","logScale","max","min","multicombo","operationNotDefined","layoutIncorrect","pivotMessage","popupHeader","radar","radarArea","rows","select","settings","stackedBar","sum","text","total","valuesNotDefined","windowTitle","windowMessage","protoUI","_selected","defaults","autoheight","padding","$init","_get_ui","$ready","_after_init","body","borderless","template","attachEvent","$eventSource","getItem","getSelected","popup","IdSpace","clickHandlers","e","$$","operation","defaultOperation","updateItem","delay","index","els","getItemNode","childNodes","el","getAttribute","op","selector","call","autofit","getFilterOptions","get","_applyLocale","bind","sel","close","func_selector","operations","p","html","locate","list","listId","innerId","splice","_removeListField","process","title","setStructure","baseName","uiArrays","uiViews","eventH","onViewInit","checkStructure","j","popupTemplates","header","iconHeader","icon","iconContent","tableValues","isArray","ops","locale","join","chartValues","color","_getColor","_valueLength","getDefault","listDrag","seed","getStructureMap","popupWidth","head","margin","cancelButtonWidth","applyButtonWidth","fieldsColumnWidth","height","scroll","drag","_getListEvents","onClick","clc","remove","add","freezeTotals","freezeTotal","getWidth","totalCount","getTotalCount","leftSplit","rightSplit","refreshColumns","Array","Object","prototype","base","source","force","method","uid","Date","getTotalColumnId","master","$divider","getValues","ids","addTotalColumns","groups","groupData","groupName","h","hRowCount","parts","totalCols","getTotalGroups","_pivotColumnGroups","columnWidth","format","rowspan","colspan","groupCount","pop","totalColumn","addTotalData","columnId","result","_pivotOperations","getTotal","_getUI","_afterInit","modal","move","define","render","getStructure","_lists","_dndCorrection","data_setter","copy","lists","forEach","listName","$css","clearAll","parse","_dropField","ctx","from","to","start","_addListField","_handlers","found","each","_setPivotFieldCss","refresh","_correctLists","targetItem","order","getFirstId","res","_setStructure","_listDragHTML","context","templateStart","templateEnd","onBeforeDrop","onBeforeDrag","onBeforeDragIn","addCss","DragControl","getNode","window","$view","className","popupBlocks","querySelectorAll","setAttribute","columnSort","webix_pivot_config_common","sortConfig","dir","as","isNum","sorting","int","string","processHeader","vConfig","valuesConfig","getHeader","sortHeader","tmp","text0","setSortConfig","column","$default","_dir","hlp","cIndex","key","keys","sorted","first","addFooter","names","footer","totalMethod","getTotalOptions","$pivotValue","calculateColumn","leavesOnly","$pivotOperation","_typeof","leaves","fItems","filterItems","selectedItems","calculateItem","isIds","divider","getOption","getKeyLeaves","setMinMax","maxArr","maxValue","minArr","minValue","$cellCss","numHelper","func","rules","contains","equal","not_equal","less","less_equal","more","more_equal","multi","fvalues","range","range_inc","setFilterValues","substr","filterItem","map","raw","Data","watch","_header","_header_hash","flt","group","processRows","processColumns","vname","$source","slice","prefix","k","setItemValues","stableRowId","open","itm","ping","filterMap","groupItem","args","Math","totalOperations","parseInt","Operations","pullTotal","totalOptions","str","eval","temp","option","_Pivot","_initOperations","webWorker","Worker","_initWorker","_pivotData","WebixPivot","_result","_pivotWorker","onmessage","_runPing","$destructed","_result_id","terminate","_getPivotData","next","serialize","t","postMessage","addOperation","addTotalOperation","addTotal","getData","fieldsHash","optionsHash","fieldMap","yScaleWidth","headerTemplate","toFixed","setColumns","footer_format","setFirstColumn","readonly","readonlyTitle","exportAsTree","init","extRender","_loadResults","silent","url","_setData","$onLoad","_pivotFields","url_setter","AtomDataLoader","load","success","JSON","Filters","_filters","_selects","getIndex","version","provideApi","_setConfig","_initDataStore","$separator","externalProcessing","ext","active","skin","$active","table","navigation","resizeColumn","rowHeight","rowLineHeight","headerRowHeight","barHeight","getTopParentView","getColumnIndex","configure","datatable","hidden","_configPopup","_createPopup","functions","pos","offset","setPosition","x","y","getFields","destructor","Destruction","skipFilters","debug_pivot","console","time","cor","_this","timeEnd","frz","$exportView","flatTree","flat","rowsHash","valuesHash","getIdByIndex","getConfigWindow","profile_setter","c","layout","DataLoader","EventSystem","Settings","colorboard","palette","getBody","chartTypes","types","chartMap","markCheckbox","scale","getType","common","chartTypeLabelWidth","chartTypeWidth","logScaleLabelWidth","_hidePopups","alert","editButtonWidth","singleLegendItem","templates","groupNameToStr","groupNameToObject","arr","seriesTitle","_capitalize","templates_setter","border","alpha","radius","borderColor","fill","disableItems","chartMap_setter","getUI","paddingY","paddingX","_pivotPopup","_eventId","eventRemove","withoutFilters","struct","_setChartConfig","_loadFilteredData","mapConfig","xAxis","yAxis","top","_getSeries","series","legend","scheme","$group","_pivot_group","$sort","by","removeAllSeries","document","createElement","style","innerHTML","insertBefore","querySelector","charAt","toUpperCase","capitalize","getRange","legendTitle","valign","align","marker","series_names","sConfig","tooltip","rowIndex","columnIndex","addGroupMethod","GroupMethods","removeGroupMethod","groupMethods_setter","hasOwnProperty","fields_hash","valueNameHash","ignore","$row"],"mappings":";;;;;;;;8wBAAO,SAASA,mBAAmBC,GAClCA,EAAUA,GAAW,OAChB,IAAIC,EAAI,EAAGA,EAAID,EAAQE,OAAQD,IACnCD,EAAQC,GAAGE,OAASC,kBAAkBJ,EAAQC,GAAGI,OAGnD,SAASD,kBAAkBC,UAC1BA,EAAQA,GAAS,GACbC,MAAMC,OAAOF,GAChBA,EAAQA,EAAMG,UAAUC,WAEA,iBAATJ,GACXA,EAAMK,OACTL,EAAQA,EAAMK,QAETL,EAGD,SAASM,eAAeC,OAC1BX,EAAGY,EAGNC,EAFAC,EAASH,EAAKG,OACdf,EAAUe,EAAOC,UAAUhB,SAAW,GAChCiB,EAAQ,GACdC,EAAU,OACNjB,EAAI,EAAGA,EAAID,EAAQE,OAAQD,IAAK,CACpCY,EAAIb,EAAQC,GACTK,MAAMa,YAAYD,EAAQL,EAAEO,SAC9BF,EAAQL,EAAEO,MAAQ,IACnBF,EAAQL,EAAEO,MAAMC,KAAKpB,OACjBmB,EAAkB,gBAAXP,EAAEO,KAAuB,aAAwB,WAAXP,EAAEO,KAAkB,aAAaP,EAAEO,QACpFN,EAAO,CACNT,MAAQC,MAAMa,YAAYN,EAAER,OAAO,GAAGQ,EAAER,MAAQiB,OAAO,EAAOC,MAAOV,EAAEW,KAAMZ,KAAMQ,EACnFK,SAAUV,EAAOW,eAAgBC,SAAUZ,EAAOa,aAI/Cb,EAAOc,oBAC8B,kBAA7Bd,EAAOc,mBACjBf,EAAKgB,YAAchB,EAAKiB,MACxBjB,EAAKiB,MAAQ,IAGbjB,EAAKgB,YAAcf,EAAOc,mBAGf,cAAVhB,EAAEO,OACJN,EAAKkB,SAAU,GAEZpB,EAAKZ,QAAQiC,SAASpB,EAAEO,QAC3BN,EAAKoB,QAAU,GACfpB,EAAKoB,QAAQC,KAAOC,eAAexB,EAAMC,EAAEW,MAAkC,GAA5BX,EAAEO,KAAKiB,QAAQ,UAChEvB,EAAKoB,QAAQZ,OAAQ,EAEV,cAARF,IACFN,EAAKoB,QAAQI,IAAM,kCACT,cAARlB,IACFN,EAAKoB,QAAQI,IAAM,mCAGjBvB,EAAOwB,gBACVzB,EAAKiB,MAAQnB,EAAK4B,UAAU3B,EAAEW,MAC9BV,EAAK2B,WAAa1B,EAAO2B,iBACzB5B,EAAK6B,WAAa5B,EAAO6B,kBAGtBhC,EAAKiC,UAAU,iBAAkB,CAAChC,EAAGC,OACrCC,EAAOwB,cAAe,KAClBR,EAAQnB,EAAK4B,UAAU3B,EAAEW,MAC/BP,EAAMI,KAAK,CACVyB,KAAM,CACL,CAAElC,KAAK,QAASmC,WAAU,EAAMhB,MAAAA,GAAS,CAAEiB,MAAM,IAAKlC,EAAM,CAACkC,MAAM,YAIrE/B,EAAMI,KAAKP,UAIPG,EAGR,SAASmB,eAAexB,EAAMW,EAAO0B,OAChC5C,EAAO6C,EAAS,GACnBf,EAAOvB,EAAKuB,KAAKgB,KACjBC,EAAO,MAELH,GACFC,EAAO7B,KAAK,CAAChB,MAAM,GAAGgD,GAAG,GAAIC,QAAO,IAElC1C,EAAK2C,eAAiB3C,EAAK2C,cAAchC,GAC3C,OAAO2B,EAAOM,OAAO5C,EAAK2C,cAAchC,QAEpC,IAAIkC,KAAOtB,EACf9B,EAAQ8B,EAAKsB,GAAKlC,GACbjB,MAAMa,YAAYd,KACjBA,GAAmB,IAAVA,GAAiB+C,EAAK/C,KACnC6C,EAAO7B,KAAK,CAAEhB,MAAMA,EAAMI,WAAY4C,GAAGhD,EAAMI,aAC/C2C,EAAK/C,IAAS,OAKbqD,EAAY,SAASC,UACfC,MAAMC,WAAWF,YAE3BT,EAAOY,KAAK,SAASC,EAAEC,OAClBC,EAAOF,EAAE1D,MACT6D,EAAOF,EAAE3D,aACR6D,EACAD,GACDP,EAAUO,IAAUP,EAAUQ,KACjCD,EAAOA,EAAKxD,WAAW0D,cACvBD,EAAKA,EAAKzD,WAAW0D,eAEVD,EAALD,EAAU,EAAGA,EAAKC,GAAM,EAAE,IALd,EADD,IAQZhB,EAGD,SAASkB,YAAYxD,EAAMZ,GACjCqE,UAAUzD,EAAMZ,OACZe,EAAS,CAACuD,SAAUtE,GACxBY,EAAKiC,UAAU,aAAc,CAAC,UAAW9B,IACrCA,EAAOuD,UAAY1D,EAAK2D,kBACN,EAAjBvE,EAAQE,QACXU,EAAK2D,gBAAgBC,OACrBlE,MAAMmE,GAAGzE,EAAQY,EAAK2D,kBAEtB3D,EAAK2D,gBAAgBG,QAMxB,SAASL,UAAUzD,EAAMZ,OACnB,IAAIC,EAAI,EAAGA,EAAID,EAAQE,OAAQD,IAAK,KACpC0E,EACHC,EAAS5E,EAAQC,GACd2E,EAAO9B,OACV8B,EAASA,EAAO9B,KAAK,IAEtB6B,EAAwB,QAAfC,EAAOhE,KAAe,kBAAkB,WACjDgE,EAAOC,GAAK,GACZD,EAAOC,GAAGF,GAAS,eACdtE,EAAQyE,KAAKC,WACb1E,GAASyE,KAAK/D,OAAOiE,YAAcF,KAAKG,gBAC3C5E,EAAQA,EAAM6E,MAAMJ,KAAK/D,OAAOiE,YACjCG,kBAAkBvE,EAAMkE,KAAK/D,OAAOQ,MAAOlB,KAK9C,SAAS8E,kBAAkBvE,EAAMW,EAAOlB,WACnCL,EAAUY,EAAKG,OAAOC,UAAUhB,QAC3BC,EAAI,EAAGA,EAAID,EAAQE,OAAQD,OAC/BD,EAAQC,GAAGuB,MAAQD,SACtBvB,EAAQC,GAAGI,MAAQA,EACnBO,EAAKiC,UAAU,iBAAkB,CAACtB,EAAOlB,KAClC,SAEF,EChKRC,MAAM8E,KAAKC,MAAQ/E,MAAMgF,OAAQhF,MAAM8E,KAAKC,OAAO,GAAI,CACtDE,MAAO,QACPC,IAAK,MACLC,OAAQ,SACRC,MAAO,QACPC,UAAW,aACXC,QAAS,UACTC,MAAO,QACPC,KAAM,OACNC,WAAY,aACZC,OAAQ,SACRhG,QAAS,UACTiG,QAAS,WACTC,KAAM,OACNC,SAAU,oBACVC,IAAK,MACLC,IAAK,MACLC,WAAY,eACZC,oBAAqB,2BACrBC,gBAAiB,0CACjBC,aAAc,qBACdC,YAAa,iBACbC,MAAO,QACPC,UAAW,aACXC,KAAM,OACNC,OAAQ,SACRC,SAAU,WACVC,WAAY,cACZC,IAAK,MACLC,KAAM,OACNC,MAAO,QACPjE,OAAQ,SACRkE,iBAAkB,wCAClBC,YAAa;AACbC,cAAe,qBClChBhH,MAAMiH,QAAQ,CACb/F,KAAK,oBACLgG,UAAW,KACXC,SAAS,CACRC,YAAY,EACZC,QAAQ,GAETC,MAAO,SAAS7G,GACfT,MAAMgF,OAAOvE,EAAQ+D,KAAK+C,QAAQ9G,SAC7B+G,OAAOzG,KAAKyD,KAAKiD,cAEvBF,QAAS,SAAS9G,SACV,CACNiH,KAAM,CACL3E,GAAG,OAAQzC,KAAK,OAAQqH,YAAY,EAAMP,YAAY,EAAMQ,SAAS,UAAW/F,KAAMpB,EAAOoB,QAIhG4F,YAAa,gBACPI,YAAY,cAAe,SAAS9E,QACnCmE,UAAY1C,KAAKsD,aAAaC,QAAQhF,QACtCqB,UAGP4D,YAAa,kBACLxD,KAAK0C,YAEXlH,MAAMmE,GAAG8D,MAAOjI,MAAMkI,aC3BZC,cAAgB,KACrB,SAASC,EAAErF,OACXgC,EAAQ/E,MAAMqI,GAAG7D,KAAK/D,OAAOsE,OAC/BvE,EAAOgE,KAAK6D,GAAG,UAAUN,QAAQhF,GACrCvC,EAAK8H,UAAUvH,KAAKgE,EAAMtE,OAAO8H,uBAC5BF,GAAG,UAAUG,WAAWzF,GAE7B/C,MAAMyI,MAAM,mBACPC,EAAQlI,EAAK8H,UAAU1I,OAAO,EAC9B+I,EAAMnE,KAAK6D,GAAG,UAAUO,YAAY7F,GAAI8F,WACxCC,EAAK,KACAnJ,EAAI,EAAGA,EAAIgJ,EAAI/I,OAAQD,QAC/BmJ,EAAKH,EAAIhJ,IACDoJ,kBAEJC,EAAKF,EAAGC,aAAa,uBACpB/I,MAAMa,YAAYmI,IAAOA,GAAMN,EAAO,MAEnC,OAALI,GACHX,cAAcc,SAASC,KAAK1E,KAAMsE,EAAI/F,EAAI+F,IACzCtE,yBAEe,SAAS4D,EAAErF,EAAG+F,OAC5Bb,EACHlD,EAAQ/E,MAAMqI,GAAG7D,KAAK/D,OAAOsE,OAC7BkE,EAAW,CACV3I,KAAM,oBAAqB0B,IAAK,oBAAqBmH,SAAQ,EAC7D/B,YAAY,EAAM1E,MAAO,IACzBb,KAAMuH,iBAAiBrE,EAAMrF,QAAQ2J,MAAOtE,EAAMuE,gBAEpDrB,EAAQjI,MAAMmE,GAAG8E,IACX/E,KAAK4E,GACXb,EAAMJ,YAAY,SAAU7H,MAAMuJ,KAAK,eAClCC,EAAMvB,EAAMD,iBACJ,OAARwB,EAAc,KACbhJ,EAAOgE,KAAK6D,GAAG,WAAWN,QAAQhF,GACtCvC,EAAKM,KAAO0I,EAAItI,KAChBV,EAAKT,MAAQ,QACRsI,GAAG,WAAWG,WAAWzF,GAG/BkF,EAAMwB,SACJjF,yBAEc,SAAS4D,EAAErF,EAAG+F,OAC3Bb,EACHlD,EAAQ/E,MAAMqI,GAAG7D,KAAK/D,OAAOsE,OAC7BkE,EAAW,CACV3I,KAAM,oBAAqB0B,IAAK,oBAAqBmH,SAAQ,EAC7D/B,YAAY,EAAM1E,MAAO,IACzBb,KAAMuH,iBAAiBrE,EAAMrF,QAAQ2J,MAAOtE,EAAMuE,gBAEpDrB,EAAQjI,MAAMmE,GAAG8E,IACX/E,KAAK4E,GACXb,EAAMJ,YAAY,SAAU7H,MAAMuJ,KAAK,eAClCC,EAAMvB,EAAMD,iBACJ,OAARwB,EAAc,KACbhJ,EAAOgE,KAAK6D,GAAG,WAAWN,QAAQhF,GACtCvC,EAAKM,KAAO0I,EAAItI,KAChBV,EAAKT,MAAQ,QACRsI,GAAG,WAAWG,WAAWzF,GAG/BkF,EAAMwB,SACJjF,iBAEQ,SAAS4D,EAAErF,EAAG+F,OACrBY,EAAgB,CACnBpJ,KAAM,oBAAqB0B,IAAK,oBAAqBmH,SAAQ,EAC7DzG,MAAO,IACPb,KAAM2C,KAAK/D,OAAOkJ,YAAY,IAE3BC,EAAI5J,MAAMmE,GAAGuF,GACjBE,EAAE1F,KAAK4E,GACPc,EAAE/B,YAAY,SAAU7H,MAAMuJ,KAAK,eAC9Bb,EAAQ1I,MAAM6J,KAAKC,OAAO1B,EAAG,mBAC7BoB,EAAMI,EAAE5B,cACA,OAARwB,SACEnB,GAAG,UAAUN,QAAQhF,GAAIuF,UAAUI,GAASc,EAAItI,UAChDmH,GAAG,UAAUG,WAAWzF,IAG9B6G,EAAEH,SACAjF,eAEM,SAAS4D,EAAGrF,OACjBgH,EAAO/J,MAAMqI,GAAGD,GAChB4B,EAASxF,KAAKyF,QAAQF,EAAKtJ,OAAOsC,IAClCvC,EAAOgE,KAAK6D,GAAG2B,GAAQjC,QAAQhF,MACtB,UAAViH,EAAmB,KACjBtB,EAAQ1I,MAAM6J,KAAKC,OAAO1B,EAAG,mBACL,EAAxB5H,EAAK8H,UAAU1I,QAClBY,EAAK8H,UAAU4B,OAAOxB,EAAO,QACxBL,GAAG,UAAUG,WAAWzF,SAExBoH,iBAAiB,SAAU3J,aAI5B2J,iBAAiBH,EAAQxJ,UAExB,IAKT,SAAS4I,iBAAiB1J,EAAS0K,OAC9BzK,EAAGuB,EAAMP,EAAQ,OACjBhB,EAAG,EAAGA,EAAID,EAAQE,OAAQD,IAC7BuB,EAAOxB,EAAQC,GACfgB,EAAMI,KAAK,CAACG,KAAMA,EAAMmJ,MAAOD,EAAQlJ,YAEjCP,WChHQ2J,aAAahK,EAAMiK,EAAU7J,EAAWD,OAEnD+J,EAAW,CAAC,OAAQ,QACvBC,EAAU,CAAC,OAAQ,QACnBxC,EAAQ3H,EACRoK,EAASjK,EAAO8D,GAAG9D,EAAO8D,GAAGoG,WAAW,KAErCC,EAAiB,SAAS7H,EAAGI,OAC5BxD,EAAGkL,EAAG3J,MAENvB,EAAG,EAAGA,EAAI8K,EAAQ7K,OAAOD,IAC5BuB,EAAO,KACJiC,EAAIsH,EAAQ9K,MACe,iBAAnBwD,EAAIsH,EAAQ9K,MACrBuB,EAAOiC,EAAIsH,EAAQ9K,IACnBwD,EAAIsH,EAAQ9K,IAAMe,EAAUQ,IAE7B0J,EAAe1J,EAAMiC,EAAIsH,EAAQ9K,UAG/BA,EAAG,EAAGA,EAAI6K,EAAS5K,OAAOD,OAC1BwD,EAAIqH,EAAS7K,IAAI,KACfqE,EAAWb,EAAIqH,EAAS7K,QACxBkL,EAAE,EAAGA,EAAI7G,EAASpE,OAAOiL,IAC5B3J,EAAO,KACkB,iBAAf8C,EAAS6G,KAClB3J,EAAO8C,EAAS6G,GAChB1H,EAAIqH,EAAS7K,IAAIkL,GAAKnK,EAAUQ,IAEjC0J,EAAe1J,EAAMiC,EAAIqH,EAAS7K,IAAIkL,IAItC9H,GAAMA,GAAIwH,IAAapH,EAAIJ,KAC7BI,EAAIJ,GAAKA,GACPA,GACC2H,GACFA,EAAOzF,MAAMgD,EAAM,CAAClF,EAAGI,YAG1ByH,EAAeL,EAAS7J,EAAU6J,IAC3B7J,EAAU6J,OCzCLO,eAAiB,CAC7BC,OAAQ,SAAS5H,UACTnD,MAAM8E,KAAKC,MAAM5B,EAAIpD,QAE7BiL,WAAY,SAAS7H,UACjBA,EAAI8H,KACC,4DAA4D9H,EAAI8H,KAAK,YAAYjL,MAAM8E,KAAKC,MAAM5B,EAAIpD,OAEtG,yCAAyCoD,EAAI+H,YAAY,UAAUlL,MAAM8E,KAAKC,MAAM5B,EAAIpD,QAEjGoL,YAAa,SAAUhI,OAChB4B,EAAQ/E,MAAMqI,GAAG7D,KAAK/D,OAAOsE,OACnC5B,EAAImF,UAAYnF,EAAImF,WAAa,CAACvD,EAAMtE,OAAO8H,kBAC1CvI,MAAMoL,QAAQjI,EAAImF,aACtBnF,EAAImF,UAAY,CAACnF,EAAImF,oBAElB+C,EAAM,GACNC,EAASvG,EAAMuE,aACV3J,EAAI,EAAGA,EAAIwD,EAAImF,UAAU1I,OAAQD,IAAK,KAC1CqJ,EAAK,kDAAoDrJ,EAAI,KACjEqJ,GAAM,SAAW7F,EAAIyD,KAAO,UAC5BoC,GAAM,sCAAwCsC,EAAOnI,EAAImF,UAAU3I,IAAM,UACzEqJ,GAAM,+EACNA,GAAM,SACNqC,EAAItK,KAAKiI,UAEHqC,EAAIE,KAAK,MAEjBC,YAAa,SAAUrI,OAChB4B,EAAQ/E,MAAMqI,GAAG7D,KAAK/D,OAAOsE,OAEnC5B,EAAImF,UAAYnF,EAAImF,WAAa,CAACvD,EAAMtE,OAAO8H,kBAC/CpF,EAAIsI,MAAQtI,EAAIsI,OAAS,GAEpBzL,MAAMoL,QAAQjI,EAAImF,aACtBnF,EAAImF,UAAY;AAACnF,EAAImF,oBAElB+C,EAAM,GACNC,EAASvG,EAAMuE,aAEV3J,EAAI,EAAGA,EAAIwD,EAAImF,UAAU1I,OAAQD,IAAK,CAC1CwD,EAAIsI,OAAUtI,EAAIsI,MAAM9L,KAC3BwD,EAAIsI,MAAM9L,GAAKoF,EAAM2G,UAAUlH,KAAKmH,mBAC/BA,oBAEF3C,EAAK,kDAAoDrJ,EAAI,KACjEqJ,GAAM,mEAAmEsC,EAAOnI,EAAIsI,MAAM9L,IAAI,iBAC9FqJ,GAAM,iCAAmC7F,EAAIyD,KAAO,SACpDoC,GAAM,qCAAuCsC,EAAOnI,EAAImF,UAAU3I,IAAM,SACxEqJ,GAAM,+EACNA,GAAM,SACNqC,EAAItK,KAAKiI,UAEHqC,EAAIE,KAAK,MAEjB7L,QAAS,SAAUyD,OACd4B,EAAQ/E,MAAMqI,GAAG7D,KAAK/D,OAAOsE,OACjC5B,EAAIrC,KAAOqC,EAAIrC,MAAQiE,EAAMrF,QAAQkM,iBACjC/B,EAAO,+BAAiC1G,EAAIyD,YAChDiD,GAAQ,sCAAwC9E,EAAMuE,aAAanG,EAAIrC,MAAQ,UAC/E+I,GAAQ,QACRA,GAAQ,gFAGTtD,KAAM,SAAUpD,OACX0G,EAAO,+BAAiC1G,EAAIyD,YAChDiD,GAAQ,QACRA,GAAQ,gFAGTvE,QAAS,SAAUnC,OACd0G,EAAO,+BAAiC1G,EAAIyD,YAChDiD,GAAQ,QACRA,GAAQ,gFAGTlE,QAAS,SAAUxC,OACd0G,EAAO,+BAAiC1G,EAAIyD,YAChDiD,GAAQ,QACRA,GAAQ,gFAGTgC,SAAU,SAAS1I,SACX,+BAAiCA,EAAIyD,KAAK,UCnE/CkF,KCbG,SAASC,gBAAgBzL,EAAMG,SAC9B,OACG,CACRiC,MAAOjC,EAAOuL,WACdC,KAAM,UACNvE,KAAM,gBAEI,CACVpH,KAAM,UACNqH,YAAY,EACZN,QAAS,GACT7E,KAAM,CACL,cACA,CACC0J,OAAQ,EACR1J,KAAM,CACL,SACA,wBAKW,CAACO,GAAI,cAAezC,KAAM,QAASmB,MAAOzB,MAAM8E,KAAKC,MAAMgC,aAAe,WAC/E,CAACzG,KAAM,SAAUyC,GAAI,SAAUtB,MAAOzB,MAAM8E,KAAKC,MAAMI,OAAQzC,MAAOjC,EAAO0L,yBAC9E,CAAC7L,KAAM,SAAUyC,GAAI,QAASjC,KAAM,OAAQW,MAAOzB,MAAM8E,KAAKC,MAAME,MAAOvC,MAAOjC,EAAO2L,uBAC1F,CACPtL,KAAM,OACNyF,KAAM,CACL,CACCvE,IAAK,4BACLlB,KAAM,QACN0B,KAAM,CACL,eACA,CACC1B,KAAM,OACNyF,KAAM,CACL,CACCzF,KAAM,OACNkB,IAAK,4BACLuE,KAAM,CACL,CACCzF,KAAM,OACN0B,KAAM,CACL,gBACA,kBAGF,CACC1B,KAAM,OACN0B,KAAM,CACL,aACA,sCAWM,CACfE,MAAOjC,EAAO4L,kBACd9F,KAAM,CACL,eACA,yBAGe,CAChBA,KAAM,CACL,gBACA,0BAGe,CAChBA,KAAM,CACL,gBACA,uBAGY,CACbA,KAAM,CACL,aACA,sBAGc,CACfA,KAAM,CACL,eACA,wBAGc,CACfxD,GAAI,eAAgBlB,KAAM,CAAC9B,MAAO,UAAWiC,IAAK,4BAClD4F,SAAUkD,eAAeC,OAAQuB,OAAQ,WAEhC,CACTvJ,GAAI,SAAUf,IAAK,qBAAsB1B,KAAM,OAAQiM,OAAQ,OAC/DzL,KAAM,CAACwL,OAAQ,QAASE,MAAM,EAAM5E,SAAU,yGAC9CrD,GAAIjE,EAAKmM,gCAEO,CAChB1J,GAAI,gBAAiBlB,KAAM,CAAC9B,MAAO,UAAWkL,KAAM,UACpDrD,SAAUkD,eAAeE,WAAYhJ,IAAK,0BAA2BsK,OAAQ,YAEnE,CACVvJ,GAAI,UAAWzC,KAAM,OAAQkM,MAAM,EAAMD,OAAQ,OACjD3E,SAAU5H,MAAMuJ,KAAKuB,eAAepL,QAASY,GAC7CQ,KAAM,CAACwL,OAAQ,QACfI,QAAS,sBACgB1M,MAAMuJ,KAAKoD,cAAkB,mBAAoBrM,qBACpDN,MAAMuJ,KAAKoD,cAAkBC,OAAQtM,IAE3DiE,GAAIjE,EAAKmM,gCAEO,CAChB1J,GAAI,gBAAiBlB,KAAM,CAAC9B,MAAO,UAAWkL,KAAM,WACpDrD,SAAUkD,eAAeE,WAAYhJ,IAAK,0BAA2BsK,OAAQ,YAEnE,CACVvJ,GAAI,UAAWzC,KAAM,OAAQkM,MAAM,EAAMD,OAAQ,OAAQzL,KAAM,CAACwL,OAAQ,QACxE1E,SAAU5H,MAAMuJ,KAAKuB,eAAexF,QAAShF,GAC7CiE,GAAIjE,EAAKmM,iBACTC,QAAS,mBACa1M,MAAMuJ,KAAKoD,cAAkBC,OAAQtM,gBAG9C,CACbyC,GAAI,aAAclB,KAAM,CAAC9B,MAAO,OAAQkL,KAAM,QAC9CrD,SAAUkD,eAAeE,WAAYhJ,IAAK,0BAA2BsK,OAAQ,SAEtE,CACPvJ,GAAI,OACJzC,KAAM,OACNkM,MAAM,EAAMD,OAAQ,OACpB3E,SAAU5H,MAAMuJ,KAAKuB,eAAevE,KAAMjG,GAC1CQ,KAAM,CAACwL,OAAQ,QACf/H,GAAIjE,EAAKmM,iBACTC,QAAS,mBACa1M,MAAMuJ,KAAKoD,cAAkBC,OAAQtM,kBAG5C,CACfyC,GAAI,eAAgBlB,KAAM,CAAC9B,MAAO,SAAUkL,KAAK,UACjDrD,SAAUkD,eAAeE,WAAYhJ,IAAK,0BAA2BsK,OAAQ,WAEpE,CACTvJ,GAAI;AAAUzC,KAAM,OAAQiM,OAAQ,OAAQC,MAAM,EAAMxK,IAAK,qBAAsBlB,KAAM,CAACwL,OAAQ,QAClG1E,SAAU5H,MAAMuJ,KAAKuB,eAAeK,YAAa7K,GACjDoM,QAAS,sBACgB1M,MAAMuJ,KAAKoD,cAAkB1D,SAAU3I,oBAC3CN,MAAMuJ,KAAKoD,cAAkBE,IAAKvM,qBACjCN,MAAMuJ,KAAKoD,cAAkBC,OAAQtM,IAE3DiE,GAAIjE,EAAKmM,mBC9JL,SAASK,aAAaxM,MACzBA,EAAKG,OAAOsM,YAAY,KACtBpN,EAAG2F,EAAUhF,EAAK+H,GAAG,QAAQ5H,OAAO6E,QACpC5C,EAAQsK,SAAS1H,GACjB2H,EAAaC,cAAc5H,OAE1B3F,EAAG,EAAGA,EAAIW,EAAK+H,GAAG,QAAQ5H,OAAO0M,UAAUxN,IAC/C+C,GAAS4C,EAAQ3F,GAAG+C,UAEhB/C,EAAG2F,EAAQ1F,OAAO,EAAGD,EAAI2F,EAAQ1F,OAAOqN,EAAWtN,IACvD+C,GAAQ4C,EAAQ3F,GAAG+C,MAET,IAARA,IACFpC,EAAK+H,GAAG,QAAQ5H,OAAO2M,WAAaH,EACpC3M,EAAK+H,GAAG,QAAQgF,mBAKnB,SAASH,cAAc5H,WAClBC,EAAQ,EACJ5F,EAAE2F,EAAQ1F,OAAO,GAAI2F,GAAY,GAAJ5F,EAAOA,IACxC2F,EAAQ3F,GAAGoL,OAAO,IAAmC,SAA7BzF,EAAQ3F,GAAGoL,OAAO,GAAG7J,OAC/CqE,EAAQD,EAAQ1F,OAAOD,UAElB4F,EAGR,SAASyH,SAAS1H,OACb3F,EAAG+C,EAAO,MACT/C,EAAG,EAAGA,EAAI2F,EAAQ1F,OAAOD,IAC7B+C,GAAQ4C,EAAQ3F,GAAG+C,aACbA,EFhCD,SAAS0I,QAAQjI,UAChBmK,MAAMlC,QAAQkC,MAAMlC,QAAQjI,GAA8C,mBAAxCoK,OAAOC,UAAUrN,SAAS+I,KAAK/F,GAGlE,SAAStC,YAAY4C,eACR,IAALA,EAGR,SAASuB,OAAOyI,EAAMC,EAAQC,OAE/B,IAAIC,KAAUF,EACbD,EAAKG,KAAWD,IACpBF,EAAKG,GAAUF,EAAOE,WACjBH,EAKD,SAASI,aACV/B,OACJA,MAAM,IAAIgC,MAAQ5N,aACnB4L,KGrBD,SAASiC,iBAAiBC,EAAQ9M,SAC1B,cAAgB8M,EAAOC,SAAW/M,EAG1C,SAASgN,UAAU1N,EAAM2N,OACpBxO,EAAGI,EAAO6C,EAAS,OACnBjD,EAAE,EAAGA,EAAGwO,EAAIvO,OAAOD,IACtBI,EAAQS,EAAK2N,EAAIxO,IACb2D,MAAMC,WAAWxD,KACpB6C,EAAO7B,KAAKhB,UAEP6C,EAGD,SAASwL,gBAAgBJ,EAAQjD,OACnCsD,EAAQC,EAAWC,EAAWC,EAAG7O,EACpC8O,EAAWC,EACXC,EAAY,OAGbF,EAAY1D,EAAO,GAAGA,OAAOnL,QAEd,EACd,OAAOmL,MAKHwD,KAFLF,GADAC,EAAYM,eAAeZ,EAAQjD,IAChBsD,OACnBL,EAAOa,mBAAqBR,EACH,KAExBG,EAAI,CACHzL,GAAIgL,iBAAiBC,EAAQO,GAC7BxD,OAAO,GACPvH,KAAK,MACLd,MAAOsL,EAAOvN,OAAOqO,YACrBC,OAAQf,EAAOvN,OAAOsO,QAIlBpP,EAAG,EAAGA,EAAI8O,EAAU,EAAG9O,IACvBA,GAAMgP,EAAU/O,OAQnB4O,EAAEzD,OAAOhK,KAAK,IAPdyN,EAAEzD,OAAOhK,KAAK,CACbG,KAAM,QACN8N,QAASP,EAAU,EACnBQ,QAASX,EAAU/I,QAQtBmJ,EAAQH,EAAU3J,MAAMoJ,EAAOC,UAC/BO,EAAEzD,OAAOhK,KAAK,CACbG,KAAKqN,EACLjG,UAAWoG,EAAM,GACjB9H,KAAM8H,EAAM,KAGbC,EAAU5N,KAAKyN,UAGTzD,EAAO7H,OAAOyL,GAGtB,SAASC,eAAeZ,EAAQjD,OAC3BwD,EAAW5O,EAAGuB,EAAMoH,EAAWoG,EAClCL,EAAS,GACTa,EAAa,MAEVvP,EAAI,EAAGA,EAAGoL,EAAOnL,OAAQD,IAE5BuB,GADAwN,EAAQ3D,EAAOpL,GAAGoD,GAAG6B,MAAMoJ,EAAOC,WACrBkB,MAEI,QADjB7G,EAAYoG,EAAMS,QACqC,WAA7BnB,EAAOvN,OAAO2O,cAElCf,EADLE,EAAYjG,EAAY0F,EAAOC,SAAW/M,KAEzCgO,IACAb,EAAOE,GAAa,CACnBjG,UAAWA,EACX6F,IAAI,GACJY,OAAQhE,EAAOgE,SAGjBV,EAAOE,GAAWJ,IAAIpN,KAAKgK,EAAOpL,GAAGoD,WAGhC,CAACsL,OAAQA,EAAQ9I,MAAO2J,GAIzB,SAASG,aAAarB,EAAQrN,OAGxBhB,EAAGwO,EAAKjN,EAFhBmN,EAASL,EAAOa,sBACjBR,MAEEnN,KAAQmN,MAEXF,EADQE,EAAOnN,GACHiN,IAERxO,EAAG,EAAGA,EAAIgB,EAAMf,OAAQD,IAAI,KAC3B2I,SACHgH,EAAWvB,iBAAiBC,EAAQ9M,GACpCqO,EAAS,GACT3M,EAASsL,UAAUvN,EAAMhB,GAAIwO,GAC3BvL,EAAOhD,SACL0I,EAAY0F,EAAOwB,iBAAiBC,SAASvO,EAAK0D,MAAMoJ,EAAOC,UAAU,OAC5EsB,EAASjH,EAAUY,KAAK8E,EAAQpL,EAAQ0M,EAAU3O,EAAMhB,KAG1DgB,EAAMhB,GAAG2P,GAAYC,EAClB5O,EAAMhB,GAAGkC,OACXlB,EAAMhB,GAAGkC,KAAOwN,aAAarB,EAAQrN,EAAMhB,GAAGkC,cAI3ClB,QC/GFsG,QAAQ,CACb/F,KAAM,4BACNoG,MAAO,SAAS7G,GACfT,MAAMgF,OAAOvE,EAAO+D,KAAK2C,UACzBnH,MAAMgF,OAAOvE,EAAQ+D,KAAKkL,OAAOjP,IAAS,QACrC+G,OAAOzG,KAAKyD,KAAKmL,aAEvBxI,SAAS,CACRE,QAAQ,EACRiF,OAAQ,IACR5J,MAAO,IACPyJ,kBAAmB,IACnBC,iBAAkB,GAClBH,MAAM,EACN2D,OAAM,EACNC,MAAM,GAEPH,OAAQ,iBACA,IAERC,WAAY,aACZrF,aAAc,SAAS7J,QACjBqP,OAAO,YAAarP,QACpBsP,UAENC,aAAc,iBACN,IAERC,OAAO,GACPC,eAAe,GACfC,YAAa,SAASpQ,OAGXJ,EACT+F,GAHD3F,EAAQC,MAAMoQ,KAAKrQ,IAGH2F,OACf2K,EAAQ7L,KAAKyL,WAEdvK,EAAO4K,QAAQ,SAASrP,GACvBoP,EAAMC,QAAQ,SAASC,GACfxQ,EAAMwQ,GACRD,QAAQ,SAAS9P,GAClBA,EAAKU,MAAQD,EAAMC,OACrBD,EAAMuP,KAAO,0CAKZnI,GAAG,UAAUoI,gBACbpI,GAAG,UAAUqI,MAAMhL,GAEnB/F,EAAE,EAAGA,EAAI0Q,EAAMzQ,OAAQD,SACtB0I,GAAGgI,EAAM1Q,IAAI8Q,gBACbpI,GAAGgI,EAAM1Q,IAAI+Q,MAAM3Q,EAAMsQ,EAAM1Q,MAGtCgR,WAAY,SAASC,OAChBpQ,EACHqQ,EAAOD,EAAIC,KACXC,EAAKF,EAAIE,MACPA,GAAMA,GAAMD,SACdrQ,EAAOR,MAAMoQ,KAAKS,EAAK9I,QAAQ6I,EAAIG,QAChCD,GAAMtM,KAAK6D,GAAG,UAChB7D,KAAK2F,iBAAiB3F,KAAKyF,QAAQ4G,EAAKpQ,OAAOsC,IAAIvC,GAEnDgE,KAAKwM,cAAcxM,KAAKyF,QAAQ6G,EAAGrQ,OAAOsC,IAAKvC,EAAMoQ,EAAIlI,QACnD,GAGTsI,cAAe,SAASjH,EAAMvJ,EAAMkI,QAC9BuI,UAAUlH,GAAMb,KAAK1E,KAAMuF,EAAMvJ,EAAMkI,IAE7CyB,iBAAkB,SAASJ,EAAMvJ,QAC3B6H,GAAG0B,GAAM6C,OAAOpM,EAAKuC,YACtBsN,EAAQ7L,KAAKyL,OACbiB,GAAQ,EACJvR,EAAG,GAAIuR,GAASvR,EAAI0Q,EAAMzQ,OAAOD,SACnC0I,GAAGgI,EAAM1Q,IAAIkC,KAAKsP,KAAK,SAASlQ,GACjCA,EAAMC,MAAQV,EAAKU,OACrBgQ,EAAQjQ,KAGPiQ,GACH1M,KAAK4M,kBAAkB5Q,EAAKU,KAAK,KAEnCkQ,kBAAmB,SAASlQ,EAAMc,QAC5BqG,GAAG,UAAUxG,KAAKsP,KAAK,SAAS3Q,GACjCA,EAAKU,MAAQA,IACfV,EAAKgQ,KAAO,IAAIxO,OACXqP,QAAQ7Q,EAAKuC,QAIrBkO,UAAW,SACC,SAASV,EAAU/P,OACzB0Q,GAAQ,EACXhQ,EAAOV,EAAKU,KACZ6I,EAAOvF,KAAK6D,GAAGkI,GAEhBxG,EAAKlI,KAAKsP,KAAK,SAASlQ,GACpBA,EAAMC,MAAQA,IAChBgQ,GAAQ,KAGNA,WACI1Q,EAAKuC,GACZgH,EAAK8C,IAAIrM,QACJ4Q,kBAAkBlQ,EAAK,mCACvBoQ,cAAcpQ,EAAMqP,UAGnB,SAASA,EAAU/P,OACtB0Q,GAAQ,EACXhQ,EAAOV,EAAKU,KACZ6I,EAAOvF,KAAK6D,GAAGkI,GAEhBxG,EAAKlI,KAAKsP,KAAK,SAASlQ,GACpBA,EAAMC,MAAQA,IAChBgQ,GAAQ,KAGNA;OACI1Q,EAAKuC,GACZgH,EAAK8C,IAAIrM,QACJ4Q,kBAAkBlQ,EAAK,mCACvBoQ,cAAcpQ,EAAMqP,aAGhB,SAASA,EAAU/P,QACxByQ,UAAU1K,KAAK2C,KAAK1E,KAAK+L,EAAU/P,WAE/B,SAAS+P,EAAU/P,EAAMkI,OAC9B6I,EAAa,KAChBxH,EAAOvF,KAAK6D,GAAGkI,GAChBxG,EAAKlI,KAAKsP,KAAK,SAASlQ,GACpBA,EAAMC,MAAQV,EAAKU,OACrBqQ,EAAatQ,KAIZsQ,EACF5E,cAAkBE,IAAI3D,KAAK1E,KAAK,GAAG+M,EAAWxO,UAGzCqO,kBAAkB5Q,EAAKU,KAAK,8BACjC6I,EAAK8C,IAAI7M,MAAMoQ,KAAK5P,GAAMkI,SAEtB4I,cAAc9Q,EAAKU,KAAMqP,YAEpB,SAASA,EAAU/P,MAC1BgE,KAAK6D,GAAGkI,GAAU1O,KAAK2P,MAAM5R,OAAO,KAClCmD,EAAKyB,KAAK6D,GAAGkI,GAAUkB,kBACtBtH,iBAAiBoG,EAAU/L,KAAK6D,GAAG,WAAWN,QAAQhF,SAEvDqO,kBAAkB5Q,EAAKU,KAAK,qCAC1BV,EAAKuC,QACPsF,GAAGkI,GAAU1D,IAAIrM,QACjB8Q,cAAc9Q,EAAKU,KAAMqP,KAGhCe,cAAe,SAASpQ,EAAMqP,OACzB5Q,EAAG+R,EACNrB,EAAQ7L,KAAK0L,eAAeK,OACxB5Q,EAAE,EAAG0Q,GAAS1Q,EAAG0Q,EAAMzQ,OAAQD,IACnC+R,EAAM,UACDrJ,GAAGgI,EAAM1Q,IAAIkC,KAAKsP,KAAK,SAAS3Q,GACjCA,EAAKU,MAAQA,IACfwQ,EAAMlR,KAELkR,GACFlN,KAAK6D,GAAGgI,EAAM1Q,IAAIiN,OAAO8E,EAAI3O,KAGhC4O,cAAe,SAASjR,EAAWD,UAC3B6J,aAAa9F,KAAK,QAAQ9D,EAAWD,IAE7CmR,cAAe,SAASC,MACpBA,EAAQd,MAAM,KACZvQ,EAAOgE,KAAKuD,QAAQ8J,EAAQd,OAChCc,EAAQhI,KAAOrF,KAAK1D,KAAKgR,cAActR,EAAKgE,KAAK1D,MAAMgK,eAAee,SAASrL,GAAMgE,KAAK1D,KAAKiR,YAAYvR,EAAMgE,KAAK1D,QAIxH2L,eAAgB,iBACR,CACNuF,aAAchS,MAAMuJ,KAAK/E,KAAKmM,WAAWnM,MACzCyN,aAAczN,KAAKoN,cACnBM,eAAgB,WACflS,MAAM6J,KAAKsI,OAAOnS,MAAMoS,YAAYC,UAAU,yBAAwB,OAIvErS,MAAMmE,GAAGmO,OAAQtS,MAAMkI,eC/LpBjB,QAAQ,CACb/F,KAAM,qBACNiG,SAAS,CACRkF,kBAAmB,IACnBL,WAAY,KAEb1E,MAAO,gBACDiL,MAAMC,WAAa,4BAEzB9C,OAAQ,SAASjP,OACZC,EAAYV,MAAMoQ,KAAKrE,gBAAgBvH,KAAM/D,WAC1C+D,KAAKmN,cAAcjR,EAAWD,IAEtCwP,OAAO,CAAC,UAAU,UAAU,OAAO,UACnCC,eAAgB,MACP,CAAC,UAAU,kBACR,CAAC,eACF,CAAC,SAEZP,WAAY,gBACN9H,YAAY,cAAe,SAAS9E,OACpCkH,EAAUzF,KAAKyF,QAAQlH,MACZ,UAAXkH,GAAkC,SAAXA,EAAmB,KAEzCvJ,EAAY8D,KAAKwL,eAElBhQ,MAAMqI,GAAG7D,KAAK/D,OAAOsE,OAAOxC,UAAU,WAAW0H,EAAS,CAACvJ,WACxD6B,UAAU,KAAK0H,EAAS,CAACvJ,SACzB0D,mBAKJqO,EAAcjO,KAAK+N,MAAMG,iBAAiB,0CACrC/S,EAAI,EAAGA,EAAI8S,EAAY7S,OAAQD,IACvC8S,EAAY9S,GAAGgT,aAAa,iBAAkB3S,MAAM8E,KAAKC,MAAMiC,gBAGjEgJ,aAAc,eACTtP,EAAY,CAAE6F,KAAK,GAAIjB,QAAQ,GAAG1C,OAAO,GAAGlD,QAAQ,IAE7C8E,KAAK6D,GAAG,QACdxG,KAAKsP,KAAK,SAAShO,GACvBzC,EAAU6F,KAAKxF,KAAKoC,EAAIjC,QAEXsD,KAAK6D,GAAG,WACdxG,KAAKsP,KAAK,SAAShO,GAC1BzC,EAAU4E,QAAQvE,KAAKoC,EAAIjC,QAGfsD,KAAK6D,GAAG,UACdxG,KAAKsP,KAAK,SAAShO,GACzBzC,EAAUkC,OAAO7B,KAAKoC,KAETqB,KAAK6D,GAAG,WACdxG,KAAKsP,KAAK,SAAShO,GAC1BzC,EAAUhB,QAAQqB,KAAKoC,SAGpB4B,EAAQ/E,MAAMqI,GAAG7D,KAAK/D,OAAOsE,cAE9BA,EAAMtE,OAAOC,UAAUkS,aACzBlS,EAAUkS,WAAa7N,EAAMtE,OAAOC,UAAUkS,YAExClS,IAENV,MAAMmE,GAAG0O,+BCjERC,WAAa,CAChBC,IAAK,EACLC,GAAI,SAASvP,EAAEC,UACXuP,MAAMxP,IAAMwP,MAAMvP,GACbwP,QAAQC,OAAI1P,EAAEC,GACfwP,QAAQE,OAAO3P,EAAEC,KAItBwP,QAAU,MACN,SAASzP,EAAEC,UACVA,GAAI,IAAXD,GAAI,GACO,EAAGA,EAAEC,GAAG,EAAE,SAEhB,SAASD,EAAEC,UACPA,GAAI,IAAbD,GAAM,GACK,EAAGA,EAAEC,GAAG,EAAE,UAEb,SAASD,EAAEC,UACdA,EACAD,GACLA,EAAIA,EAAEtD,WAAW0D,eAAeH,EAAEA,EAAEvD,WAAW0D,eACxCJ,EAAI,EAAGA,EAAEC,GAAG,EAAE,IAFL,EADD,IAOV,SAAS2P,cAAcrF,EAAQjD,OACjCpL,EAAGkL,EAAGjB,EAAU0J,EACnBC,EAAevF,EAAOvN,OAAOC,UAAUkC,WAIxCmI,EAASyI,UAAUxF,EAFnBjD,EAAS0I,WAAWzF,EAAOvN,OAAOC,UAAWqK,IAIxCpL,EAAI,EAAGA,EAAIoL,EAAOnL,OAAQD,IAAK,KAC/B+O,EAAQ,OACP7D,EAAI,EAAGA,EAAIE,EAAOpL,GAAGC,OAAQiL,IACjC6D,EAAM3N,KAAKgK,EAAOpL,GAAGkL,GAAG3J,MAGzBoS,EAAU,SACNI,EAAMhF,EAAMA,EAAM9O,OAAO,GAAGgF,MAAMoJ,EAAOC,cACzCpD,EAAG,EAAGA,EAAI0I,EAAa3T,SAAW0T,EAASzI,OAC3C0I,EAAa1I,GAAGvC,UAClB,IAAIsB,EAAG,EAAGA,EAAG2J,EAAa1I,GAAGvC,UAAU1I,OAAQgK,IAC3C2J,EAAa1I,GAAG3J,MAAQwS,EAAI,IAAMH,EAAa1I,GAAGvC,UAAUsB,IAAM8J,EAAI,KACxEJ,EAAUC,EAAa1I,IAK3BE,EAAOpL,GAAK,CAACoD,GAAI2L,EAAMnD,KAAKyC,EAAOC,UAAWlD,OAAQA,EAAOpL,IAC7DoL,EAAOpL,GAAGoP,OAAUuE,GAAWA,EAAQvE,OACtCuE,EAAQvE,OACG,SAAV2E,EAAI,GAAgB1F,EAAOvN,OAAOsO,OAAS,YAG3ChE,EAAOnL,QAAUoO,EAAO1N,MAAQ0N,EAAO1N,KAAKiC,WAC9CyL,EAAO1N,KAAKiC,UAAU,eAAgB,CAACwI,IAErCiD,EAAOvN,OAAO2O,aAAerE,EAAOnL,SACtCmL,EAASqD,gBAAgBJ,EAAQjD,IAElCA,EAAOb,OAAO,EAAG,EAAG,CAACnH,GAAG,OAAQ6E,SAAS,8BAA+BmD,OAAO,CAAEnE,UApCpE+M,KAsCN5I,EAGR,SAASkI,MAAMlT,UACNuD,MAAY,EAANvD,GAMf,SAAS6T,cAAcnT,EAAQoT,OAC1BX,EAAUJ,kBACXrS,IAECA,EAAOoT,GACTX,EAAUzS,EAAOoT,GAEVpT,EAAOqT,WACdZ,EAAUzS,EAAOqT,UAEfZ,EAAQH,MACVG,EAAQa,KAAoB,QAAbb,EAAQH,KAAa,EAAE,GACvCiB,OAAWd,EAAQJ,aAEbI,EAIR,SAASO,WAAWhT,EAAQsK,EAAOkJ,OAC9BJ,EAAQlU,EAAGuU,EAAKC,EAAMjB,EACzBkB,EAAS,MAEP7G,OAAO4G,OAA8B,IAAtB1T,EAAOmS,eACxBqB,EAASA,GAAQ,EAEjBJ,EAASpT,EAAO6E,QAAQ2O,GACxBf,EAAUU,cAAcnT,EAAOmS,WAAYiB,GAC3CM,EAAO5G,OAAO4G,KAAKpJ,GACfkJ,EAASxT,EAAO6E,QAAQ1F,SAC3BuU,EAAOA,EAAK3Q,KAAK,SAASC,EAAEC,UACpBwP,EAAQF,GAAGvP,EAAEC,GAAGwP,EAAQa,QAEjCE,IAEItU,EAAE,EAAGA,EAAIwU,EAAKvU,OAAQD,IACzBuU,EAAMC,EAAKxU,GACXyU,EAAOrT,KAAK,CACXmT,IAAKA;AACLrS,KAAM4R,WAAWhT,EAAQsK,EAAOmJ,GAAMD,cAKpCC,KAAOnJ,EACVqJ,EAAOrT,KAAK,CACXmT,IAAKA,EACLrS,KAAM4R,WAAWhT,EAAQsK,EAAOmJ,aAK5BE,EAGR,SAASZ,UAAUlT,EAAMuB,OAEpBwS,EAAO1U,EAAGa,EAAMqK,EAAG2D,EACtBzD,EAAS,OAELpL,EAAG,EAAGA,EAAIkC,EAAKjC,OAAQD,QAC3Ba,EAAOqB,EAAKlC,IAEHkC,KAAKjC,OAAQ,KACjB2P,EAASiE,UAAUlT,EAAME,EAAKqB,UAClCwS,GAAQ,EACHxJ,EAAI,EAAGA,EAAI0E,EAAO3P,OAAQiL,KAC9B2D,EAAIe,EAAO1E,IACTX,OAAO,EAAG,EAAG,CAAEhJ,KAAKV,EAAK0T,MACtBG,IACJ7F,EAAE,GAAGS,QAAUM,EAAO3P,OACtByU,GAAQ,GAETtJ,EAAOhK,KAAKyN,OAEP,KACF2F,EAAOtS,EAAKlC,GAAGuU,IAAItP,MAAMtE,EAAK2N,UAClClD,EAAOhK,KAAK,CAAC,CAAEG,KAAMW,EAAKlC,GAAGuU,IAAK5L,UAAU6L,EAAK,GAAIvN,KAAKuN,EAAK,aAG1DpJ,WC7JQuJ,UAAUtG,EAAQ1I,EAAS3E,OACtCF,EAAQd,EAAG4U,EAAOjM,MAElB3I,EAAE,EAAGA,EAAI2F,EAAQ1F,OAAOD,IAAI,CAC/Bc,EAAS,KAET6H,GADAiM,EAAQjP,EAAQ3F,GAAGoD,GAAG6B,MAAMoJ,EAAOC,WACjBsG,EAAM3U,OAAO,GACJ,WAAxBoO,EAAOvN,OAAO+T,QACA,OAAblM,IACF7H,EAAS,SAEPgU,EAAczG,EAAOwB,iBAAiBC,SAASnH,OAC/C7H,GAAUgU,EAAY,KACrB7S,EAAUoM,EAAOwB,iBAAiBkF,gBAAgBpM,GAEtD7H,EAAS,CACRkU,YAFYC,gBAAgBjU,EAAO2E,EAAQ3F,GAAGoD,GAAI0R,EAAa7S,GAASA,EAAQiT,YAGhFC,gBAAiBxM,QAIlB7H,EAAS,IACV6E,EAAQ3F,GAAG6U,OAAS/T,EAEc,UAA/BsU,QAAO/G,EAAOvN,OAAO+T,SACvBR,OAAW1O,EAAQ3F,GAAG6U,OAAQxG,EAAOvN,OAAO+T,QAAQ,IAKvD,SAASI,gBAAgBjU,EAAO2O,EAAUmF,EAAaO,OAClDrV,EAAeI,EAAZkV,EAAQ,GAAWrS,EAAS,OAEnCjC,EAAQuU,YAAYvU,EAAOqU,GAEvBrV,EAAE,EAAGA,EAAGgB,EAAMf,OAAQD,IACzBI,EAAQY,EAAMhB,GAAG2P,GACZhM,MAAMC,WAAWxD,MACrB6C,EAAO7B,KAAW,EAANhB,GACZkV,EAAOlU,KAAKJ,EAAMhB,YAGb8U,EAAY7R,EAAQ0M,EAAU2F,GAGtC,SAASC,YAAYvU,EAAOqU,EAAQG,GAC/BA,IACHA,EAAgB,QACb,IAAIxV,EAAE,EAAGA,EAAIgB,EAAMf,OAAOD,IAC1BqV,GAAUrU,EAAMhB,GAAGkC,KACrBqT,YAAYvU,EAAMhB,GAAGkC,KAAMmT,EAAQG,GAEnCA,EAAcpU,KAAKJ,EAAMhB,WAEpBwV,WCxDQC,cAAc5U,EAAMC,EAAQuN,OACvCrO,EAAG0V,EAAOnB,EAAKc,EAAQ1M,EAAWoL,EAAK9Q,EAC1CmI,EAAStK,EAAOsK,WAEZpL,EAAI,EAAGA,EAAIoL,EAAOnL,OAAQD,IAAK,IAGnC2I,GADAoL,GADAQ,EAAMnJ,EAAOpL,IACHiF,MAAMnE,EAAO6U,UACP5B,EAAI9T,OAAO,GAE3BgD,EAASpC,EAAK0T,GAEdc,EAASvU,EAAOkJ,WAAW4L,UAAUjN,EAAU,cAC/C+M,EAAQ5U,EAAOkJ,WAAW4L,UAAUjN,EAAU,OAC3C0M,GAAUxU,EAAKqB,OACjBe,EAAS,GACT4S,aAAahV,EAAKqB,KAAKqS,EAAItR,IAExBA,EAAO,SACNf,EAAO,GACPsM,EAAM,GACFtD,EAAE,EAAGA,EAAIjI,EAAOhD,OAAOiL,IAAI,KAC9B9K,EAAQ6C,EAAOiI,GACf9H,EAAK,KACW,UAAhBgS,QAAOhV,KACVA,EAAQA,EAAMA,MACdgD,EAAKH,EAAOiI,GAAG9H,KAEZhD,GAAkB,KAATA,KACZ8B,EAAKd,KAAKhB,GACNgD,GAAIoL,EAAIpN,KAAKgC,IAGhBlB,EAAKjC,OACPY,EAAK0T,GAAOzT,EAAOkJ,WAAWN,IAAIf,EAAtB7H,CAAiCoB,EAAMqS,EAAK1T,EAAM6U,EAAMlH,EAAI,MAExE3N,EAAK0T,GAAO,QAGb1T,EAAK0T,GAAO,GAIblG,EAAOzI,eAED/E,EAGR,SAASgV,aAAa3T,EAAMqS,EAAK3E,OAC5B5P,MAEAA,EAAE,EAAGA,EAAIkC,EAAKjC,OAAOD,IACrBkC,EAAKlC,GAAGkC,KACV2T,aAAa3T,EAAKlC,GAAGkC,KAAKqS,EAAI3E,GAE9BA,EAAOxO,KAAKc,EAAKlC,GAAGuU,IAIhB,SAASuB,UAAUjV,EAAMC,OAC3Bd,EAAGkL,EAAGqJ,EACTwB,EAAQC,EAAUC,EAAQC,EAC1B9V,EACAgL,EAAStK,EAAOsK,OAChBjF,EAAMrF,EAAOqF,IACbC,EAAMtF,EAAOsF,IACbnD,EAASnC,EAAOmC,WAGZmD,IAAQD,EACZ,OAAOtF,MAGHA,EAAKsV,WAAUtV,EAAKsV,SAAW,IAG/BnW,EAAI,EAAGA,EAAIiD,EAAOhD,OAAQD,IAAK,KACnCI,EAAQ6C,EAAOjD,GACf+V,EAAO,GACPC,GAAU,SACVC,EAAO,GACPC,EAAS,SAEJhL,EAAI,EAAGA,EAAIE,EAAOnL,OAAQiL,IAC9BqJ,EAAMnJ,EAAOF,GACTvH,MAAM9C,EAAK0T,MAEkB,IAA7BA,EAAInS,QAAQhC,EAAMmB,QAElB4E,GAAOtF,EAAK0T,GAAOyB,GACtBD,EAAS,CAAExB,GACXyB,EAAWnV,EAAK0T,IACN1T,EAAK0T,IAAQyB,GACvBD,EAAO3U,KAAKmT,GAETnO,GAAOvF,EAAK0T,GAAO2B,GACtBD,EAAS,CAAE1B,GACX2B,EAAWrV,EAAK0T,IACN1T,EAAK0T,IAAQ2B,GACvBD,EAAO7U,KAAKmT,QAITrJ,EAAI,EAAGA,EAAI+K,EAAOhW,OAAQiL,IAC9BrK,EAAKsV,SAASF,EAAO/K,IAAM,gBAEvBA,EAAI,EAAGA,EAAI6K,EAAO9V,OAAQiL,IAC9BrK,EAAKsV,SAASJ,EAAO7K,IAAM,mBAGtBrK,WC5GCuV,UAAUlW,EAAQE,EAAOiW,MACb,UAAjBjB,QAAOlV,QACL,IAAIF,EAAE,EAAGA,EAAIE,EAAOD,OAAQD,OAC/BE,EAAOF,GAAK4D,WAAW1D,EAAOF,IAC1B2D,MAAMzD,EAAOF,IAAK,OAAO,UAI9BE,EAAS0D,WAAW1D,GAEhByD,MAAMzD,GAAS,OAAO,SAGvByD,MAAMvD,IACHiW,EAAKnW,EAAQE,GAGd,IAAMkW,MAAQ,CACpBC,SAAU,SAASrW,EAAQE,UAC6C,GAAhEA,EAAM8D,cAAc9B,QAAQlC,EAAOM,WAAW0D,gBAEtDsS,MAAO,SAAStW,EAAQE,UAChBgW,UAAUlW,EAAQE,EAAO,SAASF,EAAQE,UACxCF,GAAUE,KAGpBqW,UAAW,SAASvW,EAAQE,UACpBgW,UAAUlW,EAAQE,EAAO,SAASF,EAAQE,UACxCF,GAAUE,KAGpBsW,KAAM,SAASxW,EAAQE,UACfgW,UAAUlW,EAAQE,EAAO,SAASF,EAAQE,UACxCA,EAAQF,KAGlByW,WAAY,SAASzW,EAAQE,UACrBgW,UAAUlW,EAAQE,EAAO,SAASF,EAAQE,UACxCA,GAASF,KAGnB0W,KAAM,SAAS1W,EAAQE,UACfgW,UAAUlW,EAAQE,EAAO,SAASF,EAAQE,UAChCF,EAARE,KAGVyW,WAAY,SAAS3W,EAAQE,UACrBgW,UAAUlW,EAAQE,EAAO,SAASF,EAAQE,UAC/BF,GAATE,KAGV0W,MAAO,SAASC,EAAS3W,GACD,iBAAZ2W,IACVA,EAAUA,EAAQ9R,MAAM,UAErB,IAAIjF,EAAE,EAAGA,EAAI+W,EAAQ9W,OAAQD,OAC5BI,GAAS2W,EAAQ/W,GACpB,OAAO,SAEF,GAERgX,MAAO,SAAS9W,EAAQE,UAChBgW,UAAUlW,EAAQE,EAAO,SAASF,EAAQE,UACxCA,EAAQF,EAAO,IAAME,GAASF,EAAO,MAG/C+W,UAAW,SAAS/W,EAAQE,UACpBgW,UAAUlW,EAAQE,EAAO,SAASF,EAAQE,UACxCA,GAASF,EAAO,IAAME,GAASF,EAAO,OAK1C,SAASgX,gBAAgBnX,GAC/BA,EAAUA,GAAW,OAEhB,IAAIC,EAAI,EAAGA,EAAID,EAAQE,OAAQD,IAAK,KACpCY,EAAIb,EAAQC,GACfE,EAASU,EAAEV,OACQ,mBAAVA,EACTU,EAAEyV,KAAOnW,EACW,UAAVU,EAAEO,MAA8B,cAAVP,EAAEO,MAClCP,EAAEyV,KAAO,SAASnW,EAAQE,UAClBF,GAAUE,GAElBF,EAAUA,GAAQ,KACiB,EAA1BU,EAAEO,KAAKiB,QAAQ,SACxBxB,EAAEyV,KAAOC,MAAMQ,MACa,WAAlB1B,QAAOlV,GACjBU,EAAEyV,KAAOC,MAAMU,MACiB,KAAtB9W,EAAOiX,OAAO,EAAE,IAC1BvW,EAAEyV,KAAOC,MAAME,MACftW,EAASA,EAAOiX,OAAO,IACS,MAAtBjX,EAAOiX,OAAO,EAAE,IAC1BvW,EAAEyV,KAAOC,MAAMG,UACfvW,EAASA,EAAOiX,OAAO,IACS,MAAtBjX,EAAOiX,OAAO,EAAE,IAC1BvW,EAAEyV,KAAOC,MAAMO,WACf3W,EAASA,EAAOiX,OAAO,IACS,KAAtBjX,EAAOiX,OAAO,EAAE,IAC1BvW,EAAEyV,KAAOC,MAAMM,KACf1W,EAASA,EAAOiX,OAAO,IACS,MAAtBjX,EAAOiX,OAAO,EAAE,IAC1BvW,EAAEyV,KAAOC,MAAMK,WACfzW,EAASA,EAAOiX,OAAO,IACS,KAAtBjX,EAAOiX,OAAO,EAAE,IAC1BvW,EAAEyV,KAAOC,MAAMI,KACfxW,EAASA,EAAOiX,OAAO,IACU,EAAxBjX,EAAOkC,QAAQ,QACxBxB,EAAEyV,KAAOC,MAAMU,MACf9W,EAASA,EAAO+E,MAAM,QACU,EAAvB/E,EAAOkC,QAAQ,OACxBxB,EAAEyV,KAAOC,MAAMW,UACf/W,EAASA,EAAO+E,MAAM,OACH,cAAVrE,EAAEO,KACXP,EAAEyV,KAAO,SAASnW,EAAQE,UAClBF,GAAUE,GAGlBQ,EAAEyV,KAAOC,MAAMC,SAEhB3V,EAAEV,OAASA,GAIN,SAASJ,qBAAmBC,OAC9BC,EAAGE,MACPH,EAAUA,GAAW;AAChBC,EAAI,EAAGA,EAAID,EAAQE,OAAQD,IAEV,iBADrBE,EAAUH,EAAQC,GAAGE,QAAUH,EAAQC,GAAGI,OAAS,KAE9CF,EAAOO,OACVP,EAASA,EAAOO,QAElBV,EAAQC,GAAGE,OAASA,EAIf,SAASkX,WAAWrX,EAASc,EAAMwW,OAEpCrX,EAAGY,KADLb,MAEGC,EAAI,EAAGA,EAAID,EAAQE,OAAQD,QAC/BY,EAAIb,EAAQC,IACNE,OAAO,KACRoB,EAAQ+V,GAAOA,EAAIzW,EAAEW,MAAM8V,EAAIzW,EAAEW,MAAMX,EAAEW,QACzC8S,YAAgBxT,EAAKS,IACxB,OAAO,MAEJgW,EAAMzW,EAAKS,MACF,KAARgW,IAAcA,EAAK,OAAO,MAE3BlX,EAAQkX,EAAI9W,eACHI,EAAEyV,KAAKzV,EAAEV,OAAQE,GAG7B,OAAO,SAIJ,MCzJKmX,KAAb,sBACalJ,EAAQvN,gCACduN,OAASA,OACTvN,OAASA,OACT8E,MAAQ,uDAcN1D,EAAM2P,OAETlM,EAASI,EAAQqF,EAAQpL,EAAGgB,OAD3BwW,MAAQ,IAAIrJ,SAGbpN,EAAY8D,KAAK9D,cACrBA,EAAU0W,QAAU,GACpB1W,EAAU2W,aAAe,GAEzBC,qBAAuB5W,EAAUhB,SACjC4X,gBAAoB5W,EAAUhB,SAEzBC,EAAI,EAAGA,EAAIe,EAAUkC,OAAOhD,OAAQD,IACxCe,EAAUkC,OAAOjD,GAAG2I,UAAY5H,EAAUkC,OAAOjD,GAAG2I,WAAa,CAAC9D,KAAK/D,OAAO8H,kBACzEyL,QAAYtT,EAAUkC,OAAOjD,GAAG2I,aACpC5H,EAAUkC,OAAOjD,GAAG2I,UAAY,CAAC5H,EAAUkC,OAAOjD,GAAG2I,gBAGvDhD,EAAU,GACN3F,EAAE,EAAEA,EAAGe,EAAU4E,QAAQ1F,OAAQD,IACpC2F,EAAQ3F,GAAqC,UAA/BoV,QAAOrU,EAAU4E,QAAQ3F,IAAgBe,EAAU4E,QAAQ3F,GAAGoD,IAAIpD,EAAGe,EAAU4E,QAAQ3F,UAGtG+F,EAAShF,EAAU6F,KAAKrD,OAAOoC,GAC/B3E,EAAQ6D,KAAK+S,MAAM1V,EAAM2P,EAAO9L,GAEhCqF,EAAS,GAERpK,EAD2B,EAAxBD,EAAU6F,KAAK3G,OACV4E,KAAKgT,YAAY7W,EAAOD,EAAU6F,KAAM7F,EAAWqK,EAAQ,UAG9D0M,eAAe9W,EAAO2E,EAAS5E,EAAWqK,GACvC,IAGTA,EAASsI,cAAc7O,KAAKwJ,OAAQjD,GAEpCpK,EAAQ0O,aAAa7K,KAAKwJ,OAAQrN,GAE/B6D,KAAK/D,OAAO+T,QACdF,UAAU9P,KAAKwJ,OAAQjD,EAAQpK,UAEzBD,EAAU0W,eACV1W,EAAU2W,aAEV,CAAEtM,OAAQA,EAAQlJ,KAAMlB,0CAGjBkB,EAAMyD,EAAS5E,EAAWqK,EAAQvK,EAAMU,OAClDwW,KAEJlX,EAAOA,GAAQ,CAAEmX,QAAS,IACL,EAAjBrS,EAAQ1F,WAEN,IAAID,KADTuB,EAAOA,GAAQ,GACDW,EACTkJ,EAAOpL,KACVoL,EAAOpL,GAAK,IACbkC,EAAKlC,GAAK6E,KAAKiT,eAAe5V,EAAKlC,GAAI2F,EAAQsS,MAAM,GAAIlX,EAAWqK,EAAOpL,GAAIa,GAAmB,EAAZU,EAAKtB,OAAYsB,EAAOsD,KAAK8Q,QAAU,IAAM3V,OAE9H,KACFiD,EAASlC,EAAUkC,WAClB,IAAIG,KAAMlB,EAAM,CACpBrB,EAAKmX,QAAQ5W,KAAKgC,OACb,IAAIpD,EAAI,EAAGA,EAAIiD,EAAOhD,OAAQD,QAC7B,IAAIkL,EAAI,EAAGA,EAAIjI,EAAOjD,GAAG2I,UAAU1I,OAAQiL,IAE9C6M,OADkB,IAATxW,EACDA,EAAOsD,KAAK8Q,QAAU1S,EAAOjD,GAAG2I,UAAUuC,GAAKrG,KAAK8Q,QAAU1S,EAAOjD,GAAGuB,KAExE0B,EAAOjD,GAAG2I,UAAUuC,GAAKrG,KAAK8Q,QAAU1S,EAAOjD,GAAGuB,KACtDR,EAAU2W,aAAaK,KAC3BhX,EAAU0W,QAAQrW,KAAK2W,GACvBhX,EAAU2W,aAAaK,IAAS,GAE7B1D,YAAgBxT,EAAKkX,MACxBlX,EAAKkX,GAAS,GACd3M,EAAOnI,EAAOjD,GAAG2I,UAAUuC,GAAKrG,KAAK8Q,QAAU1S,EAAOjD,GAAGuB,MAAQ,IAGlEV,EAAKkX,GAAO3W,KAAK,CAAChB,MAAM8B,EAAKkB,GAAIH,EAAOjD,GAAGuB,MAAM6B,GAAIA,YAKlDvC,sCAGIqB,EAAM0E,EAAM7F,EAAWqK,EAAQ8M,OACtClY,EAAGa,EAAMqK,EAAGiN,EAAG/X,EAClBY,EAAQ,MACS,EAAd4F,EAAK3G,OAAY,KACfD,KAAKkC,EACTA,EAAKlC,GAAK6E,KAAKgT,YAAY3V,EAAKlC,GAAI4G,EAAKqR,MAAM,GAAIlX,EAAWqK,EAAQ8M,EAAO,IAAIlY,OAE9EiD,EAASlC,EAAU0W,YAElBzX,KAAKkC,EAAM,KACfrB,EAAO,CAAEqB,KAAMA,EAAKlC,IACfkL,EAAI,EAAGA,EAAIrK,EAAKqB,KAAKjC,OAAQiL,QAC5BiN,EAAI,EAAGA,EAAIlV,EAAOhD,OAAQkY,IAE1B9D,YAAgBxT,EADpBT,EAAQ6C,EAAOkV,OAEdtX,EAAKT,GAAS,IACfS,EAAKT,GAAOgB,KAAKP,EAAKqB,KAAKgJ,GAAG9K,SAG3BgY,cAAcvX,GACfgE,KAAKwJ,OAAOvN,OAAOuX,cACtBxX,EAAKuC,GAAK8U,EAAS,IAAMlY,GAE1Ba,EAAKU,KAAOvB,EACZa,EAAKyX,MAAO,EACZtX,EAAMI,KAAKP,aAGPb,KAAKkC,GACTrB,EAAOgE,KAAKiT,eAAe5V,EAAKlC,GAAIe,EAAU4E,QAAS5E,EAAWqK,IAC7D7J,KAAOvB,EAER6E,KAAKwJ,OAAOvN,OAAOuX,cACtBxX,EAAKuC,GAAK8U,EAAS,IAAMlY,QAErBoY,cAAcvX,GACnBG,EAAMI,KAAKP,UAGNG,wCAGMH,UAMbA,EAAO0X,UALP1X,EAAO0X,cAAkB1X,EAAM,CAC9BuK,OAAQvG,KAAK9D,UAAU0W,QACvB9B,QAAS9Q,KAAK8Q,QACd3L,WAAYnF,KAAKmF,YACfnF,MACuB,CACzBuG,OAAQvG,KAAK9D,UAAU0W,QACvBtR,IAAKtB,KAAK/D,OAAOqF,IACjBC,IAAKvB,KAAK/D,OAAOsF,IACjBnD,OAAQ4B,KAAK9D,UAAUkC,SAIP,IAAb4B,KAAKe,aACHA,MAAQ,EACTf,KAAK/D,OAAO0X,MACf3T,KAAK/D,OAAO0X,KAAKjP,KAAK1E,KAAMA,KAAK2S,QAG5B3W,gCAGFqB,EAAM2P,EAAO9L,OACd/F,EAAOa,EACVsC,EAAO,OAEHnD,EAAI,EAAGA,EAAI6R,EAAM5R,OAAQD,KAE7Ba,EAAOqB,EADF2P,EAAM7R,MAEC2X,WAAe9S,KAAK9D,UAAUhB,QAASc,EAAMgE,KAAK/D,OAAO2X,iBAC/DC,UAAUvV,EAAMtC,EAAMkF,UAGtB5C,oCAGEA,EAAMtC,EAAMkF,MAClBA,EAAO9F,OAAO,KACZG,EAAQS,EAAKkF,EAAO,YACH,IAAV3F,EAAuB,OAAO,KAEtCiU,YAAgBlR,EAAK/C,MACvB+C,EAAK/C,GAAS,SACVsY,UAAUvV,EAAK/C,GAAQS,EAAMkF,EAAOkS,MAAM,SAG/C9U,EAAKtC,EAAKuC,IAAMvC,qCAGPA,WACNd,EAAU8E,KAAK9D,UAAUhB,SAAW,GAC/BC,EAAI,EAAGA,EAAID,EAAQE,OAAQD,IAAK,KACpCY,EAAIb,EAAQC,MACZY,EAAEV,OAAO,IACRmU,YAAgBxT,EAAKD,EAAEW,OAC1B,OAAO,MAEJnB,EAAQS,EAAKD,EAAEW,MAAMf,WAAW0D,kBACvBtD,EAAEyV,KAAKzV,EAAEV,OAAQE,GAG7B,OAAO,UAGH,4CA1MAyE,KAAKwJ,OAAOwB,wDAIZhL,KAAKwJ,OAAOC,kDAGZzJ,KAAK/D,OAAOC,gBAfrB,GCLMiJ,WAAc,CACnBhD,IAAK,SAAS/D,WACT+D,EAAM,EACDhH,EAAI,EAAGA,EAAIiD,EAAOhD,OAAQD,IAAK,KACnCI,EAAQ6C,EAAOjD,GACnBI,EAAQwD,WAAWxD,EAAO,IACrBuD,MAAMvD,KACV4G,GAAO5G,UAEF4G,GAERpB,MAAO,SAAS1D,EAAMqS,EAAK1T,OACtB+E,EAAQ,KACR/E,EAAKqB,SAGJ,IAAIlC,EAAE,EAAGA,EAAIa,EAAKqB,KAAKjC,OAAQD,IAClC4F,GAAS/E,EAAKqB,KAAKlC,GAAGuU,IAAM,OAH7B3O,EAAQ1D,EAAKjC,cAKP2F,GAERO,IAAK,SAASwS,UACM,GAAfA,EAAK1Y,OAAoB0Y,EAAK,GAC3BC,KAAKzS,IAAIb,MAAMT,KAAM8T,IAE7BvS,IAAK,SAASuS,UACM,GAAfA,EAAK1Y,OAAoB0Y,EAAK,GAC3BC,KAAKxS,IAAId,MAAMT,KAAM8T,KAIxBE,gBAAkB,KAChB,SAAS5V,OACXjD,EAAGgH,EAAM,MACRhH,EAAI,EAAGA,EAAIiD,EAAOhD,OAAQD,IAC9BgH,GAAO/D,EAAOjD,UACRgH,OAED,SAAS/D,UACM,GAAjBA,EAAOhD,OAAoBgD,EAAO,GAC/B2V,KAAKxS,IAAId,MAAM,KAAKrC,QAErB,SAASA;OACM,GAAjBA,EAAOhD,OAAoBgD,EAAO,GAC/B2V,KAAKzS,IAAIb,MAAM,KAAKrC,UAEnB,SAASA,OACb7C,EAAQyY,gBAAgB7R,IAAIuC,KAAK1E,KAAM5B,UACpC7C,EAAM0Y,SAAS1Y,EAAM,IAAI,KAIrB2Y,WAAb,uEAEO7V,KAAOmR,OAAW,GAAGrK,iBACrB/H,QAAU,QACV+W,UAAY3E,OAAW,GAAGwE,sBAC1BI,aAAe,yEAIhBC,EAAM,OACL,IAAI3E,KAAO1P,KAAK3B,KACpBgW,EAAI3E,GAAO1P,KAAK3B,KAAKqR,GAAK/T,kBACpB0Y,sCAGFA,SACA,IAAI3E,OAAO2E,IACfC,KAAK,eAAeD,IAAI3E,WACnBrR,KAAKqR,KAAO1P,KAAKuU,iCAIpB7X,EAAM0M,EAAQhM,QACZiB,KAAK3B,GAAQ0M,EACfhM,IACF4C,KAAK5C,QAAQV,GAAQU,oCAGdV,EAAM0M,EAAQhM,QACjB+W,UAAUzX,GAAQ0M,EACpBhM,IACF4C,KAAKoU,aAAa1X,GAAQU,+BAGxBV,UACIsD,KAAK3B,KAAK3B,IAAO,wCAEdA,UACHsD,KAAK5C,QAAQV,IAAO,uCAElBA,EAAK8X,UACPxU,KAAK5C,QAAQV,GAAMsD,KAAK5C,QAAQV,GAAM8X,GAAQ,sCAG7C9X,UACDsD,KAAKmU,UAAUzX,IAASsD,KAAK3B,KAAK3B,IAAO,6CAEjCA,UACRsD,KAAKmU,UAAUzX,GAAOsD,KAAKoU,aAAa1X,IAAQ,KAAMsD,KAAK5C,QAAQV,IAAO,4CAEnEA,EAAK8X,OACfpX,EAAU4C,KAAKkQ,gBAAgBxT,UAC5BU,EAAQA,EAAQV,GAAM8X,GAAQ,oBApDvC,GClDM1D,QAAU,MAET,SAAS2D,OAAOxY,EAAQuN,QACzBC,SAAWqH,aACX4D,uBACAzY,OAASA,OACTH,KAAO0N,EAERvN,EAAO0Y,WAAiC,oCAAZC,gBAAAA,UAA2BpL,OACrDqL,YAAY5Y,EAAQuN,GAEzBxJ,KAAK8U,WAAa,IAAIpC,KAAK1S,KAAMA,KAAK/D,QAElC+D,KAAK/D,OAAOC,YAChB8D,KAAK/D,OAAOC,UAAY,IACzBsT,OAAWxP,KAAK/D,OAAOC,UAAW,CAAE6F,KAAK,GAAIjB,QAAQ,GAAI1C,OAAO,GAAIlD,QAAQ,KAyEtE,SAAS6Z,WAAW9Y,EAAQuN,GAClCiL,OAAO/P,KAAK1E,KAAM/D,EAAQuN,GAvE3BiL,OAAOzL,UAAY,CAClB6L,qBAAY5Y,EAAQuN,QACdwL,QAAU,UACVC,aAAe,IAAIL,OAAO3Y,EAAO0Y,gBACjCM,aAAaC,UAAY,SAACtR,GACV,SAAhBA,EAAEvG,KAAKf,KACVkN,EAAO2L,SAASvR,EAAEvG,KAAKsV,MAAOnJ,GACpBA,EAAOwL,UAAYxL,EAAO4L,cACpC5L,EAAOzL,UAAU,iBAAkB,IAC9B6F,EAAEvG,KAAKkB,IAAMqF,EAAEvG,KAAKkB,KAAOiL,EAAO6L,aACtC7L,EAAOwL,QAAQpR,EAAEvG,KAAKA,MACtBmM,EAAOwL,QAAU,SAKrBG,kBAASxC,EAAOnJ,YAETvN,OAAO0X,KAAKhB,GAChB,MAAM/O,QACFqR,aAAaK,iBACbT,YAAY7U,KAAK/D,OAAQuN,GAC9BA,EAAOzL,UAAU,iBAAkB,MAGrCwX,uBAAclX,EAAM2O,EAAOwI,OACtBxV,KAAKiV,aAyBF,KACFlK,EAAS/K,KAAK8U,WAAWlP,QAAQvH,EAAM2O,UACvCwI,GAAMA,EAAKzK,GACRA,MA3BHxM,EAAKyB,KAAKqV,WAAa7Z,MAAM6N,WAC5B2L,QAAUQ,MAEXnY,EAAO,GACPnB,EAAY8D,KAAK/D,OAAOC,UACxB8T,EAAShQ,KAAK/D,OAAO+T,OACrB7K,EAAanF,KAAKgL,iBAAiByK,eACnCvZ,IAAcA,EAAU6F,KAAK3G,QAAUc,EAAU4E,QAAQ1F,QAC5D,IAAK,IAAID,EAAI6R,EAAM5R,OAAS,EAAQ,GAALD,EAAQA,IACtCkC,EAAKlC,GAAKkD,EAAK2O,EAAM7R,SAElB4C,UAAU,mBAAoB,QAE/BwM,EAASvK,KAAK/D,OAAOsO,UACH,mBAAXA,EAAsB,KAC5BmL,EAAI,IAAIla,MAAM6N,MAClB7N,MAAM8E,KAAKoV,GAAKnL,EAChBA,EAASmL,MAGJ/B,IAAS3T,KAAK/D,OAAO0X,UACtBsB,aAAaU,YAAY,CAC7B3F,OAAAA,EAAQ9T,UAAAA,EAAWmB,KAAAA,EAAMkB,GAAAA,EAAI4G,WAAAA,EAAYwO,KAAAA,EAAMpJ,OAAAA,KAQlDmK,+BACKvP,EAAanF,KAAKgL,iBAAmB,IAAIkJ,gBACxC/O,WAAaA,EAAW9G,MAG9BuX,sBAAalZ,EAAM0M,EAAQhM,QACrB4N,iBAAiB3C,IAAI3L,EAAM0M,EAAQhM,IAEzCyY,2BAAkBnZ,EAAM0M,EAAQhM,QAC1B4N,iBAAiB8K,SAASpZ,EAAM0M,EAAQhM,KAQ/C2X,WAAW/L,UAAYwG,OAAW,CACjCuG,iBAAQ1Y,OACHlC,EAAGoD,EAAIiW,EACV/X,EAAOyE,EAAS,GAAI8U,EAAa,GACjC9a,EAAU8E,KAAK/D,OAAOC,UAAUhB,QAChCmD,EAAO,GAAKjB,EAAU,GAAI6Y,EAAc,GACxC9Q,EAAanF,KAAKmF,WAClB6H,EAAQ,GACRjC,EAAS,OAEN5P,EAAE,EAAGA,EAAID,EAAQE,OAAQD,KACa,GAAtCD,EAAQC,GAAGmB,KAAKiB,QAAQ,YAC1BH,EAAQlC,EAAQC,GAAGuB,MAAQ,GAC3BuZ,EAAY/a,EAAQC,GAAGuB,MAAQ,QAI7BvB,EAAE,EAAGA,EAAIkC,EAAKjC,OAAQD,IAAI,IAE7BkD,EADAE,EAAKlB,EAAKlC,GAAGoD,GAAKlB,EAAKlC,GAAGoD,IAAKiR,OACpBnS,EAAKlC,GAChB6R,EAAMzQ,KAAKgC,GAERpD,EAAI,EACN,IAAKsB,KAASY,EAAKlC,GACb6a,EAAWvZ,KACfyE,EAAO3E,KAAKE,GACZuZ,EAAWvZ,GAAS+S,WAGnBgF,KAAUpX,EAAQ,KACjB7B,EAAQ8B,EAAKlC,GAAGqZ,GAChBhF,YAAgBjU,IACf0a,EAAYzB,GAAQjZ,KACvB0a,EAAYzB,GAAQjZ,GAAQ,EAC5B6B,EAAQoX,GAAQjY,KAAKhB,SAYrBgD,KALJwM,EAAO3N,QAAUA,EACjB2N,EAAO7J,OAASA,EAChB6J,EAAO1N,KAAO2C,KAAKuV,cAAclX,EAAM2O,GAEvCjC,EAAO5F,WAAa,GACVA,EACT4F,EAAO5F,WAAW5I,KAAKgC,UAEjBwM,IAEN0J,OAAOzL,eCnJGrG,SAAW,CACvBuT,SAAU,GACVC,YAAa,IACb7L,YAAa,IACbvG,iBAAkB,MAClBnG,iBAAkB,QAClBb,mBAAkB,EAClBD,YAAa,IACbF,eAAgB,IAChBkB,iBAAkB,IAClBL,eAAe,EACf2Y,eAAgB,SAASna,UACjB+D,KAAKtC,UAAUzB,EAAOmG,MAAQnG,EAAOS,MAAQ,wCAA0CsD,KAAK8E,aAAa7I,EAAO6H,WAAW,WAEnIyG,OAAQ,SAAShP,UACRA,GAAe,KAAPA,EAAWwD,WAAWxD,GAAO8a,QAAQ,GAAG9a,ICfnD,SAAS+a,WAAW9M,EAAQ1I,WAC9ByJ,EAASf,EAAOvN,OAAOsO,OACnBpP,EAAG,EAAGA,EAAI2F,EAAQ1F,OAAQD,OAC7BA,EAGA,CACHK,MAAMgF,OAAOM,EAAQ3F,GAAG,CACvBoP,OAAQA,EACRvL,KAAK,MACLd,MAAOsL,EAAOvN,OAAOqO;IAElB/D,EAASzF,EAAQ3F,GAAGoL,OAEhBF,EAAE,EAAGA,EAAIE,EAAOnL,OAAQiL,IAAI,KAC/B2D,EAAIzD,EAAOF,GACZ2D,IACE3D,GAAe,SAAV2D,EAAEtN,KAEH2J,GAAKE,EAAOnL,OAAO,EAC1B4O,EAAE5H,KAAOoH,EAAOvN,OAAOma,eAAe1R,KAAK8E,EAAOQ,GAGlDA,EAAE5H,KAAO4H,EAAEtN,KALXsN,EAAE5H,KAAOoH,EAAO1E,aAAa,cAS5BkL,EAASlP,EAAQ3F,GAAG6U,OACpBuG,EAAgBzV,EAAQ3F,GAAGoP,UAC5ByF,EAAO,CACa,iBAAXA,IAAqBA,EAAS,CAAE5N,KAAM4N,IACrB,iBAAjBuG,IACVA,EAAgB/a,MAAM8E,KAAKiW,IAAkBzI,OAAOyI,QAEjDnU,EAAQ5G,MAAMa,YAAY2T,EAAOG,aAAmCH,EAAO5N,KAA5B4N,EAAOG,YAE1DH,EAAO5N,MAAOmU,GAA4C,SAA1BvG,EAAOM,iBAA8BiG,GAAiBhM,EAA6BnI,EAApBmU,EAAcnU,SAhC9GoU,eAAehN,EAAQ1I,EAAQ3F,IAsClC,SAASqb,eAAehN,EAAQ6F,OAC3BjN,EAAO,GAEVA,EADEoH,EAAOvN,OAAOwa,SACTjN,EAAOvN,OAAOya,eAAe,GAE7B,uFAAuFlb,MAAM8E,KAAKC,MAAMoB,aAAa,SAC7H0N,EAAO9I,OAASnE,EAChBiN,EAAOnR,MAAQsL,EAAOvN,OAAOka,YAC7B9G,EAAOsH,cAAe,EACnBnN,EAAOvN,OAAO+T,SAChBX,EAAOW,OAASxG,EAAO1E,aAAa,UClD/B,SAAS8R,KAAK9a,GACpBN,MAAMgF,OAAO1E,EAAM+a,WAAW,GAE9B/a,EAAKuH,YAAY,iBAAkB,WAClCyP,mBAAuB9S,KAAK/D,OAAOC,UAAUhB,cACxC4b,cAAa,KAIpB,IAAMD,UAAY,CACjBtL,OAAQ,SAASlO,QACXA,KAAK0Z,OAAO,eACZC,EAAMhX,KAAKgX,SACV/K,gBACA+K,IAAMA,IAEZlE,mBAAuB9S,KAAK/D,OAAOC,UAAUhB,SACzCmC,EAGH2C,KAAKiX,SAAS5Z,GAFd2C,KAAK8W,gBAIPI,QAAS,SAAS7Z,MACdA,EAAK6D,SACPlB,KAAKmX,aAAe9Z,EAAK6D,QACvB7D,EAAKD,UACP4C,KAAKvB,cAAgBpB,EAAKD,SACxBC,EAAKnB,YACP8D,KAAK/D,OAAOC,UAAYmB,EAAKnB,WAE3BmB,EAAK8H,WAAW,MACbA,WAAa,OACd,IAAIhK,EAAG,EAAGA,EAAGkC,EAAK8H,WAAW/J,OAAOD,SAClCgK,WAAW9H,EAAK8H,WAAWhK,IAAM,EAErCkC,EAAKA,KAAKyD,UACZzD,EAAKA,KAAKkJ,OAASlJ,EAAKA,KAAKyD,SAE3BzD,EAAKA,MACP2C,KAAKuL,OAAOlO,EAAKA,OAEnB+Z,WAAW,SAAS7b,OACf8Y,EAAMrU,KAAK/D,OAAOC,cAClBmY,IAAQA,EAAItS,KAAK3G,SAAUiZ,EAAIvT,QAAQ1F,OAI1C,OAAOI,MAAM6b,eAAeD,WAAW1S,KAAK1E,KAAMzE,QAH7C8B,KAAK2Z,IAAMzb,OACXub,gBAIPA,aAAc,eACT5a,EAAY8D,KAAK/D,OAAOC,UAC3B8a,EAAMhX,KAAK3C,KAAK2Z,IAEdA,IACCA,EAAIM,KACNN,EAAIM,KAAKtX,KAAM,CACduX,QAAS,SAASla,QACZ6O,MAAMsL,KAAKtL,MAAM7O,MAErB,CAAEnB,UAAWA,IACK,iBAAP8a,GACdhX,KAAKsX,KAAK,SAASN,EAAK,OAAQ,CAAE9a,UAAWA,OC9DpCub,QAAb,qDAEOC,SAAW,CAAE,aAAc,SAAU,OAAQ,mBAC7CC,SAAW,YAAe,cAAkB,SAAa,aAAiB,oDAG5Ejb,EAAMS,QACJua,SAASnb,KAAKG,GACflB,MAAMa,YAAYc,KACrB6C,KAAK2X,SAASjb,GAAQS,oCAGfT,UACDsD,KAAK2X,SAASjb,wCAIhBgb,SAAW,kCAGVhb,OACFvB,EAAI6E,KAAK4X,SAASlb,GAChB,GAAHvB,GACF6E,KAAK0X,SAAShS,OAAOvK,EAAE,oCAGhBuB,OACJ,IAAIvB,EAAE,EAAGA,EAAG6E,KAAK0X,SAAStc,OAAOD,OACjC6E,KAAK0X,SAASvc,IAAMuB,EACtB,OAAOvB,SACD,8CAIwB,GAA5B6E,KAAK4X,SAAS,UACV,SACD5X,KAAK0X,SAAS,wCAId1X,KAAK0X,eAxCd,SCSMjV,QAAQ,CACb/F,KAAK,QACLmb,QAAQ,cACRlV,SAAUA,SACVG,MAAO,SAAS7G,IACc,IAAzBA,EAAOwB,gBACVxB,EAAOa,YAAcb,EAAOa,aAAe,UAGvCiR,MAAMC,WAAY,oBAElB3Q,KAAKya,WAAW9X,MAAM,QAEtB+X,WAAW9b,QAEX+b,eAAe/b,QAEfgc,WAAajY,KAAKyJ,cAElBvO,QAAU,IAAIuc,SAEpBhO,SAAU,MACVuO,eAAgB,SAAS/b,GACrBA,EAAOic,mBACTC,KAASnY,KAAK/D,SAGToB,KAAKgG,YAAY,iBAAkB7H,MAAMuJ,KAAK,WAE9C/E,KAAK6D,GAAG,SAAS7D,KAAKuL,UACxBvL,YAEEqD,YAAY,iBAAkB,gBAC7BkI,QAAO,UAGRvI,OAAOzG,KAAKyD,KAAKuL,UAGxBwM,WAAY,SAAS9b,GACfA,EAAOC,YACXD,EAAOC,UAAY,IACpBV,MAAMgF,OAAOvE,EAAOC,UAAW,CAAE6F,KAAK,GAAIjB,QAAQ,GAAI1C,OAAO,GAAIlD,QAAQ,KACzEM,MAAMgF,OAAOvE,EAAQ+D,KAAKkL,OAAOjP,KAGlCiP,OAAQ,SAASjP,OAIZmc,EAAS5c,MAAM6c,KAAKC,QACpBC,EAAQ,CACXzc,KAAK,YACLyC,GAAG,OACHf,IAAI,oBACJwE,OAAQ,MACRwW,YAAW,EACX7P,UAAU,EACV8P,cAAa,EACbC,UAAWN,EAAOM,UAAY,EAC9BC,cAAeP,EAAOM,UAAY,EAClCE,gBAAiBR,EAAOS,UAAY,EACpC9Y,GAAG,eACe,SAASxB,OACrBgC,EAAQP,KAAK8Y,mBACsB,IAAnC9Y,KAAK+Y,eAAexa,EAAG8Q,SAAkB9O,EAAMtE,OAAOwa,UACzDlW,EAAMyY,cAGTlY,QAAQ,WAGN7E,EAAOgd,WAAwC,UAA3B1I,QAAOtU,EAAOgd,oBAC7Bhd,EAAOgd,UAAU1a,GACxB/C,MAAMgF,OAAO+X,EAAMtc,EAAOgd,WAAU,IAG9B,CAAElX,KAAM,CA9BD,CAAExD,GAAG,UAAWzC,KAAK,UAAW0B,IAAI,gCAAiC2F,YAAY,EAAM+V,QAAO,EAAMrW,QAAS,GAAI7E,KAAK,CACnI,KA6ByBua,KAK3BS,UAAW,WACLhZ,KAAKmZ,cACTnZ,KAAKoZ,mBAEFC,EAAY,OACX,IAAIle,KAAK6E,KAAKmF,WAAYkU,EAAU9c,KAAK,CAACG,KAAMvB,EAAG0K,MAAO7F,KAAK8E,aAAa3J;SAE5Ege,aAAa7N,OAAO,aAAc+N,OACnCC,EAAM9d,MAAM6J,KAAKkU,OAAOvZ,KAAK6D,GAAG,QAAQgK,gBACvCsL,aAAaK,YAAYF,EAAIG,EAAI,GAAIH,EAAII,EAAI,SAC7CP,aAAa7N,OAAO,OAAQtL,KAAK2Z,kBACjCR,aAAazZ,QAEnB0Z,aAAc,eACTnd,EAAS,CAAEH,KAAK,qBAAsBqJ,WAAW,GAAI5E,MAAOP,KAAK/D,OAAOsC,IAC5E/C,MAAMgF,OAAOvE,EAAS+D,KAAK/D,OAAOwH,OAAO,SACpC0V,aAAe3d,MAAMmE,GAAG1D,QACxB8B,UAAU,UAAU,CAACiC,KAAKmZ,oBAC1BA,aAAa9V,YAAY,UAAW7H,MAAMuJ,KAAK/E,KAAK8F,aAAc9F,QAExE4Z,sBACK5Z,KAAKmZ,oBACHA,aAAaS,kBACbT,aAAe,MAErB3d,MAAMqe,YAAYD,WAAWlV,KAAK1E,OAEnCP,cAAe,kBACPO,KAAK6D,GAAG,YAMhB0H,OAAQ,SAASuO,iBACZte,MAAMue,aACTjM,OAAOkM,QAAQC,KAAK,0BAEjBja,KAAKuV,cAAc,KAChBtM,EAAO,IAAIiR,OAAWla,KAAK/D,OAAQ+D,MACzCxE,MAAMgF,OAAOR,KAAMiJ,GAEpB6J,mBAAuB9S,KAAK/D,OAAOC,UAAUhB,cAExCqa,cAAcvV,KAAK3C,KAAKgB,KAAM2B,KAAK3C,KAAK2P,MAAO,SAACjC,GACpDoP,EAAKlD,SAASlM,EAAQ+O,GAElBte,MAAMue,aACTve,MAAMyI,MAAM,WACX6J,OAAOkM,QAAQI,QAAQ,yBACvBtM,OAAOkM,QAAQI,QAAQ,wBAI3BnD,SAAU,SAAS5Z,EAAMyc,GACxBxD,WAAWtW,KAAM3C,EAAKkJ,QAEjBuT,IACJzc,EAAKnC,QAAU4X,eAAmB9S,YAE9BjC,UAAU,iBAAiB,CAACV,IAE7BA,EAAKnC,SACR4X,YAAgB9S,KAAM3C,EAAKnC,SAEzB8E,KAAK/D,OAAOwa,WACdzW,KAAK6D,GAAG,QAAQkK,MAAMC,WAAa,yBAEjChO,KAAK/D,OAAO2O,aACd5K,KAAK6D,GAAG,QAAQyH,OAAO,QAAQ,GAE7BtL,KAAK/D,OAAO+T,QACdhQ,KAAK6D,GAAG,QAAQyH,OAAO,UAAU,GAE9B9P,MAAMue,aACTjM,OAAOkM,QAAQC,KAAK,wBAEhBpW,GAAG,QAAQoI,gBACXpI,GAAG,QAAQ5H,OAAO2M,WAAa,OAC/B/E,GAAG,QAAQgF,eAAexL,EAAKkJ,aAC/B1C,GAAG,QAAQqI,MAAM7O,EAAKA,MAE3Bgd,aAAiBra,OAElBsa,YAAY,SAASld,MAChBA,EAAQmd,SAAS,CACY,WAA5BhK,QAAOnT,EAAQmd,YAClBnd,EAAQmd,SAAW,QAEhBC,EAAOpd,EAAQmd,YACnBC,EAAKjc,GAAKyB,KAAK6D,GAAG,QAAQ5H,OAAO6E,QAAQ,GAAGvC,IACvCic,EAAK1Z,QAAQ,KACbiB,EAAO/B,KAAK/D,OAAOC,UAAU6F,KACjCyY,EAAK1Z,QAAU,OACV,IAAI3F,EAAI,EAAGA,EAAI4G,EAAK3G,OAAQD,IAChCqf,EAAK1Z,QAAQvE,KAAK,CAAEgK,OAAOvG,KAAKtC,UAAUqE,EAAK5G,cAG3C6E,KAAK6D,GAAG,QAAQyW,YAAYld,IAEpC0H,aAAc,SAASvJ,UACfC,MAAM8E,KAAKC,MAAMhF,IAAQA,GAEjCmC,UAAW,SAASnC,UACZyE,KAAK/D,OAAOia,SAAS3a,IAAQA,GAErCoe,UAAW,eACNxe,EAAGsB,EAAa2F,EACnBlB,EAAS,GACT8U,EAAa,GACbyE,EAAW,GACXpG,EAAMrU,KAAK/D,OAAOC,UAClB6O,EAAS,CAAE7J,OAAO,GAAIa,KAAK,GAAIjB,QAAQ,GAAI1C,OAAO,GAAIlD,QAAQ,IAC9Dwf,EAAa,MAEV1a,KAAKmX,iBAYRjW,EAASlB,KAAKmX,aACThc,EAAI,EAAGA,EAAI+F,EAAO9F,OAAQD,IAC9B6a,EAAW9U,EAAO/F,IAAMK,MAAM6N,eAb1BlO,EAAI,EAAGA,EAAI4Y,KAAKxS,IAAIvB,KAAK3C,KAAK0D,SAAW,GAAI5F,QAE5CsB,KADEuD,KAAK3C,KAAKkG,QAAQvD,KAAK3C,KAAKsd,aAAaxf,IAEjC,OAAVsB,GAAyC,IAAvBA,EAAMc,QAAQ,MAAeyY,EAAWvZ,KAC7DyE,EAAO3E,KAAKE,GACZuZ,EAAWvZ,GAASjB,MAAM6N,WAYzBlO,EAAI,EAAGA,GAAKkZ,EAAInZ,SAAW,IAAIE,OAAQD,IAC3CsB,EAAQ4X,EAAInZ,QAAQC,GACfK,MAAMa,YAAY2Z,EAAWvZ,EAAMC,SACvC0F,EAAOpC,KAAKtC,UAAUjB,EAAMC,MAC5BqO,EAAO7P,QAAQqB,KAAK,CAACG,KAAMD,EAAMC,KAAM0F,KAAMA,EAAM9F,KAAKG,EAAMH,KAAMf,MAAMkB,EAAMlB,MAAOgD,GAAIyX,EAAWvZ,EAAMC,aAGzGvB,EAAI,EAAGA,EAAIkZ,EAAItS,KAAK3G,OAAQD,IAChCsB,EAAQ4X,EAAItS,KAAK5G,GACZK,MAAMa,YAAY2Z,EAAWvZ,MACjCsO,EAAOhJ,KAAKxF,KAAK,CAACG,KAAMD,EAAO2F,KAAMpC,KAAKtC,UAAUjB,GAAQ8B,GAAIyX,EAAWvZ,KAC3Ege,EAAShe,IAAS,OAIftB,EAAI,EAAGA,EAAIkZ,EAAIvT,QAAQ1F,OAAQD,IACnCsB,EAAkC,UAAzB8T,QAAO8D,EAAIvT,QAAQ3F,IAAiBkZ,EAAIvT,QAAQ3F,GAAGoD,IAAIpD,EAAIkZ,EAAIvT,QAAQ3F,IAC3EK,MAAMa,YAAY2Z,EAAWvZ,KAAWjB,MAAMa,YAAYoe,EAAShe,KACvEsO,EAAOjK,QAAQvE,KAAK,CAACG,KAAMD,EAAO2F,KAAMpC,KAAKtC,UAAUjB,GAAQ8B,GAAIyX,EAAWvZ,SAK3EtB,EAAI,EAAGA,EAAIkZ,EAAIjW,OAAOhD,OAAQD,OAClCsB,EAAQ4X,EAAIjW,OAAOjD,IACdK,MAAMa,YAAY2Z,EAAWvZ,EAAMC,UACpClB,MAAMa,YAAYqe,EAAWje,EAAMC,OAAO,CAC5Cge,EAAWje,EAAMC,MAAQvB,EACzBiH,EAAOpC,KAAKtC,UAAUjB,EAAMC,UACxBnB,EAAQ,CACXmB,KAAMD,EAAMC,KAAM0F,KAAMA,EAAM7D,GAAIyX,EAAWvZ,EAAMC,MACnDoH,UAAUtI,MAAMoL,QAAQnK,EAAMqH,WAAWrH,EAAMqH,UAAU,CAACrH,EAAMqH,YAEjEiH,EAAO3M,OAAO7B,KAAKhB,OAEhB,KACC2I,EAAQwW,EAAWje,EAAMC,MAC7BqO,EAAO3M,OAAO8F,GAAOJ,UAAUvH,KAAKE,EAAMqH,eAO7C5C,EAAOlC,OACF7D,EAAI,EAAGA,EAAI+F,EAAO9F,OAAQD,IAC9BsB,EAAQyE,EAAO/F,GACVK,MAAMa,YAAY2Z,EAAWvZ,KACjCsO,EAAO7J,OAAO3E,KAAK,CAACG,KAAKD,EAAO2F,KAAMpC,KAAKtC,UAAUjB,GAAQ8B,GAAIyX,EAAWvZ,YAGvEsO,GAERjF,aAAc,SAAS7J,QACjBqP,OAAO,YAAarP,QACpBsP,UAENC,aAAc,kBACNxL,KAAK/D,OAAOC,WAEpB0e,gBAAiB,kBACT5a,KAAKmZ,cAEb0B,eAAe,SAAStf,OACnBuf,EAAIhN,OAAOkM,QACXze,SACE8H,YAAY,eAAgB,WAAYyX,EAAEb,KAAK,uBAC/C5c,KAAKgG,YAAY,UAAW,WAAYyX,EAAEV,QAAQ,gBAAiBU,EAAEb,KAAK,uBAC1E5c,KAAKgG,YAAY,cAAe,WAAYyX,EAAEV,QAAQ,gBAAiBU,EAAEb,KAAK,0BAC9EjX,OAAOzG,KAAK,gBACXsH,GAAG,QAAQR,YAAY,iBAAkB,WAAgBrD,KAAKe,UAAW+Z,EAAEV;AAAQ,mBAAoBU,EAAEb,KAAK,0BAC9GpW,GAAG,QAAQR,YAAY,gBAAiB,WAAgBrD,KAAKe,SAASvF,MAAMyI,MAAM,WAAY6W,EAAEV,QAAQ,2BAI9G5e,MAAMkI,QAASlI,MAAMmE,GAAGob,OAAQvf,MAAMwf,WAAYxf,MAAMyf,YAAazf,MAAM0f,UCzS9E,IAAMvX,gBAAgBnI,MAAMgF,OAAO,OACzB,SAASoD,EAAErF,EAAG+F,OAClB6W,EAAa,CAChBrf,KAAM,aACNqH,YAAY,GAGV3H,MAAMqI,GAAG7D,KAAK/D,OAAOsE,OAAOtE,OAAOkf,WACrC3f,MAAMgF,OAAO2a,EAAW3f,MAAMqI,GAAG7D,KAAK/D,OAAOsE,OAAOtE,OAAOkf,YAG3D3f,MAAMgF,OAAO2a,EAAW,CACvBjd,MAAQ,IACR4J,OAAQ,IACRsT,QAAS5f,MAAMqI,GAAG7D,KAAK/D,OAAOsE,OAAOtE,OAAOmf,cAI1ChW,EAAI5J,MAAMmE,GAAG,CAChB7D,KAAK,QACLyC,GAAI,cACJ2E,KAAKiY,WAEN/V,EAAE1F,KAAK4E,GACPc,EAAEiW,UAAUhY,YAAY,WAAW,WAClC+B,EAAExF,SAEHwF,EAAE/B,YAAY,SAAU7H,MAAMuJ,KAAK,eAC9Bb,EAAQ1I,MAAM6J,KAAKC,OAAO1B,EAAG,mBAC7BrI,EAAQ6J,EAAEiW,UAAUpb,WACpB1E,SACEsI,GAAG,UAAUN,QAAQhF,GAAI0I,MAAM/C,GAAS3I,OACxCsI,GAAG,UAAUG,WAAWzF,IAE9B6G,EAAEH,SACAjF,QACI,IAEPmI,eAEK,SAASZ,kBAAgBzL,EAAMG,OACjCqf,EAAa,GACb/a,EAAQ/E,MAAMqI,GAAG5H,EAAOsE,OACxBgb,EAAQhb,EAAMib,aACd,IAAIlf,KAAQif,EACfD,EAAW/e,KAAK,CAACgC,GAAIjC,EAAMuJ,MAAOtF,EAAMuE,aAAaxI,GAAM+C,oBAGxDwB,EAAYN,EAAMtE,OAAO4E,gBAEtB,OACG,CACR3C,MAAOjC,EAAOuL,WACdC,KAAM,UACNvE,KAAM,gBAEI,CACVpH,KAAM,UACNqH,YAAY,EACZN,QAAS,GACT7E,KAAM,CACL,cACA,CACC0J,OAAQ,EACR1J,KAAM,CACL,SACA,wBAMW,CAAEO,GAAI,cAAgBzC,KAAM,QAASmB,MAAOzB,MAAM8E,KAAKC,MAAMgC,aAAe,WAClF,CAAEzG,KAAM,SAAUyC,GAAI,SAAWtB,MAAOsD,EAAMuE,aAAa,UAAW5G,MAAOjC,EAAO0L,yBACrF,CAAE7L,KAAM,SAAUyC,GAAI,QAASjC,KAAM,OAAQkB,IAAI,oBAAqBP,MAAMsD,EAAMuE,aAAa,SAAU5G,MAAMjC,EAAO2L,uBACtH,CACPtL,KAAM,OACNyF,KAAM,CACL,CACCvE,IAAK,4BACLlB,KAAM,QACN0B,KAAM,CACL,eACA,CACC1B,KAAM,OACNyF,KAAM,CACL,CACCzF,KAAM,OACNkB,IAAK,4BACLuE,KAAM,CACL,CACCzF,KAAM,OACN0B,KAAM,CACL,gBACA,gBAIF,CACC1B,KAAM,OACN0B,KAAM,CACL,eACA,qCAWK,CACdE,MAAOjC,EAAO4L,kBACd9F,KAAM,CACL,eACA,wBAGc,CAAExD,GAAI,eAAgBlB,KAAM,CAAC9B,MAAO,UAAWiC,IAAK,4BACnE4F,SAAUkD,eAAeC,OAAQuB,OAAQ,WAEhC,CACThM,KAAM,OAAQQ,KAAM,CAACwL,OAAQ,QAAStK,IAAK,qBAAsBwK,MAAM,EACvE5E,SAAU,yGACVrD,GAAIjE,EAAKmM,gCAEO,CAChBlG,KAAM,CACL,gBACA,0BAGe,CAAE1E,KAAK,CAAC9B,MAAO,UAAWkL,KAAK,UAAYrD,SAAUkD,eAAeE,WAAYhJ,IAAK,0BAA2BsK,OAAQ,YAC9H,CACVhM,KAAM,OAAQiM,OAAQ,OAAQzL,KAAM,CAACwL,OAAQ,QAASE,MAAM,EAC5D5E,SAAU5H,MAAMuJ,KAAKuB,eAAepL,QAASY,GAC7CoM,QAAS,sBACgB1M,MAAMuJ,KAAKpB,gBAAc,mBAAoB7H,qBAChDN,MAAMuJ,KAAKoD,cAAkBC,OAAQtM,IAE3DiE,GAAIjE,EAAKmM,+BAEK,CACdlG,KAAK,CACJ,eACA,wBAGa,CAACxD,GAAI,eAAgBlB,KAAM,CAAC9B,MAAO,SAAUkL,KAAK,gBAChErD,SAAUkD,eAAeE,WAAYhJ,IAAK,0BAA2BsK,OAAQ,WAErE,CACRhM,KAAM,OAAQiM,OAAQ,OAAQC,MAAM,EAAMxK,IAAK,2BAA4BlB,KAAM,CAAEwL,OAAQ,QAC3F1E,SAAU5H,MAAMuJ,KAAKuB,eAAeU,YAAalL,GACjDoM,QAAS,kBACY1M,MAAMuJ,KAAKpB,gBAAcc,SAAU3I,wBAC/BN,MAAMuJ,KAAKpB,gBAAcc,SAAU3I,yBAClCN,MAAMuJ,KAAKpB,gBAAcsD,MAAOnL,qBACpCN,MAAMuJ,KAAKpB,gBAAcyE,OAAQtM,IAEvDiE,GAAGjE,EAAKmM,8BAEM,CACdlG,KAAK,CACJ,cACA,wBAGa,CAAE1E,KAAK,CAAC9B,MAAO,UAAWkL,KAAK,SAAWrD,SAAUkD,eAAeE,WAAYhJ,IAAK,0BAA2BsK,OAAQ,YAC3H,CACVhM,KAAM,OAAQiM,QAAQ,EAAOC,MAAM,EAAM1L,KAAM,CAACwL,OAAQ,QACxD1E,SAAU5H,MAAMuJ,KAAKuB,eAAenF,QAASrF,GAC7CiE,GAAGjE,EAAKmM,iBACRC,QAAQ,mBACc1M,MAAMuJ,KAAKoD,cAAkBC,OAAQtM,iBAG9C,CACb0B,IAAI,0BACJuE,KAAK,CACJ,cACA,0BAKa,CAAE1E,KAAK,CAAC9B,MAAO,QAASkL,KAAK,SAAWrD,SAAUkD,eAAeE,WAAYhJ,IAAK,0BAA2BsK,OAAQ,cACvH,CACZhM,KAAM,OAAQiM,QAAQ,EAAOC,MAAM,EACnC1L,KAAK,CACJwL,OAAQ,OACR2T,aAAa,SAAS9c,SACU,oBAArBA,EAAI8c,eACZlb,EAAMtE,OAAO2E,MAAM8a,OAAmC,eAA5Bnb,EAAMtE,OAAO2E,MAAM8a,MAAwB/c,EAAI8c,aAAa,EAAE9c,EAAI8c,aAAa,GAEpG;AAAyC9c,EAAI8c,aAAa,SAAS,SAAS,aAEpFE,QAAQ,SAAShd,UACTA,EAAIkC,UAAYA,IAGzBqH,QAAQ,sBACiB,SAAStE,EAAGrF,EAAI+F,OACnCb,EACHgB,EAAW,CACV3I,KAAM,oBAAqB0B,IAAK,oBAAqBmH,SAAQ,EAC7D/B,YAAY,EAAM1E,MAAO,IACzBb,KAAMie,IAER7X,EAAQjI,MAAMmE,GAAG8E,IACX/E,KAAK4E,GACXb,EAAMJ,YAAY,SAAU7H,MAAMuJ,KAAK,eAClCC,EAAMvB,EAAMD,cACJ,OAARwB,IACHnE,EAAYmE,EAAIzG,QACXsO,WAENpJ,EAAMwB,SACJjF,6BAEmB,SAAS4D,EAAGrF,OAC9BvC,EAAOgE,KAAKuD,QAAQhF,GACxBvC,EAAKyf,aAAezf,EAAKyf,aAAa,EAAE,OACnCzX,WAAWzF,EAAIvC,KAGtBoH,SAAS,SAASzE,EAAKid,SACR,aAAXjd,EAAIJ,GACC,qCAAqCqd,EAAOH,aAAa9c,EAAKid,GAAQ,SAAUjd,EAAIkH,MAAMxG,cAAe,gBAEzG,4DAA4D7D,MAAM8E,KAAKC,MAAMM,UAAUxB,cAAc,6CAA6C7D,MAAM8E,KAAKC,MAAMqb,EAAOD,QAAQhd,EAAKid,IAAU,WAG1Mve,KAAK,CAAC,CAACwI,MAAMrK,MAAM8E,KAAKC,MAAMc,SAAU9C,GAAG,YAAa,CAACsH,MAAMrK,MAAM8E,KAAKC,MAAMM,UAAWtC,GAAG,YAAasC,UAAUA,YC3OlH4B,QAAQ,CACb/F,KAAM,2BACNoG,MAAO,gBACDiL,MAAMC,WAAa,wCAEzBrL,SAAS,CACRkZ,oBAAqB,IACrBC,eAAgB,IAChBC,mBAAoB,IACpBlU,kBAAmB,IACnBL,WAAY,KAEb0D,OAAQ,SAASjP,OACZC,EAAYV,MAAMoQ,KAAKrE,kBAAgBvH,KAAM/D,WAC1C+D,KAAKmN,cAAcjR,EAAWD,IAEtCwP,OAAO,CAAC,UAAU,SAAS,WAC3BC,eAAgB,QACL,CAAC,mBACA,CAAC,WAEbsQ,YAAa,WACZxgB,MAAMuC,UAAU,UAAU,KAE3BoN,WAAY,gBACN9H,YAAY,cAAe,SAAS9E,MACV,UAA1ByB,KAAKsD,aAAa5G,KAAiB,KAElC+I,EAAUzF,KAAKyF,QAAQlH,GAC1BrC,EAAY8D,KAAKwL,eAEJ,SAAX/F,GAAwBvJ,EAAUkC,OAAOhD,QAAWc,EAAUiF,QAI7D3F,MAAMqI,GAAG7D,KAAK/D,OAAOsE,OAAOxC,UAAU,WAAW0H,EAAS,CAACvJ,WACxD6B,UAAU,KAAO0H,EAAS,CAACvJ,SAC3B0D,QALNpE,MAAMygB,MAAMzgB,MAAM8E,KAAKC,MAAM+B,6BAU5B2L,EAAcjO,KAAK+N,MAAMG,iBAAiB,0CACrC/S,EAAI,EAAGA,EAAI8S,EAAY7S,OAAQD,IACvC8S,EAAY9S,GAAGgT,aAAa,iBAAkB3S,MAAM8E,KAAKC,MAAMiC,gBAGjEgJ,aAAc,eAST+I,EARArY,EAAY,CAAEiF,QAAQ,GAAG/C,OAAO,GAAGlD,QAAQ,IAE3CiG,EAAUnB,KAAK6D,GAAG,kBACnB1C,EAAQJ,UACV7E,EAAUiF,QAAUA,EAAQoC,QAAQpC,EAAQ8L,cAAcvQ,MAG9CsD,KAAK6D,GAAG,UAEdxG,KAAKsP,KAAKnR,MAAMuJ,KAAK,SAASpG,OAChC,IAAI0H,EAAE,EAAGA,EAAG1H,EAAImF,UAAU1I,OAAQiL,IACrCkO,EAAO/Y,MAAMoQ,KAAKjN,GAElBnD,MAAMgF,OAAO+T,EAAK,CAACzQ,UAAWnF,EAAImF,UAAUuC,GAAGY,MAAQtI,EAAIsI,MAAMZ,IAAI7K,MAAMqI,GAAG7D,KAAK/D,OAAOsE,OAAOtE,OAAOgL,QAAO,GAE/G/K,EAAUkC,OAAO7B,KAAKgY,IAEtBvU,OAEYA,KAAK6D,GAAG,WACdxG,KAAKsP,KAAK,SAAShO,GAC1BzC,EAAUhB,QAAQqB,KAAKoC,KAGjBzC,IAENV,MAAMmE,GAAG0O,+BC7EC1L,WAAW,CACvBuT,SAAU,GACVnU,KAAK,GACLgC,iBAAkB,MAClBnG,iBAAkB,QAClBd,YAAa,IACbF,eAAgB,IAChBsf,gBAAiB,IACjBpe,iBAAkB,IAClBf,mBAAkB,EAClBU,eAAe,EACfoD,UAAW,MACXoG,MAAO,UACPrG,MAAM,GACNub,iBAAkB,EAClBf,QAAS,CACR,CAAC,UAAU,UAAU,UAAU,UAAU,UAAU,WACnD,CAAC,UAAU,UAAU,UAAU,UAAU,UAAU,WACnD,CAAE,UAAU,UAAU,UAAU,UAAU,UAAU,WACpD,CAAE,UAAW,UAAU,UAAW,UAAW,UAAW,WACxD,CAAC,UAAU,UAAU,UAAU,UAAU,UAAW,WACpD,CAAC,UAAU,UAAU,UAAU,UAAU,UAAW,mBCfhD3Y,QAAQ,CACb/F,KAAK,cACLmb,QAAQ,cACRlV,SAAUA,WACVyZ,UAAU,CACTC,eAAgB,SAAS3f,EAAKoH,UACtBpH,EAAK,IAAIoH,GAEjBwY,kBAAmB,SAAS5f,OACvB6f,EAAM7f,EAAK0D,MAAM,WACd,CAAC1D,KAAK6f,EAAI,GAAGzY,UAAUyY,EAAI,KAEnCC,YAAa,SAASnf,EAAKlC,OACtBuB,EAAOsD,KAAK/D,OAAOia,SAAS7Y,EAAKX,OAAOsD,KAAKyc,YAAYpf,EAAKX,MAC9DoH,EAAatI,MAAMoL,QAAQvJ,EAAKyG,WAAWzG,EAAKyG,UAAU3I,GAAGkC,EAAKyG,iBAC/DpH,EAAK,OAAOlB,MAAM8E,KAAKC,MAAMuD,IAAYA,GAAW,MAG7D4Y,iBAAkB,SAAS/d,GACT,UAAd4R,QAAO5R,IACTnD,MAAMgF,OAAOR,KAAKoc,UAAUzd,IAE9B6c,SAAU,CACT9a,IAAK,SAASuG,SACN,CACN0V,OAAO,EACPC,MAAM,EACNC,OAAO,EACP5V,MAAOA,IAGT7F,KAAM,SAAS6F,SACP,CACN2V,MAAM,EACN5gB,KAAK,CACJ8gB,YAAa7V,EACbA,MAAOA,GAER7F,KAAK,CACJ6F,MAAOA,EACP/I,MAAM,KAIT2D,MAAO,SAASoF,SACR,CACN2V,MAAM,EACNG,MAAM,EACNC,cAAc,EACdhhB,KAAK,CACJ8gB,YAAa7V,EACbA,MAAOA,GAER7F,KAAK,CACJ6F,MAAOA,EACP/I,MAAM,MAKV+e,gBAAiB,SAASte,GACR,UAAd4R,QAAO5R,IACTnD,MAAMgF,OAAOR,KAAKwb,SAAS7c,GAAI,IAEjCmE,MAAO,SAAS7G,IACc,IAAzBA,EAAOwB,gBACVxB,EAAOa,YAAcb,EAAOa,aAAe,UAGvCO,KAAKya,WAAW9X,MAAM,GACtB/D,EAAOC,YACXD,EAAOC,UAAY,IACpBV,MAAMgF,OAAOvE,EAAOC,UAAW,CAAEiF,QAAQ,GAAI/C,OAAO,GAAIlD,QAAQ;KAE3D6S,MAAMC,WAAY,iCACvBxS,MAAMgF,OAAOvE,EAAQ,CAACigB,gBAAiBlc,KAAK2C,SAASuZ,kBACrD1gB,MAAMgF,OAAOvE,EAAQ+D,KAAKkd,MAAMjhB,SAE3B+G,OAAOzG,KAAKf,MAAMuJ,KAAK,WAC3BvJ,MAAMyI,MAAMjE,KAAKuL,OAAOvL,OACvBA,YACG3C,KAAKgG,YAAY,iBAAkB7H,MAAMuJ,KAAK,WAE9C/E,KAAK6D,GAAG,UACX7D,KAAKuL,UACJvL,YAEEqD,YAAY,iBAAkB,gBAC7BkI,QAAO,UAGRrQ,QAAU,IAAIuc,SAEpByF,MAAO,iBASC,CAAEnb,KAAM,CARA,CACdjG,KAAK,UACLyC,GAAI,UAAW2a,QAAO,EAAMiE,SAAU,GACtCC,SAAU,EACVja,YAAY,EACZuE,OAAQ,GAAI1J,KAAK,IAEN,CAAEO,GAAI,aAAcjC,KAAM,OAAQoL,OAAQ,GAAI1J,KAAK,CAAC,CAACO,GAAG,QAASzC,KAAM,cAGpFkd,UAAW,eACLhZ,KAAKqd,YAAa,KAClBphB,EAAS,CAAEH,KAAK,2BAA4BqJ,WAAW,GAAI5E,MAAOP,KAAK/D,OAAOsC,IAClF/C,MAAMgF,OAAOvE,EAAS+D,KAAK/D,OAAOwH,OAAO,SAEpC4Z,YAAc7hB,MAAMmE,GAAG1D,QACvB8B,UAAU,UAAU,CAACiC,KAAKqd,mBAC1BA,YAAYha,YAAY,UAAW7H,MAAMuJ,KAAK,SAAS7I,QACtDD,OAAO4E,UAAYb,KAAKqd,YAAYxZ,GAAG,aAAa7D,KAAKqd,YAAYxZ,GAAG,aAAaN,QAAQ,aAAa1C,UAAU,WACpH5E,OAAO2E,MAAM8a,MAAS1b,KAAKqd,YAAYxZ,GAAG,aAAaN,QAAQ,YAAYkY,aAAa,cAAc,SAC3GjgB,MAAMgF,OAAOR,KAAK/D,OAAOC,UAAWA,GAAW,QAC1CqP,UACHvL,WAGAqZ,EAAY,OACX,IAAIle,KAAK6E,KAAKmF,WAAYkU,EAAU9c,KAAK,CAACG,KAAMvB,EAAG0K,MAAO7F,KAAK8E,aAAa3J,UAC5EkiB,YAAYlW,aAAenH,KAAKmH,cAAgB,OAChDkW,YAAY/R,OAAO,aAAc+N,OAClCC,EAAM9d,MAAM6J,KAAKkU,OAAOvZ,KAAK6D,GAAG,SAASgK,gBACxCwP,YAAY7D,YAAYF,EAAIG,EAAI,GAAIH,EAAII,EAAI,SAC5C2D,YAAY/R,OAAO,OAAQtL,KAAK2Z,kBAChC0D,YAAY3d,QAElBka,sBACK5Z,KAAKqd,cACLrd,KAAKsd,UACP9hB,MAAM+hB,YAAYvd,KAAKsd,eAEnBD,YAAYzD,kBACZyD,YAAc,MAEpB7hB,MAAMqe,YAAYD,WAAWlV,KAAK1E,OAEnCuL,OAAQ,SAASiS,GACZA,GAGH1K,YAAgB9S,KADF8S,eAAmB9S,YAG7BmH,aAAe,MAChBsW,EAASzd,KAAK/D,OAAOC,UACrBuhB,GAAUA,EAAOtc,SAAWsc,EAAOrf,QAAUqf,EAAOrf,OAAOhD,aACzDsiB,uBACAC,2BAEA1hB,OAAOC,UAAY,CACvBkC,OAAO,SAEHsf,oBAGPA,gBAAiB,mBACZzhB,EAAS+D,KAAK/D,OACdmC,EAASnC,EAAOC,UAAUkC,OAErBjD,EAAI,EAAGA,EAAIiD,EAAOhD,OAAQD,IAClCiD,EAAOjD,GAAG2I,UAAY1F,EAAOjD,GAAG2I,WAAa,CAAC7H,EAAO8H,kBAChDvI,MAAMoL,QAAQxI,EAAOjD,GAAG2I,aAC5B1F,EAAOjD,GAAG2I,UAAY,CAAC1F,EAAOjD,GAAG2I,gBAG/BjD,EAAY5E,EAAO4E,WAAW,MAC9B+c,EAAY5d,KAAKwb,SAAS3a,GAE1BD,EAAQ,MACDgd,GAAWA,EAAU,IAAIthB,KAAKshB,EAAU,IAAIthB,KAAKuE,QAClDrF,MAAMgF,OAAO,CAAC4C,SAAU,QAAQnH,EAAO2E,MAAMid,OAAO,IAAG,SACvDriB,MAAMgF,OAAO,GAAGvE,EAAO2E,MAAMkd,OAAO,KAG9CtiB,MAAMgF,OAAOI,EAAM3E,EAAO2E,OACtBA,EAAMiC,UACTjC,EAAMiC,QAAU,CAAEkb,IAAK,SAGpBhT,EAAS/K,KAAKge,iBAgBd,IAAIlD,KAdRla,EAAMqd,OAASlT,EAAOkT,OAEtBrd,EAAMsd,QAAS,GACZjiB,EAAOkgB,kBAAsC,EAAlBnc,KAAKmH,gBAClCvG,EAAMsd,OAASnT,EAAOmT,QAGvBtd,EAAMud,OAAS,CACdC,OAAQpe,KAAKqe,aACbC,MAAM,CACLC,GAAI,YAGD1a,GAAG,SAAS2a,kBACJ5d,OACPiD,GAAG,SAASyH,OAAOwP,EAAEla,EAAMka,OAG9B9a,KAAK6D,GAAG,WAAa5H,EAAOwa,SAAS,KACnCnS,EAAKma,SAASC,cAAc,OAChCpa,EAAG0J,UAAY,wBACf1J,EAAGuB,MAAQ7F,KAAK8E,aAAa,YAC7BR,EAAGqa,MAAMzgB,MAAQ0C,EAAMsd,OAAOhgB,MAAO,KACrCoG,EAAGqa,MAAMZ,IAAMnd,EAAMiC,QAAQkb,IAAK,KAClCzZ,EAAGsa,UAAY,+FAA+FpjB,MAAM8E,KAAKC,MAAMoB,aAAa,eACvIkC,GAAG,SAASkK,MAAM8Q,aAAava,EAAItE,KAAK6D,GAAG,SAASkK,MAAM+Q,cAAc,gBACxExB,SAAW9hB,MAAMqE,MAAMG,KAAK6D,GAAG,SAASkK,MAAM+Q,cAAc,0BAA2B,QAAS,gBAC/F9F,aACJjU,KAAK/E,SAGT8E,aAAc,SAASvJ,UACfC,MAAM8E,KAAKC,MAAMhF,IAAQA,GAEjCkhB,YAAa,SAASlhB,UACdA,EAAMwjB,OAAO,GAAGC,cAAgBzjB,EAAM6X,MAAM,IAEpD1V,UAAW,SAASnC,EAAO0jB,UACnBjf,KAAK/D,OAAOia,SAAS3a,KAAS0jB,EAAWjf,KAAKyc,YAAYlhB,GAAOA,IAEzEoiB,kBAAmB,eACdziB,EAAU8E,KAAK/D,OAAOC,UAAUhB,QAEpC4X,mBAAuB5X,GACvBmX,gBAAgBnX,QAEXmC,KAAK0Z,OAAO,2BACX1Z,KAAKyC,OAAO,SAAC9D,UAASuW,WAAWrX,EAAQc,EAAMme,EAAKle,OAAO2X,cAC/D5T,WACG6D,GAAG,SAASxG,KAAK0Z,OAAO,gBACvBlT,GAAG,SAASoI,YAChBjM,WACG6D,GAAG,SAASqI,MAAMlM,KAAK3C,KAAK6hB,iBAE5B7hB,KAAK0Z,OAAO,gBACX1Z,KAAKyC,OAAO,KAChBE,OAEHqc,eAAgB,SAAS1d,UACjBA,EAAIjC,KAAK,IAAIiC,EAAImF,WAEzBwY,kBAAmB,SAAS5f,OACvB6f,EAAM7f,EAAK0D,MAAM,WACd,CAAC1D,KAAK6f,EAAI,GAAGzY,UAAUyY,EAAI,KAEnCyB,WAAY,eACP7iB,EAAGkL,EAAG6X,EAAkBxhB,EAAMyiB,EAAhB3M,EAAM,GAAuByL,EAAS;AACvD7f,EAAS4B,KAAK/D,OAAOC,UAAUkC,WAGhC8f,EAAS,CACRkB,OAAO,SACPC,MAAM,QACNnhB,MAAM,IACN6c,OAAO,KAGRvf,MAAMgF,OAAO0d,EAAOle,KAAK/D,OAAO2E,MAAMsd,QAAQ,IAAG,GACjDA,EAAO9f,OAAS,GACZ8f,EAAOoB,SACVpB,EAAOoB,OAAS,IACjBpB,EAAOoB,OAAOhjB,KAA+B,QAAvB0D,KAAK/D,OAAO4E,UAAkB,OAAO,SAEtD0e,aAAe,GAGhBpkB,OAFCgM,aAAe,EAEVhM,EAAIiD,EAAOhD,OAAQD,QACxBK,MAAMoL,QAAQxI,EAAOjD,GAAG2I,aAC3B1F,EAAOjD,GAAG2I,UAAY,CAAC1F,EAAOjD,GAAG2I,YAE9BtI,MAAMoL,QAAQxI,EAAOjD,GAAG8L,SAE3B7I,EAAOjD,GAAG8L,MAAQ,CAAC7I,EAAOjD,GAAG8L,OAAOjH,KAAKkH,UAAUlH,KAAKmH,gBAErDd,EAAE,EAAEA,EAAEjI,EAAOjD,GAAG2I,UAAU1I,OAAOiL,IAAI,CAExC3J,EAAOsD,KAAKoc,UAAUC,eAAeje,EAAOjD,GAAGuB,KAAK0B,EAAOjD,GAAG2I,UAAUuC,SACnEkZ,aAAahjB,KAAKG,GACnB0B,EAAOjD,GAAG8L,MAAMZ,KACnBjI,EAAOjD,GAAG8L,MAAMZ,GAAKrG,KAAKkH,UAAUlH,KAAKmH,mBACtCF,EAAQ7I,EAAOjD,GAAG8L,MAAMZ,GACxBmZ,EAAUxf,KAAKwb,SAASxb,KAAK/D,OAAO4E,WAAWoG,IAAQ,GAC3DuY,EAAQjkB,MAAQ,IAAImB,EAAK,IACzB8iB,EAAQC,QAAU,CACjBrc,SAAU5H,MAAMuJ,KAAK,SAASpG,UACtBA,EAAIqB,MAAMqW,QAAQ,IACxB3Z,IAGHuhB,EAAO1hB,KAAKijB,GACZL,EAAcnf,KAAKoc,UAAUI,YAAY9X,KAAK1E,KAAK5B,EAAOjD,GAAGkL,GAC7D6X,EAAO9f,OAAO7B,KAAK,CAClB6F,KAAM+c,EACNlY,MAAOA,IAERuL,EAAI9V,GAAO,CAAC0B,EAAOjD,GAAGuB,KAAK0B,EAAOjD,GAAG2I,UAAUuC,SAC1Cc,2BAGFkX,aAAe,GACjBjgB,EAAOhD,SACT4E,KAAKqe,aAAe7iB,MAAMoQ,KAAK,CAC9B2S,GAAKve,KAAK/D,OAAOC,UAAUiF,QAC3BqR,IAAKA,KAGA,CAACyL,OAAQA,EAAOC,OAAQA,IAEhChX,UAAU,SAAS/L,OACdigB,EAAUpb,KAAK/D,OAAOmf,QACtBsE,EAAWvkB,EAAEigB,EAAQ,GAAGhgB,OAC5BskB,EAAYA,EAAUtE,EAAQhgB,OAAO,EAAE6Y,SAASyL,EAAS,QACrDC,EAAcxkB,EAAEigB,EAAQ,GAAGhgB,cACxBggB,EAAQsE,GAAUC,IAE1Bxa,WAAY,CAAEhD,IAAK,EAAGpB,MAAM,EAAGO,IAAK,EAAGC,IAAK,GAC5Cqe,eAAgB,SAASljB,EAAM0M,QACzBjE,WAAWzI,GAAQ,EACrB0M,IACF5N,MAAMqkB,aAAanjB,GAAQ0M,IAE7B0W,kBAAmB,SAASpjB,UACpBsD,KAAKmF,WAAWzI,IAExBqjB,oBAAqB,SAASphB,OACzB,IAAIM,KAAKN,EACTA,EAAIqhB,eAAe/gB,IACrBe,KAAK4f,eAAe3gB,EAAGN,EAAIM,KAI9B0a,UAAW,eACNxe,EACH+F,EAAS,GACT+e,EAAc,OAEV9kB,EAAI,EAAGA,EAAI4Y,KAAKxS,IAAIvB,KAAK3C,KAAK0D,SAAW,GAAI5F,IAAK,KAClDa,EAAOgE,KAAK3C,KAAKkG,QAAQvD,KAAK3C,KAAKsd,aAAaxf,QAC/C,IAAIY,KAAKC,EACRikB,EAAYlkB,KAChBmF,EAAO3E,KAAKR,GACZkkB,EAAYlkB,GAAKP,MAAM6N,WAKtBgL,EAAMrU,KAAK/D,OAAOC,UAClB6O,EAAS,CAAE7J,OAAO,GAAIC,QAAQ,GAAI/C,OAAO,GAAIlD,QAAQ,IAErDuB,EAA+B,UAAtB8T,QAAO8D,EAAIlT,SAAoBkT,EAAIlT,QAAQ,GAAGkT,EAAIlT,QAC1D3F,MAAMa,YAAY4jB,EAAYxjB,KAClCsO,EAAO5J,QAAQ5E,KAAK,CAACG,KAAMD,EAAO2F,KAAMpC,KAAKtC,UAAUjB,GAAQ8B,GAAI0hB,EAAYxjB,SAI5E2F,EADA8d,EAAgB,OAEf/kB,EAAI,EAAGA,EAAIkZ,EAAIjW,OAAOhD,OAAQD,OAClCsB,EAAQ4X,EAAIjW,OAAOjD,IACdK,MAAMa,YAAY4jB,EAAYxjB,EAAMC,UACxC0F,EAAOpC,KAAKtC,UAAUjB,EAAMC,MACzBlB,MAAMa,YAAY6jB,EAAczjB,EAAMC,OACxCwjB,EAAczjB,EAAMC,MAAQqO,EAAO3M,OAAOhD,OAC1C2P,EAAO3M,OAAO7B,KAAK,CAACG,KAAMD,EAAMC,KAAM0F,KAAMA,EAAM0B,UAAWrH,EAAMqH,UAAWmD,MAAOxK,EAAMwK,OAAO,CAACjH,KAAKkH,UAAU/L,IAAKoD,GAAI0hB,EAAYxjB,EAAMC,YAE1I,KACCnB,EAAQwP,EAAO3M,OAAO8hB,EAAczjB,EAAMC,OAC9CnB,EAAMuI,UAAWvI,EAAMuI,UAAUpF,OAAOjC,EAAMqH,WAC9CvI,EAAM0L,MAAO1L,EAAM0L,MAAMvI,OAAOjC,EAAMwK,OAAO,CAACjH,KAAKkH,UAAU/L,SAK3DA,EAAI,EAAGA,GAAKkZ,EAAInZ,SAAW,IAAIE,OAAQD,IAC3CsB,EAAQ4X,EAAInZ,QAAQC,GACfK,MAAMa,YAAY4jB,EAAYxjB,EAAMC,SACxC0F,EAAOpC,KAAKtC,UAAUjB,EAAMC,MAC5BqO,EAAO7P,QAAQqB,KAAK,CAACG,KAAMD,EAAMC,KAAM0F,KAAMA,EAAM9F,KAAKG,EAAMH,KAAMf,MAAMkB,EAAMlB,MAAOgD,GAAI0hB,EAAYxjB,UAIzGyE,EAAOlC,OAEF7D,EAAI,EAAGA,EAAI+F,EAAO9F,OAAQD,IAC9BsB,EAAQyE,EAAO/F,GACVK,MAAMa,YAAY4jB,EAAYxjB,KAClCsO,EAAO7J,OAAO3E,KAAK,CAACG,KAAKD,EAAO2F,KAAMpC,KAAKtC,UAAUjB,GAAQ8B,GAAI0hB,EAAYxjB,YAGxEsO,GAERjF,aAAc,SAAS7J,QACjBqP,OAAO,YAAarP,QACpBsP,UAENC,aAAc,kBACNxL,KAAK/D,OAAOC,WAEpB0e,gBAAiB,kBACT5a,KAAKqd,aAEb5d,cAAe,kBACPO,KAAK6D,GAAG,YAEhByW,YAAY,SAASld,UACpB5B,MAAMgF,OAAOpD,EAAS,CACrB+iB,OAAO,CAAE/B,QAAO,EAAMgC,MAAK,KAErBpgB,KAAK6D,GAAG,WAEdrI,MAAMkI,QAASlI,MAAMmE,GAAGob,OAAQvf,MAAMwf,WAAYxf,MAAMyf,YAAazf,MAAM0f"}