{"version":3,"file":"spreadsheet.js","sources":["../sources/math/methods/helpers.js","../sources/views/date.js","../sources/locale.js","../sources/locales/en.js","../sources/views/align.js","../sources/views/border.js","../sources/views/color.js","../sources/views/dialog.js","../sources/views/form.js","../sources/views/formlate.js","../sources/views/icons.js","../sources/views/list_suggest.js","../sources/views/suggest_formula.js","../sources/operations/undo_group.js","../sources/operations/save.js","../sources/helpers/column_names.js","../sources/toolbar/defaults.js","../sources/operations/styles.js","../sources/operations/formats.js","../sources/math/parser.js","../sources/views/button.js","../sources/views/live_editor.js","../sources/views/separator.js","../sources/views/sheets.js","../sources/views/toggle.js","../sources/views/toolbar_title.js","../sources/views/multicheckbox.js","../sources/views/formlist.js","../sources/views/ui.js","../sources/editors/date.js","../sources/editors/richselect.js","../sources/toolbar/actions.js","../sources/toolbar/buttons.js","../sources/toolbar/all_elements.js","../sources/toolbar.js","../sources/toolbar/helpers.js","../sources/operations/column_operations.js","../sources/table.js","../sources/hotkeys.js","../sources/math/methods/numbers.js","../sources/math/methods/strings.js","../sources/math/methods/date.js","../sources/math/methods/other.js","../sources/math/methods.js","../sources/operations/types.js","../sources/editor.js","../sources/helpers/array.js","../sources/sheets.js","../sources/dialogs/common.js","../sources/math/writer.js","../sources/dialogs/imagecell.js","../sources/dialogs/imagetop.js","../sources/math/cache.js","../sources/math/updater.js","../sources/math/sheet.js","../sources/math/ranges.js","../sources/dialogs/sparkline.js","../sources/dialogs/ranges.js","../sources/dialogs/dropdown.js","../sources/operations/lock_cell.js","../sources/operations/spans.js","../sources/operations/filter.js","../sources/dialogs/filter.js","../sources/dialogs/format.js","../sources/dialogs/conditional.js","../sources/dialogs/export.js","../sources/dialogs/link.js","../sources/dialogs/print.js","../sources/dialogs/comments.js","../sources/dialogs/sizing.js","../sources/dialogs/chart.js","../sources/dialogs/index.js","../sources/operations/undo.js","../sources/operations/add_row_col.js","../sources/math/math.js","../sources/math/placeholder.js","../sources/operations/conditional_formats.js","../sources/operations/dropdown.js","../sources/operations/clipboard.js","../sources/operations/data.js","../sources/operations/hide_row_col.js","../sources/operations/resize.js","../sources/operations/selection.js","../sources/helpers/expand_selection.js","../sources/operations/sorting.js","../sources/operations/hide_gridlines.js","../sources/operations/hide_headers.js","../sources/operations/comments.js","../sources/operations/states.js","../sources/operations/import.js","../sources/operations/print.js","../sources/operations/export.js","../sources/operations/load.js","../sources/operations/views.js","../sources/operations/clear_styles.js","../sources/api/row_col_operations.js","../sources/api/lock_cell.js","../sources/api/freeze.js","../sources/api/hide_gridlines.js","../sources/api/hide_headers.js","../sources/api/hide_rows.js","../sources/api/math.js","../sources/api/operations.js","../sources/api/core.js","../sources/api/save.js","../sources/api/dropdown.js","../sources/api/filter.js","../sources/api/confirm.js","../sources/api/undo.js","../sources/api/number_formats.js","../sources/menu.js","../sources/helpers/conditional.js","../sources/spreadsheet.js","../sources/context.js","../sources/operations/index.js","../sources/api/index.js"],"sourcesContent":["export function dayOfTheYear(date){\n\tconst start = new Date(date.getFullYear(), 0, 0);\n\tconst diff = (date - start) + ((start.getTimezoneOffset() - date.getTimezoneOffset()) * 60 * 1000);\n\treturn Math.floor(diff / (1000 * 60 * 60 * 24));\n}\n\nexport function getJsDateFromExcel(excelDate) {\n\tconst date = new Date(Math.round((excelDate - 25569) * 86400 * 1000));\n\treturn new Date(date.getTime() + date.getTimezoneOffset() * 60000);\n}\n\nexport function getExcelDateFromJs(jsDate) {\n\tconst returnDateTime = 25569 + ((jsDate.getTime() - (jsDate.getTimezoneOffset() * 60000)) / (86400 * 1000));\n\treturn returnDateTime.toString();\n}\n\nexport function _to_number(v){\n\tif(v || v === 0){\n\t\tv = v*1;\n\t\tif(!isNaN(v)) return v;\n\t}\n\treturn false;\n}\n\nexport function _combine(data){\n\tvar arr = [];\n\tfor (var i = 0; i < data.length; i++){\n\t\tarr = arr.concat(data[i]);\n\t}\n\treturn arr;\n}","import {getJsDateFromExcel, getExcelDateFromJs} from \"../math/methods/helpers\";\n\nfunction getJsDate(value){\n\tif ((value || value === 0) && !(value instanceof Date) && !isNaN(value)){\n\t\tvalue = getJsDateFromExcel(value);\n\t}\n\treturn value;\n}\n\nfunction getExcelDate(value){\n\tif (value && value instanceof Date){\n\t\tvalue = getExcelDateFromJs(value);\n\t}\n\treturn value;\n}\n\nwebix.protoUI({\n\t$cssName: \"datepicker\",\n\tname: \"ssheet-datepicker\",\n\tgetValue:function(){\n\t\tconst value = webix.ui.datepicker.prototype.getValue.apply(this);\n\t\treturn getExcelDate(value) || \"\";\n\t},\n\t$prepareValue:function(value){\n\t\tvalue = getJsDate(value);\n\t\treturn webix.ui.datepicker.prototype.$prepareValue.apply(this, [value]);\n\t}\n}, webix.ui.datepicker);\n\nwebix.protoUI({\n\t$cssName: \"daterangepicker\",\n\tname: \"ssheet-daterangepicker\",\n\tgetValue:function(){\n\t\tlet value = webix.ui.datepicker.prototype.getValue.apply(this);\n\t\tif (value){\n\t\t\tvalue = webix.copy(value);\n\t\t\tvalue.start = getExcelDate(value.start);\n\t\t\tvalue.end = getExcelDate(value.end);\n\t\t}\n\t\treturn value || \"\";\n\t},\n\t$prepareValue:function(value){\n\t\tif (!value){\n\t\t\tvalue = { start:null, end:null };\n\t\t}\n\t\telse if (!value.start && !value.end)\n\t\t\tvalue = { start:value };\n\n\t\tvalue.start = getJsDate(value.start);\n\t\tvalue.end = getJsDate(value.end);\n\n\t\treturn webix.ui.daterangepicker.prototype.$prepareValue.apply(this, [value]);\n\t}\n}, webix.ui.daterangepicker);","import en from \"./locales/en\";\nwebix.i18n.spreadsheet = en;","export default {\n\tlabels:{\n\t\t// formats\n\t\t\"common\": \"Common\",\n\t\t\"currency\": \"Currency\",\n\t\t\"number\": \"Number\",\n\t\t\"percent\": \"Percent\",\n\t\t\"date\": \"Date\",\n\t\t\"string\": \"Text\",\n\t\t\"custom-format\": \"Custom\",\n\t\t\"decimal-places\":\"Decimal places\",\n\t\t\"separator\":\"Group separator\",\n\t\t\"negative\":\"Negative number\",\n\t\t\"date-format\":\"Date format\",\n\t\t\"format-docs\":\"How to create a format\",\n\t\t// titles\n\t\t\"undo-redo\": \"Undo/Redo\",\n\t\t\"font\": \"Font\",\n\t\t\"text\": \"Text\",\n\t\t\"cell\": \"Cell\",\n\t\t\"align\": \"Align\",\n\t\t\"format\": \"Number\",\n\t\t\"column\": \"Column\",\n\t\t\"borders\": \"Borders\",\n\t\t\"px\": \"px\",\n\t\t\"apply\": \"Apply\",\n\t\t// popups and dialogs\n\t\t\"cancel\": \"Cancel\",\n\t\t\"save\": \"Save\",\n\t\t// multisheets\n\t\t\"sheet\": \"Sheet\",\n\t\t// conditions\n\t\t\"conditional-format\": \"Conditional Format\",\n\t\t\"condition\": \"Condition\",\n\t\t\"conditional-style\": \"Style\",\n\t\t\"conditional-operator\": \"Operator\",\n\t\t\"conditional-between\":\"between\",\n\t\t\"conditional-not-equal\":\"not equal\",\n\t\t// ranges\n\t\t\"range\": \"Range\",\n\t\t\"range-title\": \"Named ranges\",\n\t\t\"range-name\": \"Name\",\n\t\t\"range-cells\": \"Range\",\n\t\t// images\n\t\t\"image-or\": \"or\",\n\t\t\"image-title\": \"Add image\",\n\t\t\"image-upload\": \"Select file for upload\",\n\t\t\"image-url\": \"URL (e.g. http://*)\",\n\t\t// sparklines\n\t\t\"sparkline-title\": \"Add sparkline\",\n\t\t\"sparkline-type\": \"Type\",\n\t\t\"sparkline-range\": \"Range\",\n\t\t\"sparkline-color\": \"Color\",\n\t\t\"sparkline-positive\": \"Positive\",\n\t\t\"sparkline-negative\": \"Negative\",\n\t\t// custom format\n\t\t\"format-title\": \"Set format\",\n\t\t\"format-pattern\": \"Format pattern\",\n\t\t//dropdown\n\t\t\"dropdown-empty\": \"Empty cells\",\n\t\t\"dropdown-title\": \"Add dropdown\",\n\t\t\"dropdown-range\": \"Range\",\n\t\t// confirm\n\t\t\"ok\": \"OK\",\n\t\t// import/export\n\t\t\"import-title\": \"Import\",\n\t\t\"import-not-support\": \"Sorry, your browser does not support import\",\n\t\t\"export-title\": \"Export\",\n\t\t\"export-name\": \"Name of xslx file\",\n\t\t\"export-all-sheets\":\"Export all sheets\",\n\t\t// add link\n\t\t\"link-title\": \"Add Link\",\n\t\t\"link-name\": \"Text\",\n\t\t\"link-url\": \"URL\",\n\t\t//images\n\t\t\"image\": \"Image\",\n\t\t\"add-image-cell\":\"Add to cell\",\n\t\t\"add-image-top\":\"Add above cells\",\n\t\t//charts\n\t\t\"graph\": \"Graph\",\n\t\t\"add-sparkline\":\"Add to cell\",\n\t\t\"add-chart\":\"Add above cells\",\n\t\t//conditional format labels\n\t\t\"display\" : \"Display\",\n\t\t\"value\" : \"Value\",\n\t\t// confirm messages\n\t\t\"range-remove-confirm\": \"Are you sure you want to remove the range permanently?\",\n\t\t\"sheet-remove-confirm\": \"Are you sure you want to remove the sheet permanently?\",\n\t\t\"merge-cell-confirm\":\"Only the left top value will remain after merging. Continue?\",\n\t\t\"error-range\": \"The range is incorrect!\",\n\t\t//print\n\t\t\"print\":\"Print\",\n\t\t\"print-title\":\"Before you print..\",\n\t\t\"print-settings\":\"General settings\",\n\t\t\"print-paper\":\"Paper size\",\n\t\t\"print-layout\":\"Layout\",\n\t\t\"current-sheet\":\"Current sheet\",\n\t\t\"all-sheets\":\"All sheets\",\n\t\t\"selection\":\"Selected cells\",\n\t\t\"borderless\":\"Hide gridlines\",\n\t\t\"sheet-names\":\"Show sheet names\",\n\t\t\"skip-rows\":\"Skip empty rows\",\n\t\t\"margin\":\"Hide margins\",\n\t\t\"page-letter\":\"Letter\",\n\t\t\"page-a4\":\"A4 (210x297mm)\",\n\t\t\"page-a3\":\"A3 (297x420mm)\",\n\t\t\"page-width\":\"Page width\",\n\t\t\"page-actual\":\"Actual Size\",\n\t\t\"page-portrait\":\"Portrait\",\n\t\t\"page-landscape\":\"Landscape\",\n\t\t//comment\n\t\t\"comment\":\"Comment\",\n\t\t//resize\n\t\t\"width\":\"Width\",\n\t\t\"height\":\"Height\",\n\t\t\"fit-content\": \"Fit to content\",\n\t\t//views\n\t\t\"edit-view\":\"Edit\",\n\t\t\"remove-view\":\"Remove\",\n\t\t\"line-chart\":\"Line\",\n\t\t\"area-chart\":\"Area\",\n\t\t\"bar-chart\":\"Bar\",\n\t\t\"donut-chart\":\"Donut\",\n\t\t\"pie-chart\":\"Pie\",\n\t\t\"radar-chart\":\"Radar\",\n\t\t\"spline-chart\":\"Spline\",\n\t\t\"splinearea-chart\":\"Spline Area\",\n\t\t\"stacked-chart\":\"Stacked\",\n\t\t\"chart-range\":\"Range\",\n\t\t\"chart-type\":\"Type\",\n\t\t\"chart-config\":\"Add chart\",\n\t\t\"chart-col-axis\":\"Use left column as xAxis\",\n\t\t\"chart-row-legend\":\"Use top row as legend\",\n\t\t\"chart-col-legend\":\"Use left column as legend\",\n\t\t\"chart-pie-text\":\"Show values inside\"\n\t},\n\ttooltips: {\n\t\t\"color\": \"Font color\",\n\t\t\"background\": \"Background color\",\n\t\t\"font-family\": \"Font family\",\n\t\t\"font-size\": \"Font size\",\n\t\t\"text-align\": \"Horizontal align\",\n\t\t\"vertical-align\": \"Vertical align\",\n\t\t\"borders\": \"Borders\",\n\t\t\"borders-no\": \"Clear borders\",\n\t\t\"borders-left\": \"Left border\",\n\t\t\"borders-top\": \"Top border\",\n\t\t\"borders-right\": \"Right border\",\n\t\t\"borders-bottom\": \"Bottom border\",\n\t\t\"borders-all\": \"All borders\",\n\t\t\"borders-outer\": \"Outer borders\",\n\t\t\"borders-top-bottom\": \"Top and bottom borders\",\n\t\t\"borders-color\": \"Border color\",\n\t\t\"align-left\": \"Left align\",\n\t\t\"align-center\": \"Center align\",\n\t\t\"align-right\": \"Right align\",\n\t\t\"align-top\": \"Top align\",\n\t\t\"align-middle\": \"Middle align\",\n\t\t\"align-bottom\": \"Bottom align\",\n\t\t\"span\": \"Merge\",\n\t\t\"wrap\": \"Text wrap\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"format\": \"Number format\",\n\t\t\"increase-decimals\":\"Increase decimal places\",\n\t\t\"decrease-decimals\":\"Decrease decimal places\",\n\t\t\"font-weight\": \"Bold\",\n\t\t\"font-style\": \"Italic\",\n\t\t\"text-decoration\": \"Underline\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"create-filter\": \"Create/remove filters\",\n\t\t\"freeze-columns\" : \"Freeze/unfreeze columns\",\n\t\t\"add-range\": \"Set name for the selected range\",\n\t\t\"conditional\": \"Conditional formatting\",\n\t\t\"add-sheet\": \"Add Sheet\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"clear\": \"Clear\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"row\": \"Rows\",\n\t\t\"column\": \"Columns\",\n\t\t\"sheet\": \"Sheet\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"add-comment\": \"Comment\"\n\t},\n\tmenus:{\n\t\t\"remove-sheet\": \"Remove sheet\",\n\t\t\"rename-sheet\": \"Rename sheet\",\n\t\t\"file\": \"File\",\n\t\t\"new\": \"New\",\n\t\t\"new-sheet\": \"New sheet\",\n\t\t\"excel-import\": \"Import from Excel\",\n\t\t\"excel-export\": \"Export to Excel\",\n\t\t\"sheet\": \"Sheets\",\n\t\t\"copy-sheet\": \"Copy to new sheet\",\n\t\t\"edit\": \"Edit\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"columns\": \"Columns\",\n\t\t\"insert-column\": \"Insert column\",\n\t\t\"delete-column\": \"Delete column\",\n\t\t\"show-column\": \"Show column\",\n\t\t\"hide-column\": \"Hide column\",\n\t\t\"resize-column\": \"Resize column\",\n\t\t\"rows\": \"Rows\",\n\t\t\"insert-row\": \"Insert row\",\n\t\t\"delete-row\": \"Delete row\",\n\t\t\"show-row\": \"Show row\",\n\t\t\"hide-row\": \"Hide row\",\n\t\t\"resize-row\": \"Resize row\",\n\t\t\"insert\": \"Insert\",\n\t\t\"conditional-format\": \"Conditional format\",\n\t\t\"clear\": \"Clear\",\n\t\t\"clear-value\":\"Values\",\n\t\t\"clear-style\":\"Styles\",\n\t\t\"clear-conditional-formats\":\"Conditional formats\",\n\t\t\"clear-dropdown-editors\":\"Dropdowns and filters\",\n\t\t\"clear-comments\":\"Comments\",\n\t\t\"clear-all\":\"All\",\n\t\t\"image\": \"Image\",\n\t\t\"add-image-cell\":\"Add to cell\",\n\t\t\"add-image-top\":\"Add above cells\",\n\t\t\"graph\": \"Graph\",\n\t\t\"add-sparkline\":\"Add to cell\",\n\t\t\"add-chart\":\"Add above cells\",\n\t\t\"data\": \"Data\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"add-range\": \"Named ranges\",\n\t\t\"sort\": \"Sort\",\n\t\t\"sort-asc\": \"Sort A to Z\",\n\t\t\"sort-desc\": \"Sort Z to A\",\n\t\t\"view\": \"View\",\n\t\t\"freeze-columns\": \"Freeze/unfreeze columns\",\n\t\t\"freeze-rows\": \"Freeze/unfreeze rows\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"create-filter\": \"Create/remove filters\",\n\t\t\"add-dropdown\": \"Add dropdown\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"print\": \"Print\",\n\t\t\"add-comment\":\"Comment\"\n\t},\n\ttable:{\n\t\t\"math-error\":\"ERROR\",\n\t\t\"format-error\":\"INCORRECT FORMAT\"\n\t},\n\tliveEditor:{\n\t\t\"edit\":\"Edit:\"\n\t},\n\tformats:{\n\t\t\"dateFormat\": \"mm/dd/yyyy\",\n\t\t\"timeFormat\": \"hh:mm AM/PM\",\n\t\t\"longDateFormat\": \"dd mmmm yyyy\",\n\t\t\"fullDateFormat\": \"mm/dd/yyyy hh:mm AM/PM\",\n\t\t\"parseDateTime\": \"%m/%d/%Y %G:%i:%s\",\n\t\t\"parseDate\": \"%m/%d/%Y\"\n\t}\n};\n","webix.protoUI({\n\tname: \"ssheet-align\",\n\t$cssName:\"richselect\",\n\t$init: function(config){\n\t\tconfig.options =  {\n\t\t\tview:\"datasuggest\",\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-icons\",\n\t\t\t\ttooltip: {\n\t\t\t\t\ttemplate:\"#tooltip#\"\n\t\t\t\t},\n\t\t\t\txCount:3, yCount:1\n\t\t\t},\n\t\t\tdata: config.data\n\t\t};\n\t}\n},webix.ui.richselect);","webix.protoUI({\n\tname: \"ssheet-borders-suggest\",\n\tdefaults:{\n\t\twidth: 300\n\t},\n\t$init: function(config){\n\t\tconfig.body = {\n\t\t\tmargin: 6,\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-icons\", scroll: false, select: true,\n\t\t\t\t\txCount: 4,\n\t\t\t\t\tyCount: 2,\n\t\t\t\t\ttooltip: {\n\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\treturn webix.i18n.spreadsheet.tooltips[\"borders-\"+obj.id];\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonAfterSelect: function(){\n\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView();\n\t\t\t\t\t\t\tsuggest.updateMasterValue(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\tvar css = \"webix_ssheet_button_icon webix_ssheet_icon ssi-borders-\"+obj.value;\n\t\t\t\t\t\treturn \"<span class='\"+css+\"'></span>\";\n\t\t\t\t\t},\n\t\t\t\t\tdata: config.data\n\t\t\t\t},\n\t\t\t\t{ view: \"ssheet-separator\"},\n\t\t\t\t{\n\t\t\t\t\trows:[\n\t\t\t\t\t\t{ view: \"ssheet-color\", css: config.css,  name: config.name, width: 68, value: \"#000000\",\n\t\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"borders-color\"],\n\t\t\t\t\t\t\ttitle: \"<span class='webix_icon wxi-pencil'></span>\",\n\t\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\t\tonChange: function(){\n\t\t\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView().getParentView();\n\t\t\t\t\t\t\t\t\tsuggest.updateMasterValue(false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ }\n\t\t\t\t\t]\n\t\t\t\t}\n\n\t\t\t]\n\t\t};\n\t},\n\tupdateMasterValue: function(hide){\n\t\tvar value = this.getValue();\n\t\tvar master = webix.$$(this.config.master);\n\t\tmaster.setValue(value);\n\t\tif(hide)\n\t\t\tthis.hide();\n\t},\n\tsetValue: function(value){\n\t\tif(value[0])\n\t\t\tthis.getList().select(value[0]);\n\t\tif(value[1])\n\t\t\tthis.getColorView().setValue(value[1]);\n\t},\n\tgetValue: function(){\n\t\treturn [this.getList().getSelectedId(), this.getColorView().getValue()||\"\"];\n\t},\n\tgetList: function(){\n\t\treturn this.getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[0];\n\t},\n\tgetItemText:function(){\n\t\treturn \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-borders-all'>\";\n\t}\n},webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-borders\",\n\t$cssName: \"richselect\",\n\t$init: function(config){\n\t\tconfig.options = {\n\t\t\tview: \"ssheet-borders-suggest\",\n\t\t\tfitMaster: false,\n\t\t\tdata: config.data\n\t\t};\n\n\t\tthis.$ready.push(webix.bind(function(){\n\t\t\tthis.getPopup().config.master = this.config.id;\n\t\t},this));\n\n\t},\n\tsetValue: function(value){\n\t\tif(webix.isArray(value)){\n\t\t\tif(!this.config.value || value[0] !=  this.config.value[0] || value[1] !=  this.config.value[1]){\n\t\t\t\tthis.getPopup().setValue(value);\n\t\t\t}\n\t\t\tthis.config.value = value;\n\t\t\tif (value[0])\n\t\t\t\tthis.callEvent(\"onChange\");\n\t\t}\n\t\treturn value;\n\t},\n\tgetValue: function(){\n\t\treturn  this.getPopup().getValue().join(\",\");\n\t},\n\tgetList: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[1].getChildViews()[0];\n\t}\n},webix.ui.richselect);","// toolbar: color selector\nwebix.protoUI({\n\t$cssName: \"colorboard\",\n\tname: \"ssheet-colorboard\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_colorboard\",\n\t\tpalette: [\n\t\t\t[\"#000000\", \"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"],\n\t\t\t[\"#980000\", \"#ff0000\", \"#ff9900\", \"#ffff00\", \"#00ff00\", \"#00ffff\", \"#4a86e8\", \"#0000ff\", \"#9900ff\", \"#ff00ff\"],\n\t\t\t[\"#e6b8af\", \"#f4cccc\", \"#fce5cd\", \"#fff2cc\", \"#d9ead3\", \"#d0e0e3\", \"#c9daf8\", \"#cfe2f3\", \"#d9d2e9\", \"#ead1dc\"],\n\t\t\t[\"#dd7e6b\", \"#ea9999\", \"#f9cb9c\", \"#ffe599\", \"#b6d7a8\", \"#a2c4c9\", \"#a4c2f4\", \"#9fc5e8\", \"#b4a7d6\", \"#d5a6bd\"],\n\t\t\t[\"#cc4125\", \"#e06666\", \"#f6b26b\", \"#ffd966\", \"#93c47d\", \"#76a5af\", \"#6d9eeb\", \"#6fa8dc\", \"#8e7cc3\", \"#c27ba0\"],\n\t\t\t[\"#a61c00\", \"#cc0000\", \"#e69138\", \"#f1c232\", \"#6aa84f\", \"#45818e\", \"#3c78d8\", \"#3d85c6\", \"#674ea7\", \"#a64d79\"],\n\t\t\t[\"#85200c\", \"#990000\", \"#b45f06\", \"#bf9000\", \"#38761d\", \"#134f5c\", \"#1155cc\", \"#0b5394\", \"#351c75\", \"#741b47\"],\n\t\t\t[\"#5b0f00\", \"#660000\", \"#783f04\", \"#7f6000\", \"#274e13\", \"#0c343d\", \"#1c4587\", \"#073763\", \"#20124d\", \"#4c1130\"]\n\t\t]\n\t}\n},webix.ui.colorboard);\n\nwebix.protoUI({\n\t$cssName: \"richselect\",\n\tname: \"ssheet-color\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_color\",\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t\theight: 202,\n\t\t\t\ton:{\n\t\t\t\t\tonSelect: function(value){\n\t\t\t\t\t\tthis.getParentView().setMasterValue({ value:value });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_color\";\n\t},\n\t$renderInput: function(config, divStart, id){\n\t\tvar color  = this.renderColor.call(this);\n\t\tdivStart = divStart.replace(/([^>]>)(.*)(<\\/div)/, function(match, p1, p2, p3){\n\t\t\treturn p1+config.title +color+p3;\n\t\t});\n\n\t\treturn webix.ui.colorpicker.prototype.$renderInput.call(this,config, divStart, id);\n\t},\n\t$setValue: function(value){\n\t\tvar popup =  webix.$$(this.config.popup.toString());\n\t\tvar colorboard = popup.getBody();\n\t\tif(value){\n\t\t\tcolorboard.setValue(value);\n\t\t\tthis.config.value = value;\n\t\t\tthis.getColorNode().style.backgroundColor = value;\n\t\t}\n\n\t},\n\trenderColor: function(){\n\t\treturn \"<div class='webix_ssheet_cp_color' style='background-color:\"+this.config.value+\";'> </div>\";\n\t},\n\tgetColorNode: function(){\n\t\treturn this.$view.firstChild.firstChild.childNodes[1];\n\t},\n\t$renderIcon:function(){\n\t\treturn webix.ui.text.prototype.$renderIcon.apply(this,arguments);\n\t}\n},webix.ui.colorpicker);","webix.protoUI({\n\t$cssName: \"window\",\n\tname: \"ssheet-dialog\",\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_dialog\";\n\t\tthis.config.buttons = config.buttons;\n\t},\n\tgetHeaderConfig: function(label){\n\t\treturn {\n\t\t\tpaddingX: 10,\n\t\t\tpaddingY: 5,\n\t\t\theight: 60,\n\t\t\tcols: [\n\t\t\t\t{ view: \"label\", label: label},\n\t\t\t\t{ view: \"icon\", css:\"webix_ssheet_hide_icon\", icon:\"webix_ssheet_icon ssi-close\", width: 50, click: function(){\n\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\tparentView.callEvent(\"onHideClick\",[]);\n\t\t\t\t}}\n\t\t\t]\n\t\t};\n\t},\n\tgetBodyConfig: function(content){\n\t\tcontent.borderless = true;\n\t\tvar elements = this.getFormElements(content);\n\t\tvar config = {\n\t\t\tview: \"form\",\n\t\t\tcss: \"webix_ssheet_form\",\n\t\t\tpaddingY: 0,\n\t\t\telements: elements\n\t\t};\n\t\treturn config;\n\t},\n\tgetFormElements: function(content){\n\t\tvar elements;\n\t\tif(webix.isArray(content))\n\t\t\telements= content;\n\t\telse{\n\t\t\telements = [];\n\t\t\telements.push(content);\n\t\t}\n\t\tif(this.config.buttons){\n\t\t\telements.push({height:1});\n\t\t\telements.push( {\n\t\t\t\tmargin: 10,\n\t\t\t\tcols:[\n\t\t\t\t\t{},\n\t\t\t\t\t{view: \"button\", css: \"ssheet_cancel_button\", label: webix.i18n.spreadsheet.labels.cancel, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onCancelClick\",[]);\n\t\t\t\t\t}},\n\t\t\t\t\t{view: \"button\", label: webix.i18n.spreadsheet.labels.save, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onSaveClick\",[]);\n\t\t\t\t\t}}\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\telements.push({height:10, borderless: true});\n\t\treturn elements;\n\t},\n\tbody_setter: function(value){\n\t\tif(typeof value == \"object\"){\n\t\t\tvalue.paddingY = value.paddingY||0;\n\t\t\tif(value.view == \"form\" && value.elements){\n\t\t\t\tvalue.elements = this.getFormElements(value.elements);\n\t\t\t\tif(!value.css)\n\t\t\t\t\tvalue.css = \"webix_ssheet_form\";\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = this.getBodyConfig(value);\n\t\t}\n\n\t\treturn webix.ui.window.prototype.body_setter.call(this,value);\n\t},\n\thead_setter:function(value){\n\t\tif(value){\n\t\t\tvalue = this.getHeaderConfig(value);\n\t\t}\n\t\treturn webix.ui.window.prototype.head_setter.call(this,value);\n\t},\n\tdefaults:{\n\t\tpadding:0,\n\t\tmove:true,\n\t\thead: true,\n\t\tbuttons: true,\n\t\t//we need to retain focus in table area, so disabling the autofocusing feature\n\t\tautofocus:false,\n\t\twidth: 350\n\t}\n}, webix.ui.window, webix.IdSpace);\n\n\n\nwebix.protoUI({\n\t$cssName: \"datatable\",\n\tname: \"ssheet-dialog-table\",\n\t$init: function(config){\n\t\tif(!config.headerRowHeight)\n\t\t\tconfig.headerRowHeight = 34;\n\t\tthis.$view.className += \" webix_ssheet_table webix_ssheet_dialog_table\";\n\t}\n},webix.ui.datatable);","webix.protoUI({\n\tname: \"ssheet-form-popup\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_form\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-form-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_suggest\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\t$cssName: \"colorpicker\",\n\tname: \"ssheet-colorpicker\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_colorpicker\";\n\t},\n\tdefaults:{\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t\theight: 202,\n\t\t\t\ton:{\n\t\t\t\t\tonSelect: function(value){\n\t\t\t\t\t\tthis.getParentView().setMasterValue({ value:value });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n},webix.ui.colorpicker);","webix.protoUI({\n\tname:\"formlate\",\n\tsetValue:function(a){ return this.setHTML(a); },\n\tgetValue:function(){ return \"\"; }\n}, webix.ui.template);","webix.protoUI({\n\tname:\"ssheet-icons\",\n\t$cssName: \"dataview\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_dataview\";\n\t},\n\tdefaults:{\n\t\tborderless: true,\n\t\ttemplate: \"<span class='webix_ssheet_button_icon #css#' ></span>\",\n\t\ttype:{\n\t\t\twidth: 36,\n\t\t\theight: 36\n\t\t}\n\t}\n},webix.ui.dataview);","webix.protoUI({\n\tname: \"ssheet-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tcss: \"webix_ssheet_suggest\"\n\t}\n},webix.ui.contextmenu);","webix.protoUI({\n\tname: \"suggest-formula\",\n\tdefaults: {\n\t\tfitMaster: false,\n\t\twidth: 200,\n\t\tfilter(item, value) {\n\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\n\t\t\tif(val.charAt(0) !== \"=\") return;\n\n\t\t\tlet str1 = val.substring(0, cursor).match(/([a-zA-Z]+)$/);\n\t\t\tlet str2 = val.charAt(cursor).search(/[^A-Za-z0-9]/);\n\n\t\t\tif(str1 && (cursor === val.length || str2 === 0))\n\t\t\t\tvalue = str1[0];\n\n\t\t\treturn item.value.toString().toLowerCase().indexOf(value.toLowerCase()) === 0;\n\t\t}\n\t},\n\t$init() {\n\t\tthis.attachEvent(\"onBeforeShow\", (node) => {\n\t\t\tif(node.tagName){\n\t\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\t\tconst text = editor.getValue();\n\n\t\t\t\t//only for formulas\n\t\t\t\tif(!text || text.charAt(0) !== \"=\") return false;\n\n\t\t\t\tconst sizes = webix.html.offset(node);\n\n\t\t\t\tconst selectionStart = editor.getInputNode().selectionStart;\n\t\t\t\tconst textWidth = webix.html.getTextSize(text.substring(0, selectionStart), \"webix_ssheet_formula\").width;\n\n\t\t\t\tconst y = sizes.y + sizes.height;\n\t\t\t\tconst x = sizes.x + textWidth;\n\n\t\t\t\twebix.ui.popup.prototype.show.apply(this, [{x, y}]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t},\n\tsetMasterValue(data, refresh) {\n\t\tconst text = data.id ? this.getItemText(data.id) : (data.text||data.value);\n\t\twebix.$$(this.config.master).setValueHere(text);\n\n\t\tif (!refresh)\n\t\t\tthis.hide(true);\n\n\t\tthis.callEvent(\"onValueSuggest\", [data, text]);\n\t},\n\t$enterKey: function() {\n\t\tif (this.isVisible())\n\t\t\treturn webix.ui.suggest.prototype.$enterKey.apply(this, arguments);\n\t}\n}, webix.ui.suggest);","const group = {\n\tvalue: null,\n\tset: function(method, master){\n\t\tif(!this.value){\n\t\t\tthis.start();\n\t\t\tmethod.call(master);\n\t\t\tthis.end();\n\t\t}\n\t\telse\n\t\t\tmethod.call(master);\n\t},\n\tstart(){\n\t\tthis.value = webix.uid();\n\t},\n\tend(){\n\t\tthis.value = null;\n\t}\n};\n\nexport default group;","export function init(view){\n\tconst events = [\n\t\t{name:\"onSheetAdd\", type:\"insert\"},\n\t\t{name:\"onSheetRemove\", type:\"remove\"},\n\t\t{name:\"onSheetRename\", type:\"rename\"},\n\t\t{name:\"onCellChange\"},\n\t\t{name:\"onStyleChange\"},\n\t\t{name:\"onAction\"},\n\t\t{name:\"onRowOperation\"},\n\t\t{name:\"onColumnOperation\"},\n\t\t{name:\"onAfterConditionSet\"},\n\t\t{name:\"onAfterRangeSet\"},\n\t\t{name:\"onAfterSpan\"},\n\t\t{name:\"onAfterSplit\"},\n\t\t{name:\"onAfterFilter\", view: \"cells\"},\n\t\t{name:\"onRowResize\", view: \"cells\"},\n\t\t{name:\"onColumnResize\", view: \"cells\"}\n\t];\n\n\tlet thread;\n\tfor (let i = 0; i < events.length; i++){\n\t\tconst handler = events[i];\n\t\t(handler.view ? view.$$(handler.view) : view).attachEvent(handler.name, function(name, newName){\n\t\t\tif (view._loading_data) return;\n\n\t\t\tlet params;\n\t\t\tif(handler.type)\n\t\t\t\tparams = handler.type == \"rename\" ? [handler.type, newName, name] : [handler.type, name];\n\t\t\telse\n\t\t\t\tparams = [\"update\", view.getActiveSheet()];\n\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(() => view.callEvent(\"onChange\", params));\n\t\t});\n\t}\n\n\tview.attachEvent(\"onChange\", function(){\n\t\tsave(view, \"all\");\n\t});\n}\n\nexport function save(view, name, data){\n\tvar save = view.config.save;\n\tvar url;\n\tif (!save) return;\n\n\tif(name == \"all\"){\n\t\tif(!save.all)\n\t\t\treturn;\n\t\tdata = { data: view.serialize({ sheets: true }) };\n\t\turl = save.all;\n\t}\n\telse{\n\t\turl = typeof save === \"string\" ? save + \"/\" + name : save[name];\n\t}\n\n\turl = webix.proxy.$parse(url);\n\n\tif(url){\n\t\tif (typeof url === \"function\")\n\t\t\treturn url(name, data);\n\n\t\tif (url.$proxy && url.save)\n\t\t\treturn url.save(view, data, null, null);\n\n\t\tvar ajax = webix.ajax();\n\t\tif (name === \"all\")\n\t\t\tajax.headers({ \"Content-type\" : \"application/json\" });\n\t\tajax.post(url, data);\n\t}\n}","export const decode = {};\nexport const encode = {};\n\nconst alpha = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nfor (var i=1; i<1000; i++){\n\tvar prefixIndex = parseInt((i-1)/alpha.length);\n\tvar str = (prefixIndex?alpha[prefixIndex-1]:\"\")+alpha[(i-1)%(alpha.length)];\n\n\tdecode[str] = i;\n\tencode[i] = str;\n}\n\nencode[0]=encode[1];\n\n\nexport function adress(text){\n\tvar size = (text.charCodeAt(1) < 59) ? 1 : 2;\n\tvar col = text.substr(0, size);\n\tvar row = text.substr(size);\n\n\treturn [row*1, decode[col]];\n}\n\nexport function range(text, view){\n\tvar nind = text.indexOf(\"!\");\n\tvar sheet = \"\";\n\n\t//parse sheet names\n\tif (nind !== -1){\n\t\tsheet = text.substr(0, nind);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\ttext = text.substr(nind+1);\n\t}\n\n\tvar parts = text.split(\":\");\n\tif (parts.length != 2 && view){\n\t\ttext = view.ranges.getCode(text, sheet);\n\t\tif (!text) return null;\n\t\tparts = text.split(\":\");\n\t} \n\n\tvar d1 = adress(parts[0]);\n\tvar d2 = adress(parts[1]);\n\treturn [d1[0], d1[1], d2[0], d2[1], sheet];\n}\n\n\nvar notAlphaNum = /[^A-Za-z0-9]/;\nfunction escapeSheet(text){\n\tif (notAlphaNum.test(text))\n\t\treturn `'${text}'`;\n\treturn text;\n}\n\nexport function toRange(x,y,x2,y2,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+encode[y]+x+\":\"+encode[y2]+x2;\n}\nexport function toSheetRange(x,y,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+x+\":\"+y;\n}\n\nexport function rangeObj(text, view){\n\tif (typeof text === \"object\") return text;\n\tlet a = range(text, view);\n\treturn { start:{ row:a[0], column:a[1]}, end:{ row:a[2], column:a[3] }, sheet: a[4] };\n}\n\nexport function eachRange(text, view, callback, data){\n\tvar range = rangeObj(text);\n\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\tfor (let column = range.start.column; column <=  range.end.column; column++) {\n\t\t\tcallback(view, {row: row, column: column}, data);\n\t\t}\n\t}\n}\n\nvar rangeTest = /(([A-Za-z0-9]+|'[^']+')!|)[A-Z]+[0-9]+:[A-Z]+[0-9]+/;\nexport function isRange(text){\n\treturn rangeTest.test(text);\n}\n\nexport function changeRange(text,name,inc,start){\n\tlet updated = false;\n\n\tif(isRange(text)){\n\t\tlet [r1,c1,r2,c2,sheet] = range(text);\n\n\t\t//ranges like B2:A1\n\t\tif(r1 > r2)\n\t\t\t[r1, r2] = [r2, r1];\n\t\tif(c1 > c2)\n\t\t\t[c1, c2] = [c2, c1];\n\n\t\tif (name === \"row\" && start.row <= r2){\n\t\t\tif((inc < 0 && start.row < r1) || (inc > 0 && start.row <= r1))\n\t\t\t\tr1 += inc;\n\t\t\tr2 += inc;\n\n\t\t\tif(r2<r1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\telse if (name === \"column\" && start.column <= c2){\n\t\t\tif((inc < 0 && start.column < c1) || (inc > 0 && start.column <= c1))\n\t\t\t\tc1 += inc;\n\t\t\tc2 += inc;\n\n\t\t\tif(c2<c1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\tif(updated)\n\t\t\ttext = toRange(r1,c1,r2,c2,sheet);\n\t}\n\n\treturn text;\n}","export const toolbarSizes = {\n\twidth:38,\n\tmargin: 7,\n\tpaddingY: 1,\n\tsectorPadding: 5,\n\tsectorMargin: 0\n};\n\n// default styles for toolbar elements\nexport const defaultStyles = {\n\t\"color\"         : \"#666666\",\n\t\"background\"    : \"#ffffff\",\n\t\"font-family\"   : \"'PT Sans', Tahoma\",\n\t\"font-size\" : \"15px\",\n\t\"text-align\": \"left\",\n\t\"vertical-align\": \"middle\",\n\t\"white-space\": \"nowrap\",\n\t\"format\": \"common\"\n};\n\nexport function setSkinDefaults(){\n\tconst material = webix.skin.$name == \"material\" || webix.skin.$name == \"mini\";\n\ttoolbarSizes.width = webix.skin.$active.inputHeight+2;\n\ttoolbarSizes.titleHeight = webix.skin.$name == \"mini\" ? 18 : 20;\n\n\tdefaultStyles[\"font-family\"] = material ? \"'Roboto', sans-serif\" : \"'PT Sans', Tahoma\";\n}","import group from \"./undo_group\";\nimport {save} from \"./save\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {defaultStyles} from \"../toolbar/defaults\";\n\n//do not change order, it will break server side compatibility\n//add new options to the end of this list\nexport const style_names = [\n\t\"color\",\"background\",\"text-align\",\n\t\"font-family\",\"font-size\",\n\t\"font-style\",\"text-decoration\",\"font-weight\",\n\t\"vertical-align\", \"wrap\", \"borders\", \"format\",\n\t\"border-right\", \"border-bottom\",\"border-left\", \"border-top\"\n];\n\nconst _style_map = {\n\t\"text-align\": {\n\t\tleft: () => \"justify-content:flex-start;\",\n\t\tcenter: () => \"justify-content:center;\",\n\t\tright: () => \"justify-content:flex-end;\"\t\t\n\t},\n\t\"vertical-align\": {\n\t\ttop: () => \"align-items:flex-start;\",\n\t\tmiddle: () => \"align-items:center;\",\n\t\tbottom: () => \"align-items:flex-end;\"\n\t},\n\twrap: {\n\t\twrap: ()=> {\n\t\t\treturn \"white-space: normal !important;\";\n\t\t}\n\t},\n\t\"border-left\": obj => {\n\t\tif(obj[\"border-left\"])\n\t\t\treturn \"border-left: 1px solid \"+obj[\"border-left\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-top\":obj => {\n\t\tif(obj[\"border-top\"])\n\t\t\treturn \"border-top: 1px solid \"+obj[\"border-top\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-right\": obj => {\n\t\tif(obj[\"border-right\"])\n\t\t\treturn \"border-right: 1px solid \"+obj[\"border-right\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-bottom\": obj => {\n\t\tif(obj[\"border-bottom\"])\n\t\t\treturn \"border-bottom: 1px solid \"+obj[\"border-bottom\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"font-weight\": obj => {\n\t\t//Roboto bold - font-weight:500 (looks better, than 700). Roboto is default font for material skins.\n\t\tif(obj[\"font-weight\"] == \"bold\"){\n\t\t\tconst family = obj[\"font-family\"] || defaultStyles[\"font-family\"];\n\t\t\treturn \"font-weight:\" + (family == \"'Roboto', sans-serif\" ? 500 : 700) + \";\";\n\t\t}\n\t\treturn \"\";\n\t}\n};\n\n\nconst border_checks = {\n\t\"border-left\":\t\tfunction(cell, area, mode){ return cell.column == area.start.column || mode ==\"no\"; },\n\t\"border-right\":\t\tfunction(cell, area, mode){ return cell.column == area.end.column || mode == \"all\" || mode ==\"no\"; },\n\t\"border-top\":\t\tfunction(cell, area , mode){ return cell.row == area.start.row || mode ==\"no\"; },\n\t\"border-bottom\":\tfunction(cell, area, mode){ return cell.row == area.end.row || mode == \"all\"|| mode ==\"no\"; }\n};\n\nconst _style_handlers = {\n\t\"borders\": function(view, style, value, cell){\n\t\tvar area = view.$$(\"cells\").getSelectArea();\n\t\tvalue = value.split(\",\");\n\t\tvar type = value[0];\n\t\tvar color = value[1];\n\n\t\tvar modes = [\"border-left\", \"border-right\", \"border-bottom\", \"border-top\"];\n\n\t\tif(type == \"no\")\n\t\t\tcolor = \"\";\n\t\telse if(type == \"top-bottom\"){\n\t\t\tmodes = [\"border-top\",\"border-bottom\"];\n\t\t}\n\t\telse if (type != \"all\" && type != \"outer\")\n\t\t\tmodes = [\"border-\"+type];\n\t\t\n\t\tfor (var i = 0; i < modes.length; i++){\n\t\t\tvar mode = modes[i];\n\t\t\tlet result = view.callEvent(\"onAction\", [\"check-borders\", {row:cell.row, column:cell.column, area, type, mode}]);\n\t\t\tif (result === true || border_checks[mode](cell, area, type))\n\t\t\t\tstyle = _updateStyle(view, style, mode, color, cell);\n\t\t}\n\t\treturn style;\n\t}\n};\n\nvar sizeEl;\nexport function init(view){\n\tview.attachEvent(\"onStyleSet\", (name, value) => _applyStyles(view, name, value));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, style) => {\n\t\tif(type == \"style\")\n\t\t\t_undoStyle(view, row, column, style);\n\t});\n\n\treset(view);\n\n\tif (!sizeEl)\n\t\tsizeEl = webix.html.create(\"DIV\", { style:\"visibility:hidden; position:absolute; top:0px; left:0px; height:auto;\"}, \"\");\n}\n\nfunction reset(view){\n\tview._styles = {};\n\tview._styles_cache = {};\n\tview._styles_max = 1;\n\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.removeStyle(prefix);\n}\n\nexport function getStyle(view, cell){\n\tvar styles = view.getRow(cell.row).$cellCss;\n\tif (styles){\n\t\tvar styleid = styles[cell.column];\n\t\tif (styleid)\n\t\t\treturn view._styles[styleid];\n\t}\n\treturn null;\n}\n\n// undo\nfunction _undoStyle(view, row, column, style){\n\tvar cell = {row: row, column: column};\n\tsetStyle(view, cell, style);\n}\n\nfunction _serialize(view, obj){\n\tvar styles = [];\n\n\tfor (var key in view._styles_cache)\n\t\tstyles.push([view._styles_cache[key].id, key]);\n\n\tobj.styles = styles;\n}\n\nexport function addStyle(view, props, origin){\n\tvar style = {\n\t\tprops:_styleFromText(\";;;;;;;;;;;;;;;\")\n\t};\n\n\tif (origin)\n\t\tfor (var key in origin.props)\n\t\t\tstyle.props[key] = origin.props[key];\n\n\tfor (let  key in props)\n\t\tstyle.props[key] = props[key];\n\t\t\n\n\tstyle.text = _styleToText(style);\n\tvar cache = view._styles_cache[style.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view, style);\n\n\treturn style;\n}\n\nfunction _parse(view, obj){\n\tif (obj.styles)\n\t\tfor (let i=0; i < obj.styles.length; i++){\n\t\t\tvar styleObj = obj.styles[i];\n\t\t\tvar style = {\n\t\t\t\tid: styleObj[0],\n\t\t\t\ttext:styleObj[1],\n\t\t\t\tprops: _styleFromText(styleObj[1])\n\t\t\t};\n\n\t\t\t_addStyle(view, style, true);\n\t\t}\n\n\tfor (let i = 0; i < obj.data.length; i++){\n\t\tvar [row, column, , css] = obj.data[i];\n\n\t\tif (css)\n\t\t\tupdate_style_data(view, row, column, view._styles[css]);\n\t}\n}\n\nfunction _applyStyles(view, name, value){\n\t//this - spreadsheet\n\tgroup.set(function(){\n\t\tview.eachSelectedCell(function(cell){\n\t\t\t_applyCellStyles(view, cell, name, value);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _applyCellStyles(view, cell, name, value){\n\tvar ostyle = getStyle(view, cell);\n\tvar nstyle = _updateStyle(view, ostyle, name, value, cell);\n\n\tif (nstyle && nstyle != ostyle)\n\t\t_setStyle(view, cell, nstyle, ostyle);\n}\n\nfunction _updateStyle(view, style, name, value, cell){\n\n\tif(_style_handlers[name]){\n\t\treturn _style_handlers[name](view, style, value, cell);\n\t}\n\n\tif (style && style.props[name] == value) return style;\n\n\tvar nstyle = { text:\"\", id:0, props: (style?webix.copy(style.props):{}) };\n\tnstyle.props[name] = value;\n\tnstyle.text = _styleToText(nstyle);\n\n\tvar cache = view._styles_cache[nstyle.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view,nstyle);\n\n\treturn nstyle;\n}\n\nfunction update_style_data(view, row, column, style){\n\tconst item = view.getRow(row);\n\n\titem.$cellCss = item.$cellCss || {};\n\titem.$cellFormat = item.$cellFormat || {};\n\n\tif(style){\n\t\titem.$cellCss[column] = style.id;\n\t\titem.$cellFormat[column] = style.props.format || null;\n\t} else {\n\t\tdelete item.$cellCss[column];\n\t\tdelete item.$cellFormat[column];\n\t}\n}\n\nexport function setStyle(view, cell, style){\n\tvar old = getStyle(view, cell);\n\treturn _setStyle(view, cell, style, old);\n}\n\nexport function setRangeStyle(view, range, style) {\n\teachRange(range, view, _setStyle, style);\n}\n\nexport function getTextSize(view, text, css, baseWidth){\n\tsizeEl.innerHTML = text;\n\tsizeEl.style.width = baseWidth ? baseWidth+\"px\" : \"auto\";\n\n\tsizeEl.className = \"webix_table_cell webix_cell \"+css;\n\tview._table.$view.appendChild(sizeEl);\n\n\tconst width = Math.max(0, sizeEl.offsetWidth+1);\n\tconst height = Math.max(0, sizeEl.offsetHeight+1);\n\n\tview._table.$view.removeChild(sizeEl);\n\tsizeEl.innerHTML = \"\";\n\n\treturn { width, height };\n}\n\nfunction _setStyle(view, cell, style, old){\n\tgroup.set(()=>{\n\t\tif(view.callEvent(\"onBeforeStyleChange\", [cell.row, cell.column, style, old])){\n\t\t\tconst format = style && style.props.format || null;\n\t\t\tconst oldFormat = old && old.props.format || null;\n\t\t\tconst formatChanged = format != oldFormat;\n\t\t\tif(!formatChanged || formatChanged && view.callEvent(\"onBeforeFormatChange\", [cell.row, cell.column, format, oldFormat])){\n\t\t\t\tupdate_style_data(view, cell.row, cell.column, style);\n\t\t\t\tview.callEvent(\"onStyleChange\", [cell.row, cell.column, style, old]);\n\n\t\t\t\tif(formatChanged)\n\t\t\t\t\tview.callEvent(\"onFormatChange\", [cell.row, cell.column, format, oldFormat]);\n\n\t\t\t\tview.saveCell(cell.row,cell.column);\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction _buildCssString(style) {\n\tlet css = \"\";\n\n\tfor (var key in style){\n\t\tif (style[key]){\n\t\t\tif( _style_map[key]){\n\t\t\t\tif(_style_map[key][style[key]])\n\t\t\t\t\tcss += _style_map[key][style[key]](style);\n\t\t\t\telse if(typeof  _style_map[key] == \"function\")\n\t\t\t\t\tcss += _style_map[key](style);\n\t\t\t}\n\t\t\telse\n\t\t\t\tcss+= key+\":\"+style[key]+\";\";\n\t\t}\n\t}\n\n\treturn css;\n}\n\nfunction _addStyle(view, style, silent){\n\tview._styles_cache[style.text] = style;\n\n\twhile (!style.id || view._styles[style.id])\n\t\tstyle.id = \"wss\"+(view._styles_max++);\n\tview._styles[style.id] = style;\n\n\tconst css = _buildCssString(style.props);\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.addStyle(prefix+\" .\"+style.id+\"{\"+css+\"}\", prefix);\n\n\tif (!silent)\n\t\tsave(view, \"styles\", { name:style.id, text: style.text } );\n}\n\nfunction _styleToText(style){\n\tvar id = [];\n\tfor (var i=0; i<style_names.length; i++)\n\t\tid.push(style.props[style_names[i]]);\n\treturn id.join(\";\");\n}\n\nfunction _styleFromText(text){\n\tvar parts = text.split(\";\");\n\tvar props = {};\n\tfor (var i=0; i<style_names.length; i++)\n\t\tprops[style_names[i]] = parts[i];\n\treturn props;\n}\n\n\n\nexport function clearRangeStyle(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tlet style = getStyle(view,cell);\n\t\t\tif (style)\n\t\t\t\tsetStyle(view, cell, null);\n\t\t});\n\t});\n}\n\nexport function compactStyles(view){\n\tlet params  = view.serialize();\n\n\tlet data = params.data;\n\tlet styles = params.styles;\n\n\tlet used = {};\n\tfor (let i=0; i<data.length; i++){\n\t\tlet name = data[i][3];\n\t\tif (name)\n\t\t\tused[name] = 1;\n\t}\n\n\tlet newStyles = [];\n\tfor(let i = 0; i<styles.length; i++){\n\t\tlet name = styles[i][0];\n\t\tif (used[name])\n\t\t\tnewStyles.push(styles[i]);\n\t}\n\n\tparams.styles = newStyles;\n\treset(view);\n\t_parse(view, params);\n}","import {addStyle} from \"./styles\";\nimport {getJsDateFromExcel} from \"../math/methods/helpers\";\nimport group from \"./undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onDataParse\", (data) => load(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => serialize(view, data, config));\n}\n\nexport let formatHelpers = {};\n\nlet formats;\nlet formatsCount;\nlet formatSources;\nlet formatCache;\n\nexport function setDefaultFormats(){\n\tconst formatsLocale = webix.i18n.spreadsheet.formats;\n\tformats = {};\n\tformatsCount = 0;\n\tformatSources = {};\n\tformatCache = {};\n\tformatHelpers = {\n\t\tprice : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_price\";\n\t\t\t\treturn webix.i18n.priceFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.priceSettings.decimalSize, \n\t\t\t\tsymbol: webix.i18n.priceFormat(\"\"),\n\t\t\t\tseparator: 1, negative:1, type: \"price\"\n\t\t\t}, getDelimiters(\"price\"))\n\t\t},\n\t\t\"int\" : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_int\";\n\t\t\t\treturn webix.i18n.numberFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.decimalSize,\n\t\t\t\tseparator: 1, negative:1, type: \"int\",\n\t\t\t}, getDelimiters(\"int\"))\n\t\t},\n\t\tpercent : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_percent\";\n\t\t\t\treturn Math.round(value*100)+\"%\";\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: 0, separator: 0, negative:1, type: \"percent\",\n\t\t\t}, getDelimiters(\"percent\"))\n\t\t},\n\t\tdate : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_date\";\n\t\t\t\treturn format2code(formatsLocale.dateFormat, getDelimiters(\"date\"))(value);\n\t\t\t},\n\t\t\tvalues: { type:\"date\", date:formatsLocale.dateFormat }\n\t\t},\n\t\tstring : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_text\";\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tvalues: { type:\"string\" }\n\t\t}\n\t};\n\n\tfor(let i in formatHelpers){\n\t\tformatSources[i] = serializeFormat(formToValues(i, formatHelpers[i].values));\n\t\tformatCache[formatSources[i]] = i;\n\t}\n}\n\nexport function getDelimiters(type){\n\tif(type == \"price\")\n\t\treturn { groupSign:webix.i18n.priceSettings.groupDelimiter, decimalSign:webix.i18n.priceSettings.decimalDelimiter };\n\telse \n\t\treturn { groupSign:webix.i18n.groupDelimiter, decimalSign:webix.i18n.decimalDelimiter };\n}\n\nfunction serialize(view, data){\n\tconst formats = [];\n\tconst defaultFormats = [\"percent\", \"int\", \"price\", \"date\", \"string\"];\n\n\tfor(let i in formatSources){\n\t\tif(defaultFormats.indexOf(i) == -1) //exclude default formats\n\t\t\tformats.push([i,formatSources[i]]);\n\t}\n\tdata.formats = formats;\n}\n\nfunction load(view,data){\n\tvar i,\n\t\tformats = data.formats;\n\n\tif(formats)\n\t\tfor(i = 0; i < formats.length; i++)\n\t\t\tcreateFormatName(formats[i][1],formats[i][0]);\n}\n\nexport function getFormat(name){\n\treturn formatHelpers[name] ? formatHelpers[name].getFormat : formatHelpers[name];\n}\n\nexport function getFormatSource(name, toexcel){\n\tif(toexcel){\n\t\tlet parsed = parseFormat({values: formatHelpers[name].values, format: formatSources[name]});\n\t\treturn serializeFormat(parsed, true);\n\t}\n\telse\n\t\treturn formatSources[name];\n}\n\nfunction createFormatName(str, values){\n\tif (formatCache[str]) return formatCache[str];\n\n\tlet name = typeof(values) == \"object\" ? \"fmt\"+(formatsCount) : values;\n\tformatsCount++;\n\n\tformats[name] = str;\n\n\tvalues = webix.extend(\n\t\ttypeof(values) == \"object\" ? values : { format:str, type:\"custom\" }, \n\t\tgetDelimiters(\"custom\")\n\t);\n\n\tformatHelpers[name] = {\n\t\tgetFormat:format2code(str, {decimalSign: values.decimalSign, groupSign: values.groupSign}),\n\t\tvalues: values\n\t};\n\n\tformatSources[name] = str;\n\tformatCache[str] = name;\n\n\treturn name;\n}\n\nexport function addFormat(view, row, column, format, type){\n\tif(!type)\n\t\ttype = {format:format, type: \"custom\"};\n\tconst old = view.getStyle(row, column);\n\tconst nev = addStyle(view, { format:createFormatName(format, type) }, old);\n\tview.setStyle(row, column, nev);\n}\n\nexport function removeFormat(view, row, column){\n\tconst old = view.getStyle(row, column);\n\tconst nev = addStyle(view, { format:\"\" }, old);\n\tview.setStyle(row, column, nev);\n}\n\nfunction splitFormat(str){\n\tvar conditional = str.match(/.*\\[[><=].*/g);\n\tvar parts = str.split(\";\");\n\tif (!conditional){\n\t\tif (parts.length > 1){\n\t\t\tparts[0] = (parts.length > 2 ? \"[>0]\" : \"[>=0]\")+parts[0];\n\t\t\tparts[1] = \"[<0]\"+parts[1];\n\t\t\tif (parts[2])\n\t\t\t\tparts[2] = \"[=0]\"+parts[2];\n\t\t}\n\t}\n\treturn parts;\n}\n\nexport function format2code(str, delimiters){\n\tconst errorMessage = webix.i18n.spreadsheet.table[\"format-error\"];\n\tlet parts = splitFormat(str);\n\tlet code = [\"var spaces = \\\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\";\"];\n\tfor (var i=0; i<parts.length; i++){\n\t\tvar separated = separateFmt(parts[i]);\n\t\tcode.push(genCode(separated.condition, separated.color.toLowerCase(), separated.fmt, i, parts.length > 0, delimiters));\n\t}\n\n\treturn new Function(\"val\",\"extra\", `try{ ${code.join(\"\\n\")} return val; } catch(err) { return \"${errorMessage}\"; }`);\n}\n\nfunction genCode(check, color, line, ind, isAbs, delimiters){\n\tvar str = \"\";\n\tif (check){\n\t\tif (!ind) str+=\"if\"; else str+=\"else if\";\n\t\tif (check[0] === \"=\") check = \"=\"+check;\n\t\tstr+=\"(val\"+check+\"){\";\n\t\tif (isAbs) str+=\"val = Math.abs(val);\";\n\t}\n\tif (color)\n\t\tstr+=\"extra.css = \\\"webix_ssheet_format_\"+color+\"\\\";\";\n\n\tstr += genFormatCode(line, delimiters);\n\n\treturn str+(check?\"}\":\"\");\n}\n\nconst dateTypes = {\n\t\"yy\": \"%y\",\n\t\"yyyy\": \"%Y\",\n\t\"m\": \"%n\",\n\t\"mm\": \"%m\",\n\t\"mmm\": \"%M\",\n\t\"mmmm\": \"%F\",\n\t\"mmmmm\":\"%F\", //not supported by webix\n\t\"d\": \"%j\",\n\t\"dd\": \"%d\",\n\t\"ddd\": \"%D\",\n\t\"dddd\": \"%l\"\n};\n\nconst timeTypes = {\n\t\"h\": \"%G\",\n\t\"hh\": \"%H\",\n\t\"m\": \"%i\", //not supported by webix\n\t\"mm\": \"%i\",\n\t\"s\": \"%s\", //not supported by webix\n\t\"ss\": \"%s\",\n\t\"AM/PM\": \"%A\"\n};\n\nconst dateOrder = Object.keys(dateTypes).sort((a, b) => b.length - a.length);\nconst timeOrder = Object.keys(timeTypes).sort((a, b) => b.length - a.length);\n\nfunction excelDateToWebix(text, lastDateType){\n\tconst typesOrder = [\n\t\t{name:\"date\", order:dateOrder, types:dateTypes}, \n\t\t{name:\"time\", order:timeOrder, types:timeTypes}\n\t];\n\n\t// \"m\"/\"mm\" format can be either date (%n/%m) or time (%i), so check last date type\n\tconst basedOnLast = /^m{1,2}(?!m)/.test(text);\n\tif(basedOnLast && lastDateType != \"date\")\n\t\ttypesOrder.reverse();\n\n\tfor(let i = 0; i < typesOrder.length; i++){\n\t\tconst type = typesOrder[i];\n\t\tfor(let j = 0; j < type.order.length; j++)\n\t\t\tif(text.indexOf(type.order[j]) == 0)\n\t\t\t\treturn {\n\t\t\t\t\tformat: type.types[type.order[j]],\n\t\t\t\t\tlength: type.order[j].length,\n\t\t\t\t\ttype: type.name\n\t\t\t\t};\n\t}\n}\n\nfunction genFormatCode(line, delimiters){\n\tif (!line)\n\t\treturn \"return val;\";\n\n\tlet str = \"return \\\"\\\"\";\n\n\tlet isQuote;\n\tlet fmt = \"\";\n\tlet multiply = 1;\n\tlet comma, numberPlaceholder, textPlaceholder;\n\tlet date = [];\n\tlet lastDateType = \"date\";\n\n\tfor (var i=0; i<line.length; i++){\n\t\tvar betweenPlaceholders = placeholder(line[i-1])&&placeholder(line[i+1]);\n\t\tif (line[i] == \"\\\"\"){\n\t\t\tif(webix.isUndefined(isQuote))\n\t\t\t\tisQuote = i;\n\t\t\telse {\n\t\t\t\tstr += `+\"${line.substr(isQuote+1, i-isQuote-1)}\"`;\n\t\t\t\tisQuote = undefined;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tif (!webix.isUndefined(isQuote))\n\t\t\tcontinue;\n\t\tif(line[i] == \"%\")\n\t\t\tmultiply = multiply*100;\n\n\t\tif(/[a-zA-Z]/.test(line[i])){\n\t\t\tconst datePart = excelDateToWebix(line.substr(i), lastDateType);\n\t\t\tif(datePart){\n\t\t\t\tif(numberPlaceholder || textPlaceholder)\n\t\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\t\tdate.push(datePart.format);\n\t\t\t\tstr += \"/*date*/\"; //update this value after date format is ready\n\t\t\t\tlastDateType = datePart.type;\n\t\t\t\ti += datePart.length-1;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse\n\t\t\t\tstr += `+\"${line[i]}\"`;\n\t\t}\n\t\telse if (line[i] === delimiters.decimalSign && betweenPlaceholders){\n\t\t\tfmt+= delimiters.decimalSign;\n\t\t}\n\t\telse if(line[i]==\"@\"){\n\t\t\tif(numberPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\tif(!textPlaceholder){\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\ttextPlaceholder = true;\n\t\t\t}\n\t\t\tfmt+=line[i];\t\t\n\t\t}\n\t\telse if (placeholder(line[i])){\n\t\t\tif(textPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected text placeholder\\\";\";\n\t\t\tif (!numberPlaceholder) {\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\tnumberPlaceholder=true;\n\t\t\t}\n\t\t\tfmt+=line[i];\n\t\t}\n\t\telse if (line[i] === delimiters.groupSign && betweenPlaceholders)\n\t\t\tcomma = true;\n\t\telse\n\t\t\tstr += `+\"${line[i]}\"`;\n\t}\n\n\tif(date.length){\n\t\t// 12-hour or 24-hour clock depends on AM/PM in format\n\t\tif(date.indexOf(\"%A\") != -1)\n\t\t\tdate = date.map(datePart => {\n\t\t\t\tswitch(datePart){\n\t\t\t\t\tcase \"%G\": return \"%g\";\n\t\t\t\t\tcase \"%H\": return \"%h\";\n\t\t\t\t\tdefault: return datePart;\n\t\t\t\t}\n\t\t\t});\n\n\t\tfor(let i = 0; i < date.length; i++)\n\t\t\tstr = str.replace(\"/*date*/\", `+dateParts[${i}]`);\n\t}\n\n\treturn `\n\t\t${date.length ? `val = (${getJsDateFromExcel})(val); var dateParts = webix.Date.dateToStr(\"${date.join(\";\")}\")(val).split(\";\");` : \"\"}\n\t\t${fmt ? `${numberFormat(fmt, comma, delimiters, multiply)};` : \"\"}\n\t\t${str};`;\n}\n\nfunction numberFormat(fmt, comma, delimiters, multiply){\n\tvar str = `if(/^@+$/.test(\"${fmt}\") || isNaN(val)){ var fmt = val; }else {`;\n\tvar decimal = delimiters.decimalSign;\n\tvar [left, right] = getParts(fmt, decimal);\n\tright = (right || \"\").split(\"\").reverse().join(\"\");\n\n\t//calculate indexes in mask\n\tvar lzeros = left.indexOf(\"0\"); if (lzeros>=0) lzeros = left.length - lzeros;\n\tvar lfills = left.indexOf(\"?\"); if (lfills>=0) lfills = left.length - lfills;\n\tvar rzeros = right.indexOf(\"0\"); if (rzeros>=0) rzeros = right.length - rzeros;\n\tvar rfills = right.indexOf(\"?\"); if (rfills>=0) rfills = right.length - rfills;\n\tvar rmax = right.length;\n\n\tstr += `\n\tval = val*${multiply};\n\tvar parts = val.toFixed(${rmax}).split(\".\");\n\tvar left = parts[0];\n\tvar lsize = left.length; \n\tvar right = parts[1] || \"\";\n\tif (left.length < ${lzeros}) left = \"0000000000\".substr(0, ${lzeros} - left.length)+left;\n\tif (left.length < ${lfills}) left = spaces.substr(0, 6*(${lfills} - left.length))+left;\n\tif (${comma}) {\n\t\tvar buf = [];\n\t\tvar start = 3;\n\t\twhile (lsize > start) { buf.push(left.substr(left.length-start,3)); start+=3; }\n\t\tvar last = left.substr(0,left.length-start+3);\n\t\tif (last !== \"-\")\n\t\t\tbuf.push(last);\n\t\telse\n\t\t\tbuf.push(\"-\"+buf.pop());\n\n\t\tleft = buf.reverse().join(\"${delimiters.groupSign}\");\n\t}\n\tif (right){\n\t\tvar zpoint = right.length-1;\n\t\twhile (zpoint >= ${rzeros}){\n\t\t\tif (right[zpoint] !== \"0\"){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tzpoint--;\n\t\t}\n\n\t\tif (zpoint <= right.length)\n\t\t\tright = right.substr(0, zpoint+1);\n\n\t\tif (right.length < ${rfills}){\n\t\t\tright += spaces.substr(0, 6*(${rfills} - right.length));\n\t\t}\n\t}\n\tvar fmt = left+(right?\"${decimal}\":\"\")+right;\n\t`;\n\n\treturn str+\"}\\n\";\n}\n\nfunction updateDecimals(fmt, inc, val){\n\tlet parsed = parseFormat(fmt);\n\tfor(let i = 0; i < parsed.length; i++){\n\t\tif(parsed[i].decimals){\n\t\t\tif(inc>0)\n\t\t\t\tparsed[i].right.placeholders += Array(inc+1).join(\"0\");\n\t\t\telse\n\t\t\t\tparsed[i].right.placeholders = parsed[i].right.placeholders.slice(0, inc);\n\t\t}\n\t\telse{\n\t\t\tconst withoutText = !parsed[i].left.text && !parsed[i].right.text;\n\t\t\tconst withoutPlaceholders = !parsed[i].left.placeholders && !parsed[i].right.placeholders;\n\t\t\t//check if cell value have decimals (not cell format)\n\t\t\tif(inc < 0 && withoutText && withoutPlaceholders && webix.rules.isNumber(val) && val.indexOf(\".\") > -1){\n\t\t\t\tparsed[i].left.placeholders = \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(val.split(\".\")[1].length).join(Array(inc+1).join(\"0\"));\n\t\t\t}\n\t\t\t//ignore text\n\t\t\telse if(inc > 0 && (parsed[i].left.placeholders || withoutText)){\n\t\t\t\tparsed[i].left.placeholders = parsed[i].left.placeholders || \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(inc+1).join(\"0\");\n\t\t\t\tparsed[i].decimals = true;\n\t\t\t}\n\t\t}\n\t\tparsed[i].decimals = parsed[i].right.placeholders.length > 0;\n\t}\n\n\treturn serializeFormat(parsed);\n}\n\nexport function changeAreaDecimals(view, inc, row, column){\n\tlet cells = getCells(view, row, column);\n\tif(cells.length == 0)\n\t\treturn;\n\n\tconst item = view.$$(\"cells\").getItem(cells[0].row)[cells[0].column];\n\tconst firstValue = item ? item.toString() : item;\n\tconst firstStyle = view.getStyle(cells[0].row, cells[0].column);\n\n\tif(webix.rules.isNumber(firstValue) || (firstStyle && firstStyle.props.format)){\n\t\tgroup.set(function(){\n\t\t\tfor(let i = 0; i < cells.length; i++)\n\t\t\t\tchangeCellDecimals(view, inc, cells[i]);\n\t\t});\n\t\tview.refresh();\n\n\t\tlet format = view.getStyle(cells[0].row, cells[0].column).props.format || \"common\";\n\t\tformat = isCustom(format) ? \"custom\" : format;\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:format}]);\n\t}\n}\n\nexport function changeCellDecimals(view, inc, cell){\n\tlet format;\n\tconst style = view.getStyle(cell.row, cell.column);\n\tlet value = view.$$(\"cells\").getItem(cell.row)[cell.column];\n\tvalue = value ? value.toString() : \"\";\n\n\tif(style && style.props.format){\n\t\tconst name = style.props.format;\n\t\tformat = webix.copy({values:formatHelpers[name].values, format:getFormatSource(name)});\n\t\tformat.format = updateDecimals(format, inc, value);\n\n\t\tif(format.values && format.values.hasOwnProperty(\"zeros\"))\n\t\t\tformat.values.zeros = Math.max(format.values.zeros+inc, 0);\n\t}\n\t//add format for cell without format\n\telse{\n\t\tconst zeros = webix.rules.isNumber(value) && value.split(\".\")[1] ? Math.max(value.split(\".\")[1].length+inc, 0) : Math.max(inc, 0);\n\n\t\tformat = {values:{negative:1, zeros:zeros, separator:0, type:\"int\"}};\n\t\tformat.format = serializeFormat(formToValues(format.values.type, format.values));\n\t}\n\taddFormat(view, cell.row, cell.column, format.format, format.values);\n}\n\nexport function isCustom(name){\n\treturn name != \"common\" && (name.indexOf(\"fmt\") != -1 || formatHelpers[name].values.type == \"custom\");\n}\n\nexport function formToValues(type, formValues){\n\tif(type == \"string\")\n\t\treturn [{left:{text:\"@\"}}];\n\tif(formValues.date)\n\t\treturn [{left:{text:formValues.date}}];\n\n\tlet values = [{condition:\">=0\", left:{text:\"\"},right:{text:\"\"}}, {condition:\"<0\", left:{text:\"\"}, right:{text:\"\"}}];\n\twebix.extend(values, getDelimiters(type));\n\tvalues[0].right.placeholders = values[1].right.placeholders = formValues.zeros ? Array(formValues.zeros + 1).join(\"0\") : \"\";\n\tvalues[0].separator = values[1].separator = formValues.separator && type != \"percent\";\n\tvalues[0].left.placeholders = values[1].left.placeholders = values[0].separator ? \"#\"+values.groupSign +\"0\" : \"0\";\n\tvalues[0].decimals = values[1].decimals = formValues.zeros ? true : false;\n\tvalues[1].color = formValues.negative != 1 ? \"red\" : \"\";\n\tvalues[1].left.text += formValues.negative < 3 ? \"-\" : \"\";\n\n\tif(type === \"percent\")\n\t\tvalues[0].right.text = values[1].right.text  = \"%\";\n\telse if(type === \"price\"){\n\t\tconst symbol = formatHelpers.price.values.symbol;\n\t\tconst right = symbol.indexOf(\" \") == 0;\n\n\t\tvalues[1][right?\"right\":\"left\"].text += symbol;\n\t\tvalues[0][right?\"right\":\"left\"].text += symbol;\n\t}\n\n\treturn values;\n}\n\nexport function serializeFormat(values, toExcel){\n\tlet fmt = \"\";\n\tfor(let i = 0; i < values.length; i++){\n\t\tif(values[i].condition)\n\t\t\tfmt += \"[\"+values[i].condition+\"]\";\n\t\tif(values[i].color)\n\t\t\tfmt += \"[\"+values[i].color+\"]\";\n\n\t\tif(values[i].left){\n\t\t\tif(values[i].left.text){\n\t\t\t\tlet leftText = values[i].left.text;\n\t\t\t\tfmt += leftText;\n\t\t\t}\n\t\t\tif(values[i].left.placeholders){\n\t\t\t\tlet leftPlaceholders = values[i].left.placeholders;\n\t\t\t\tfmt += toExcel ? leftPlaceholders.replace(values.groupSign, \",\") : leftPlaceholders;\n\t\t\t}\n\t\t}\n\n\t\tif(values[i].decimals)\n\t\t\tfmt += toExcel ? \".\" : values.decimalSign;\n\n\t\tif(values[i].right){\n\t\t\tif(values[i].right.placeholders)\n\t\t\t\tfmt += values[i].right.placeholders;\n\t\t\tif(values[i].right.text){\n\t\t\t\tlet rightText = values[i].right.text;\n\n\t\t\t\tfmt += rightText;\n\t\t\t}\n\t\t}\n\t\tif(i != values.length - 1)\n\t\t\tfmt += \";\";\n\t}\n\treturn fmt;\n}\n\nfunction parseFormat(fmt){\n\tconst fmtParts = fmt.format.split(\";\");\n\tlet values = [];\n\n\tfor(let i = 0; i < fmtParts.length; i++){\n\t\tlet separated = separateFmt(fmtParts[i]);\n\t\tvalues[i] = {color:separated.color, condition:separated.condition, left:{}, right:{}};\n\n\t\tconst format = separated.fmt;\n\n\t\tvalues.groupSign = fmt.values.groupSign;\n\t\tvalues.decimalSign = fmt.values.decimalSign;\n\n\t\tif(format.indexOf(values.groupSign) > -1)\n\t\t\tvalues[i].separator = true;\n\n\t\tconst sepFmtParts = getParts(format, values.decimalSign);\n\n\t\tlet left = sepFmtParts[0];\n\t\tlet right = sepFmtParts[1] || \"\";\n\n\t\tif(sepFmtParts[1])\n\t\t\tvalues[i].decimals = true;\n\n\t\tleft = getFmtPartValues(left, \"left\", values.groupSign);\n\t\tright = getFmtPartValues(right, \"right\", values.groupSign);\n\n\t\tvalues[i].left = {\n\t\t\ttext: left.leftText,\n\t\t\tplaceholders: left.placeholders\n\t\t};\n\n\t\tvalues[i].right = {\n\t\t\ttext: left.rightText + right.rightText,\n\t\t\tplaceholders: right.placeholders\n\t\t};\n\t}\n\treturn values;\n}\n\nfunction getFmtPartValues(fmtPart, type, groupSign){\n\tlet firstPlaceholder;\n\tif(type == \"left\"){\n\t\tfirstPlaceholder = fmtPart.match(/[#?0]/);\n\t\tfirstPlaceholder = firstPlaceholder ? firstPlaceholder.index : Infinity;\n\t}\n\n\tlet leftText = \"\";\n\tlet rightText = \"\";\n\tlet placeholders = \"\";\n\tfor(let k = 0; k < fmtPart.length; k++){\n\t\tif(!placeholder(fmtPart[k])){\n\t\t\tif(fmtPart[k] == groupSign && placeholder(fmtPart[k+1]) && placeholder(fmtPart[k-1])){\n\t\t\t\tplaceholders += fmtPart[k];\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(type == \"left\")\n\t\t\t\tif(k < firstPlaceholder){\n\t\t\t\t\tleftText += fmtPart[k];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\trightText += fmtPart[k];\n\t\t}\n\t\telse\n\t\t\tplaceholders += fmtPart[k];\n\t}\n\treturn {leftText: leftText, rightText: rightText, placeholders: placeholders};\n}\n\nfunction separateFmt(line){\n\tlet color = \"\";\n\tlet check = \"\";\n\tlet start = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tif (line[1].match(/[><=]/)){\n\t\t\tlet end = line.indexOf(\"]\");\n\t\t\tcheck = line.substr(start+1, end-start-1);\n\t\t\tline = line.substr(end+1);\n\t\t}\n\t}\n\n\tstart = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tlet end = line.indexOf(\"]\");\n\t\tcolor = line.substr(start+1, end-start-1);\n\t\tline = line.substr(end+1);\n\t}\n\treturn {condition:check, color:color, fmt:line};\n}\n\nfunction getCells(view, row, column){\n\tif(row && column){\n\t\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\t\tlet cells = [];\n\t\t\tfor (let r = row.row; r<=column.row; r++)\n\t\t\t\tfor (let c = row.column; c<=column.column; c++)\n\t\t\t\t\tcells.push({row: r, column: c});\n\t\t\treturn cells;\n\t\t}\n\t\telse\n\t\t\treturn [{row: row, column: column}];\n\t}\n\telse\n\t\treturn view.getSelectedId(true);\n}\n\nfunction placeholder(val){\n\treturn val === \"0\" || val === \"#\" || val === \"?\";\n}\n\nfunction getParts(str, decimal){\n\t// it is nessesary to use \"/\" before decimal to escape regex special characters\n\tconst match = str.match(\"[#?0][/\"+decimal+\"][#?0]\");\n\tif(match)\n\t\treturn [str.substring(0, match.index+1), str.substring(match.index+2)];\n\telse\n\t\treturn [str];\n}\n\n//simple check: take into account only first condition\nexport function checkFormat(format, type, checkTime){\n\tformat = format && format.fmt ? format.fmt : getFormatSource(format);\n\tif(!format) return;\n\tconst parts = splitFormat(format);\n\tconst separated = separateFmt(parts[0]).fmt;\n\n\tlet quot;\n\tif(separated)\n\t\tfor(let i = 0; i < separated.length; i++){\n\t\t\tif(separated[i] == \"\\\"\")\n\t\t\t\tquot = !quot;\n\t\t\tif(quot) continue;\n\n\t\t\tif(type == \"date\" && /[a-zA-Z]/.test(separated)){\n\t\t\t\tconst datePart = excelDateToWebix(separated.substr(i), \"date\");\n\t\t\t\tif(datePart){\n\t\t\t\t\tif(checkTime){\n\t\t\t\t\t\tif(datePart.type == \"time\")\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(type == \"string\" && separated[i] == \"@\")\n\t\t\t\treturn true;\n\t\t}\n}\n\nexport function getFormatName(view, row, col){\n\tconst item = view.getRow(row);\n\treturn item.$cellFormat && item.$cellFormat[col];\n}\n\nexport function isDateInvalid(value){\n\treturn value < -99974430.925 || value > 100025569.125;\n}\n\nexport function getDateEditFormat(item, col){\n\tconst formatName = item.$cellFormat[col];\n\tconst locale = webix.i18n.spreadsheet.formats;\n\tconst isTime = checkFormat(formatName, \"date\", true);\n\n\treturn webix.Date.dateToStr( locale[isTime ? \"parseDateTime\" : \"parseDate\"] );\n}","import {getFormatName, getFormatSource} from \"../operations/formats\";\n\nfunction isChar(char){\n\tvar code = char.charCodeAt(0);\n\t// #(35) - errors like #REF!, $(36) - absolute cell reference, a-zA-Z(65-122) - chars\n\treturn (code>=65 && code<=122) || code == 35 || code == 36;\n}\nfunction isNumber(char){\n\tvar code = char.charCodeAt(0);\n\treturn code>=48 && code<=57;\n}\n\nfunction getWord(formula, i, passive){\n\tvar max = formula.length;\n\tvar sheet = passive;\n\tvar quotes = false;\n\n\tfor(var j=i; j<max; j++){\n\t\tvar key =  formula[j];\n\t\tif (key === \"'\"){\n\t\t\tquotes = !quotes;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\tif (key == \"!\"){\n\t\t\t\tif(formula[i] == \"#\") //error\n\t\t\t\t\tcontinue;\n\t\t\t\telse{\n\t\t\t\t\t//multi-sheet math\n\t\t\t\t\tsheet = formula.substr(i, j-i);\n\t\t\t\t\tif (sheet[0] === \"'\")\n\t\t\t\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\t\t\t\ti=j+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!isChar(key) && !isNumber(key)){\n\t\t\t\treturn [formula.substr(i, j-i), j, i, sheet];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn [formula.substr(i), j, i, sheet];\n}\n\nvar operand = /^[A-Z$]+[0-9]+$/;\nfunction isPosition(text){\n\treturn operand.test(text);\n}\n\nexport function position(word){\n\tvar row = 0, sum = 0, x = 1, mode = 1, flags = 0;  \n\tvar chars = false;\n\n\tfor (var j =word.length-1; j>=0; j--){\n\t\tvar key = word[j].charCodeAt(0);\n\t\tif (key === 36) {\n\t\t\tflags = flags+mode;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (key < 58){\n\t\t\t//numeric\n\t\t\tsum += (key - 48)*x;\n\t\t\tx *= 10;\n\t\t} else {\n\t\t\tif (!chars){\n\t\t\t\tx = 1; row = sum; sum = 0; chars = true; mode += 1;\n\t\t\t}\n\t\t\t//alpha\n\t\t\tsum += (key - 64)*x;\n\t\t\tx*=26;\n\t\t}\n\t}\n\n\t/*\n\t\t$X$Y => flags = 3\n\t\t$XY  => flags = 2\n\t\tX$Y  => flags = 1\n\t\tXY   => flags = 0\n\t*/\n\treturn [row, sum, flags];\n}\n\nfunction errorCode(e){\n\treturn `this.e(\"${e}\")`;\n}\n\nfunction operandCode(deps, word, sheet){\n\tlet [r,c] = position(word);\n\n\tif (sheet !== \"\"){\n\t\tdeps.push([r,c,r,c,sheet]);\n\t\treturn `this.vs(\"${sheet}\",${r},${c})`;\n\t} else {\n\t\tdeps.push([r,c,r,c,\"\"]);\n\t\treturn `this.v(${r},${c})`;\n\t}\n}\n\nfunction methodCode(word){\n\treturn `this.m.${word}`;\n}\n\nfunction namedRangeCode(deps, view, word, sheet){\n\tvar code  = view.ranges.getCode(word, sheet);\n\tif(!code) return \"\";\n\n\tvar sheetInd = code.indexOf(\"!\");\n\tif (sheetInd !== -1){\n\t\tsheet = code.substr(0, sheetInd);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\tcode = code.substr(sheetInd+1);\n\t}\n\n\tlet [a,b] = code.split(\":\");\n\treturn rangeCode(deps, a, b, sheet);\n}\n\nfunction templateCode(word){\n\treturn `this.p.${word}`;\n}\n\nfunction rangeCode(deps, a, b, sheet){\n\tlet [r1,c1] = position(a);\n\tlet [r2,c2] = position(b);\n\n\tif (r1>r2) { let t=r1; r1=r2; r2=t; }\n\tif (c1>c2) { let t=c1; c1=c2; c2=t; }\n\t\n\tif (sheet === \"\"){\n\t\tdeps.push([r1,c1,r2,c2,\"\"]);\n\t\treturn `this.r(${r1},${c1},${r2},${c2})`;\n\t} else {\n\t\tdeps.push([r1,c1,r2,c2, sheet]);\n\t\treturn `this.rs(\"${sheet}\",${r1},${c1},${r2},${c2})`;\n\t}\n}\n\nexport function split(formula, crosssheet, ranges){\n\tvar lines = [];\n\tvar index = 0;\n\tvar quotes = false, ph = false;\n\tfor (var i = formula[i] === \"=\" ? 1 : 0; i < formula.length; i++){\n\t\tvar key = formula[i];\n\t\tif (key == \"\\\"\"){\n\t\t\tquotes = !quotes;\n\t\t} else if (!quotes){\n\t\t\tif (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\t\tph = true;\n\t\t\t} else if (key == \"}\" && formula[i+1] == \"}\"){\n\t\t\t\tph = false;\n\t\t\t} else if (!ph){\n\t\t\t\tconst escaped = key === \"'\";\n\t\t\t\tif (escaped || isChar(key)){\n\t\t\t\t\tlet [word, end, ,sheet] = getWord(formula, i, \"\");\n\t\t\t\t\tlet next = end - 1;\n\t\t\t\t\tlet value;\n\t\t\t\t\tif (!sheet || (!crosssheet && sheet)){\n\t\t\t\t\t\tif(sheet){\n\t\t\t\t\t\t\t// 'sheet'! - 3 extra symbols, sheet! - 1 extra symbol\n\t\t\t\t\t\t\ti += sheet.length + (escaped ? 3 : 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (formula[next+1] !== \"(\" && (isPosition(word) || (ranges && ranges[word]))){\n\t\t\t\t\t\t\tvalue = crosssheet ? word : position(word);\n\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if(crosssheet){\n\t\t\t\t\t\tvalue = [sheet, word, escaped];\n\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t}\n\t\t\t\t\ti = next;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (index!=formula.length)\n\t\tlines.push(formula.substr(index));\n\treturn lines;\n}\n\nfunction pushLine(lines, formula, i, index, value){\n\tif (i!==0)\n\t\tlines.push(formula.substr(index, i-index));\n\tlines.push(value);\n}\n\nexport function parse(formula, view, passive = \"\"){\n\tvar code =\"return \";\n\tvar deps = [];\n\n\tvar quotes = false;\n\tvar pair = \"\", pairsheet = \"\";\n\n\tif (formula[0] != \"=\") return false;\n\n\tfor (var i = 1; i < formula.length; i++){\n\t\tvar key = formula[i];\n\n\t\tif (key == \"\\\"\")\n\t\t\tquotes = !quotes;\n\t\telse if (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\tlet [word, end] = getWord(formula, i+2);\n\t\t\ti = end + 1;\n\t\t\tcode += templateCode(word);\n\t\t\tcontinue;\n\t\t}\n\t\telse if (!quotes && (key == \"'\" || isChar(key))){\n\t\t\tlet [rawword, end, start, sheet] = getWord(formula, i, passive);\n\n\t\t\t//lower case formulas, fix them\n\t\t\tlet word = rawword.toUpperCase();\n\n\t\t\ti = end - 1;\n\n\t\t\t//errors like #REF!\n\t\t\tif(word[0] == \"#\"){\n\t\t\t\tcode += errorCode(word);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (formula[i+1] == \"(\"){\n\t\t\t\tcode += methodCode(word);\n\t\t\t}\n\t\t\telse if (isPosition(word)){\n\t\t\t\tif (formula[i+1] == \":\"){\n\t\t\t\t\tpair = word; pairsheet = sheet;\n\t\t\t\t\ti++;\n\t\t\t\t} else {\n\t\t\t\t\tif (pair !== \"\"){\n\t\t\t\t\t\tcode += rangeCode(deps, pair, word, pairsheet);\n\t\t\t\t\t\tpair = \"\";\n\t\t\t\t\t} else \n\t\t\t\t\t\tcode += operandCode(deps, word, sheet);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet range = namedRangeCode(deps, view, word, sheet);\n\t\t\t\t//we have some error word in a formula\n\t\t\t\t//break from loop to skip formula updating\n\t\t\t\tif (range == \"\"){\n\t\t\t\t\tcode += errorCode(\"#REF!\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcode += range;\n\t\t\t}\n\n\t\t\t//operator, or range, or parameter\n\t\t\tif (word !== rawword){\n\t\t\t\tformula = formula.substr(0, start)+word+formula.substr(end);\n\t\t\t}\n\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\t//special handling for & operator, string concat\n\t\t\tif (key === \"&\" && formula[i+1] !== \"&\")\n\t\t\t\tcode += \"+\";\n\t\t\t//convert <> to !=\n\t\t\telse if (key === \"<\" && formula[i+1] === \">\"){\n\t\t\t\tcode += \"!=\";\n\t\t\t\ti++;\n\t\t\t//convert = to ==\n\t\t\t} else if (key === \"=\" && formula[i-1] !== \"<\" && formula[i-1] !== \">\")\n\t\t\t\tcode += \"==\";\n\t\t\telse\n\t\t\t\tcode += key;\n\t\t} else\n\t\t\tcode += key;\n\t}\n\n\n\treturn { code: code+\";\", triggers:deps, text: formula };\n}\n\nexport function getMathFormat(view, value){\n\tlet level = 0;\n\tlet blockLevel;\n\tconst ranges = view.ranges._ranges;\n\tconst parts = split(value, true, ranges);\n\n\tfor(let i = 0; i < parts.length; i++){\n\t\t// parts[i] can contain numbers, math operators, formulas, etc.\n\t\tif(i%2 === 0){\n\t\t\t// check formulas and round brackets which are not in quotes\n\t\t\tconst methods = parts[i].match(/(([a-zA-Z]*\\()|\\))(?=(?:[^\"]|\"[^\"]*\")*$)/g);\n\t\t\tif(methods)\n\t\t\t\tmethods.forEach(part => {\n\t\t\t\t\tif(part.indexOf(\"(\") > -1){\n\t\t\t\t\t\tlevel++;\n\t\t\t\t\t\t// some methods block format addition (like count,odd,etc.)\n\t\t\t\t\t\tconst safeMethods = /^(SUM|AVERAGE|MAX|MIN|INT|ROUND|ROUNDDOWN|ROUNDUP|TRUNC)?\\($/gi;\n\t\t\t\t\t\tif(!blockLevel && !safeMethods.test(part))\n\t\t\t\t\t\t\tblockLevel = level;\n\t\t\t\t\t}\n\t\t\t\t\telse if(--level < blockLevel)\n\t\t\t\t\t\tblockLevel = null;\n\t\t\t\t});\n\t\t}\n\t\t// parts[i] can be named range, cell from the active / non-active sheet\n\t\telse if(!blockLevel){\n\t\t\tif(webix.isArray(parts[i])){\n\t\t\t\tif(parts[i][0] == view.getActiveSheet())\n\t\t\t\t\tparts[i] = parts[i][1];\n\t\t\t\telse\n\t\t\t\t\tcontinue; // ignore non-active sheets\n\t\t\t}\n\n\t\t\t// if range - check first cell position\n\t\t\tconst cell = /^[A-Za-z]+$/.test(parts[i]) ? position(ranges[parts[i]].split(\":\")[0]) : position(parts[i]);\n\t\t\tconst name = getFormatName(view, cell[0], cell[1]);\n\n\t\t\t// first cell with number format\n\t\t\tif(name)\n\t\t\t\treturn {fmt: getFormatSource(name)};\n\t\t}\n\t}\n}","webix.protoUI({\n\tname: \"ssheet-button\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 40\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_button\"+(config.arrow?\" webix_ssheet_button_menu\":\"\");\n\t\tif(config.label || config.icon){\n\t\t\tlet icon = (config.icon||config.name),\n\t\t\t\ttext = config.label||\"\";\n\t\t\tif(config.arrow)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+icon+\"'></span> \"+text;\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nwebix.protoUI({\n\tname: \"ssheet-button-icon-top\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 70,\n\t\theight: 70\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" ssheet_button_icon_top\";\n\t\tif(config.label) {\n\t\t\tlet icon = (config.icon || config.name||\"\"),\n\t\t\t\ttext = config.label;\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + icon + \"'></span><br/>\";\n\t\t\tconfig.label += \"<span class='ssheet_button_icon_top_text'>\"+text+\"</span>\";\n\t\t\tif (config.arrow)\n\t\t\t\tconfig.label += \"<br/><span class='ssheet_button_icon_top_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nfunction getPopupConfig(options){\n\treturn {\n\t\tview: \"ssheet-suggest\",\n\t\tcss: \"webix_ssheet_suggest\",\n\t\tautowidth:true,\n\t\ttemplate: function(obj){\n\t\t\tvar text = \"\";\n\t\t\tif(obj.icon)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + obj.icon + \"'></span> \";\n\t\t\ttext += obj.value || webix.i18n.spreadsheet.menus[obj.id] || obj.id;\n\t\t\treturn text;\n\t\t},\n\t\tdata: options,\n\t\ton:{\n\t\t\tonItemClick: function(id){\n\t\t\t\tvar button = this.config.master;\n\t\t\t\tif(button){\n\t\t\t\t\tlet view = webix.$$(button).getTopParentView();\n\t\t\t\t\tvar params = [this.getItem(id)];\n\t\t\t\t\tif(webix.$$(button).config.area){\n\t\t\t\t\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\t\t\t\t\tif(area)\n\t\t\t\t\t\t\tparams = params.concat([area.start,area.end]);\n\t\t\t\t\t}\n\t\t\t\t\tview.callEvent(\"onCommand\",params);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}","import \"./suggest_formula\";\nimport {split, position} from \"../math/parser\";\n\nwebix.protoUI({\n\tname: \"live-editor\",\n\t$cssName:\"texthighlight\",\n\t$init(config){\n\t\tconfig.suggest = {\n\t\t\tview: \"suggest-formula\",\n\t\t\tdata: config.suggestData\n\t\t};\n\t\tconfig.highlight = this.highlight;\n\n\t\tthis._highlightedCells = {};\n\t\tthis.$view.className += \" webix_ssheet_formula\";\n\n\t\tthis.attachEvent(\"onKeyPress\", (code, e) => {\n\t\t\tdelete this._update_range;\n\t\t\tif(code === 13) {\n\t\t\t\t//ignore Enter key if it was pressed to select some value from suggest\n\t\t\t\tif ((new Date() - (this._last_value_set || 0)) > 300){\n\t\t\t\t\tthis.showActiveSheet();\n\t\t\t\t\tthis.updateCellValue();\n\t\t\t\t\t//we have 'enter' hot key to activate editor\n\t\t\t\t\twebix.delay(()=>{\n\t\t\t\t\t\tthis.getTopParentView()._table.moveSelection(\"down\");\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\twebix.html.preventEvent(e);\n\t\t\t}\n\t\t});\n\n\t\tthis.attachEvent(\"onAfterRender\", function(){\n\t\t\twebix.eventRemove(this.keydownEv);\n\n\t\t\tthis.keydownEv = webix.event(this.getInputNode(), \"keydown\", e => {\n\t\t\t\tthis.endEdit(e);\n\t\t\t});\n\t\t});\n\t},\n\thighlight(value){\n\t\tlet html = \"\";\n\t\tconst master = this.getTopParentView();\n\t\tconst escapeText = webix.template.escape;\n\n\t\tfor(let area in this._highlightedCells){\n\t\t\tconst cells = this._highlightedCells[area];\n\t\t\tthis.changeCellCss(cells[0], cells[1], cells[2], true);\n\t\t}\n\t\tthis._highlightedCells = {};\n\n\t\t//value can be null\n\t\tif(value && value[0]==\"=\"){\n\t\t\tconst ranges = master.ranges._ranges;\n\t\t\tconst parts = split(value, true, ranges);\n\t\t\tconst sheet = master.getActiveSheet();\n\n\t\t\tlet colorIndex = 1;\n\n\t\t\tfor(let i = 0; i < parts.length; i++){\n\t\t\t\tif(i%2 === 0)\n\t\t\t\t\thtml += escapeText(parts[i]);\n\t\t\t\telse{\n\t\t\t\t\tconst crossheet = webix.isArray(parts[i]);\n\t\t\t\t\tconst cellSheet = crossheet ? this.prepareSheet(parts[i][0], parts[i][2]) : \"\";\n\t\t\t\t\tconst activeMath = this._activeMath;\n\n\t\t\t\t\tconst activeSheet = !crossheet && (!activeMath || activeMath == sheet);\n\t\t\t\t\tlet cell = position(crossheet ? parts[i][1] : parts[i]);\n\t\t\t\t\tconst cellText = crossheet ? cellSheet+parts[i][1] : parts[i];\n\n\t\t\t\t\tconst rangeName = /^[A-Za-z]+$/.test(parts[i]);\n\t\t\t\t\tif(activeSheet || (crossheet && parts[i][0] == sheet)){\n\t\t\t\t\t\tlet repeatedColor;\n\t\t\t\t\t\t//range\n\t\t\t\t\t\tif((parts[i+1] == \":\" && parts[i+2]) || rangeName){\n\t\t\t\t\t\t\tlet nextCell, nextCellText;\n\n\t\t\t\t\t\t\tif(rangeName){\n\t\t\t\t\t\t\t\tconst cells = ranges[parts[i]].split(\":\");\n\t\t\t\t\t\t\t\tcell = position(cells[0]);\n\t\t\t\t\t\t\t\tnextCell = position(cells[1]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tnextCell = position(crossheet ? parts[i+2][1] : parts[i+2]);\n\t\t\t\t\t\t\t\tnextCellText = crossheet ? cellSheet+parts[i+2][1] : parts[i+2];\n\t\t\t\t\t\t\t\ti+=2;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], nextCell[0], nextCell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${rangeName ? parts[i] : cellText+\":\"+nextCellText}</span>`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//cell\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], cell[0], cell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${cellText}</span>`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst colors = 7;\n\t\t\t\t\t\tif(!repeatedColor)\n\t\t\t\t\t\t\tcolorIndex += colorIndex == colors ? -1*(colors-1) : 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\thtml += cellText;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\thtml = escapeText(value);\n\n\t\tmaster.$$(\"cells\").refresh();\n\n\t\tif(document.activeElement == this.getInputNode())\n\t\t\tthis.paintValue();\n\t\treturn html;\n\t},\n\tshowActiveSheet(){\n\t\tconst master = this.getTopParentView();\n\n\t\tif(this._activeMath){\n\t\t\tif(this._activeMath != master.getActiveSheet()){\n\t\t\t\tconst val = this.getValue();\n\n\t\t\t\tconst cell = this.config.activeCell;\n\t\t\t\tthis.define({activeCell:null});\n\n\t\t\t\tmaster.showSheet(this._activeMath);\n\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tmaster._table.select(cell.row, cell.column);\n\t\t\t\t\tthis.setValue(val);\n\t\t\t\t\tthis.updateCellValue();\n\t\t\t\t});\n\t\t\t}\n\t\t\tdelete this._activeMath;\n\t\t}\n\t},\n\tchangeCellCss(row, col, index, remove){\n\t\tconst css = `webix_ssheet_highlight_background_${index}`;\n\t\tfor (let r = row.start; r <= row.end; r++)\n\t\t\tfor (let c = col.start; c <=  col.end; c++)\n\t\t\t\tthis.getTopParentView().$$(\"cells\")[remove?\"removeCellCss\":\"addCellCss\"](r, c, css, true);\n\t},\n\tendEdit(e){\n\t\tlet code = e.which || e.keyCode;\n\n\t\t//if it is a formula - force user to finish it by click outside or 'enter'\n\t\tif(code == 9 || (code>36 && code<41 && this.getValue().charAt(0)!==\"=\")){\n\t\t\tlet dir = (code == 40)?\"down\":(code === 39?\"right\":(code ==37?\"left\":\"up\"));\n\t\t\tif (code === 9)\n\t\t\t\tdir = \"right\";\n\n\t\t\tthis.updateCellValue();\n\t\t\tthis.getTopParentView()._table.moveSelection(dir);\n\t\t}\n\t},\n\tpaintValue(){\n\t\tlet master = this.getTopParentView();\n\t\tif(!this._activeMath || this._activeMath == master.getActiveSheet()){\n\t\t\tlet cell = this.config.activeCell;\n\t\t\tlet node = master._table.getItemNode(cell);\n\t\t\tif(cell && node) \n\t\t\t\tnode.innerHTML = `<div>${webix.template.escape(this.getValue())}</div>`;\n\t\t}\n\t},\n\tupdateCellValue() {\n\t\tlet newv = this.getValue();\n\t\tlet master = this.getTopParentView();\n\t\tlet cell = this.config.activeCell;\n\n\t\tif (!cell)\n\t\t\tthis.setValue(\"\");\n\t\telse{\n\t\t\tlet val = master.getCellValue(cell.row, cell.column);\n\n\t\t\tif(newv != val){\n\t\t\t\tthis.config.value = newv;\n\t\t\t\tmaster.setCellValue(cell.row, cell.column, newv);\n\t\t\t\tmaster.refresh();\n\t\t\t}\n\t\t}\n\n\t\tdelete master.$handleSelection;\n\t},\n\t$setValueHere(value){\n\t\tthis.setValueHere(value);\n\t},\n\tsetValueHere(value) {\n\t\tthis._last_value_set = new Date();\n\n\t\tconst formula = this.getValue();\n\t\tif(formula && formula.charAt(0)===\"=\"){\n\t\t\tconst cursor = this.getInputNode().selectionStart;\n\t\t\tlet str1 = formula.substring(0, cursor);\n\t\t\tlet str2 = formula.substring(cursor);\n\n\t\t\tconst updatedStr = /[a-zA-Z]+\\(?$/.test(str1) ? str1.replace(/[a-zA-Z]+\\(?$/, value) : str1 + value;\n\n\t\t\t//suggest called via up/down key\n\t\t\tstr1 = updatedStr + (str2[0] == \"(\" ? \"\" : \"(\");\n\n\t\t\tthis.setValue(str1 + str2);\n\t\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t\t}\n\t},\n\texpectRange(){\n\t\tlet text = this.getValue().trim();\n\t\tlet last = text.substr(text.length-1,1);\n\t\treturn last.match(/[(,]/);\n\t},\n\texpectOperator(){\n\t\tlet text = this.getValue();\n\t\tconst cursor = this.getInputNode().selectionStart;\n\t\treturn text[0] == \"=\" && text[cursor-1] && text[cursor-1].match(/[+&\\-/*%=(:,]/);\n\t},\n\tsetRange(range, replace){\n\t\tconst cursor = this.getInputNode().selectionStart;\n\t\tconst formula = this.getValue();\n\n\t\tlet str1, str2;\n\n\t\t//check if range was added by click\n\t\tif(replace)\n\t\t\treplace = this._update_range && cursor == this._update_range.pos + this._update_range.len;\n\n\t\tconst lastPos = replace ? this._update_range.pos : cursor;\n\n\t\tstr1 = formula.substring(0, lastPos) + range;\n\t\tstr2 = formula.substring(cursor);\n\n\t\tthis._update_range = {pos: lastPos, len: range.length};\n\n\t\tthis.setValue(str1 + str2);\n\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t},\n\tprepareSheet(sheet, escaped){\n\t\tconst condition = webix.isUndefined(escaped) ? sheet.indexOf(\" \") != -1 : escaped;\n\t\treturn (condition ? `'${sheet}'` : sheet) + \"!\";\n\t},\n\tprepareArea(first, second){\n\t\treturn {\n\t\t\tstart: Math.min(first, second),\n\t\t\tend: Math.max(first, second)\n\t\t};\n\t},\n\tsetColor(row1, col1, row2, col2, color){\n\t\tconst row = this.prepareArea(row1, row2);\n\t\tconst col = this.prepareArea(col1, col2);\n\t\tconst index = [row.start, row.end, col.start, col.end].join(\",\");\n\t\tconst coloredArea = this._highlightedCells[index];\n\n\t\tif(!coloredArea){\n\t\t\tthis._highlightedCells[index] = [row, col, color];\n\t\t\tthis.changeCellCss(row, col, color);\n\t\t}\n\t\telse\n\t\t\treturn coloredArea[2];\n\t}\n}, webix.ui.texthighlight);","webix.protoUI({\n\tname: \"ssheet-separator\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_toolbar_spacer\",\n\t\ttemplate: \" \",\n\t\twidth: 1,\n\t\tborderless: true\n\t}\n},webix.ui.view);","webix.protoUI({\n\tname: \"sheets\",\n\tdefaults:{\n\t\tlayout: \"x\",\n\t\tborderless: true,\n\t\tcss:\"ssheet_list_sheets\",\n\t\tselect: true,\n\t\tdrag: \"order\",\n\t\tdragscroll:\"x\",\n\t\tscroll:false\n\t}\n},webix.EditAbility,webix.ui.list);","// toolbar: toogle button\nwebix.protoUI({\n\t$cssName: \"toggle\",\n\tname:\"ssheet-toggle\",\n\ttoggle:function(){\n\t\tvar value = this.getValue() == this.config.onValue?true:false;\n\t\tthis.setValue(!value);\n\t},\n\t$setValue:function(value){\n\t\tif(value == this.config.offValue)\n\t\t\tvalue = false;\n\t\telse if(value == this.config.onValue)\n\t\t\tvalue = true;\n\t\twebix.ui.toggle.prototype.$setValue.call(this,value);\n\t},\n\tgetValue:function(){\n\t\tvar config = this.config;\n\t\tvar value = config.value;\n\t\treturn  !value || value==config.offValue?(config.offValue||false):(config.onValue||true);\n\t},\n\tdefaults:{\n\t\ttemplate:function(obj, common){\n\t\t\tvar css = (obj.value === true ||obj.value == obj.onValue) ? \" webix_pressed\" : \"\";\n\t\t\tvar inp = common.$renderInput(obj, common);\n\t\t\treturn \"<div class='webix_el_box\"+css+\"' style='width:\"+obj.awidth+\"px; height:\"+obj.aheight+\"px'>\"+inp+\"</div>\";\n\t\t}\n\t}\n}, webix.ui.toggle);\n\n\n// toolbar: silent toggle button\nwebix.protoUI({\n\tname:\"ssheet-toggle-silent\",\n\t$cssName:\"toggle\",\n\t$allowsClear:false,\n\tsetValue:function(){\n\t\tthis.blockEvent();\n\t\twebix.ui.toggle.prototype.setValue.apply(this, arguments);\n\t\tthis.unblockEvent();\n\t}\n}, webix.ui.toggle);","webix.protoUI({\n\tname: \"ssheet-bar-title\",\n\tdefaults:{\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_subbar_title\";\n\t}\n},webix.ui.template);","webix.protoUI({\n\tname:\"multicheckbox\",\n\tdefaults:{\n\t\tpadding:0,\n\t\ttype:\"clean\",\n\t\tborderless:true,\n\t\telementsConfig:{\n\t\t\tlabelWidth:10\n\t\t}\n\t},\n\t$init:function(config){\n\t\tconfig.rows = [{height:0.000001}];\n\t\tthis.$ready.push(function(){\n\t\t\tthis._initOnChange();\n\t\t});\n\t},\n\t_initOnChange(){\n\t\tthis.attachEvent(\"onChange\", function(newv){\n\t\t\tconst name = this.$eventSource.config.name;\n\n\t\t\tthis.blockEvent();\n\t\t\tif(name == \"$all\"){\n\t\t\t\tfor(let i in this.elements)\n\t\t\t\t\tthis.elements[i].setValue(newv);\n\t\t\t\tif(!newv)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconst count = this.getValue().length;\n\t\t\t\tthis.elements.$all.setValue(count == this._count ? 1 : 0);\n\t\t\t\tif(!count)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\tthis.unblockEvent();\n\t\t});\n\t},\n\tsetValue:function(value){\n\t\tthis.elements = {};\n\t\tthis._count = value.length;\n\n\t\tif(value.length > 1){\n\t\t\tlet elements = [];\n\t\t\tlet base = [];\n\t\t\tconst maxHeight = 400;\n\n\t\t\tvalue.forEach(sheet => {\n\t\t\t\tbase.push({ view: \"checkbox\", labelRight: sheet.name, name: sheet.name, value: sheet.active});\n\t\t\t});\n\n\t\t\tconst baseHeight = base.length * webix.skin.$active.inputHeight;\n\t\t\tconst scroll = baseHeight > maxHeight;\n\n\t\t\telements.push({\n\t\t\t\tview:\"scrollview\", body:{rows:base},\n\t\t\t\tscroll: scroll,\n\t\t\t\theight: scroll ? maxHeight : baseHeight\n\t\t\t});\n\n\t\t\telements.push({ template:\"<div class='ss_sep_line'></div>\", height:10 });\n\t\t\telements.push({ view:\"checkbox\", labelRight:webix.i18n.spreadsheet.labels[\"export-all-sheets\"], name:\"$all\", value:0 });\n\n\t\t\twebix.ui(elements, this);\n\t\t}\n\t\telse if(this.getChildViews().length > 1){\n\t\t\twebix.ui([{height:0.000001}], this);\n\t\t}\n\t},\n\tgetValue:function(){\n\t\tconst checkboxes = this._getCheckboxes();\n\t\tlet output = [];\n\n\t\t//save order\n\t\tfor(let i = 0; i < checkboxes.length; i++)\n\t\t\tif(checkboxes[i].getValue())\n\t\t\t\toutput.push(checkboxes[i].config.name);\n\n\t\treturn output;\n\t},\n\t_getCheckboxes(){\n\t\tconst scrollview = this.queryView(\"scrollview\");\n\t\treturn scrollview ? scrollview.getBody().getChildViews() : [];\n\t}\n}, webix.ui.form);","webix.protoUI({\n\tname:\"formlist\",\n\tdefaults:{\n\t\tpaddingY: 5,\n\t\theight: 120,\n\t},\n\t$init:function(config){\n\n\t\tconfig.cols = [\n\t\t\t{\n\t\t\t\tcss:\"webix_inp_label\",\n\t\t\t\ttemplate:config.label,\n\t\t\t\twidth:config.labelWidth,\n\t\t\t\tborderless:true\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"list\",\n\t\t\t\tdata:config.data,\n\t\t\t\tcss:config.css,\n\t\t\t\ttemplate:config.template,\n\t\t\t\tselect: true,\n\t\t\t\tscroll:false,\n\t\t\t\tborderless:true,\n\t\t\t\ton:{\n\t\t\t\t\tonSelectChange:()=>{\n\t\t\t\t\t\tthis.getParentView().callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t},\n\tsetValue:function(value){this.getChildViews()[1].select(value);},\n\tgetValue:function(){return this.getChildViews()[1].getSelectedId();},\n\trefresh: function(){this.getChildViews()[1].refresh();},\n\tfocus:function(){}\n}, webix.ui.layout);","webix.protoUI({\n\tname: \"ssheet-ui\",\n\tdefaults:{\n\t\tmove:true,\n\t\tcss:\"webix_shadow_none webix_ssheet_ui\",\n\t\thead:false,\n\t\tresize:true,\n\t\ttoFront:true,\n\t\tminWidth:50,\n\t\tminHeight:200,\n\t\tescHide:false,\n\t\tautofit:false\n\t},\n\t$init: function(){\n\t\t// prevent block selection\n\t\tthis.$view.setAttribute(\"webixignore\", \"1\");\n\t\tthis.getMenu();\n\n\t\tthis.$ready.push(function(){\n\t\t\twebix.UIManager.addHotKey(\"delete\", webix.bind(this._removeView, this));\n\t\t\twebix.UIManager.addHotKey(\"backspace\", webix.bind(this._removeView, this));\n\t\t});\n\t\tthis.attachEvent(\"onDestruct\", function(){\n\t\t\twebix.eventRemove(this._clickEv);\n\t\t\tthis._menu.destructor();\n\t\t});\n\t},\n\tmove_setter:function(value){\n\t\tif (value){\n\t\t\twebix.DragControl.addDrag(this.$view, this);\n\t\t}\n\t\treturn value;\n\t},\n\t$dragPos:function(pos, e){\n\t\tthis.callEvent(\"onViewMove\", [pos, e]);\n\t\treturn pos;\n\t},\n\t$dragCreate:function(object, e){\n\t\tconst trg = e.target;\n\t\tif (!trg.getAttribute || trg.getAttribute(\"webix_disable_drag\") || trg.getAttribute(\"webixignore\"))\n\t\t\treturn;\n\n\t\tthis.getMenu().hide();\n\t\tconst elOffset = webix.html.offset(object);\n\t\tconst elPos = webix.html.pos(e);\n\t\tconst pOffset = webix.html.offset(object.parentNode);\n\t\tconst state = webix.$$(this.config.master).getScrollState();\n\n\t\twebix.DragControl.top = elOffset.y - elPos.y - pOffset.y;\n\t\twebix.DragControl.left = elOffset.x - elPos.x - pOffset.x + state.x;\n\n\t\treturn webix.toNode(this.$view);\n\t},\n\t$dragDestroy:function(node, drag){\n\t\tconst x = this.config.left = parseInt(drag.style.left,10);\n\t\tconst y = this.config.top = parseInt(drag.style.top,10);\n\n\t\twebix.DragControl.top = webix.DragControl.left = 0;\n\n\t\tthis.callEvent(\"onViewMoveEnd\", [x, y]);\n\t\treturn;\n\t},\n\tgetMenu:function(){\n\t\tif(!this._menu){\n\t\t\tthis._menu = webix.ui({\n\t\t\t\tview:\"contextmenu\",\n\t\t\t\tdata:[\n\t\t\t\t\t{ id:\"edit\", value:webix.i18n.spreadsheet.labels[\"edit-view\"] },\n\t\t\t\t\t{ id:\"del\", value:webix.i18n.spreadsheet.labels[\"remove-view\"] }\n\t\t\t\t],\n\t\t\t\ton:{\n\t\t\t\t\tonItemClick:(id) => this._menuActions(id)\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst dots = webix.html.create(\"span\", {\"class\":\"webix_ssheet_view_menu webix_icon wxi-dots\"});\n\t\t\tthis._clickEv = webix.event(dots, \"click\", ()=> {\n\t\t\t\tif(this._menu.isVisible())\n\t\t\t\t\tthis._menu.hide();\n\t\t\t\telse\n\t\t\t\t\tthis._menu.show(dots);\n\t\t\t});\n\t\t\tthis.$view.firstChild.appendChild(dots);\n\t\t}\n\t\treturn this._menu;\n\t},\n\t_menuActions:function(id){\n\t\tif(id == \"del\")\n\t\t\tthis.callEvent(\"onViewRemove\", []);\n\t\telse if(id == \"edit\")\n\t\t\tthis.callEvent(\"onViewEdit\", []);\n\t},\n\t_removeView(view){\n\t\tif(view && view.getTopParentView() == this)\n\t\t\tthis.callEvent(\"onViewRemove\", []);\n\t}\n}, webix.ui.window);","import {getJsDateFromExcel, getExcelDateFromJs} from \"../math/methods/helpers\";\nimport {getDateEditFormat} from \"../operations/formats\";\n\nwebix.editors.excel_date = webix.extend({\n\tcreatePopup:function(){\n\t\tconst editor = webix.editors.excel_date;\n\n\t\tif(!editor.popup){\n\t\t\tconst popup = webix.ui({\n\t\t\t\tview:\"popup\",\n\t\t\t\tbody:{ \n\t\t\t\t\tview:\"calendar\",\n\t\t\t\t\ticons:true,\n\t\t\t\t\ttimepicker:true,\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonChange: function(val){\n\t\t\t\t\t\t\tval = val[0];\n\t\t\t\t\t\t\tthis.getParentView()._last_input_target.value = val ? getExcelDateFromJs(val) : \"\";\n\t\t\t\t\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonEnter: function(){\n\t\t\t\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\teditor.popup = popup.config.id;\n\t\t}\n\n\t\treturn editor.popup;\n\t},\n\trender:function(){\n\t\tconst node = webix.html.create(\"div\", {\n\t\t\t\"class\":\"webix_dt_editor\"\n\t\t}, \"<input type='text'>\");\n\n\t\tthis.popup = this.createPopup();\n\n\t\twebix.event(node.firstChild, \"click\", ()=> this.getPopup().show(node));\n\n\t\treturn node;\n\t},\n\tgetPopup(){\n\t\treturn webix.$$(this.popup);\n\t},\n\tshowPopup:function(){\n\t\tconst input = this.getInputNode();\n\t\tconst popup = this.getPopup();\n\n\t\tpopup._last_input_target = input;\n\t\tpopup.show(input);\n\n\t\tinput.setAttribute(\"aria-expanded\", \"true\");\n\t},\n\tupdateCalendar(value){\n\t\tconst calendar = this.getPopup().getBody();\n\n\t\tcalendar.blockEvent();\n\t\tcalendar.setValue(value);\n\t\tcalendar.unblockEvent();\n\t},\n\tafterRender:function(){\n\t\tthis.showPopup();\n\t},\n\tsetValue:function(value){\n\t\tconst noDate = (value === \"\" || isNaN(value*1));\n\t\tvalue = noDate ? new Date() : getJsDateFromExcel(value);\n\t\tthis.updateCalendar(value);\n\n\t\tconst format = getDateEditFormat(this.config.row, this.config.id);\n\t\tthis.getInputNode().value = format(value);\n\t},\n\tgetValue:function(){\n\t\tconst value = this.getInputNode().value;\n\t\tthis.getPopup().hide();\n\t\treturn value;\n\t}\n}, webix.editors.text);","webix.editors.ss_richselect = webix.extend({\n\tgetFormat:function(value){\n\t\tconst list = this.getInputNode();\n\t\tlet item;\n\n\t\tif (value && list.exists(value))\n\t\t\titem = list.getItem(value);\n\t\treturn item && item.format;\n\t},\n\tpopupInit:function(popup){\n\t\twebix.editors.richselect.popupInit.apply(this, arguments);\n\n\t\tpopup.getList().define(\"template\", function(obj){\n\t\t\treturn obj.$value || obj.value;\n\t\t});\n\t}\n}, webix.editors.richselect);","import {changeAreaDecimals} from \"../operations/formats\";\n\nexport const actions = {\n\tspan: function(view){\n\t\tvar range = view.$$(\"cells\").getSelectArea();\n\t\tif(range){\n\t\t\tif(isMerged(view,range)){\n\t\t\t\tview.splitCell();\n\t\t\t}\n\t\t\telse{\n\t\t\t\tlet values = [];\n\t\t\t\tfor(let r = range.start.row; r<=range.end.row; r++){\n\t\t\t\t\tfor(let c = range.start.column; c<=range.end.column; c++){\n\t\t\t\t\t\tlet value = view.getCellValue(r,c);\n\t\t\t\t\t\tif(value) values.push(value);\n\t\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t\t}\n\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t}\n\t\t\t\tif(values.length>1){\n\t\t\t\t\tview.confirm({\n\t\t\t\t\t\ttext:webix.i18n.spreadsheet.labels[\"merge-cell-confirm\"]\n\t\t\t\t\t}).then(()=> view.combineCells() );\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tview.combineCells();\n\t\t\t}\n\t\t}\n\t},\n\tundo: function(view){\n\t\tview.undo();\n\t},\n\tredo: function(view){\n\t\tview.redo();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t},\n\t\"freeze-columns\": function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeColumns(select && select.column!=\"rowId\"?select.column : 0);\n\t},\n\t\"freeze-rows\":function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeRows(select ? select.row : 0);\n\t},\n\t\"increase-decimals\": function(view){\n\t\tchangeAreaDecimals(view, 1);\n\t},\n\t\"decrease-decimals\": function(view){\n\t\tchangeAreaDecimals(view, -1);\n\t},\n};\n\nfunction isMerged(view,range){\n\tvar i, j,\n\t\tc0 = range.start,\n\t\tc1 = range.end;\n\n\tfor( i = c0.row*1; i <= c1.row*1; i++ ){\n\t\tfor( j = c0.column*1; j <= c1.column*1; j++ ){\n\t\t\tif(view.$$(\"cells\").getSpan(i, j))\n\t\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n","import {toolbarSizes, defaultStyles} from \"./defaults\";\nimport {formatHelpers} from \"../operations/formats\";\n\n// options for 'font-family' select\nexport const fontFamily = [\n\t{id: \"Arial\", value: \"Arial\"},\n\t{id: \"'Roboto', sans-serif\", value: \"Roboto\"},\n\t{id: \"'PT Sans', Tahoma\", value: \"PT Sans\"},\n\t{id: \"Tahoma\", value: \"Tahoma\"},\n\t{id: \"Verdana\", value: \"Verdana\"},\n\t{id: \"Calibri, Tahoma\", value:\"Calibri\"}\n];\n\n// options for 'format' select\nfunction getCellFormats(){\n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn [\n\t\t{id: \"common\", value: locale.common },\n\t\t{id: \"price\", value: locale.currency, example: \"98.20\"},\n\t\t{id: \"int\", value: locale.number, example: \"2120.02\"},\n\t\t{id: \"percent\", value: locale.percent, example:\"0.5\"},\n\t\t{id: \"date\", value: locale.date, example:\"45000\"},\n\t\t{id: \"string\", value: locale.string, example:\"012345\"},\n\t\t{id: \"custom\", value: locale[\"custom-format\"]},\n\t];\n}\n\nexport function getColumnOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet colOperations = [\n\t\t{ id:\"add\",    group:\"column\", value:locale[\"insert-column\"]},\n\t\t{ id:\"del\",    group:\"column\", value:locale[\"delete-column\"]},\n\t\t{ id:\"show\",   group:\"column\", value:locale[\"show-column\"]},\n\t\t{ id:\"hide\",   group:\"column\", value:locale[\"hide-column\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\tcolOperations.push({ id:\"resize\", group:\"column\", value:locale[\"resize-column\"]});\n\treturn colOperations;\n}\n\nexport function getRowOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet rowOperations = [\n\t\t{ id:\"add\",    group:\"row\", value:locale[\"insert-row\"]},\n\t\t{ id:\"del\",    group:\"row\", value:locale[\"delete-row\"]},\n\t\t{ id:\"show\",   group:\"row\", value:locale[\"show-row\"]},\n\t\t{ id:\"hide\",   group:\"row\", value:locale[\"hide-row\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\trowOperations.push({ id:\"resize\", group:\"row\", value:locale[\"resize-row\"]});\n\treturn rowOperations;\n}\n\n// options for 'clear' select\nexport function getClearOperation(){\n\treturn [\n\t\t{id: \"clear-value\",               value: getLocaleClear(\"value\")},\n\t\t{id: \"clear-style\",               value: getLocaleClear(\"style\")},\n\t\t{id: \"clear-conditional-formats\", value: getLocaleClear(\"conditional-formats\")},\n\t\t{id: \"clear-dropdown-editors\",    value: getLocaleClear(\"dropdown-editors\")},\n\t\t{id: \"clear-comments\",            value: getLocaleClear(\"comments\")},\n\t\t{ $template: \"Separator\" },\n\t\t{id: \"clear-all\",                 value: getLocaleClear(\"all\")}\n\t];\n}\n\n// options for 'borders' select\nconst borders = [\n\t{id: \"no\", value: \"no\"},\n\t{id: \"left\", value: \"left\"},\n\t{id: \"top\", value: \"top\"},\n\t{id: \"right\", value: \"right\"},\n\t{id: \"bottom\", value: \"bottom\"},\n\t{id: \"all\", value: \"all\"},\n\t{id: \"outer\", value: \"outer\"},\n\t{id: \"top-bottom\", value: \"top-bottom\"}\n];\n\nfunction getLocaleClear(value){\n\tvar locale = webix.i18n.spreadsheet.menus;\n\treturn locale[\"clear\"] + \" \" + locale[\"clear-\"+value].toLowerCase();\n}\n\n// options for 'font-size' select\nfunction getFontSize(){\n\tvar numbers = [\n\t\t\"8\",\"9\",\"10\",\"11\",\"12\",\"14\",\"15\",\n\t\t\"16\",\"18\",\"20\",\"22\",\"24\",\"28\",\"36\"\n\t];\n\tvar  fontSize = [];\n\n\tfor(var i =0; i < numbers.length; i++){\n\t\tfontSize.push({id: numbers[i]+webix.i18n.spreadsheet.labels.px, value: numbers[i]});\n\t}\n\treturn fontSize;\n}\n\nexport const styleFormats = {\n\t\"font-weight\": \"bold\",\n\t\"font-style\": \"italic\",\n\t\"text-decoration\": \"underline\"\n};\n\nexport const ui = {\n\tbutton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle\", width: config.width||toolbarSizes.width, id: config.name, name: config.name,  label: config.label,\n\t\t\tcss: config.css||\"\", onValue: styleFormats[config.name], offValue: \"normal\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\tcolorButton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-color\",  css: config.css,  name: config.name, width: config.width||toolbarSizes.width+24,\n\t\t\ttitle: \"<span class='webix_ssheet_button_icon webix_ssheet_color_button_icon webix_ssheet_icon ssi-\"+config.name+\"' ></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ttoggleButton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle-silent\", width: toolbarSizes.width, id: config.name, name: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ticonButton: function(config){\n\t\tvar btn = webix.copy(config);\n\t\twebix.extend(btn, {view: \"button\", width: toolbarSizes.width, id: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\tcss: \"\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||webix.i18n.spreadsheet.menus[config.name]||\"\"\n\t\t});\n\t\tif(config.onValue){\n\t\t\twebix.extend(btn,{view: \"ssheet-toggle\", onValue: config.onValue, offValue: config.offValue},true);\n\t\t}\n\n\t\treturn btn;\n\t},\n\tsegmented: function(config){\n\t\treturn  {\n\t\t\tview: \"segmented\", name: config.name, css:config.css||\"\", width: config.width||toolbarSizes.width+76,  options:config.options\n\t\t};\n\t},\n\tselect: function(config){\n\t\twebix.extend(config,{\n\t\t\tview: \"richselect\",\n\t\t\tid: config.name,\n\t\t\tvalue: defaultStyles[config.name],\n\t\t\tsuggest: {\n\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\t//fitMaster: false,\n\t\t\t\tpadding: 0,\n\t\t\t\tdata: config.options\n\t\t\t}\n\t\t});\n\n\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\tif(config.popupWidth){\n\t\t\tconfig.suggest.fitMaster = false;\n\t\t\tconfig.suggest.width = config.popupWidth;\n\t\t}\n\t\tif(config.popupTemplate)\n\t\t\tconfig.suggest.body = {\n\t\t\t\ttemplate: config.popupTemplate\n\t\t\t};\n\t\tif(config.popupEvents){\n\t\t\tconfig.suggest.body = config.suggest.body || {};\n\t\t\tconfig.suggest.body.on = config.popupEvents;\n\t\t}\n\t\treturn config;\n\t},\n\tseparator: function(){\n\t\treturn {\n\t\t\tview: \"ssheet-separator\"\n\t\t};\n\t},\n\ttitle: function(config){\n\t\tvar title = config.title;\n\t\tif(title.indexOf(\"$\") === 0)\n\t\t\ttitle = \"\";\n\t\ttitle = webix.i18n.spreadsheet.labels[config.title]||title;\n\n\t\treturn {\n\t\t\ttemplate: title, view: \"ssheet-bar-title\", height: toolbarSizes.titleHeight\n\t\t};\n\t},\n\tborders: function(config){\n\t\treturn {view: \"ssheet-borders\", width:config.width||toolbarSizes.width+24, data: borders, id: config.name, name: config.name,\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\talign: function(config){\n\t\treturn {view: \"ssheet-align\", value: defaultStyles[config.name], width:config.width||toolbarSizes.width+24, data: config.options,\n\t\t\tname: config.name, tooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\tcondFormat: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-cond-format\",\n\t\t\twidth: 40,\n\t\t\tid: config.name,\n\t\t\tname: config.name\n\t\t};\n\t}\n};\n\nexport const buttonsMap = {\n\t\"font-family\": function(){\n\t\treturn  ui.select({name: \"font-family\", options:fontFamily, width: 100});\n\t},\n\t\"font-size\": function(){\n\t\treturn  ui.select({name: \"font-size\", options:getFontSize(), width: 64});\n\t},\n\t\"font-weight\": function(){\n\t\treturn ui.button({name:\"font-weight\",label: \"B\", css: \"webix_ssheet_bold\"});\n\t},\n\t\"font-style\": function(){\n\t\treturn ui.button({name: \"font-style\",label: \"I\",css:\"webix_ssheet_italic\"});\n\t},\n\t\"text-decoration\": function(){\n\t\treturn ui.button({name: \"text-decoration\",label: \"U\",css: \"webix_ssheet_underline\"});\n\t},\n\t\"color\": function(){\n\t\treturn ui.colorButton({name: \"color\",icon:\"font\",css:\"webix_ssheet_color\"});\n\t},\n\t\"background\": function(){\n\t\treturn  ui.colorButton({name: \"background\",icon:\"paint-brush\",css:\"webix_ssheet_background\", width: 64});\n\t},\n\t\"borders\": function(){\n\t\treturn ui.borders({ name: \"borders\" });\n\t},\n\t\"text-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn ui.align({name: \"text-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"left\", css: \"webix_ssheet_icon ssi-left\", tooltip: locale[\"align-left\"]},\n\t\t\t{id: \"center\", css: \"webix_ssheet_icon ssi-center\", tooltip: locale[\"align-center\"]},\n\t\t\t{id: \"right\", css: \"webix_ssheet_icon ssi-right\", tooltip: locale[\"align-right\"]}\n\t\t]});\n\t},\n\t\"vertical-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn  ui.align({name: \"vertical-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"top\", css: \"webix_ssheet_icon ssi-top\", tooltip: locale[\"align-top\"]},\n\t\t\t{id: \"middle\", css: \"webix_ssheet_icon ssi-middle\", tooltip: locale[\"align-middle\"]},\n\t\t\t{id: \"bottom\", css: \"webix_ssheet_icon ssi-bottom\", tooltip: locale[\"align-bottom\"]}\n\t\t]});\n\t},\n\t\"wrap\": function(){\n\t\treturn ui.iconButton({name: \"wrap\", onValue:\"wrap\", offValue:\"nowrap\"});\n\t},\n\t\"format\": function(){\n\t\treturn ui.select({\n\t\t\tname: \"format\", width: 106, options:getCellFormats(), popupWidth: 180,\n\t\t\tpopupTemplate: function(obj){\n\t\t\t\t//make it look like an actual cell\n\t\t\t\tvar format =  formatHelpers[obj.id] ? formatHelpers[obj.id].getFormat : \"\";\n\t\t\t\tvar cell = {css:\"\"};\n\t\t\t\tvar example = format && obj.example?format(obj.example, cell):\"\";\n\t\t\t\treturn obj.value + (format?\"<span class='webix_ssheet_right\"+(cell.css?\" \"+cell.css:\"\")+\"'>\"+example+\"</span>\":\"\");\n\t\t\t},\n\t\t\tpopupEvents:{\n\t\t\t\tonItemClick: function(id){\n\t\t\t\t\tif(id == \"custom\")\n\t\t\t\t\t\tthis.getTopParentView().callEvent(\"onCommand\", [{id:id}]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t\"column\": function(view){\n\t\treturn {\n\t\t\tname: \"column\",\n\t\t\tview: \"ssheet-button\", icon: \"column\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getColumnOperation(view)\n\t\t};\n\t},\n\t\"row\": function(view){\n\t\treturn {\n\t\t\tname: \"row\", view: \"ssheet-button\", icon: \"row\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getRowOperation(view)\n\t\t};\n\t},\n\t\"clear\": function(){\n\t\treturn {\n\t\t\tname: \"clear\", view: \"ssheet-button\", icon: \"clear-styles\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getClearOperation()\n\t\t};\n\t},\n\t\"image\":function(){\n\t\treturn {\n\t\t\tname:\"image\", view:\"ssheet-button\", icon:\"add-image\",\n\t\t\tarrow:true, options:[\n\t\t\t\t{id:\"add-image-cell\", value: webix.i18n.spreadsheet.labels[\"add-image-cell\"]},\n\t\t\t\t{id:\"add-image-top\", value: webix.i18n.spreadsheet.labels[\"add-image-top\"]}\n\t\t\t]\n\t\t};\n\t},\n\t\"graph\":function(){\n\t\treturn {\n\t\t\tname:\"graph\", view:\"ssheet-button\", icon:\"add-sparkline\",\n\t\t\tarrow:true, options:[\n\t\t\t\t{id:\"add-sparkline\", value:webix.i18n.spreadsheet.labels[\"add-sparkline\"]},\n\t\t\t\t{id:\"add-chart\", value: webix.i18n.spreadsheet.labels[\"add-chart\"]}\n\t\t\t]\n\t\t};\n\t},\n\t\"comment\": function(){\n\t\treturn {\n\t\t\tname: \"comment\",\n\t\t\tview: \"ssheet-button\", icon: \"comments\",\n\t\t\tarrow: true, area: true, width: 55\n\t\t};\n\t},\n\t\"create-filter\": function(){\n\t\treturn ui.toggleButton({name: \"create-filter\"});\n\t},\n\t\"hide-gridlines\": function(){\n\t\treturn ui.toggleButton({name: \"hide-gridlines\"});\n\t},\n\t\"hide-headers\": function(){\n\t\treturn ui.toggleButton({name: \"hide-headers\"});\n\t}\n};","import {toolbarSizes} from \"./defaults\";\n\nfunction getText(text){\n\tvar locale = webix.i18n.spreadsheet;\n\treturn locale.menus[text] || locale.labels[text] || locale.tooltips[text] || text;\n}\nfunction calcButtons(){\n\tvar i, name, width,\n\t\tgroups = {\n\t\t\t\"undo\":[\"undo\",\"redo\"],\n\t\t\t\"insert\":[\"add-sparkline\",\"add-image\",\"add-comment\"]\n\t\t},\n\t\tresult = {};\n\n\tfor( name in groups){\n\t\tresult[name] = 0;\n\t\tfor(i=0; i < groups[name].length; i++){\n\t\t\twidth = webix.html.getTextSize(getText(groups[name][i]), \"webix_ssheet_button_measure\").width + 7;\n\t\t\tresult[name] = Math.max(width,result[name]);\n\t\t}\n\t}\n\treturn result;\n}\nexport function getAllElements(){\n\tvar sizes = calcButtons();\n\tvar titleHeight = toolbarSizes.titleHeight;\n\n\treturn [\n\t\t{\n\t\t\tpadding: 3,\n\t\t\tmargin: 0,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"sheet\", view: \"ssheet-button-icon-top\", label: getText(\"sheet\"), arrow: true,\n\t\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t\t{id: \"new-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"copy-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"remove-sheet\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"excel-import\"},\n\t\t\t\t\t\t\t\t{$button: \"excel-export\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"print\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{template: getText(\"file\"), view: \"ssheet-bar-title\", height: titleHeight, width: 85}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"undo\", view: \"ssheet-button\", label: getText(\"undo\"), width: sizes.undo },\n\t\t\t\t{$button: \"redo\", view: \"ssheet-button\", label: getText(\"redo\"), width: sizes.undo},\n\t\t\t\t{template: getText(\"undo-redo\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-family\", width: (webix.skin.$active.inputHeight+2)*3+4},\n\t\t\t\t\t\t\t\t{$button: \"font-size\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{$button: \"borders\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-weight\"},\n\t\t\t\t\t\t\t\t{$button: \"font-style\"},\n\t\t\t\t\t\t\t\t{$button: \"text-decoration\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{$button: \"background\"},\n\t\t\t\t\t\t{$button: \"color\"}\n\t\t\t\t\t]\n\n\t\t\t\t},\n\t\t\t\t{template: getText(\"font\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"text-align\"},\n\t\t\t\t\t\t{$button: \"span\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"vertical-align\"},\n\n\t\t\t\t\t\t{$button: \"wrap\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"align\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"format\"},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"increase-decimals\"},\n\t\t\t\t\t\t{$button: \"decrease-decimals\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\n\t\t\t\t{template: getText(\"number\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-asc\"},\n\t\t\t\t\t{ $button: \"create-filter\"},\n\t\t\t\t\t{ $button: \"conditional-format\"},\n\t\t\t\t\t{ $button: \"add-link\"},\n\t\t\t\t\t{ $button: \"clear\"}\n\t\t\t\t]},\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-desc\"},\n\t\t\t\t\t{ $button: \"add-range\"},\n\t\t\t\t\t{ $button: \"lock-cell\"},\n\t\t\t\t\t{ $button: \"add-dropdown\"}\n\t\t\t\t]},\n\t\t\t\t{template: getText(\"edit\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"image\", view: \"ssheet-button\", label: getText(\"image\"), width:sizes.insert},\n\t\t\t\t\t\t{$button: \"add-comment\", view: \"ssheet-button\", label: getText(\"comment\"), width:sizes.insert},\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{$button: \"graph\", view: \"ssheet-button\", label: getText(\"graph\"), width:sizes.insert},\n\t\t\t\t{template: getText(\"insert\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{rows:[\n\t\t\t\t\t\t\t{$button:\"row\"},\n\t\t\t\t\t\t\t{$button:\"column\"}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"hide-gridlines\"},\n\t\t\t\t\t\t\t\t{$button:\"hide-headers\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"freeze-rows\"},\n\t\t\t\t\t\t\t\t{$button:\"freeze-columns\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"view\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{}\n\t];\n}","import {actions} from \"./toolbar/actions\";\nimport {defaultStyles} from \"./toolbar/defaults\";\nimport {toolbarButtons, getButtons} from \"./toolbar/helpers\";\nimport * as elm from \"./toolbar/all_elements\";\nimport {isCustom} from \"./operations/formats\";\n\nconst buttons = {\n\t\"undo-redo\": [\"undo\",\"redo\"],\n\t\"font\": [\"font-family\",\"font-size\",\"font-weight\",\"font-style\",\"text-decoration\",\"color\",\"background\",\"borders\"],\n\t\"align\": [\"text-align\",\"vertical-align\",\"wrap\",\"span\"],\n\t\"format\": [\"format\"]\n};\n\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"toolbar-update\")\n\t\t\tupdateValue(view, action.name, action.value);\n\t});\n\n\tvar elements = [];\n\n\tif(view.config.toolbar){\n\t\tlet allElements =  view.config.toolbar;\n\t\tif(allElements == \"full\"){\n\t\t\tallElements = elm.getAllElements();\n\t\t\tif(webix.isUndefined(view.config.bottombar))\n\t\t\t\tview.config.bottombar = true;\n\t\t}\n\t\telements =   toolbarButtons(view, allElements);\n\t}\n\telse\n\t\telements =   getButtons(view, view.config.buttons || buttons);\n\n\tvar bar = {\n\t\tview:\"toolbar\",\n\t\tcss: \"webix_ssheet_toolbar webix_layout_toolbar\",\n\t\tid:\"bar\",\n\t\tpadding:0,\n\t\telements: elements,\n\t\ton: {\n\t\t\tonChange: function (){\n\t\t\t\tvar source = this.$eventSource;\n\t\t\t\tvar value = source.getValue();\n\t\t\t\tvar name = source.config.name;\n\t\t\t\tif(name == \"format\" && value == \"common\")\n\t\t\t\t\tvalue = \"\";\n\t\t\t\tif(!(name == \"format\" && value == \"custom\"))\n\t\t\t\t\tview.callEvent(\"onStyleSet\", [name, value]);\n\t\t\t},\n\t\t\tonItemClick: function (id){\n\t\t\t\tvar viewId = view.innerId(id);\n\t\t\t\tif (actions[viewId])\n\t\t\t\t\tactions[viewId].call(this, view);\n\t\t\t\telse\n\t\t\t\t\tview.callEvent(\"onCommand\", [{ id: viewId }]);\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"toolbar\", bar]);\n\treturn bar;\n\n}\n\nfunction ready(view){\n\tview.attachEvent(\"onAfterSelect\", (selected) => setValues(view, selected));\n}\n\nfunction setValues(view, selected) {\n\tconst cell = selected[0];\n\tlet styles = {};\n\n\tif (cell){\n\t\tconst obj = view.getStyle(cell.row, cell.column);\n\t\tstyles = obj ? obj.props : styles;\n\t}\n\tconst barStyles = webix.copy(styles);\n\n\tfor (let i in defaultStyles){\n\t\tif(!barStyles[i])\n\t\t\tbarStyles[i] = defaultStyles[i];\n\t}\n\n\tbarStyles.format = isCustom(barStyles.format) ? \"custom\" : barStyles.format;\n\n\tview.$$(\"bar\").setValues(barStyles);\n}\n\nfunction updateValue(view, name, value){\n\tconst element = view.$$(\"bar\").elements[name];\n\n\tif (element)\n\t\telement.setValue(value);\n}","import {ui, buttonsMap} from \"./buttons\";\n\nexport function toolbarButtons(view,structure){\n\tvar checkButtons = function(cells){\n\t\tfor(var i =0; i < cells.length; i++){\n\t\t\tvar name = cells[i].$button;\n\t\t\tif (name){\n\t\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\t\twebix.extend(cells[i], base);\n\t\t\t}\n\t\t\t\n\t\t\tif(cells[i].rows)\n\t\t\t\tcheckButtons(cells[i].rows);\n\t\t\tif(cells[i].cols)\n\t\t\t\tcheckButtons(cells[i].cols);\n\t\t}\n\t};\n\tcheckButtons(structure);\n\treturn structure;\n}\n\nexport function getButtons(view,structure){\n\tvar config = [];\n\tfor(var block in structure){\n\t\tconfig.push(elementsBlock(view, block, structure[block]));\n\t\tconfig.push(ui.separator());\n\t}\n\treturn config;\n}\n\nfunction blockColumns(view, buttons){\n\tvar cols = [];\n\tfor(var i =0; i < buttons.length; i++){\n\t\tlet name = buttons[i];\n\t\tif(typeof name == \"object\"){\n\t\t\tcols.push(name);\n\t\t}\n\t\telse {\n\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\tcols.push(base);\n\t\t}\n\t}\n\treturn cols;\n}\n\n\nfunction elementsBlock(view, name, columns){\n\tvar block = {\n\t\trows:[\n\t\t\t{\n\t\t\t\tpadding:2,\n\t\t\t\tcols:[{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: blockColumns(view, columns)\n\t\t\t\t}]\n\t\t\t},\n\t\t\tui.title({title:name})\n\t\t]\n\t};\n\treturn block;\n}","import {getTextSize} from \"./styles\";\n\nexport function selectRow(row, view, endRow){\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow:row,\n\t\tcolumn:columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: (endRow || row),\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectAll(view){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow: order[0],\n\t\tcolumn: columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: order[order.length-1],\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectColumn(column, view, endColumn){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar startRow = order[0];\n\tvar lastRow = order[order.length-1];\n\n\tvar start = {row: startRow, column: column};\n\tvar last = {row: lastRow, column: (endColumn || column) };\n\n\t_selectRange(start, last, view);\n}\n\nexport function isColSelected(column, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (column >= selectedArea.start.column && column <= selectedArea.end.column)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function isCellSelected(row, column, view){\n\treturn isRowSelected(row, view) && isColSelected(column, view);\n}\n\nexport function isRowSelected(row, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (row >= selectedArea.start.row && row <= selectedArea.end.row)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function selectColumns(column, view) {\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\n\tif (!selectedArea)\n\t\tselectColumn(column, view);\n\telse {\n\t\tlet col1 = Math.min(selectedArea.start.column, selectedArea.end.column, column);\n\t\tlet col2 = Math.max(selectedArea.start.column, selectedArea.end.column, column);\n\t\tselectColumn(col1, view, col2);\n\t}\n}\n\nfunction _selectRange(a, b, view){\n\tview.$$(\"cells\").addSelectArea(a, b);\n}\n\n\nexport function adjustColumn(column, view) {\n\tlet width = 25;\n\tconst columnWidth = view._table.getColumnConfig(column).width;\n\n\tview._table.eachRow(function(row) {\n\t\tconst span = view._table.getSpan(row, column);\n\t\tif(span && span[2] > 1)\n\t\t\treturn;\n\n\t\tconst text = this.getText(row, column);\n\t\tconst style = view.getStyle(row, column);\n\t\tconst css = style ? style.id : \"\";\n\n\t\tif (text.replace(/<\\/?[^>]+(>|$)/g, \"\")) {\n\t\t\tconst size = getTextSize(view, text, css);\n\n\t\t\tif(view.getCellEditor(row, column) || view.getCellFilter(row, column))\n\t\t\t\tsize.width += 20;\n\t\t\tif(style && style.props.wrap == \"wrap\" && size.width > columnWidth)\n\t\t\t\tsize.width = columnWidth;\n\t\t\tif (size.width > width)\n\t\t\t\twidth = size.width;\n\t\t}\n\t});\n\tview._table.setColumnWidth(column, width);\n}\n\nexport function adjustRow(row, view) {\n\tlet height = 25;\n\n\tview._table.eachColumn(function(column) {\n\t\tif(column != \"rowId\"){\n\t\t\tconst text = this.getText(row, column);\n\t\t\tlet width = this.getColumnConfig(column).width;\n\n\t\t\tconst span = view._table.getSpan(row, column);\n\t\t\tif(span)\n\t\t\t\twidth = view._table.getSpanNode({row:span[0], column:span[1]}).offsetWidth;\n\n\t\t\tlet style = view.getStyle(row, column);\n\t\t\tlet css = style ? style.id : \"\";\n\n\t\t\tif (text.replace(/<\\/?[^>]+(>|$)/g, \"\")) {\n\t\t\t\tlet size = getTextSize(view, text, css, width);\n\t\t\t\tif (size.height > height) height = size.height;\n\t\t\t}\n\t\t}\n\t});\n\tview._table.setRowHeight(row, height);\n}\n\nexport function highlightColRow(start,end, view){\n\tif(!view._table.config.header) return;\n\n\tconst css = \"webix_highlight\";\n\n\tlet sr = start.row, er = end.row, sc = start.column, ec = end.column;\n\tif(er<sr) [sr, er] = [er, sr];\n\tif(ec<sc) [sc, ec] = [ec, sc];\n\n\tview._table.eachRow(function(row){\n\t\tif(row < sr || row > er)\n\t\t\tview._table.removeCellCss(row, \"rowId\", css);\n\t\telse\n\t\t\tview._table.addCellCss(row, \"rowId\", css);\n\t});\n\n\tview._table.eachColumn(function(col){\n\t\tconst node = view._table.getHeaderNode(col);\n\t\tif(col == \"rowId\" || !node) return;\n\n\t\tif(col < sc || col > ec)\n\t\t\twebix.html.removeCss(node, css);\n\t\telse\n\t\t\twebix.html.addCss(node, css, true);\n\t});\n}","import * as cop from \"./operations/column_operations\";\nimport * as nms from \"./helpers/column_names\";\nimport * as fmt from \"./operations/formats\";\n\nexport function init(view, extra){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar datatable = {\n\t\tview:\"datatable\", id:\"cells\", css:\"webix_ssheet_table webix_data_border wss_\"+view.$index,\n\t\theaderRowHeight: webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20,\n\t\tspans: true,\n\t\tleftSplit: 1,\n\t\tareaselect:true,\n\t\tminColumnWidth:38,\n\t\teditable:true,\n\t\teditaction:(extra.liveEditor ? \"custom\" : \"dblclick\"),\n\t\tminRowHeight:1,\n\t\tnavigation:true\n\t};\n\n\t//enable clipboard by default\n\tif (extra.clipboard !== false){\n\t\textra.clipboard = \"custom\";\n\t\tif(extra.clipboardDecimalDelimiter)\n\t\t\textra.templateCopy = function(item) {\n\t\t\t\tif(webix.rules.isNumber(item))\n\t\t\t\t\titem = item.toString().replace(\".\", extra.clipboardDecimalDelimiter);\n\t\t\t\treturn item;\n\t\t\t};\n\t}\n\tif (extra)\n\t\tdatatable = webix.extend(datatable, extra, true);\n\n\treturn datatable;\n}\n\nfunction ready(view){\n\tvar grid = view._table;\n\n\tvar showCommentHandler = webix.event(document.body, \"mousemove\", function(){\n\t\tvar thread;\n\t\treturn function(e) {\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(function(e){\n\t\t\t\tif(view.comments._activeComment.editStatus)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar cell = grid.locate(e);\n\t\t\t\tvar visible = view.comments.commentsView && view.comments.commentsView.isVisible();\n\n\t\t\t\tif(cell && view.comments.get(cell.row, cell.column)){\n\t\t\t\t\tvar activeCell = view.comments._activeComment.cell;\n\t\t\t\t\tif((activeCell && (activeCell.row != cell.row || activeCell.column != cell.column)) || !visible)\n\t\t\t\t\t\tview.callEvent(\"onCommand\",[{id: \"add-comment\", cell, viewonly: true }]);\n\t\t\t\t}\n\t\t\t\telse if(visible && !view.comments.commentsView.$view.contains(e.target))\n\t\t\t\t\tview.callEvent(\"onCommentHide\", []);\n\t\t\t}, true, [e], 250);\n\t\t};\n\t}());\n\n\t//in grid math\n\tif (view.config.math){\n\t\tgrid.config.editMath = true;\n\t}\n\n\t//saving value after edit\n\tgrid.attachEvent(\"onBeforeEditStop\", (st, ed) => {\n\t\t//ignore empty cells\n\t\tif (st.old === webix.undefined && st.value === \"\") return;\n\n\t\tif (st.value != st.old){\n\t\t\tview.setCellValue(ed.row, ed.column, st.value);\n\t\t\tgrid.refresh();\n\t\t}\n\t\tst.value = st.old;\n\t});\n\n\tgrid.attachEvent(\"onEnter\", function(ev){\n\t\tif (grid.getEditor()){\n\t\t\twebix.delay(function(){\n\t\t\t\tgrid.moveSelection(\"down\");\n\t\t\t});\n\t\t}\n\t\twebix.html.preventEvent(ev);\n\t});\n\n\t//prevent editing of locked cells\n\tview.attachEvent(\"onBeforeEditStart\", (row, column) => !view.isCellLocked(row, column));\n\tgrid.attachEvent(\"onBeforeEditStart\", (editor) => \n\t\tview.callEvent(\"onBeforeEditStart\", [editor.row, editor.column]) );\n\n\t//column drag event checking\n\tlet dragStartColumn;\n\tlet dragEndColumn;\n\n\t//column and row selection\n\tgrid.attachEvent(\"onBeforeSelect\", (id) => id.column != \"rowId\" );\n\tgrid.attachEvent(\"onBeforeBlockSelect\", (start, end, finalStep) => {\n\t\tif (finalStep &&\n\t\t(start.column !== \"rowId\" || end.column !== \"rowId\")) {\n\t\t\tif (start.column === \"rowId\") start.column = 1;\n\t\t\tif (end.column === \"rowId\") end.column = 1;\n\t\t}\n\t\tif(start.column !== \"rowId\" || end.column !== \"rowId\"){\n\t\t\tcop.highlightColRow(start,end, view);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t});\n\n\tfunction highlightHeaders(){\n\t\tlet ids = grid.getSelectedId(true);\n\t\tif(ids.length){\n\t\t\tlet start = ids[0];\n\t\t\tlet end = ids[ids.length-1]?ids[ids.length-1]:ids[0];\n\t\t\tcop.highlightColRow(start, end, view);\n\t\t}\n\t\telse {\n\t\t\tlet data = {row:0, column:0};\n\t\t\tcop.highlightColRow(data, data, view);\n\t\t}\n\t}\n\n\tgrid.attachEvent(\"onSelectChange\", () => highlightHeaders());\n\tgrid.attachEvent(\"onColumnResize\", () => {\n\t\twebix.delay(() => highlightHeaders());\n\t});\n\n\twebix.event(grid.$view.firstChild, \"mousedown\", e => {\n\t\tconst resizeColumn = grid.config.resizeColumn;\n\t\tconst col = grid.locate(e);\n\n\t\tif(col && col.cind){\n\t\t\tif(resizeColumn){\n\t\t\t\tconst dx = grid.getColumnConfig(col.column).width;\n\t\t\t\tconst pos = webix.html.posRelative(e);\n\t\t\t\tif(pos.x < resizeColumn.size || dx-pos.x < resizeColumn.size+1)\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\tdragStartColumn = col.cind;\n\t\t}\n\t});\n\n\twebix.event(grid.$view.firstChild, \"mousemove\", e => {\n\t\tif(dragStartColumn){\n\t\t\tconst col = grid.locate(e);\n\n\t\t\tif(col){\n\t\t\t\tdragEndColumn = col.cind;\n\t\t\t\tcop.highlightColRow(\n\t\t\t\t\t{column: grid.columnId(dragStartColumn)},\n\t\t\t\t\t{column: grid.columnId(dragEndColumn||1)},\n\t\t\t\t\tview\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n\n\tconst selectColumnHandler = webix.event(document.body, \"mouseup\", () => {\n\t\tif(dragStartColumn){\n\t\t\tif(dragEndColumn != null){\n\t\t\t\tcop.selectColumn(\n\t\t\t\t\tgrid.columnId(dragStartColumn),\n\t\t\t\t\tview,\n\t\t\t\t\tgrid.columnId(dragEndColumn||1)\n\t\t\t\t);\n\t\t\t\tdragEndColumn = null;\n\t\t\t}\n\t\t\tdragStartColumn = null;\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onItemDblClick\", (id) => {\n\t\tif (id.column === \"rowId\")\n\t\t\tcop.adjustRow(id.row, view);\n\t});\n\n\tlet lastHeaderClick = 0;\n\tgrid.attachEvent(\"onHeaderClick\", (id, e) => {\n\t\tif(id.column == \"rowId\"){\n\t\t\tcop.selectAll(view);\n\t\t\treturn;\n\t\t}\n\t\tlet headerClick = new Date();\n\t\tlet dblClick = (headerClick - lastHeaderClick <= 300);\n\n\t\tif (dblClick) {\n\t\t\tcop.adjustColumn(id.column, view);\n\t\t} else {\n\t\t\tlastHeaderClick = headerClick;\n\t\t\tif (e.shiftKey) {\n\t\t\t\tcop.selectColumns(id.column, view);\n\t\t\t} else {\n\t\t\t\tcop.selectColumn(id.column, view);\n\t\t\t}\n\t\t}\n\t});\n\n\t//select rows by shift click\n\tvar lastClickedRow = null;\n\tgrid.attachEvent(\"onItemClick\", (cell, e) => {\n\t\tif (cell.column === \"rowId\") {\n\t\t\tif (!e.shiftKey)\n\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\telse {\n\t\t\t\tif (!lastClickedRow)\n\t\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\t\telse\n\t\t\t\t\tcop.selectRow(lastClickedRow, view, cell.row);\n\t\t\t}\n\t\t\tlastClickedRow = cell.row;\n\t\t}\n\t});\n\n\t//reset API\n\tview.attachEvent(\"onReset\", () => reset(view));\n\n\tview.attachEvent(\"onBeforeSheetShow\", () => grid.editStop());\n\n\tgrid.attachEvent(\"onBlur\", function(){\n\t\t//after focus moved out, check and if it is somewhere\n\t\t//on the spreadsheet controls them move focus back to datatable\n\t\twebix.delay(function(){\n\t\t\tvar target = document.activeElement;\n\n\t\t\tif (target && target.tagName == \"INPUT\") return;\n\n\t\t\tvar focus = webix.UIManager.getFocus();\n\t\t\tvar need_focus = focus &&\n\t\t\t\tfocus != grid &&\n\t\t\t\tfocus.getTopParentView &&\n\t\t\t\tfocus.getTopParentView() === view;\n\n\t\t\tif (need_focus)\n\t\t\t\twebix.UIManager.setFocus(grid);\n\n\t\t}, this, [], 100);\n\t});\n\n\tsetDefaultCss(view);\n\n\tview.attachEvent(\"onDestruct\", () => {\n\t\twebix.eventRemove(showCommentHandler);\n\t\twebix.eventRemove(selectColumnHandler);\n\t});\n}\n\nexport function cell_template(view, obj, common, value, column, valueOnly){\n\tconst col = column.id;\n\tconst row = obj.id;\n\tlet css = \"\";\n\n\tconst text = value === \"\" || isNaN(value);\n\tconst format = fmt.getFormatName(view, row, col);\n\tconst invalidDate = fmt.checkFormat(format, \"date\") && fmt.isDateInvalid(value);\n\n\tlet extra = \"\";\n\tif (!valueOnly){\n\t\textra += view.comments.get(row, col) ? \"<div class='ssheet_commented_sign'></div>\" : \"\";\n\t\textra += view.getCellFilter(row, col) ? \"<div class='ssheet_filter_sign'></div>\" : \"\";\n\t}\n\n\t//text can be formatted only in case of string number format\n\tif(!invalidDate && (!text || fmt.checkFormat(format, \"string\"))){\n\t\tif (format){\n\t\t\tconst cell = { css:\"\" };\n\t\t\tconst helper = fmt.getFormat(format);\n\t\t\tif (helper){\n\t\t\t\tlet newValue = helper(value, cell);\n\n\t\t\t\tif(newValue != webix.i18n.spreadsheet.table[\"format-error\"]){\n\t\t\t\t\tif (cell.css)\n\t\t\t\t\t\tcss = `class=\"${cell.css}\"`;\n\t\t\t\t\tvalue = newValue;\n\t\t\t\t}\n\t\t\t\telse if(!text)\n\t\t\t\t\tvalue = value * 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tvalue = value * 1;\n\t}\n\n\tif(webix.isUndefined(value) || value === null)\n\t\tvalue = \"\";\n\n\treturn `<div ${css}>${value}</div>${extra}`;\n}\n\nexport function reset(view){\n\tconst grid = view.$$(\"cells\");\n\tgrid.clearAll();\n\n\tconst columns = view.config.columnCount;\n\tconst rows = view.config.rowCount;\n\n\tconst cols = [{\n\t\tid:\"rowId\", header:\"\", width:40,\n\t\tcss:\"sheet_column_0\",\n\t\ttemplate:(el) => {\n\t\t\treturn el.id;\n\t\t}\n\t}];\n\n\tfor (let i=1; i<=columns; i++){\n\t\tcols.push({\n\t\t\tid:i,\n\t\t\teditor:\"text\",\n\t\t\theader:{\n\t\t\t\ttext: nms.encode[i]\n\t\t\t},\n\t\t\ttemplate:function(obj, common, value, column){\n\t\t\t\treturn cell_template(view, obj, common, value, column);\n\t\t\t}\n\t\t});\n\t\tview.callEvent(\"onColumnInit\",[cols[i]]);\n\t}\n\tgrid.refreshColumns(cols);\n\n\tconst data = [];\n\tfor (let i=1; i<=rows; i++)\n\t\tdata.push({ id:i });\n\n\tgrid.parse(data);\n}\n\n// nowrap by default\nfunction setDefaultCss(view){\n\twebix.html.addStyle(\"#\"+view._table.$view.id+\".webix_dtable .webix_cell { white-space:nowrap;}\");\n}\n","import group from \"./operations/undo_group\";\nimport {selectAll} from \"./operations/column_operations\";\nimport {styleFormats} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tvar grid = view.$$(\"cells\");\n\n\tvar key = webix.env.isMac ? \"command\" : \"ctrl\";\n\twebix.UIManager.addHotKey(key+\"-a\", () => { if(!grid.getEditor()) selectAll(view); }, grid);\n\n\tif(!view.config.readonly){\n\t\twebix.UIManager.addHotKey(\"any\", (view, ev) => {\n\t\t\t//ignore shift key\n\t\t\tif ((ev.which || ev.keyCode)  == 16) return;\n\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tgrid.$anyKey = true;\n\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"enter\", (view) => {\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tif(view.config.liveEditor)\n\t\t\t\t\tgrid.callEvent(\"onBeforeLiveEditor\", [sel[0]]);\n\t\t\t\telse\n\t\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"backspace\", () => del(view), grid);\n\t\twebix.UIManager.addHotKey(\"delete\", () => del(view), grid);\n\n\t\tvar redo = webix.env.isMac ? \"command-shift-z\" : \"ctrl-y\";\n\t\twebix.UIManager.addHotKey(redo, () => view.redo(), grid);\n\t\twebix.UIManager.addHotKey(key+\"-z\", () => view.undo(), grid);\n\n\t\twebix.UIManager.addHotKey(key+\"-b\", () => styleHotKey(view, \"font-weight\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-i\", () => styleHotKey(view, \"font-style\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-u\", (v, e) => ctrlU(view, e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-p\", (v, e) => ctrlP(view, e), grid);\n\t}\n}\n\nfunction del(view) {\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => view.setCellValue(cell.row,cell.column, \"\"));\n\t\tview.refresh();\n\t});\n}\n\nfunction ctrlU(view, e) {\n\tstyleHotKey(view, \"text-decoration\");\n\treturn webix.html.preventEvent(e);\n}\nfunction ctrlP(view, e) {\n\tview.callEvent(\"onCommand\",[{id: \"print\"}]);\n\treturn webix.html.preventEvent(e);\n}\n\nfunction styleHotKey(view, attr) { \n\tvar cell = view.getSelectedId();\n\tif(cell){\n\t\tvar style = view.getStyle(cell.row, cell.column);\n\n\t\tvar elementOn = styleFormats[attr];\n\t\tvar elementOff = \"normal\";\n\n\t\tvar state = (style && style.props[attr] === elementOn)? elementOff : elementOn;\n\t\tview.callEvent(\"onStyleSet\", [attr, state]);\n\t}\n}","import {_to_number, _combine} from \"./helpers\";\n\n/*Empty cells, logical values like TRUE, or text are ignored.*/\nexport function SUM(){\n\tvar sum = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false) sum+=v;\n\t}\n\treturn sum;\n}\n\n/*If a range or cell reference argument contains text, logical values, or empty cells, those values are ignored; \nhowever, cells with the value zero are included.*/\nexport function AVERAGE(){\n\tvar sum = 0, count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false){\n\t\t\tsum+=v; count++;\n\t\t}\n\t}\n\treturn sum/count;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are not counted. */\nexport function COUNT(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false)\n\t\t\tcount++;\n\t}\n\treturn count;\n}\n\n/*counts the number of cells that are not empty in a range, zero is excluded.*/\nexport function COUNTA(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(set[i] && set[i]*1 !==0 ) count++;\n\treturn count;\n}\n\n/*Counts empty cells in a specified range of cells. Cells with zero values are not counted.*/\nexport function COUNTBLANK(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(!set[i]*1) count++;\n\treturn count;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored.\nIf the arguments contain no numbers, MAX returns 0 (zero).*/\nexport function MAX(){\n\tvar max = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v>max || max ===\"\"))\n\t\t\tmax = v;\n\t}\n\treturn max || 0;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored. \nIf the arguments contain no numbers, MIN returns 0.*/\nexport function MIN(){\n\tvar min = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v<min || min ===\"\"))\n\t\t\tmin = v;\n\t}\n\treturn min || 0;\n}\n\n/* Only numbers in the array or reference are multiplied. \nEmpty cells, logical values, and text in the array or reference are ignored.*/\nexport function PRODUCT(){\n\tvar product = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tproduct = product===\"\"?v:product*v;\n\t}\n\treturn product;\n}\n\n/* For valid products only numbers are multiplied. Empty cells, logical values, and text are ignored.\nTreats array entries that are not numeric as if they were zeros.*/\nexport function SUMPRODUCT(sets){\n\tvar length = sets[0].length;\n\tfor(let i in sets)\n\t\tif(sets[i].length !== length)\n\t\t\treturn;\n\n\tvar sp = 0;\n\tfor (let i = 0; i < sets[0].length; i++){\n\t\tvar product = \"\";\n\t\tfor(var s in sets){\n\t\t\tvar v = _to_number(sets[s][i]);\n\t\t\tif(v !== false) product = product===\"\" ? v: product*v;\n\t\t\telse{ product = 0; break; }\n\t\t}\n\t\tif(!webix.isUndefined(product)) sp+=product;\n\t}\n\treturn sp;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function SUMSQ(){\n\tvar sq = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(typeof v ===\"number\")\n\t\t\tsq += Math.pow(v, 2);\n\t}\n\treturn sq;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function VARP(){\n\tvar set = _combine(arguments);\n\tvar count = this.COUNT(set);\n\tvar avg = this.AVERAGE(set);\n\t\n\tvar sum = 0;\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tsum += Math.pow(v - avg, 2);\n\t}\n\treturn sum/count;\n}\n\n/* Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function STDEVP(){\n\tvar set = _combine(arguments);\n\treturn Math.sqrt(this.VARP(set));\n}\n\n/*real numbers*/\nexport function POWER(num, pow){\n\tvar n = _to_number(num), p = _to_number(pow);\n\tif(typeof n == \"number\" && typeof p ==\"number\")\n\t\treturn Math.pow(n, p);\n\t\n}\n\n/*real numbers*/\nexport function QUOTIENT(num, div){\n\tvar n = _to_number(num), d = _to_number(div);\n\tif(typeof n == \"number\" && typeof d ==\"number\")\n\t\treturn n/d;\n}\n\n/*Returns a positive square root.*/\nexport function SQRT(num){\n\tvar v = _to_number(num);\n\tif(v !== false && v>=0)\n\t\treturn Math.sqrt(v);\n}\n\nexport function ABS(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.abs(v);\n}\n\nexport function RAND(){\n\treturn Math.random();\n}\n\nexport function PI(){\n\treturn Math.PI;\n}\n\n/*Rounds a number down to the nearest integer*/\nexport function INT(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.round(v);\n}\n\n/*rounds a number to a specified number of digits*/\nexport function ROUND(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn parseFloat(v.toFixed(d));\n}\n\n/*rounds a number down to a specified number of digits*/\nexport function ROUNDDOWN(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn  Math.floor(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*rounds a number up to a specified number of digits*/\nexport function ROUNDUP(num,digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn Math.ceil(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*Truncates a number to an integer by removing the fractional part of the number.*/\nexport function TRUNC(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn parseInt(v);\n}\n\n/*Returns number rounded up to the nearest even integer*/\nexport function EVEN(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r+1:r;\n\t}\n}\n\n/*Returns number rounded up to the nearest odd integer*/\nexport function ODD(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r:r+1;\n\t}\n}","export function CONCATENATE(){\n\tvar data = Array.prototype.slice.call(arguments);\n\tdata = data.map(function(obj){\n\t\tif (typeof obj === \"object\")\n\t\t\treturn obj.join(\"\");\n\t\treturn obj;\n\t});\n\treturn data.join(\"\");\n}\n \nexport function LEFT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(0, count);\n}\n\nexport function MID(text, start, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(start, start + count);\n}\n\nexport function RIGHT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(text.length - count);\n}\n\nexport function LOWER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toLowerCase();\n}\n\nexport function UPPER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toUpperCase();\n}\n\nexport function PROPER(text) {\n\tif (!text) { return \"\"; }\n\tvar temp = text.toLowerCase().split(\" \");\n\ttext = \"\";\n\tfor (var idx in temp) {\n\t\ttext += (text ? \" \" : \"\") + temp[idx].substring(0, 1).toUpperCase() + temp[idx].substring(1);\n\t}\n\treturn text;\n}\n\nexport function TRIM(text) {\n\tif (!text) { return \"\"; }\n\treturn text.trim();\n}\n\nexport function LEN(text) {\n\tif (!text && text !== 0) { return 0; }\n\treturn text.toString().length;\n}","import {getJsDateFromExcel, getExcelDateFromJs, dayOfTheYear} from \"./helpers\";\n\nexport function DATE(year, month, day){\n\tconst date = new Date(year, month-1, day);\n\treturn getExcelDateFromJs(date);\n}\n\nexport function TIME(hour, minute, second){\n\tconst date = new Date(1900, 0, 1, hour, minute, second);\n\treturn getExcelDateFromJs(date);\n}\n\nexport function DAY(date){\n\treturn getJsDateFromExcel(date).getDate();\n}\n\nexport function MONTH(date){\n\treturn getJsDateFromExcel(date).getMonth()+1;\n}\n\nexport function YEAR(date){\n\treturn getJsDateFromExcel(date).getFullYear();\n}\n\nexport function NOW(){\n\tconst date = new Date();\n\treturn getExcelDateFromJs(date);\n}\n\nexport function DATEDIF(start, end, unit){\n\tif(unit != \"D\"){\n\t\tstart = getJsDateFromExcel(start);\n\t\tend = getJsDateFromExcel(end);\n\t}\n\n\tswitch(unit){\n\t\tcase \"Y\":\n\t\t\treturn end.getFullYear() - start.getFullYear();\n\t\tcase \"M\":{\n\t\t\tlet months = (end.getFullYear() - start.getFullYear()) * 12;\n\t\t\treturn months + end.getMonth() - (start.getMonth());\n\t\t}\n\t\tcase \"D\":{ \n\t\t\treturn Math.floor(end - start);\n\t\t}\n\t\tcase \"MD\":{\n\t\t\tconst diff = end.getDate() - start.getDate();\n\t\t\tif(diff < 0){\n\t\t\t\tconst startDateDays = new Date(start.getFullYear(), start.getMonth() + 1, 0).getDate();\n\t\t\t\treturn end.getDate() + startDateDays - start.getDate();\n\t\t\t}\n\t\t\treturn diff;\n\t\t}\n\t\tcase \"YM\":{\n\t\t\tconst months = end.getMonth() - start.getMonth();\n\t\t\treturn months < 0 ? 12 + months : months;\n\t\t}\n\t\tcase \"YD\":{\n\t\t\tconst diff = dayOfTheYear(end) - dayOfTheYear(start);\n\t\t\treturn diff < 0 ? 365 + diff : diff;\n\t\t}\n\t}\n}","export function IMAGE(url){\n\treturn `<img class=\"webix_ssheet_cimage\" src=\"${webix.template.escape(url)}\">`;\n}\n\nexport function SPARKLINE(arr, type, color1, color2){\n\tvar i, config = { type: type, color: color1, negativeColor:color2  },\n\t\twidth =  type == \"pie\"? 60: 150;\n\tfor(i =0 ; i < arr.length; i++)\n\t\tarr[i] = arr[i]||0;\n\treturn webix.Sparklines.getTemplate(config)(arr, { width:width, height: 35 });\n}\n\nexport function HYPERLINK(url, text){\n\ttext = text || url;\n\treturn `<a target=\"blank\" href=\"${webix.template.escape(url)}\">${webix.template.escape(text)}</a>`;\n}\n\nexport function IF(check, pos, neg){\n\tif (check)\n\t\treturn pos;\n\telse\n\t\treturn neg;\t\n}","import * as numbers from \"./methods/numbers\";\nimport * as strings from \"./methods/strings\";\nimport * as date from \"./methods/date\";\nimport * as other from \"./methods/other\";\n\nexport const methods = {};\n\nwebix.extend(methods, numbers);\nwebix.extend(methods, strings);\nwebix.extend(methods, date);\nwebix.extend(methods, other);\n\nexport function addMethod(name, handler){\n\tmethods[name] = handler;\n}","import {getFormatName, checkFormat, isDateInvalid} from \"./formats\";\nimport {getExcelDateFromJs} from \"../math/methods/helpers\";\nimport {getMathFormat} from \"../math/parser\";\n\nexport function init(view){\n\tview.attachEvent(\"onCellChange\", function(row, col, value, type){\n\t\tif(!this._setType){\n\t\t\tconst format = getFormatName(this, row, col);\n\t\t\tsetType(this, row, col, format, type);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeFormatChange\", function(row, col, format){\n\t\tif(!this._setType)\n\t\t\tsetType(this, row, col, format, null, true);\n\t});\n\n\tview.attachEvent(\"onAction\", function(action, values){\n\t\tif(action == \"dropdown\" && values.newValue && values.newValue.editor == \"excel_date\"){\n\t\t\tconst format = getFormatName(this, values.row, values.column);\n\t\t\tif(getFormatType(format) != \"date\")\n\t\t\t\tthis.setFormat(values.row, values.column, webix.i18n.spreadsheet.formats.dateFormat);\n\t\t}\n\t});\n}\n\nfunction getExpectType(view, row, col, value, parseDate, isFormula, formatType, style){\n\t//date based math\n\tlet type = \"string\";\n\tif(!webix.isUndefined(value)){\n\t\tif(isFormula){\n\t\t\ttype = \"number\";\n\n\t\t\tif(/^=(now|date|time)\\(/i.test(value))\n\t\t\t\ttype = \"date\";\n\t\t}\n\t\telse if(!isNaN(value))\n\t\t\ttype = \"number\";\n\t\telse if(formatType != \"string\" && parseDate){\n\t\t\t//if user types a date string, or it comes from Excel import\n\t\t\t//set date type and convert string to Excel date\n\t\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\t\tvalue  = parser(value);\n\t\t\tif(!isNaN(value)*1){\n\t\t\t\t//change cell style - value changes once (some value -> 35767.5)\n\t\t\t\t//change cell value - value changes twice (some value -> \"12/03/97\" -> 35767.5)\n\t\t\t\t//so ignore undo for cell value change\n\t\t\t\tif(style)\n\t\t\t\t\tdateToExcel(view, row, col, value);\n\t\t\t\telse\n\t\t\t\t\tview.ignoreUndo(() => dateToExcel(view, row, col, value));\n\n\t\t\t\ttype = \"date\";\n\t\t\t}\n\t\t}\n\t}\n\treturn type;\n}\n\nfunction dateToExcel(view, row, col, value){\n\tvalue = getExcelDateFromJs(value);\n\tview.setCellValue(row, col, value);\n}\n\nfunction checkType(type, expectType, formatType, isFormula, value){\n\ttype = type || expectType;\n\n\t//strings will always have string type regardless of format\n\tif(expectType == \"string\")\n\t\ttype = \"string\";\n\telse if(formatType)\n\t\ttype = formatType;\n\n\tif(type == \"date\" && !isFormula && isDateInvalid(value))\n\t\ttype = \"number\";\n\n\treturn type;\n}\n\nfunction getFormatType(format){\n\tlet formatType = format ? \"number\" : null;\n\tif(checkFormat(format, \"string\"))\n\t\tformatType = \"string\";\n\telse if(checkFormat(format, \"date\"))\n\t\tformatType = \"date\";\n\treturn formatType;\n}\n\nexport function getType(view, row, column){\n\tconst types = view.getRow(row).$cellType;\n\tif (types && types[column])\n\t\treturn types[column];\n}\n\nfunction setType(view, row, col, format, type, style){\n\t//prevent type change during value or format change\n\tview._setType = true;\n\tlet value = view.getCellValue(row, col);\n\n\tconst isFormula = typeof value == \"string\" && value[0] == \"=\";\n\tconst parseDate = (!style || format == \"date\") && (!view._loading_data || type == \"date\");\n\n\tconst mathFormat = isFormula && !format ? getMathFormat(view, value) : null;\n\n\tconst formatType = getFormatType(format || mathFormat);\n\tconst expectType = getExpectType(view, row, col, value, parseDate, isFormula, formatType, style);\n\n\ttype = checkType(type, expectType, formatType, isFormula, value);\n\tupdateCell(view, row, col, type, expectType, formatType, mathFormat);\n\n\tconst item = view.getRow(row);\n\tif(!item.$cellType)\n\t\titem.$cellType = {};\n\titem.$cellType[col] = type;\n\n\tdelete view._setType;\n}\n\n\n\nfunction updateCell(view, row, col, type, expectType, formatType, mathFormat){\n\tlet value = view.getCellValue(row, col);\n\tconst isFormula = typeof value == \"string\" && value[0] == \"=\";\n\tconst cellEditor = view.getCellEditor(row, col);\n\n\tif(mathFormat)\n\t\tview.setFormat(row, col, mathFormat.fmt);\n\telse if(type == \"date\"){\n\t\t// add default date format\n\t\tif(formatType != \"date\"){\n\t\t\tconst isTime = isFormula && value.toUpperCase().indexOf(\"=TIME(\") == 0;\n\t\t\tconst locale = webix.i18n.spreadsheet.formats;\n\t\t\tconst format = isTime ? locale.timeFormat : locale.dateFormat;\n\t\t\tview.setFormat(row, col, format);\n\t\t}\n\n\t\t//set date editor for cells with date type\n\t\tif(!isFormula && !cellEditor)\n\t\t\tview.setCellEditor(row, col, {editor: \"excel_date\"});\n\t}\n\telse if(formatType != \"string\" && type == \"string\" && expectType != \"string\"){\n\t\t//force text format for numbers typed as strings\n\t\tview.setFormat(row, col, \"@\");\n\t}\n\n\t//remove date editor\n\tif((type != \"date\" || isFormula) && cellEditor && cellEditor.editor == \"excel_date\")\n\t\tview.setCellEditor(row, col, null);\n}\n","import * as methods from \"./math/methods\";\nimport {getJsDateFromExcel} from \"./math/methods/helpers\";\nimport {getDateEditFormat} from \"./operations/formats\";\nimport {getType} from \"./operations/types\";\n\nlet methodsName = [];\nfor(let i in methods.methods)\n\tif( i!=\"__esModule\") methodsName.push(i);\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\treturn {\n\t\tview:\"toolbar\",\n\t\tcss:\"webix_ssheet_toolbar\",\n\t\telements:[\n\t\t\t{\n\t\t\t\tview:\"label\",\n\t\t\t\tlabel:webix.i18n.spreadsheet.liveEditor[\"edit\"],\n\t\t\t\twidth:60\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"live-editor\",\n\t\t\t\tdisabled:true,\n\t\t\t\tid:\"liveEditor\",\n\t\t\t\tsuggestData: methodsName\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tvar editor = view.$$(\"liveEditor\");\n\n\t//block native editor, and move focus to the custom input\n\t//edit by key press\n\tview._table.attachEvent(\"onBeforeEditStart\", function(cell){\n\t\tlet mode = view._table.$anyKey;\n\t\tview._table.$anyKey = false;\n\n\t\treturn startEdit(this, cell, mode);\n\t});\n\t//edit by enter key\n\tview._table.attachEvent(\"onBeforeLiveEditor\", function(cell){\n\t\treturn startEdit(this, cell, false);\n\t});\n\t//edit by dbl-click\n\tview._table.attachEvent(\"onItemDblClick\", function(id){\n\t\tif(view.getCellEditor(id.row, id.column))\n\t\t\tthis.edit(id);\n\t\teditor.focus();\n\t});\n\n\tview._table.attachEvent(\"onAfterScroll\", function(){\n\t\tif(editor.$view.contains(document.activeElement))\n\t\t\teditor.paintValue();\n\t});\n\n\tview.attachEvent(\"onCellChange\", (r,c,v) => {\n\t\tvar cell = editor.config.activeCell;\n\t\tif (cell && cell.row == r && cell.column == c)\n\t\t\teditor.setValue(v);\n\t});\n\n\tview.attachEvent(\"onAfterSelect\", (data) => {\n\t\tif (!view.$handleSelection){\n\t\t\tlet cell = data[0];\n\t\t\tfillEditor(cell);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onChange\", (mode) => {\n\t\tif (mode == \"update\" && editor.isEnabled()){\n\t\t\tconst cell = editor.config.activeCell;\n\t\t\tif(cell && editor.getValue() != view.getCellValue(cell.row, cell.column)){\n\t\t\t\tdelete editor._update_range;\n\t\t\t\teditor.showActiveSheet();\n\t\t\t\teditor.updateCellValue();\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeSheetShow\", (name)=> {\n\t\tconst cell = editor.config.activeCell;\n\t\tif(cell){\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\t\t\tif(view.getCellValue(cell.row, cell.column) != val){\n\t\t\t\tif(!editor._activeMath)\n\t\t\t\t\teditor._activeMath = view.getActiveSheet();\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tif(name == editor._activeMath){\n\t\t\t\t\t\tview.$handleSelection = null;\n\t\t\t\t\t\tconst cell = editor.config.activeCell;\n\t\t\t\t\t\tview._table.select(cell.row, cell.column);\n\t\t\t\t\t}\n\n\t\t\t\t\teditor.setValue(val);\n\t\t\t\t\t//update highlight\n\t\t\t\t\teditor.refresh();\n\n\t\t\t\t\teditor.focus();\n\t\t\t\t\teditor.getInputNode().setSelectionRange(cursor, cursor);\n\t\t\t\t\teditor.paintValue();\n\n\t\t\t\t\tview.$handleSelection = function(a,b,st,en){ return pasteRange(st, en, a); };\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t\tclearEditor();\n\t\t}\n\t});\n\n\tview.attachEvent(\"onReset\", () => view.$handleSelection = null);\n\n\tview.attachEvent(\"onAfterLoad\", () => clearEditor());\n\n\tview.attachEvent(\"onAction\", function(name, options){\n\t\tconst cell = editor.config.activeCell;\n\t\tconst isActiveCell = cell && cell.row == options.row && cell.column == options.column;\n\t\tif(isActiveCell && (name == \"lock\" || name == \"dropdown\"))\n\t\t\tdisableEditor(options.row, options.column);\n\t});\n\n\tview.attachEvent(\"onFormatChange\", (r, c) => updateEditor(r, c));\n\tview.attachEvent(\"onCellChange\", (r, c) => updateEditor(r, c));\n\n\tfunction updateEditor(row, column){\n\t\tconst activeCell = editor.config.activeCell;\n\t\tif(activeCell && activeCell.row == row && activeCell.column == column)\n\t\t\tfillEditor({row, column});\n\t}\n\n\tfunction startEdit(table, cell, clear){\n\t\t//do not interfere with custom editors\n\t\tif (!view.getCellEditor(cell.row, cell.column) && fillEditor(cell, clear)){\n\t\t\teditor.focus();\n\t\t\tif(!clear)\n\t\t\t\teditor.paintValue();\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction disableEditor(row,column){\n\t\tconst disabled = view.getCellEditor(row, column) || view.isCellLocked(row, column);\n\t\tif(disabled)\n\t\t\teditor.disable();\n\t\telse\n\t\t\teditor.enable();\n\t\treturn disabled;\n\t}\n\n\tfunction fillEditor(cell, clear){\n\t\tconst disabled = disableEditor(cell.row, cell.column);\n\t\teditor.config.activeCell = cell;\n\t\teditor.setValue( clear ? \"\" : getCellValue(cell.row, cell.column) );\n\n\t\tview.$handleSelection = disabled ? null : function(a,b,st,en){ return pasteRange(st, en, a); };\n\t\treturn !disabled;\n\t}\n\n\tfunction getCellValue(row, column){\n\t\tlet value = view.getCellValue(row, column);\n\t\tif(getType(view, row, column) == \"date\" && value[0] != \"=\"){\n\t\t\tconst format = getDateEditFormat(view.getRow(row), column);\n\t\t\tvalue = format(getJsDateFromExcel(value));\n\t\t}\n\t\treturn value;\n\t}\n\n\tfunction pasteRange(st, en, cell){\n\t\tlet sheet = \"\";\n\t\tif(editor._activeMath){\n\t\t\tconst activeSheet = view.getActiveSheet();\n\t\t\tif(editor._activeMath != activeSheet)\n\t\t\t\tsheet = editor.prepareSheet(activeSheet);\n\t\t}\n\n\t\tconst range = st == en ? sheet+st : `${sheet+st}:${sheet+en}`;\n\t\tconst updateRange = editor._update_range;\n\n\t\tif(updateRange && updateRange.pos == editor.getInputNode().selectionStart - updateRange.len)\n\t\t\teditor.setRange(range, true);\n\t\telse if(editor.expectOperator())\n\t\t\teditor.setRange(range);\n\t\telse\n\t\t\treturn endEdit(cell);\n\n\t\twebix.delay(() => {\n\t\t\teditor.focus();\n\t\t\teditor.paintValue();\n\t\t});\n\n\t\treturn false;\n\t}\n\n\tfunction endEdit(st){\n\t\tif (editor.isEnabled()){\n\t\t\teditor.showActiveSheet();\n\t\t\teditor.updateCellValue();\n\t\t\teditor.setValue(st ? view.getCellValue(st.row, st.column) : \"\");\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction clearEditor(){\n\t\teditor.define({activeCell:null});\n\t\teditor.setValue(\"\");\n\t\teditor.disable();\n\t}\n}\n","export function find(arr, func){\n\tvar result = findIndex(arr, func);\n\treturn arr[result];\n}\n\nexport function findIndex(arr, func){\n\tvar result = -1;\n\tfor(var i =0; result<0 && i < arr.length; i++){\n\t\tif(func(arr[i]))\n\t\t\tresult = i;\n\t}\n\treturn result;\n}\n\nexport function getDimension(data, rows, cols){\n\t//var [ row, column, value, style] = obj.data[i];\n\tfor (var i=0; i<data.length; i++){\n\t\tlet line = data[i];\n\t\tif (line[0]>rows) rows=line[0];\n\t\tif (line[1]>cols) cols=line[1];\n\t}\n\treturn [rows*1, cols*1];\n}","import * as arr from \"./helpers/array\";\n\nconst options = [\n\t\"rename-sheet\",\n\t\"remove-sheet\"\n];\n\nconst actionMap = {\n\t\"remove-sheet\": function(view){\n\t\tview.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"sheet-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tremove(view, view._activeSheet);\n\t\t});\n\t},\n\t\"rename-sheet\": function(view){\n\t\tedit(view, view._activeSheet);\n\t},\n\t\"new-sheet\": function(view){\n\t\tadd(view);\n\t},\n\t\"copy-sheet\": function(view){\n\t\tcopy(view);\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n}\n\nexport function defaultBottom(view){\n\tvar readonly = view.config.readonly;\n\tvar tabWidth = view.config.sheetTabWidth;\n\tvar toolbar =  {\n\t\tview: \"toolbar\",\n\t\tid: \"bottom-toolbar\",\n\t\tcss: \"webix_ssheet_bottom_toolbar webix_layout_toolbar\",\n\t\tpaddingY: 0,\n\t\theight: 34,\n\t\telements:[\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"add-sheet\",\n\t\t\t\tlabel: \"<span class='webix_ssheet_icon_add_sheet'></span>\",\n\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"add-sheet\"]||\"\", hidden:readonly\n\t\t\t},\n\t\t\t{\n\t\t\t\tid:\"sheets\",\n\t\t\t\tview:\"sheets\",\n\t\t\t\twidth: 5 * tabWidth,\n\t\t\t\teditable:!readonly,\n\t\t\t\teditaction: \"dblclick\",\n\t\t\t\teditor:\"text\",\n\t\t\t\teditValue:\"value\",\n\t\t\t\ttype:{\n\t\t\t\t\twidth: tabWidth,\n\t\t\t\t\theight: 32,\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\treturn \"<div>\"+obj.value+\"</div>\"+\n\t\t\t\t\t\t\t(!readonly?\"<div class='webix_input_icon wxi-menu-down webix_ssheet_sheet_arrow'></div>\":\"\");\n\t\t\t\t\t},\n\t\t\t\t\t//remove skin selection css on dnd\n\t\t\t\t\tcss:\"ssheet_order_sheets\"\n\t\t\t\t},\n\t\t\t\tonClick:{\n\t\t\t\t\twebix_ssheet_sheet_arrow: function(e, id){\n\t\t\t\t\t\tinitSheetMenu(view, e, id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonItemClick: function(id){\n\t\t\t\t\t\tif(id != view._activeSheet)\n\t\t\t\t\t\t\tview.showSheet(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"prev-sheet\", disabled:true, hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-left'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, -1);}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"next-sheet\", hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-right'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, 1);}\n\t\t\t}\n\t\t]\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"bottom-toolbar\", toolbar]);\n\n\treturn toolbar;\n}\n\nfunction scrollSheets(view, direction){\n\tvar sheets = view.$$(\"sheets\");\n\tsheets.scrollTo(sheets.getScrollState().x+(direction*view.config.sheetTabWidth), 0);\n}\n\nfunction menuInit(view){\n\tvar data = [];\n\tfor(var i=0; i < options.length;i++)\n\t\tdata.push({id: options[i], value:webix.i18n.spreadsheet.menus[options[i]]||options[i]});\n\n\tvar menu =  {\n\t\tview: \"ssheet-suggest\",\n\t\tdata: data\n\t};\n\tview.callEvent(\"onViewInit\", [\"sheet-menu\", menu]);\n\treturn menu;\n}\n\nexport function reset(view, obj){\n\tlet tabs = view.$$(\"sheets\");\n\tif (tabs){\n\t\ttabs.clearAll();\n\t\tlet set = [];\n\t\tobj.sheets.forEach(function(sheet){\n\t\t\tset.push({id:sheet.name, value: sheet.name});\n\t\t});\n\t\ttabs.parse(set);\n\t}\n}\n\nfunction ready(view){\n\tprepare(view);\n\n\tif(view.$$(\"add-sheet\"))\n\t\tview.$$(\"add-sheet\").attachEvent(\"onItemClick\", function(){\n\t\t\tadd(view);\n\t\t});\n\n\tview.attachEvent(\"onAfterSheetShow\", (name) => selectSheet(view,name));\n\n\tview.attachEvent(\"onCommand\", function(command){\n\t\tif(actionMap[command.id])\n\t\t\tactionMap[command.id](this);\n\t});\n\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").data.attachEvent(\"onStoreUpdated\", () => changePagerVisability(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterScroll\", () => changePagerStatus(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterDrop\", (context) => dataOrder(view,context.start,context.index));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterEditStop\", (state) => rename(view,state.old,state.value));\n\t}\n}\n\nfunction initSheetMenu(view, e, id){\n\tif(!view.$sheetMenu){\n\t\tview.$sheetMenu = webix.ui(menuInit(view));\n\t\tview._destroy_with_me.push(view.$sheetMenu);\n\t\tview.$sheetMenu.attachEvent(\"onItemClick\", (id)=> callAction(view,id));\n\t}\n\n\tif(view.$sheetMenu.getItem(\"remove-sheet\"))\n\t\tif(view.$$(\"sheets\").count() == 1)\n\t\t\tview.$sheetMenu.disableItem(\"remove-sheet\");\n\t\telse\n\t\t\tview.$sheetMenu.enableItem(\"remove-sheet\");\n\tif(view.callEvent(\"onBeforeSheetMenu\", [id])){\n\t\tview.$sheetMenu.show(e);\n\t}\n}\n\nfunction changePagerStatus(view){\n\tconst sheets = view.$$(\"sheets\");\n\tconst scrollPos = sheets.getScrollState().x;\n\n\tif(scrollPos == 0){\n\t\tview.$$(\"prev-sheet\").disable();\n\t}\n\telse{\n\t\tview.$$(\"prev-sheet\").enable();\n\t\tvar tabWidth = view.config.sheetTabWidth;\n\t\tif(scrollPos == (sheets.count()-(sheets.config.width/tabWidth))*tabWidth){\n\t\t\tview.$$(\"next-sheet\").disable();\n\t\t\treturn;\n\t\t}\n\t}\n\tview.$$(\"next-sheet\").enable();\n}\n\nfunction changePagerVisability(view){\n\tvar toolbar = view.$$(\"bottom-toolbar\");\n\tvar sheets = view.$$(\"sheets\");\n\n\tif(sheets.count() <= (sheets.config.width/view.config.sheetTabWidth))\n\t\ttoolbar.showBatch(\"pager\", false);\n\telse\n\t\ttoolbar.showBatch(\"pager\");\n}\n\nfunction dataOrder(view, name, num){\n\tfor (let id in view._sheets) {\n\t\tif (view._sheets[id].name == name) {\n\t\t\tconst item = view._sheets.splice(id, 1);\n\t\t\tview._sheets.splice(num, 0, item[0]);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport function add(view, content){\n\tvar index, name, newIndex;\n\n\tindex = arr.findIndex(view._sheets, x => x.name == view._activeSheet);\n\tnewIndex = index>-1?index+1:view._sheets.length;\n\tname = getNewTitle(view);\n\tcontent = content || {data:[]};\n\tview._sheets.splice(newIndex, 0, {\n\t\tname: name,\n\t\tcontent: content\n\t});\n\tview.$$(\"sheets\").add({id: name, value: name},newIndex);\n\tview.showSheet(name);\n\tview.callEvent(\"onSheetAdd\", [name]);\n\treturn name;\n}\n\nfunction getNewTitle(view){\n\tvar index = view._sheets.length+1;\n\twhile(getSheet(view, (webix.i18n.spreadsheet.labels.sheet+index)))\n\t\tindex++;\n\tvar name = webix.i18n.spreadsheet.labels.sheet+index;\n\treturn name;\n}\n\nfunction selectSheet(view,name){\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").select(name);\n\t\tview.$$(\"sheets\").showItem(name);\n\t}\n}\n\nexport function edit(view,name){\n\tview.$$(\"sheets\").edit(name);\n}\n\nexport function remove(view,name){\n\tvar index, newSheet;\n\tif(view._sheets.length >1){\n\t\tindex = arr.findIndex(view._sheets,x => x.name == name);\n\t\tview._sheets.splice(index,1);\n\t\tif(!view._sheets[index])\n\t\t\tindex = 0;\n\t\tnewSheet = \tview._sheets[index];\n\t\tview._activeSheet = null;\n\t\tif(view.$$(\"sheets\")){\n\t\t\tview.$$(\"sheets\").remove(name);\n\t\t\tview.$$(\"sheets\").refresh();\n\t\t}\n\t\tview.showSheet(newSheet.name);\n\t\tview.callEvent(\"onSheetRemove\", [name]);\n\t}\n}\n\nexport function rename(view,name,newName){\n\tif (name == newName) return;\n\n\t//correct sheet name\n\tvar i = 1;\n\twhile (!newName || getSheet(view, newName)){\n\t\tnewName = webix.i18n.spreadsheet.labels.sheet + i;\n\t\ti++;\n\t}\n\tnewName = newName.replace(/[*?:[\\]\\\\/]/g,\"\").substring(0, 31);\n\n\tvar sheet = getSheet(view, name);\n\tvar sheets = view.$$(\"sheets\");\n\n\tsheet.name = newName;\n\tif(view._activeSheet == name)\n\t\tview._activeSheet = newName;\n\n\tif(sheets){\n\t\tlet item = sheets.getItem(name);\n\t\titem.value = newName;\n\t\tsheets.data.changeId(name,newName);\n\t\tsheets.refresh(newName);\n\t}\n\n\tview.callEvent(\"onSheetRename\", [name, newName]);\n}\n\nexport function serialize(view, obj){\n\tgetSheet(view, view._activeSheet).content = obj;\n\treturn view._sheets;\n}\n\nexport function load(view, obj){\n\tobj = webix.isArray(obj)?{sheets:obj}:obj;\n\t\n\tif((obj.excel || !obj.sheets) && view._activeSheet){\n\t\t//loading into active sheet\n\t\tvar name = view._activeSheet;\n\t\tgetSheet(view, name).content = obj;\n\t\trefresh(view, obj);\n\t} else {\n\t\t//creating new set of sheets\n\t\tprepare(view, obj);\n\t}\n}\n\nexport function prepare(view, obj){\n\tif(!obj) obj = {data:[]}; \n\tif(!obj.sheets)\n\t\tobj = newSheet(obj);\n\t\n\tvar name = obj.sheets[0].name;\n\tview._activeSheet = \"\";\n\tview._sheets = obj.sheets;\n\treset(view, obj);\n\tshow(view, name);\n}\n\nexport function newSheet(obj){\n\treturn {\n\t\tsheets:[{\n\t\t\tname: webix.i18n.spreadsheet.labels.sheet + 1,\n\t\t\tcontent: obj\n\t\t}]\n\t};\n}\n\nexport function show(view,name){\n\tif (name == view._activeSheet) return;\n\n\tif(view.callEvent(\"onBeforeSheetShow\", [name])){\n\t\tif (view._activeSheet)\n\t\t\tgetSheet(view, view._activeSheet).content = view.serialize();\n\n\t\tview._activeSheet = name;\n\t\tvar obj = getSheet(view, name).content;\n\t\trefresh(view, obj);\n\n\t\tview.callEvent(\"onAfterSheetShow\", [name]);\n\t}\n}\n\nexport function getSheet(view, name){\n\treturn arr.find(view._sheets, x => x.name == name);\n}\n\nexport function eachSheet(view, callback){\n\tfor (var i=0; i<view._sheets.length; i++)\n\t\tcallback(view._sheets[i].name);\n}\n\nexport function getActive(view){\n\treturn view._activeSheet;\n}\n\nfunction refresh(view, obj){\n\tlet [rows, cols] = arr.getDimension(obj.data, view.config.rowCount, view.config.columnCount);\n\tview.callEvent(\"onReset\", []);\n\tif (rows != view.config.rowCount || cols != view.config.columnCount){\n\t\tview.config.rowCount = rows;\n\t\tview.config.columnCount = cols;\n\t\tview._resetTable();\n\t}\n\n\tview._loading_data = true;\n\tview.callEvent(\"onDataParse\", [obj]);\n\tview._loading_data = false;\n\tview._table.refresh();\n\tif(view.config.bottombar)\n\t\tview.$$(\"sheets\").refresh();\n}\n\nfunction copy(view){\n\tadd(view, view.serialize());\n}\n\nfunction callAction(view, id){\n\tif(!view.$sheetMenu.data.getMark(id, \"webix_disabled\"))\n\t\tactionMap[id](view);\n}\n\n","import \"../views/formlate\";\n\nexport class Dialog{\n\tconstructor(view){\n\t\tthis.view = view;\n\t}\n\t$init(){}\n\t$show(){}\n\t$hide(){}\n\topen(){\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t}\n\n\t\tvar form = this.$dialog.getBody();\n\t\tthis.$dialog.show();\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\tclose(){\n\t\twebix.UIManager.setFocus(this.view);\n\t\tthis.$dialog.hide();\n\t}\n}","export function image(url){\n\treturn `=IMAGE(\"${url}\")`;\n}\n\nexport function chart(config){\n\tlet result = `=SPARKLINE(${config.range},\"${config.type}\"`;\n\tif (config.type === \"bar\")\n\t\tresult += `,\"${config.color}\",\"${config.negativeColor}\"`;\n\telse if(config.color)\n\t\tresult += `,\"${config.color}\"`;\n\treturn result+\")\";\n\n}\n\nexport function parseImage(value){\n\tif (value && value.indexOf(\"=IMAGE(\") === 0)\n\t\treturn {\n\t\t\turl: unescape(value.substr(7, value.length-8))\n\t\t};\n}\n\nexport function parseChart(value){\n\tif (value && value.indexOf(\"=SPARKLINE(\") === 0){\n\t\tlet text = value.substr(11, value.length-12).split(\",\");\n\t\treturn {\n\t\t\trange: text[0],\n\t\t\ttype: unescape(text[1]),\n\t\t\tcolor: unescape(text[2]),\n\t\t\tnegativeColor: unescape(text[3])\n\t\t};\n\t}\n}\n\nfunction unescape(text){\n\tif (!text) return \"\";\n\n\ttext = text.trim();\n\tif (text[0] === \"\\\"\") \n\t\ttext = text.substr(1);\n\tif (text[text.length-1] === \"\\\"\")\n\t\ttext = text.substr(0, text.length-1);\n\treturn text;\n}","import {Dialog} from \"./common\";\nimport {parseImage} from \"../math/writer\";\n\nexport const action = \"add-image-cell\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseImage(value);\n\t\tif (data && data.url)\n\t\t\tform.elements.url.setValue(data.url);\n\t\n\t\tform.elements.url.focus();\n\t}\n\t$init(){\n\n\t\tvar save = this.view.config.save;\n\t\tvar server = (save && save.images) || null;\n\t\t\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"image-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"image-url\"], on:{\n\t\t\t\t\t\t\"onChange\":(image) => this.showPreview(image)\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"label\", label:webix.i18n.spreadsheet.labels[\"image-or\"], align: \"center\"},\n\t\t\t\t\t{ view:\"uploader\", label:webix.i18n.spreadsheet.labels[\"image-upload\"], upload:server, on:{\n\t\t\t\t\t\t\"onBeforeFileAdd\": startLoad,\n\t\t\t\t\t\t\"onFileUpload\": endLoad\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless: true, css: \"webix_ssheet_preview\", template:\"\", height:50 }\n\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tvar cell = this.cell;\n\t\tvar image = this.fillUrl(this.$dialog.getBody().elements.url.getValue());\n\t\tthis.view.addImage(cell.row, cell.column, image);\n\t\tthis.close();\n\t}\n\tfillUrl(url){\n\t\tif (!/^[/]|((https?:\\/|data:image)\\/)/i.test(url))\n\t\t\turl = \"http://\" + url;\n\t\treturn url;\n\t}\n\tshowPreview(image){\n\t\tif (image){\n\t\t\timage = webix.template.escape(this.fillUrl(image));\n\t\t\tthis.$dialog.queryView(\"form\").elements.preview.setHTML(\"<img class='webix_ssheet_cimage' src='\"+image+\"'></img>\");\n\t\t}\n\t}\n}\n\n\nfunction startLoad(file){ \n\tif (!this.config.upload){\n\t\tvar reader = new FileReader();\n\t\treader.onload = (e) => this.getFormView().elements.url.setValue(e.target.result);\n\t\treader.readAsDataURL(file.file);\n\t\treturn false;\n\t} else\n\t\tthis.getFormView().elements.preview.setHTML(\"\");\n}\n\nfunction endLoad(item, response){\n\tthis.getFormView().elements.url.setValue(response.imageURL);\n}","import * as box from \"./imagecell\";\n\nexport const action = \"add-image-top\";\n\nexport class DialogBox extends box.DialogBox{\n\topen(action){\n\t\tthis.config = action.config;\n\t\tthis.viewid = action.viewid;\n\t\tbox.DialogBox.prototype.open.apply(this, arguments);\n\t}\n\t$hide(){\n\t\tthis.config = this.viewid = null;\n\t}\n\t$show(box, form){\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\tif(this.config && this.config.data)\n\t\t\tform.elements.url.setValue(this.config.data);\n\t\n\t\tform.elements.url.focus();\n\t}\n\tokClick(){\n\t\tconst image = this.fillUrl(this.$dialog.getBody().elements.url.getValue());\n\t\tif(this.viewid)\n\t\t\tthis.view.views.update(this.viewid, image);\n\t\telse\n\t\t\tthis.view.views.add(null, null, \"image\", image);\n\t\tthis.close();\n\t}\n}","import * as parser \t\t\tfrom \"./parser\";\n\n//convert math string to the js function\nlet actives = {};\nlet passives = {};\nexport function _parse(value, core, passive){\n\tvar struct = parser.parse(value, core, passive);\n\tif(passive && !passives[passive])\n\t\tpassives[passive] = {};\n\tvar cache = passive ? passives[passive] : actives;\n\tstruct.handler = cache[value] = cache[value] || _build_function(struct.code);\n\treturn struct;\n}\n\nexport function clearMathCache(activeOnly){\n\tactives = {};\n\tif(!activeOnly)\n\t\tpassives = {};\n}\n\nfunction error_function(){\n\treturn webix.i18n.spreadsheet.table[\"math-error\"];\n}\nfunction _build_function(value){\n\ttry{\n\t\treturn new Function(value);\n\t} catch(e){\n\t\treturn error_function;\n\t}\n}","import * as nms from \"../helpers/column_names\";\nimport {split, position} from \"../math/parser\";\n\nexport function updateMath(formula, action, area){\n\tconst stack = split(formula, true);\n\tconst max = stack.length;\n\tconst start = area ? area.start : null;\n\tconst end = area ? area.end : null;\n\tconst {count, id} = action;\n\n\tfor (let i = 1; i < max; i+=2) {\n\t\t//do not update cells in other sheets\n\t\tif(webix.isArray(stack[i])){\n\t\t\tconst [sheet, cell, escaped] = stack[i];\n\t\t\tconst quot = escaped ? \"'\" : \"\";\n\t\t\tstack[i] = quot + sheet + quot + \"!\" + cell;\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet [row, column, flags] = position(stack[i]);\n\n\t\tconst isRowFix = flags & 1;\n\t\tconst isColumnFix = flags & 2;\n\t\tconst range = checkRange(stack, i);\n\n\t\t// for cut operations we need to check whether referenced values are inside cut block. if so - update them.\n\t\tif (id == \"move\" && (!action.cut || (row >= start.row && row <= end.row && column >= start.column && column <= end.column))){\n\t\t\tcolumn += isColumnFix ? 0 : action.column;\n\t\t\trow += isRowFix ? 0 : action.row;\n\t\t}\n\t\telse if(id == \"row\" || id == \"column\"){\n\t\t\tconst isRow = id == \"row\";\n\t\t\tlet val = isRow ? row : column;\n\t\t\tif(count < 0 && range == \"start\"){\n\t\t\t\tif(action.start <= val && position(stack[i+2])[isRow ? 0 : 1] <= action.start + Math.abs(count)){\n\t\t\t\t\tstack[i] = stack[i+2] = \"#REF!\";\n\t\t\t\t\ti += 2;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(action.start <= val){\n\t\t\t\tlet updated;\n\t\t\t\tif(count < 0 && action.start + Math.abs(count) > val){\n\t\t\t\t\tif(range){\n\t\t\t\t\t\tval = action.start - (range == \"end\" ? 1 : 0);\n\t\t\t\t\t\tupdated = true;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tstack[i] = \"#REF!\";\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!updated)\n\t\t\t\t\tval += count;\n\n\t\t\t\tif(isRow)\n\t\t\t\t\trow = val;\n\t\t\t\telse\n\t\t\t\t\tcolumn = val;\n\t\t\t}\n\t\t}\n\n\t\tif (column <= 0 || row <= 0)\n\t\t\tstack[i] = \"#REF!\";\n\t\telse\n\t\t\tstack[i] = (isColumnFix?\"$\":\"\") + nms.encode[column] + (isRowFix?\"$\":\"\") + row;\n\t}\n\n\treturn stack.join(\"\");\n}\n\nfunction checkRange(stack, index){\n\tif(stack[index+1] == \":\" && stack[index+2])\n\t\treturn \"start\";\n\telse if(stack[index-1] == \":\" && stack[index-2])\n\t\treturn \"end\";\n}\n\nexport function updateSheetNames(formula, oldName, newName, extra){\n\tvar stack = split(formula, true);\n\tfor(var i = 0; i < stack.length; i++){\n\t\tif(webix.isArray(stack[i])){\n\t\t\tvar thisSheet = stack[i][0] === oldName;\n\t\t\tif(!extra.multiSheet && thisSheet)\n\t\t\t\textra.multiSheet = true;\n\t\t\tvar sheet = thisSheet ? newName : stack[i][0];\n\t\t\tstack[i] = \"'\"+sheet+\"'!\"+stack[i][1];\n\t\t}\n\t}\n\treturn stack.join(\"\");\n}","//TODO\n// ### column deleting | adding\n// recalculate positions\n\n// ### copy paste between sheets\n// force sheet name\n\n// ### triggers\n// a <- p <- a\n// register triggers from passive sheet\n\n// ### sheet renaming\n// adjust math on sheet rename\n// adjust ranges on sheet rename\n\nimport {getActive, getSheet} from \"../sheets\";\nimport {range} from \"../helpers/column_names\";\nimport {clearMathCache} from \"./cache\";\nimport {updateSheetNames} from \"./updater\";\n\n\nexport function init(view, core, helpers){\n\tview.attachEvent(\"onBeforeSheetShow\", function(){\n\t\tdelete view._mathSheetCache[getActive(view)];\n\t});\n\tview.attachEvent(\"onSheetRename\", function(name, newName){\n\t\tview._sheets.forEach((sheet)=>{\n\t\t\tlet extra = {multiSheet:false};\n\t\t\tconst edit = [\"data\", \"editors\", \"conditions\", \"ranges\"];\n\t\t\tedit.forEach((param)=>{\n\t\t\t\tif(sheet.content[param])\n\t\t\t\t\tsheet.content[param].forEach((value)=>{\n\t\t\t\t\t\tswitch (param) {\n\t\t\t\t\t\t\tcase \"data\":\n\t\t\t\t\t\t\t\tif(value[2][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[2] = updateSheetNames(value[2], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"editors\": {\n\t\t\t\t\t\t\t\tconst options = value[2].options;\n\t\t\t\t\t\t\t\tif(options){\n\t\t\t\t\t\t\t\t\tif(typeof options == \"string\")\n\t\t\t\t\t\t\t\t\t\tvalue[2].options = updateSheetNames(options, name, newName, extra);\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < options.length; i++){\n\t\t\t\t\t\t\t\t\t\t\tconst option = typeof options[i] == \"string\" ? options[i] : options[i].value;\n\t\t\t\t\t\t\t\t\t\t\toptions[i] = updateSheetNames(option, name, newName, extra);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcase \"conditions\":\n\t\t\t\t\t\t\t\tif(value[3][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[3] = updateSheetNames(value[3], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"ranges\":\n\t\t\t\t\t\t\t\tvalue[1] = updateSheetNames(value[1], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t});\n\t\t\tif(extra.multiSheet === true){\n\t\t\t\tdelete view._mathSheetCache[sheet.name];\n\t\t\t\tgetAccessor(view, sheet.name);\n\t\t\t\tclearMathCache();\n\t\t\t}\n\t\t});\n\t\tdelete view._mathSheetCache[name];\n\t});\n\tview.attachEvent(\"onSheetRemove\", function(name){\n\t\tdelete view._mathSheetCache[name];\n\t});\n\n\tview._mathSheetCore = core;\n\tview._mathSheetHelpers = helpers;\n}\n\nexport function getAccessor(view, name){\n\tconst cache = view._mathSheetCache;\n\n\tif (!cache[name]){\n\t\tconst helpers = (!name || name == getActive(view)) ? activeAccessor(view) : passiveAccessor(view, name);\n\n\t\t//invalid sheet name\n\t\tif(!helpers)\n\t\t\treturn;\n\n\t\tconst temp = cache[name] = SheetAccessor(helpers);\n\n\t\ttemp.init();\n\t}\n\treturn cache[name];\n}\n\nfunction SheetAccessor(helpers){\n\treturn {\n\t\tinit:function(){\n\t\t\thelpers.init();\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn helpers.getRangeCode(name);\n\t\t},\n\t\tgetItem:function(r){\n\t\t\treturn helpers.getRow(r);\n\t\t},\n\t\tgetValue(r,c){\n\t\t\tvar val = helpers.getCell(r,c);\n\t\t\tvar test = val*1;\n\t\t\tif (!isNaN(test) && val !== \"\") return test;\n\t\t\treturn val?val:\"\";\n\t\t},\n\t\tgetRangeValue(name){\n\t\t\tvar code = this.getRangeCode(name) || name;\n\t\t\tif (code.indexOf(\":\") == -1) return [];\n\t\t\tvar pos = range(code);\n\t\t\treturn this.getRange.apply(this, pos);\n\t\t},\n\t\tgetRange(r1,c1,r2,c2){\n\t\t\tconst set = helpers.getRange(r1,c1,r2,c2);\n\t\t\tfor (let i = set.length-1; i>=0; i--){\n\t\t\t\tlet val = set[i];\n\t\t\t\tlet test = val !== \"\" ? val * 1 : \"\";\n\t\t\t\tset[i] = isNaN(test) ? (val?val:\"\") : test;\n\t\t\t}\n\t\t\treturn set;\n\t\t},\n\t\tgetRangeCols:function(r1,c1,r2,c2){\n\t\t\treturn helpers.getRangeCols(r1,c1,r2,c2);\n\t\t}\n\t};\n}\n\nfunction activeAccessor(view){\n\treturn {\n\t\tinit:function(){\n\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn view.ranges.getCode(name);\n\t\t},\n\t\tgetRow:function(r){\n\t\t\treturn view.getRow(r);\n\t\t},\n\t\tgetCell:function(r,c){\n\t\t\treturn view.getRow(r)[c];\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++){\n\t\t\t\tvar item = view.getRow(i);\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(item[j]);\n\t\t\t}\n\t\t\treturn set;\n\t\t},\n\t\tgetRangeCols:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tvar rind = 0;\n\t\t\tfor (var i = r1; i <= r2; i++){\n\t\t\t\tset[rind] = {};\n\t\t\t\tvar item = view.getRow(i);\n\t\t\t\tvar cind = 0;\n\t\t\t\tfor (var j = c1; j <= c2; j++){\n\t\t\t\t\tset[rind][\"data\"+cind] = (item[j]);\n\t\t\t\t\tcind++;\n\t\t\t\t}\n\t\t\t\trind++;\n\t\t\t}\n\t\t\treturn set;\n\t\t}\n\t};\n}\n\nfunction passiveAccessor(view, name){\n\tconst sheet = getSheet(view, name);\n\tif(!sheet)\n\t\treturn;\n\n\tconst page = sheet.content;\n\tconst table = [];\n\tconst formulas = [];\n\n\tconst ranges = [];\n\n\treturn {\n\t\tinit:function(){\n\t\t\tif (page.ranges){\n\t\t\t\tfor (var i = 0; i < page.ranges.length; i++) {\n\t\t\t\t\tvar line = page.ranges[i];\n\t\t\t\t\tranges[line[0]] = line[1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (page.data){\n\t\t\t\tfor (let i = 0; i < page.data.length; i++) {\n\t\t\t\t\t//expand data structure\n\t\t\t\t\tlet [row, column, value] = page.data[i];\n\t\t\t\t\tif (!table[row])\n\t\t\t\t\t\ttable[row] = [];\n\t\t\t\t\ttable[row][column] = value;\n\n\t\t\t\t\tif (value[0] === \"=\"){\n\t\t\t\t\t\t//for math cells, store the code\n\t\t\t\t\t\tlet math = view._mathSheetHelpers.parse(value, view._mathSheetCore, name);\n\t\t\t\t\t\ttable[row][column] = math.handler;\n\n\t\t\t\t\t\t//store list of cross-sheet formulas\n\t\t\t\t\t\tfor (var j=0; j<math.triggers.length; j++){\n\t\t\t\t\t\t\tif (math.triggers[j][5]){\n\t\t\t\t\t\t\t\tformulas.push(page.data[i]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn ranges[name];\n\t\t},\n\t\tgetRow(i){\n\t\t\treturn table[i] || [];\n\t\t},\n\t\tgetCell(i, j){\n\t\t\tvar value = this.getRow(i)[j];\n\t\t\tif (typeof value === \"function\")\n\t\t\t\treturn view._mathSheetHelpers.execute(value, view._mathSheetCore);\n\n\t\t\treturn value;\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++)\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(this.getCell(i,j));\n\t\t\treturn set;\n\t\t},\n\t\tgetRangeCols:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tvar rind = 0;\n\t\t\tfor (var i = r1; i <= r2; i++){\n\t\t\t\tset[rind] = {};\n\t\t\t\tvar item = this.getRow(i);\n\t\t\t\tvar cind = 0;\n\t\t\t\tfor (var j = c1; j <= c2; j++){\n\t\t\t\t\tset[rind][\"data\"+cind] = (item[j]);\n\t\t\t\t\tcind++;\n\t\t\t\t}\n\t\t\t\trind++;\n\t\t\t}\n\t\t\treturn set;\n\t\t}\n\t};\n}","import {range} from \"../helpers/column_names\";\nimport {getAccessor} from \"./sheet\";\nimport {cell_template} from \"../table\";\nimport {clearMathCache} from \"./cache\";\n\nfunction nullFilter(){ \n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn { id:\"$empty\", value:\"\", $value:\"<span class='webix_ssheet_empty'>\"+locale[\"dropdown-empty\"]+\"</span>\" };\n}\n\nfunction getRange(view, r1,c1,r2,c2,sheet){\n\tconst values = [];\n\tfor (let i=r1; i<=r2; i++){\n\t\tconst item = this.getItem(i);\n\t\tfor (let j=c1; j<=c2; j++){\n\t\t\tlet value = (item[j] || item[j] === 0) ? item[j] : \"\";\n\t\t\tvalue = { id:value, value:value };\n\n\t\t\tif (!sheet || sheet == view._activeSheet){\n\t\t\t\tvalue[\"$value\"] = cell_template(view, item, null, item[j], {id:j}, true);\n\t\t\t\tvalue[\"format\"] = item.$cellFormat && item.$cellFormat[j];\n\t\t\t}\n\t\t\tvalues.push(value);\n\t\t}\n\t}\n\treturn values;\n}\n\nexport function rangeOptions(view, text, extra){\n\tlet values = [];\n\tif (typeof text == \"string\"){\n\t\tconst pos = range(text, view);\n\t\tif (pos){\n\t\t\tconst page = getAccessor(view, pos[4]);\n\t\t\tvalues = page ? getRange.apply(page, [view, ...pos]) : [];\n\t\t}\n\t}\n\telse if (webix.isArray(text))\n\t\tfor (let i=0; i<text.length; i++){\n\t\t\tlet v = (text[i] || text[i] === 0) ? text[i] : \"\";\n\t\t\tv = (typeof v === \"object\") ? webix.copy(v) : { id:v, value:v };\n\t\t\tvalues.push(v);\n\t\t}\n\n\tif (extra){\n\t\tif (extra.unique){\n\t\t\tconst test = {};\n\t\t\tfor (let i=values.length-1; i>=0; i--){\n\t\t\t\tif (test[values[i].id])\n\t\t\t\t\tvalues.splice(i, 1);\n\t\t\t\telse\n\t\t\t\t\ttest[values[i].id] = true;\n\t\t\t}\n\t\t}\n\n\t\tlet empty = false;\n\t\tfor (let i=values.length-1; i>=0; i--){\n\t\t\tvalues[i].value = String(values[i].value);\n\t\t\tif (values[i].value === \"\"){\n\t\t\t\tvalues.splice(i, 1);\n\t\t\t\tempty = true;\n\t\t\t}\n\t\t}\n\n\t\tif (extra.order)\n\t\t\tvalues.sort(function(objA, objB){\n\t\t\t\tconst sorters = view.$$(\"cells\").data.sorting.as;\n\t\t\t\tconst a = objA.value;\n\t\t\t\tconst b = objB.value;\n\n\t\t\t\treturn webix.rules.isNumber(a) && webix.rules.isNumber(b) ? sorters.int(a, b) : sorters.string(a, b);\n\t\t\t});\n\n\t\tif (empty && extra.filter)\n\t\t\tvalues.unshift( nullFilter() );\n\n\t\tif (extra.empty)\n\t\t\tvalues.unshift({ id:\"$empty\", $empty:true, value:\"\" });\n\t}\n\treturn values;\n}\n\nexport function rangeValues(view, text){\n\tlet values = [];\n\tif (typeof text == \"string\"){\n\t\tconst pos = range(text, view);\n\t\tif (pos){\n\t\t\tconst page = getAccessor(view, pos[4]);\n\t\t\tvalues = page ? page.getRange.apply(page, pos) : [];\n\t\t}\n\t} else\n\t\tvalues = webix.copy(text);\n\n\treturn values;\n}\n\nexport class Ranges{\n\tconstructor(view){\n\t\tthis._master = view;\n\t\tthis._ranges = {};\n\t}\n\tclear(){\n\t\tthis._ranges = {};\n\t}\n\tadd(name, text){\n\t\tthis._master.callEvent(\"onAfterRangeSet\", [name, text]);\n\t\tthis._ranges[name] = text;\n\n\t\tclearMathCache(true);\n\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetCode(name, sheet){\n\t\tif (sheet){\n\t\t\tconst accessor = getAccessor(this._master, sheet);\n\t\t\treturn accessor ? accessor.getRangeCode(name) : null;\n\t\t}\n\n\t\treturn this._ranges[name];\n\t}\n\tremove(name){\n\t\tdelete this._ranges[name];\n\n\t\tclearMathCache(true);\n\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetRanges(){\n\t\tvar data = [];\n\t\tfor(var name in this._ranges)\n\t\t\tdata.push({ name, range:this._ranges[name] });\n\n\t\treturn data;\n\t}\n\tparse(data){\n\t\tif (!data) return;\n\n\t\tlet i = data.length;\n\t\twhile(i--){\n\t\t\tvar c = data[i];\n\t\t\tthis._ranges[c[0]] = c[1];\n\t\t}\n\t}\n\tserialize(){\n\t\tvar name, data = [];\n\t\tfor( name in this._ranges)\n\t\t\tdata.push([name,this._ranges[name]]);\n\t\treturn data;\n\t}\n}\n","import {Dialog} from \"./common\";\nimport {rangeValues} from \"../math/ranges\";\nimport {range} from \"../helpers/column_names\";\nimport {parseChart} from \"../math/writer\";\n\nexport const action = \"add-sparkline\";\n\nconst labels = webix.i18n.spreadsheet.labels;\n\nfunction getTypes(){\n\treturn  [\n\t\t{id:\"line\", value:labels[\"line-chart\"]},\n\t\t{id:\"spline\", value:labels[\"spline-chart\"]},\n\t\t{id:\"splineArea\", value:labels[\"splinearea-chart\"]},\n\t\t{id:\"area\", value:labels[\"area-chart\"]},\n\t\t{id:\"bar\", value:labels[\"bar-chart\"]},\n\t\t{id:\"pie\", value:labels[\"pie-chart\"]}\n\t];\n}\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tvar els = form.elements;\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tels.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tels.range.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseChart(value);\n\t\tif (data){\n\t\t\tform.blockEvent();\n\t\t\tels.type.setValue(data.type);\n\t\t\tels.range.setValue(data.range);\n\t\t\tif (data.color){\n\t\t\t\tels.color_def.setValue(data.color);\n\t\t\t\tels.color_pos.setValue(data.color);\t\t\n\t\t\t}\n\t\t\tif (data.negativeColor)\n\t\t\t\tels.color_neg.setValue(data.negativeColor);\n\t\t\tform.unblockEvent();\n\t\t\trenderPreview(this);\n\t\t}\t\n\n\t\tels.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead:labels[\"sparkline-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\", visibleBatch:1, on:{ onChange : ()=> renderPreview(this) },  elements:[\n\t\t\t\t\t{view: \"richselect\", name:\"type\", label:labels[\"sparkline-type\"], value:\"line\", labelPosition:\"left\", suggest:{\n\t\t\t\t\t\tview:  \"ssheet-form-suggest\",\n\t\t\t\t\t\tdata:getTypes()\n\t\t\t\t\t}, on:{\n\t\t\t\t\t\t\"onChange\": typesChangeHandler\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"text\", label:labels[\"sparkline-range\"], name:\"range\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-color\"], name:\"color_def\", id:\"add_sparkline_color\", value:\"#6666FF\", batch:\"1\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-positive\"], name:\"color_pos\", value:\"#6666FF\", batch:\"2\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-negative\"], name:\"color_neg\", value:\"#FF6666\", batch:\"2\"},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless:true, css:\"webix_ssheet_preview\", height:50 }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tcheckRange(text){\n\t\tif(text && range(text, this.view))\n\t\t\treturn true;\n\t\tthis.view.alert({text:labels[\"error-range\"]});\n\t}\n}\n\nfunction renderPreview(dialog){\n\tvar form = dialog.$dialog.getBody();\n\tvar data = form.getValues();\n\n\tif (data.range && dialog.checkRange(data.range)){\n\t\tlet i,\n\t\t\tvalues = rangeValues(dialog.view, data.range),\n\t\t\tconfig = sparkConfig(form);\n\t\tfor(i =0 ; i < values.length; i++)\n\t\t\tvalues[i] = values[i]||0;\n\t\tform.elements.preview.setValue(webix.Sparklines.getTemplate(config)(values, { width:200, height: 40 }));\n\t}\n}\n\nfunction sparkConfig(form, config){\n\tvar data = form.getValues();\n\tconfig = config || { type: data.type  };\n\tif (data.type === \"bar\"){\n\t\tconfig.color = data.color_pos;\n\t\tconfig.negativeColor = data.color_neg;\n\t}\n\telse if(form.elements.color_def.isVisible())\n\t\tconfig.color = data.color_def;\n\n\treturn config;\n}\n\nfunction okClick(dialog){\n\tvar form = dialog.$dialog.getBody();\n\tvar config = sparkConfig(form, form.getValues());\n\tif (dialog.checkRange(config.range)){\n\t\tdialog.view.addSparkline(dialog.cell.row, dialog.cell.column, config);\n\t\tdialog.close();\n\t}\n}\n\n\n\n\nfunction typesChangeHandler(type){\n\tvar form = this.getFormView();\n\tswitch(type){\n\t\tcase \"pie\":\n\t\t\tform.showBatch(3);\n\t\t\tbreak;\n\t\tcase \"bar\":\n\t\t\tform.showBatch(2);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tform.showBatch(1);\n\t}\n}","import {Dialog} from \"./common\";\nimport {isRange, toSheetRange} from \"../helpers/column_names\";\n\nexport const action = \"add-range\";\n\nexport class DialogBox extends Dialog{\n\t$show(box){\n\t\tvar table = box.$$(\"table\");\n\t\tvar form = box.$$(\"form\");\n\t\tvar sheet = \"\";// this.view.getActiveSheet(); ranges are per-sheet by default\n\n\t\tform.clear();\n\t\tform.clearValidation();\n\t\tform.elements.name.focus();\n\t\tform.elements.range.setValue(this.view.getSelectedRange());\n\n\t\ttable.clearAll();\n\t\ttable.parse( this.view.ranges.getRanges() );\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(toSheetRange(a,b,sheet));\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tsaveClick(){\n\t\tconst form = this.$dialog.$$(\"form\");\n\t\tconst data = form.getValues();\n\n\t\tconst sheets = data.range.indexOf(\"!\");\n\t\tdata.range = data.range.substr(0, sheets+1)+data.range.substr(sheets+1).toUpperCase();\n\t\tdata.name = data.name.toUpperCase();\n\n\t\tform.setValues(data);\n\n\t\tif (form.validate()){\n\t\t\tlet table = this.$dialog.$$(\"table\");\n\n\t\t\tif (data.id && table.exists(data.id))\n\t\t\t\ttable.updateItem(data.id, data);\n\t\t\telse\n\t\t\t\ttable.add(data);\n\n\t\t\tthis.view.ranges.add(data.name, data.range);\n\t\t\tform.clear();\n\t\t}\n\t}\n\tremoveRange(id){\n\t\tthis.view.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"range-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\tthis.view.ranges.remove(table.getItem(id).name);\n\t\t\ttable.remove(id);\n\t\t});\n\t}\n\teditRange(id){\n\t\tvar form = this.$dialog.$$(\"form\");\n\t\tform.clearValidation();\n\t\tform.setValues(this.$dialog.$$(\"table\").getItem(id));\n\t}\n\t$init(){\n\t\tvar theform = {\n\t\t\ttype: \"clean\",\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-dialog-table\", id: \"table\", borderless:true, columns:[\n\t\t\t\t\t{ id:\"name\", header:webix.i18n.spreadsheet.labels[\"range-name\"], width: 120 },\n\t\t\t\t\t{ id:\"range\", header:webix.i18n.spreadsheet.labels[\"range-cells\"], width: 120 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-pencil'></div>\", width:40 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-trash'></div>\", width:40 }\n\t\t\t\t],\n\t\t\t\tautowidth:true, height: 150,\n\t\t\t\tonClick:{\n\t\t\t\t\t\"wxi-trash\":(ev, id) => this.removeRange(id),\n\t\t\t\t\t\"wxi-pencil\":(ev, id) => this.editRange(id)\n\t\t\t\t}},\n\t\t\t\t{ width: 250, view: \"form\", id:\"form\",\n\t\t\t\t\trules:{\n\t\t\t\t\t\tname:(value) => { \n\t\t\t\t\t\t\tlet correct = /^[A-Za-z]+$/.test(value);\n\t\t\t\t\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\t\t\t\t\tlet data = this.$dialog.$$(\"form\").getValues();\n\n\t\t\t\t\t\t\tlet unique = true;\n\t\t\t\t\t\t\ttable.eachRow(function(id){\n\t\t\t\t\t\t\t\tlet obj = this.getItem(id);\n\t\t\t\t\t\t\t\tif (obj.name == value && obj.id != data.id)\n\t\t\t\t\t\t\t\t\tunique = false; \n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn correct && unique; \n\t\t\t\t\t\t},\n\t\t\t\t\t\trange:isRange\n\t\t\t\t\t},\n\t\t\t\t\telementsConfig:{\n\t\t\t\t\t\tlabelWidth: 70\n\t\t\t\t\t},\n\t\t\t\t\telements:[\n\t\t\t\t\t\t{ view: \"text\", name:\"name\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-name\"]},\n\t\t\t\t\t\t{ view: \"text\", name:\"range\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-cells\"]},\n\t\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t{ view:\"button\", value:\"Save\", click: () => this.saveClick() }\n\t\t\t\t\t\t]}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tmove:true,\n\t\t\thead: webix.i18n.spreadsheet.labels[\"range-title\"],\n\t\t\tbuttons: false,\n\t\t\tautoheight: true,\n\t\t\twidth: 610,\n\t\t\tposition: \"center\",\n\t\t\tbody: theform,\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.close(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\n","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"add-dropdown\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tlet form = this.$dialog.$$(\"form\");\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tform.clear();\n\n\t\t//restore previosly selected range\n\t\tlet value = this.view.getCellEditor(this.cell[0].row, this.cell[0].column);\n\t\tif (value && value.options)\n\t\t\tform.elements.range.setValue(value.options);\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"dropdown-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tview:\"form\", id:\"form\", rows:[\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"dropdown-range\"], name:\"range\" }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tvar values = this.$dialog.$$(\"form\").elements.range.getValue();\n\n\t\tif (values){\n\t\t\tif(!range(values, this.view))\n\t\t\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"]});\n\t\t\telse{\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tfor (var i = 0; i < this.cell.length; i++)\n\t\t\t\t\t\tthis.view.setCellEditor(this.cell[i].row, this.cell[i].column, { editor:\"ss_richselect\", options:values});\n\t\t\t\t}, this);\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tthis.close();\n\t}\n}","import group from \"./undo_group\";\n\nexport const lockCss = \"webix_lock\";\n\nexport function init(view){\n\tview._locks = {};\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, mode) => {\n\t\tif (type === \"lock\") lockCell(view, row, column, !!mode, true);\n\t});\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"lock-cell\")\n\t\t\tlock(view);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._locks = {};\n}\n\nexport function lockCell(view, row, column, mode, silent){\n\tvar table = view.$$(\"cells\");\n\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\tgroup.set(function() {\n\t\t\t_mapCellsCalls(row, column, function(row, column){\n\t\t\t\tlockCell(view, row, column, mode, true);\n\t\t\t});\n\t\t});\n\t} else {\n\t\tmode = ((mode === false) ? false : true);\n\t\tvar objrow = view._locks[row] = view._locks[row] || {};\n\t\tobjrow[column] = mode;\n\t\tif (mode)\n\t\t\ttable.addCellCss(row, column, lockCss, true);\n\t\telse\n\t\t\ttable.removeCellCss(row, column, lockCss, true);\n\n\t\tview.callEvent(\"onAction\", [\"lock\", { row, column, value: !mode, newValue: mode }]);\n\t}\n\n\tif (!silent)\n\t\ttable.refresh();\n}\n\nfunction _mapCellsCalls(start, end, handler,master){\n\tfor (let x = start.row; x<=end.row; x++)\n\t\tfor (let y = start.column; y<=end.column; y++)\n\t\t\thandler.call(master||this, x, y);\n}\n\nexport function isCellLocked(view, row, column){\n\treturn view._locks[row]?view._locks[row][column]:false;\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tlocked = [];\n\tfor(row in view._locks){\n\t\tfor(column in view._locks[row])\n\t\t\tif(view._locks[row][column])\n\t\t\t\tlocked.push([row,column]);\n\t}\n\tdata.locked = locked;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tlocked = data.locked;\n\n\tif(locked)\n\t\tfor(i = 0; i < locked.length; i++)\n\t\t\tlockCell(view, locked[i][0],locked[i][1],true, true);\n}\n\nfunction lock(view){\n\tvar block = view.$$(\"cells\").getSelectArea();\n\tif (block){\n\t\tvar mode = view.isCellLocked(block.start.row, block.start.column);\n\t\tview.lockCell(block.start, block.end, !mode);\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet locked = data.locked,\n\t\ti = locked.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = locked[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tlocked.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tlocked[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tlocked.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tlocked[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","import {lockCss} from \"./lock_cell\";\nimport {find, findIndex} from \"../helpers/array\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\tview.attachEvent(\"onStyleChange\", (row, column, style) => {\n\t\tvar span = getSpan(view, row, column);\n\t\tif (span){\n\t\t\tvar extraCss = getExtraCss(view, row, column);\n\t\t\tspan[3] = (style ? style.id : \"\") + (extraCss ? (\" \" + extraCss) : \"\");\n\t\t}\n\t});\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.spans)\n\t\t\tfor (var i = 0; i < data.spans.length; i++) {\n\t\t\t\tvar span = data.spans[i];\n\t\t\t\taddSpan( view,\n\t\t\t\t\t{ row: span[0], column: span[1] },\n\t\t\t\t\tspan[2]*1,\n\t\t\t\t\tspan[3]*1,\n\t\t\t\t\ttrue \n\t\t\t\t);\n\t\t\t}\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar spans = [];\n\t\tvar pull = view.$$(\"cells\").getSpan();\n\t\tif (pull){\n\t\t\tfor (var rid in pull){\n\t\t\t\tvar row = pull[rid];\n\t\t\t\tfor (var cid in row){\n\t\t\t\t\tvar span = row[cid];\n\t\t\t\t\tspans.push([rid*1, cid*1, span[0], span[1]]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdata.spans = spans;\n\t\t}\n\t});\n\t\n\tview.attachEvent(\"onUndo\", (type, row, column, value, isUndo) => {\n\t\tif(type == \"span\" || type == \"split\"){\n\t\t\tif (type == \"span\") \n\t\t\t\tisUndo = !isUndo;\n\t\t\tundoSpan(view, row, column, value, isUndo);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (name, options) => {\n\t\tif(name == \"lock\")\n\t\t\tsetSpanCss(view, options.row, options.column, lockCss, options.newValue);\n\t\telse if(name == \"before-grid-change\")\n\t\t\tupdatePosition(options.name,options.inc,options.data, options.start);\n\t\telse if(name == \"check-borders\")\n\t\t\treturn checkSpanBorders(view, options.row, options.column, options.area, options.mode);\n\t});\n}\n\nfunction getSpan(view, row, column){\n\tvar item = view.$$(\"cells\").getSpan()[row];\n\tif (item)\n\t\treturn item[column];\n}\n\nexport function addSpan(view, cell, x, y, silent){\n\tif (x<2 && y<2) return;\n\n\tif(silent || view.callEvent(\"onBeforeSpan\", [cell.row, cell.column, [x, y]])){\n\t\tvar row = view.getRow(cell.row);\n\t\tvar css = row.$cellCss ? (row.$cellCss[cell.column] || \"\") : \"\";\n\t\tvar extraCss = getExtraCss(view, cell.row, cell.column);\n\t\tif (extraCss)\n\t\t\tcss += \" \" + extraCss;\n\n\t\tsetSpanValue(view, cell, x, y);\n\t\tview.$$(\"cells\").addSpan(cell.row, cell.column, x, y, null, css);\n\t\tif (!silent){\n\t\t\tview.callEvent(\"onAfterSpan\", [cell.row, cell.column, [x, y]]);\n\t\t\tsave(view, \"spans\", {\n\t\t\t\trow:cell.row, column: cell.column,\n\t\t\t\tx:x, y:y\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport function removeSpan(view, cell){\n\tvar span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span && view.callEvent(\"onBeforeSplit\", [ cell.row, cell.column, [span[2], span[3]] ])){\n\t\tview.$$(\"cells\").removeSpan(cell.row, cell.column);\n\t\tview.callEvent(\"onAfterSplit\", [ cell.row, cell.column, [span[2], span[3]] ]);\n\t\tsave(view, \"spans\", {\n\t\t\trow:cell.row, column: cell.column,\n\t\t\tx:0, y:0\n\t\t});\n\t}\n}\n\nexport function getRange(sel){\n\tvar lx, ly, rx, ry;\n\trx = ry = 0;\n\tlx = ly = Infinity;\n\n\tfor (var i=0; i<sel.length; i++){\n\t\tvar cx = sel[i].column*1;\n\t\tvar cy = sel[i].row*1;\n\n\t\tlx = Math.min(cx, lx);\n\t\trx = Math.max(cx, rx);\n\t\tly = Math.min(cy, ly);\n\t\try = Math.max(cy, ry);\n\t}\n\n\treturn {\n\t\tcell:{ row:ly, column:lx },\n\t\tx: rx-lx+1,\n\t\ty: ry-ly+1\n\t};\n}\n\nexport function setSpanCss(view, row, column, css, add){\n\tconst span = getSpan(view, row, column);\n\tif (span){\n\t\tif (add){\n\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\tspan[3] += \" \" + css;\n\t\t} else {\n\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t}\n\t}\n}\n\nfunction getExtraCss(view, row, column){\n\treturn view.getCellEditor(row, column) ? \"ss_editor\"\n\t\t: (view.getCellFilter(row, column) ? \"ss_filter\" : \"\");\n}\n\nfunction undoSpan(view,row, column,value,isUndo){\n\tif(isUndo){\n\t\tremoveSpan(view,{row: row, column: column});\n\t}\n\telse{\n\t\taddSpan(view, {row: row, column: column}, value[0], value[1]);\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet spans = data.spans;\n\tif(inc){\n\t\tfor(let i = spans.length-1;i >=0;i--){\n\t\t\tlet [row,column] = spans[i];\n\n\t\t\tif(inc < 0){//deleting\n\t\t\t\tif(name == \"row\" && row <= start.row-inc-1)\n\t\t\t\t\tinc = start.row - spans[i][0];\n\t\t\t\telse if (name == \"column\" && column <= start.column-inc-1)\n\t\t\t\t\tinc = start.column - spans[i][1];\n\t\t\t}\n\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tspans[i][0] =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tspans[i][1] = name == \"column\"?column*1 + inc:column;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar borderChecks = {\n\t\"border-right\":\t\tfunction(row, column, span, area){\n\t\treturn area.end.column == column+span[0]-1;\n\t},\n\t\"border-bottom\":\tfunction(row, column, span, area){\n\t\treturn area.end.row == row+span[1]-1;\n\t}\n};\n\nfunction checkSpanBorders(view, row, column, area, mode){\n\tvar span = getSpan(view, row, column);\n\treturn span&&borderChecks[mode]?borderChecks[mode](row, column, span, area):false;\n}\n\n// clear merged cells except the first one\nfunction setSpanValue(view, cell, x, y){\n\tvar i,j,value,\n\t\trow = cell.row*1,\n\t\tcolumn = cell.column*1,\n\t\tisEmpty = !view.getCellValue(row,column);\n\tfor(i = row; i < row+y; i++){\n\t\tfor(j = column; j < column+x; j++) {\n\t\t\tvalue = view.getCellValue(i,j);\n\t\t\tif(value!==\"\" && (j != column || i != row)){\n\t\t\t\tif(isEmpty){\n\t\t\t\t\tisEmpty = false;\n\t\t\t\t\tview.setCellValue(row,column,value);\n\t\t\t\t}\n\t\t\t\tview.setCellValue(i,j,\"\");\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function adjustSpan (span, action, start, end, data){\n\tvar length = action.group == \"row\" ? span[3] : span[2];\n\tvar checkSpan = action.group == \"row\" ? [span[0]*1, span[0]*1+span[3]-1] : [span[1]*1, span[1]*1+span[2]-1];\n\tvar selection = action.group == \"row\" ? [start.row, end.row] : [start.column, end.column];\n\n\t//if we add, the number of selected rows/cols is added to span, so we need original selection length\n\tvar inc = selection[1] - selection[0] + 1;\n\n\tselection[0] = Math.max(selection[0], checkSpan[0]);\n\tselection[1] = Math.min(selection[1], checkSpan[1]);\n\n\tvar isFirstCell = selection[0] == checkSpan[0];\n\n\tif(selection[0] <= selection[1]){ //selection is in span\n\t\tif(action.id == \"del\") //if we delete, only rows/cols included into span\n\t\t\tinc = (selection[1] - selection[0]+ 1) * -1;\n\t\t//delete smth which starts as span and less than it's length\n\t\tif(action.id == \"del\" && isFirstCell && length > -1*inc){\n\t\t\tvar value = find(data, function(value) {\n\t\t\t\treturn (value[0] == span[0] && value[1] == span[1]);\n\t\t\t});\n\n\t\t\tvalue[0] = action.group == \"row\" ? value[0] - inc : value[0];\n\t\t\tvalue[1] = action.group == \"column\" ? value[1] - inc : value[1];\n\n\t\t\tvar oldValue = findIndex(data, function(oldValue) {\n\t\t\t\treturn oldValue[0] == value[0] && oldValue[1] == value[1] && (oldValue[2] != value[2] || oldValue[3] != value[3]); \n\t\t\t});\n\n\t\t\tif(oldValue > -1) //remove another data at the same place\n\t\t\t\tdata.splice(oldValue,1);\n\t\t}\n\n\t\tif(!(isFirstCell && action.id == \"add\")){\n\t\t\tspan[2] = action.group == \"column\" ? span[2]+inc : span[2];\n\t\t\tspan[3] = action.group == \"row\" ? span[3]+inc : span[3];\n\t\t}\n\t}\n\treturn span;\n}\n\nexport function pasteSpan(view, extra, row, col, cutted, translate){\n\t//existing span\n\tvar s = view._table.getSpan(row, col);\n\tif(extra && extra.span){\n\t\tvar span = extra.span;\n\t\t//if we are on start position for the future span\n\t\tif(row == span[0]*1+translate.row && col == span[1]*1+translate.column){\n\t\t\t//delete spans in future paste zone \n\t\t\tview._table.mapCells(row, col, span[3], span[2], (value, rid, cid) => {\n\t\t\t\ts = view._table.getSpan(rid,cid);\n\t\t\t\tif(s) removeSpan(view, {row:s[0], column:s[1]});\n\t\t\t}, true);\n\t\t\taddSpan(view, {row:row, column:col}, span[2], span[3]);\n\t\t\tif(cutted === 1)\n\t\t\t\tremoveSpan(view, {row:extra.row, column:extra.col});\n\t\t}\n\t}\n\telse if(s)\n\t\tremoveSpan(view, {row:s[0], column:s[1]});\n}","import group from \"./undo_group\";\nimport {getType} from \"./types\";\nimport {setSpanCss} from \"./spans\";\nimport {isDateInvalid} from \"./formats\";\nimport {rangeOptions} from \"../math/ranges\";\nimport {changeRange, eachRange, toRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.on_click.ssheet_filter_sign = (e, id) => {\n\t\tconst filter = table._ssFilters[id.row][id.column];\n\t\tconst mode = filter.mode || getFilterMode(view, id.row, id.column);\n\n\t\tlet options = [];\n\t\tif (filter.options){\n\t\t\tif (typeof filter.options == \"string\")\n\t\t\t\toptions = rangeOptions(view, filter.options, { unique:true, order:true, filter:true });\n\t\t\telse if (webix.isArray(filter.options))\n\t\t\t\toptions = rangeOptions(view, filter.options, { filter:true });\n\t\t}\n\t\tview.callEvent(\"onCommand\", [{id:\"start-filter\", cell:id, mode, options, filter}]);\n\t};\n\ttable.on_dblclick.ssheet_filter_sign = () => false;\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"create-filter\")\n\t\t\ttoggleFilters(view);\n\t});\n\n\tlet refilter = false;\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"filter\"){\n\t\t\tvalue = (typeof value == \"object\") ? value : null;\n\t\t\tview.setCellFilter(row, column, value);\n\t\t\trefilter = true;\n\t\t}\n\t\telse if (type == \"apply-filter\"){\n\t\t\tconst filter = view.getCellFilter(row, column);\n\n\t\t\tfilter.value = value;\n\t\t\tdelete filter.handler;\n\t\t\tif (value && value.condition){\n\t\t\t\tconst mode = filter.mode || getFilterMode(view, row, column);\n\t\t\t\tfilter.handler = getFilterFunction(mode, filter.value);\n\t\t\t}\n\t\t\trefilter = true;\n\n\t\t\t// update css\n\t\t\tconst add = value && isValueActive(value);\n\t\t\ttable[add?\"addCellCss\":\"removeCellCss\"](row, column, \"ss_filter_active\");\n\t\t\tsetSpanCss(view, row, column, \"ss_filter_active\", add);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAfterUndo\", () => {\n\t\tif (refilter){\n\t\t\tview.filterSpreadSheet();\n\t\t\trefilter = false;\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"filter\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter\", p.newValue);\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter_active\", (p.newValue && p.newValue.value && isValueActive(p.newValue.value)));\n\t\t\tmarkBarFilter(view);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name, p.inc, p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssFilters = {};\n\tmarkBarFilter(view);\n}\n\nexport function getFilters(table){\n\tconst filters = table._ssFilters;\n\tconst all = [];\n\tfor (let row in filters)\n\t\tfor (let column in filters[row])\n\t\t\tall.push(filters[row][column]);\n\treturn all;\n}\n\nexport function serialize(view,data){\n\tconst filters = getFilters(view._table);\n\tconst result = data.filters = [];\n\n\tfor (let i = 0; i<filters.length; i++){\n\t\tlet {row, column, options, mode, value} = filters[i];\n\t\tvalue = value && webix.copy(value);\n\t\tresult.push([row, column, {value, options, mode}]);\n\t}\n}\n\nexport function load(view,data){\n\tconst filters = data.filters;\n\n\tif (filters){\n\t\tfor (let i = 0; i < filters.length; i++){\n\t\t\tview.setCellFilter(filters[i][0], filters[i][1], (filters[i][2] || {options:\"\"}));\n\t\t}\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nexport function clearFilters(view, range){\n\tlet refilter = false;\n\teachRange(range, view, function(view, cell){\n\t\tlet filter = view._table._ssFilters[cell.row];\n\t\tif (filter){\n\t\t\tif (filter[cell.column]){\n\t\t\t\trefilter = true;\n\t\t\t\tdelete filter[cell.column];\n\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter\");\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter_active\");\n\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter\", false);\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter_active\", false);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (refilter)\n\t\tview.filterSpreadSheet();\n}\n\nexport function isFilter(view, row, column){\n\tconst filters = view._table._ssFilters;\n\treturn filters[row] && !!filters[row][column];\n}\n\nexport function calibrateRange(view, row, column, range){\n\tif(!range)\n\t\trange = {end:{row:row}};\n\n\tif (range.end){\n\t\tvar endRow = range.end.row;\n\t\trange = getFilterRange(view, row, column, endRow);\n\t}\n\treturn range;\n}\n\nexport function isValueActive(value){\n\treturn !!(value.includes || (value.condition && value.condition.filter));\n}\n\nfunction isFilterExists(view){\n\tconst filters = view._table._ssFilters;\n\tfor (let row in filters)\n\t\tfor (let column in filters[row])\n\t\t\tif (filters[row][column]) return true;\n\treturn false;\n}\n\nfunction markBarFilter(view){\n\tconst value = isFilterExists(view);\n\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"create-filter\", value}]);\n}\n\n\nfunction getFilterRange(view, row, column, endRow){\n\tif (row === endRow){\n\t\tfor (endRow = row; endRow < view.config.rowCount; endRow++){\n\t\t\tif(!view.getCellValue(endRow+1, column))\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn toRange(row+1, column, endRow, column);\n}\n\nexport function getFilterMode(view, row, column){\n\tfor (let i=row; i<view.config.rowCount; i++){\n\t\tconst item = view.getRow(i+1);\n\t\tconst value = item[\"$\"+column] || item[column];\n\n\t\tif (value || value === 0){\n\t\t\tconst type = getType(view, i+1, column);\n\t\t\treturn (type == \"number\" || type == \"date\") ? type : \"text\";\n\t\t}\n\t\telse if (value !== \"\")\n\t\t\tbreak;\n\t}\n\treturn \"text\";\n}\n\nfunction toggleFilters(view){\n\tconst range = view._table.getSelectArea();\n\n\tif (isFilterExists(view)){\n\t\tgroup.set(function(){\n\t\t\tview.removeFilters();\n\t\t});\n\t\tif (range)\n\t\t\tview._table.addSelectArea(range.start, range.end);\n\t}\n\telse if (range)\n\t\tgroup.set(function(){\n\t\t\tlet row = range.start.row;\n\t\t\tfor (let i=range.start.column; i<=range.end.column; i++){\n\t\t\t\tview.setCellFilter(row, i, { options:range });\n\t\t\t}\n\t\t});\n\tmarkBarFilter(view);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tconst filters = data.filters;\n\n\tif (inc){\n\t\tfor(let i=filters.length-1; i>=0; i--){\n\t\t\tlet [row,column,filter] = filters[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete filter mark if row was deleted\n\t\t\t\t\t\tfilters.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tfilters[i][0] = row*1 + inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tfilters.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\tfilters[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\tfilter.options = changeRange(filter.options, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteFilter(view, extra, row, col, cutted, translate){\n\tconst filter = extra.filter;\n\n\tfilter.options = changeRange(filter.options, \"row\", translate.row, {column:extra.col, row:extra.row});\n\tfilter.options = changeRange(filter.options, \"column\", translate.column, {column:extra.col, row:extra.row});\n\n\tdelete filter.value; delete filter.handler;\n\tview.setCellFilter(row, col, filter);\n}\n\nexport function getSingleOption(mode, type){\n\tconst c = conditions[mode];\n\tfor (let i=0; i<c.length; i++)\n\t\tif (c[i].id == type) return c[i];\n}\n\nexport function getConditions(name){\n\treturn webix.copy( conditions[name] );\n}\n\nexport function getFilterFunction(mode, value){\n\tconst { includes, condition } = value;\n\tconst opt = getSingleOption(mode, condition.type);\n\tconst handler = opt ? opt.handler : function(){ return true; };\n\n\tif (includes){\n\t\tfor (let i=0; i<includes.length; i++)\n\t\t\tincludes[i] = String(includes[i]);\n\t}\n\n\treturn function(value){\n\t\tif (includes){\n\t\t\treturn includes.indexOf(value) !== -1;\n\t\t} else {\n\t\t\treturn condition.filter === \"\" || handler(value, condition.filter);\n\t\t}\n\t};\n}\n\nfunction isDate(value){\n\treturn value && !isNaN(value) && !isDateInvalid(value);\n}\n\nconst conditions = {\n\tnumber:[\n\t\t{ id:\"greater\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 > b*1);\n\t\t}},\n\t\t{ id:\"less\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 < b*1);\n\t\t}},\n\t\t{ id:\"greaterOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 >= b*1);\n\t\t}},\n\t\t{ id:\"lessOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 <= b*1);\n\t\t}},\n\t\t{ id:\"equal\", batch:\"text\", handler:function(a,b){ return a == b; }},\n\t\t{ id:\"notEqual\", batch:\"text\", handler:function(a,b){ return a != b; }},\n\t\t{ id:\"contains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase()) !== -1;\n\t\t}},\n\t\t{ id:\"notContains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase()) === -1;\n\t\t}}\n\t],\n\ttext: [\n\t\t{ id:\"contains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase()) !== -1;\n\t\t}},\n\t\t{ id:\"notContains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase()) === -1;\n\t\t}},\n\t\t{ id:\"equal\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase() === b.toLowerCase();\n\t\t}},\n\t\t{ id:\"notEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase() !== b.toLowerCase();\n\t\t}},\n\t\t{ id:\"beginsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().lastIndexOf(b.toLowerCase(), 0) === 0;\n\t\t}},\n\t\t{ id:\"notBeginsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().lastIndexOf(b.toLowerCase(), 0) !== 0;\n\t\t}},\n\t\t{ id:\"endsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase(), a.length - b.length) !== -1;\n\t\t}},\n\t\t{ id:\"notEndsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase(), a.length - b.length) === -1;\n\t\t}}\n\t],\n\tdate: [\n\t\t{ id:\"greater\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a > b;\n\t\t}},\n\t\t{ id:\"less\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a < b;\n\t\t}},\n\t\t{ id:\"greaterOrEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a >= b;\n\t\t}},\n\t\t{ id:\"lessOrEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a <= b;\n\t\t}},\n\t\t{ id:\"equal\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a == b;\n\t\t}},\n\t\t{ id:\"notEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn !isDate(a) || a != b;\n\t\t}},\n\t\t{ id:\"between\", batch: \"daterangepicker\", handler: function(a, b){\n\t\t\tif (!isDate(a)) return false;\n\t\t\treturn (!b.start || a > b.start) && (!b.end || a < b.end);\n\t\t}},\n\t\t{ id:\"notBetween\", batch: \"daterangepicker\", handler: function(a, b){\n\t\t\tif (!isDate(a)) return false;\n\t\t\treturn (!b.start || a <= b.start) || (!b.end || a >= b.end);\n\t\t}}\n\t]\n};","import {Dialog} from \"./common\";\nimport * as flt from \"../operations/filter\";\n\nexport const action = \"start-filter\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.cell = action.cell;\n\t\tthis.$mode = action.mode;\n\t\tthis.$filter = action.filter;\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column))){\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", () => this.$hide());\n\n\t\t\tconst table = this.view.$$(\"cells\");\n\t\t\ttable.attachEvent(\"onScrollY\", () => this.syncScroll());\n\t\t\ttable.attachEvent(\"onScrollX\", () => this.syncScroll());\n\t\t}\n\n\t\tif (this.$show(this.$filter.value, action.options) === false)\n\t\t\treturn this.close();\n\t\tthis.$dialog.show( this._getTargetNode() );\n\t}\n\t_getTargetNode(){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = table.getSpan(this.cell.row, this.cell.column);\n\t\treturn span ? table.getSpanNode(this.cell) : table.getItemNode(this.cell);\n\t}\n\t$show(value, options){\n\t\tconst list = this.getList();\n\t\tconst filter = this.getFilter();\n\n\t\tif (filter.config.mode !== this.$mode){\n\t\t\tfilter.define(\"conditions\", this.getConditions(this.$mode));\n\t\t\tfilter.define(\"mode\", this.$mode);\n\t\t}\n\n\t\t// if the filter mode for the current column has been changed - reset the value\n\t\tconst type = value && value.conditions && value.conditions.type;\n\t\tif (type && !flt.getSingleOption(this.$mode, type))\n\t\t\tvalue = \"\";\n\n\t\tlist.clearAll();\n\t\tlist.data.importData(options);\n\n\t\t// filter data has been changed - reset value\n\t\tfilter.config.value = \"\";\n\t\tfilter.setValue( webix.copy(value||{}) );\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn {\n\t\t\tview:\"popup\",\n\t\t\tcss:\"ssheet_filter\",\n\t\t\tpadding:7,\n\t\t\trelative:\"right\",\n\t\t\tbody:{\n\t\t\t\tmargin:4,\n\t\t\t\trows:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"filter\",\n\t\t\t\t\t\tfield:\"value\",\n\t\t\t\t\t\tmode:\"text\",\n\t\t\t\t\t\tconditions:this.getConditions(\"text\"),\n\t\t\t\t\t\tinputs:[\n\t\t\t\t\t\t\t\"text\",\n\t\t\t\t\t\t\t{ view:\"ssheet-datepicker\", timepicker:true, batch:\"datepicker\", on:{\n\t\t\t\t\t\t\t\tonChange:() => this.getFilter().applyFilter()\n\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t{ view:\"ssheet-daterangepicker\", timepicker:true, batch:\"daterangepicker\", on:{\n\t\t\t\t\t\t\t\tonChange:() => this.getFilter().applyFilter()\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t],\n\t\t\t\t\t\ttemplate:function(obj){\n\t\t\t\t\t\t\treturn obj.$value || obj.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ },\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"cancel\"], autowidth:true, css:\"webix_transparent\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.close()\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"apply\"], autowidth:true, css:\"webix_secondary\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.applyFilter()\n\t\t\t\t\t\t}},\n\t\t\t\t\t]}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\tapplyFilter(){\n\t\tconst filter = this.getFilter();\n\t\tconst oldValue = this.$filter.value;\n\t\tconst value = this.$filter.value = filter.getValue();\n\t\tthis.$filter.handler = flt.getFilterFunction(this.$mode, value);\n\n\t\tthis.view.filterSpreadSheet();\n\t\tthis.view.callEvent(\"onAction\", [\"apply-filter\", { row:this.cell.row, column:this.cell.column, value:oldValue, newValue:value }]);\n\t\tthis.setCellStyle(this.cell.row, this.cell.column, \"ss_filter_active\", flt.isValueActive(value));\n\n\t\tthis.close();\n\t}\n\tsetCellStyle(row, column, css, add){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = this.getSpan(table, row, column);\n\n\t\tif (span){\n\t\t\tif (add){\n\t\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\t\tspan[3] += \" \" + css;\n\t\t\t} else {\n\t\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t\t}\n\t\t}\n\t\ttable[add?\"addCellCss\":\"removeCellCss\"](row, column, css);\n\t}\n\tgetSpan(table, row, column){\n\t\tlet item = table.getSpan()[row];\n\t\tif (item)\n\t\t\treturn item[column];\n\t}\n\tgetList(){\n\t\treturn this.getFilter().getChildViews()[2];\n\t}\n\tgetFilter(){\n\t\treturn this.$dialog.getBody().getChildViews()[0];\n\t}\n\tsyncScroll(){\n\t\tif (this.$dialog.isVisible()){\n\t\t\tconst node = this._getTargetNode();\n\t\t\tconst table = this.view.$$(\"cells\");\n\n\t\t\tlet isHidden = false;\n\t\t\tif (node){\n\t\t\t\tconst nodeOffset = webix.html.offset( node );\n\t\t\t\tconst tableOffset = webix.html.offset( table.$view.getElementsByClassName(\"webix_ss_body\")[0] );\n\t\t\t\tconst ydiff = nodeOffset.y - tableOffset.y;\n\t\t\t\tconst xdiff = nodeOffset.x - tableOffset.x + nodeOffset.width;\n\n\t\t\t\tisHidden = (ydiff < 0 || ydiff+nodeOffset.height > tableOffset.height || \n\t\t\t\t\txdiff < 0 || xdiff-nodeOffset.width > tableOffset.width - webix.env.scrollSize);\n\t\t\t}\n\t\t\tif (!node || isHidden)\n\t\t\t\tthis.$dialog.show({x:-9999, y:-9999});\n\t\t\telse \n\t\t\t\tthis.$dialog.show(node);\n\t\t}\n\t}\n\tgetConditions(name){\n\t\tconst locale = webix.i18n.filter;\n\t\tconst conditions = flt.getConditions(name);\n\n\t\tfor (let i=0; i<conditions.length; i++)\n\t\t\tif (conditions[i].id)\n\t\t\t\tconditions[i].value = locale[conditions[i].id];\n\n\t\treturn conditions;\n\t}\n}","import {Dialog} from \"./common\";\nimport * as fmt from \"../operations/formats\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"custom\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tthis.form = this.$dialog.$$(\"form\");\n\t\tthis.list = this.$dialog.$$(\"list\");\n\t\tthis.preview = this.$dialog.$$(\"preview\");\n\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tthis.fillForm(this.view);\n\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\tconst i18n = webix.i18n.spreadsheet;\n\t\tconst labelsLocale = i18n.labels;\n\t\tconst formatsLocale = i18n.formats;\n\n\t\tconst docsLink = \"https://webix-guides.gitbook.io/spreadsheet-user-guide/formatting_numbers#custom-number-format\";\n\t\tconst delimiters = fmt.getDelimiters(\"int\");\n\n\t\tconst commonConfig = [\n\t\t\t{\n\t\t\t\tname:\"zeros\",\n\t\t\t\tview:\"counter\",\n\t\t\t\tcss:\"webix_ssheet_counter\",\n\t\t\t\tlabel:labelsLocale[\"decimal-places\"],\n\t\t\t\tvalue:0,\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"separator\",\n\t\t\t\tview:\"checkbox\",\n\t\t\t\tlabel:labelsLocale[\"separator\"],\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabel:labelsLocale[\"negative\"],\n\t\t\t\tname:\"negative\",\n\t\t\t\tbatch:\"common\",\n\t\t\t\tcss:\"webix_ssheet_format_negative\",\n\t\t\t\ttemplate: obj => {\n\t\t\t\t\tif(this.list){\n\t\t\t\t\t\tlet format = this.getFormat(obj.id);\n\t\t\t\t\t\tformat = fmt.format2code(format.fmt, format.delimiters);\n\t\t\t\t\t\tconst style = {css:\"\"};\n\t\t\t\t\t\tconst value = format(-1234.56789, style);\n\n\t\t\t\t\t\treturn \"<span class='\"+style.css+\"'>\"+value+\"</span>\";\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdata:[{id:1}, {id:2}, {id:3}]\n\t\t\t}\n\t\t];\n\n\t\tconst customConfig = [\n\t\t\t{\n\t\t\t\tview:\"text\",\n\t\t\t\tlabel: labelsLocale[\"format-pattern\"],\n\t\t\t\tname:\"format\",\n\t\t\t\tlabelPosition:\"top\",\n\t\t\t\tbatch:\"custom\",\n\t\t\t\tplaceholder:\"[>100]0\"+delimiters.groupSign+\"000\"+delimiters.decimalSign+\"00;[>0]None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"docs\",\n\t\t\t\ttemplate: \"<a href='\"+docsLink+\"' target='_blank' class = 'docs'>\"+labelsLocale[\"format-docs\"]+\"</a>\",\n\t\t\t\tborderless:true,\n\t\t\t\tbatch:\"custom\"\n\t\t\t}\n\t\t];\n\n\t\tconst dateConfig = [\n\t\t\t{\n\t\t\t\tname:\"date\",\n\t\t\t\tbatch:\"date\",\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabelWidth: 90,\n\t\t\t\theight: 160,\n\t\t\t\tlabel:labelsLocale[\"date-format\"],\n\t\t\t\tcss:\"webix_ssheet_format_date\",\n\t\t\t\ttemplate: obj => fmt.format2code(obj.value, delimiters)(45000),\n\t\t\t\tdata:[\n\t\t\t\t\tformatsLocale.dateFormat,\n\t\t\t\t\tformatsLocale.timeFormat,\n\t\t\t\t\tformatsLocale.fullDateFormat,\n\t\t\t\t\tformatsLocale.longDateFormat\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth:460,\n\t\t\thead: labelsLocale[\"format-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"list\",\n\t\t\t\t\t\tid:\"list\",\n\t\t\t\t\t\tcss:\"webix_ssheet_format_type\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tscroll:false,\n\t\t\t\t\t\tdata:this.getFormats(),\n\t\t\t\t\t\tselect:true,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonSelectChange: (id)=>{\n\t\t\t\t\t\t\t\tthis.updateForm();\n\t\t\t\t\t\t\t\tswitch(id[0]){\n\t\t\t\t\t\t\t\t\tcase \"custom\":\n\t\t\t\t\t\t\t\t\tcase \"date\":\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(id[0]);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(\"common\");\n\t\t\t\t\t\t\t\t\t\tthis.form.elements.separator.show();\n\t\t\t\t\t\t\t\t\t\tif(id[0] == \"percent\")\n\t\t\t\t\t\t\t\t\t\t\tthis.form.elements.separator.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"form\",\n\t\t\t\t\t\tid:\"form\",\n\t\t\t\t\t\tmargin:15,\n\t\t\t\t\t\theight:270,\n\t\t\t\t\t\tpaddingY:0,\n\t\t\t\t\t\tpaddingX:20,\n\t\t\t\t\t\telements:[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: \"preview\",\n\t\t\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\t\t\tif(obj.value == i18n.table[\"format-error\"])\n\t\t\t\t\t\t\t\t\t\treturn obj.value;\n\t\t\t\t\t\t\t\t\treturn \"<span class ='\"+obj.css+\"'>\"+obj.value+\"</span>\";\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_format_preview\",\n\t\t\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\t\t\tborderless:true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t].concat(commonConfig, customConfig, dateConfig),\n\t\t\t\t\t\telementsConfig: {\n\t\t\t\t\t\t\tlabelWidth: 155\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: () => this.updateForm()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.closeWin()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tlet type = this.list.getSelectedId();\n\t\tlet values = (type == \"custom\")?{format:this.form.getValues().format}:this.form.getValues();\n\t\tvalues.type = type;\n\n\t\tgroup.set(()=>{\n\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\tfmt.addFormat(this.view, this.cell[i].row, this.cell[i].column, values.format, values);\n\t\t});\n\n\t\tthis.view.$$(\"cells\").refresh();\n\t\tthis.closeWin();\n\t}\n\tcloseWin(){\n\t\tconst style = this.view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tconst name = style && style.props.format ? style.props.format : \"common\";\n\n\t\t//default format\n\t\tif(!fmt.isCustom(name))\n\t\t\tthis.view.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:name}]);\n\t\tthis.close();\n\t}\n\tgetFormat(negative){\n\t\tconst type = this.list.getSelectedId();\n\t\tlet values = this.form.getValues();\n\n\t\tvalues.negative = negative || values.negative;\n\t\tif(type != \"custom\"){\n\t\t\tif(type != \"date\")\n\t\t\t\tvalues.date = \"\";\n\n\t\t\tvalues = fmt.formToValues(type, values);\n\t\t\treturn {\n\t\t\t\tfmt: fmt.serializeFormat(values),\n\t\t\t\tdelimiters:fmt.getDelimiters(type)\n\t\t\t};\n\t\t}\n\t\telse\n\t\t\treturn {\n\t\t\t\tfmt: values.format,\n\t\t\t\tdelimiters: fmt.getDelimiters(type)\n\t\t\t};\n\t}\n\tfillForm(view){\n\t\tconst locale = webix.i18n.spreadsheet;\n\t\tconst style = view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tlet values = { zeros:0, separator: 0, negative: 1, date: locale.formats.dateFormat, format: \"\"};\n\t\tlet type;\n\n\t\tlet name = style && style.props.format ? style.props.format : \"\";\n\n\t\tvalues.format = fmt.getFormatSource(name || \"price\");\n\n\t\tif(!name)\n\t\t\ttype = name = \"price\";\n\t\telse if(name == \"string\")\n\t\t\ttype = name = \"custom\";\n\t\telse\n\t\t\ttype = fmt.formatHelpers[name].values.type;\n\n\t\tif(type != \"custom\")\n\t\t\twebix.extend(values, fmt.formatHelpers[name].values, true);\n\n\t\tconst item = this.view.$$(\"cells\").getItem(this.cell[0].row);\n\t\tconst col = this.cell[0].column;\n\n\t\tthis.value = webix.isUndefined(item[col]) ? \"\" : item[col];\n\n\t\tthis.form.setValues(values);\n\t\tthis.list.select(type);\n\t\tthis.updateForm();\n\t}\n\tupdateForm(){\n\t\tconst form = this.form.elements;\n\t\tconst format = this.getFormat();\n\t\tlet value = this.value;\n\n\t\tconst isText = value === \"\" || isNaN(value);\n\n\t\tif(fmt.checkFormat(format, \"date\") && (isText || fmt.isDateInvalid(value)))\n\t\t\tvalue = 45000;\n\t\telse if(isText && !fmt.checkFormat(format, \"string\"))\n\t\t\tvalue = 1234.56789;\n\n\t\tlet style = {css:\"\"};\n\t\tvalue = fmt.format2code(format.fmt, format.delimiters)(value, style);\n\n\t\t//preview values\n\t\tthis.preview.parse({value:value, css:style.css});\n\t\tform.negative.refresh();\n\t\tform.date.refresh();\n\n\t\t//set new format string\n\t\tform.format.setValue(format.fmt);\n\t}\n\tgetFormats(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn [\n\t\t\t{id: \"price\", value: locale.currency},\n\t\t\t{id: \"int\", value: locale.number},\n\t\t\t{id: \"percent\", value: locale.percent},\n\t\t\t{id: \"date\", value: locale.date},\n\t\t\t{id: \"custom\", value: locale[\"custom-format\"]}\n\t\t];\n\t}\n}","import {Dialog} from \"./common\";\nimport {getJsDateFromExcel, getExcelDateFromJs} from \"../math/methods/helpers\";\nimport {isDateInvalid} from \"../operations/formats\";\nimport {getDateEditFormat} from \"../operations/formats\";\n\nexport const action = \"conditional-format\";\n\nconst condition = [\n\t{id: \">\",value: \">\" },\n\t{id: \"<\",value: \"<\"},\n\t{id: \"=\",value: \"=\"},\n\t{id: \"!=\",value: webix.i18n.spreadsheet.labels[\"conditional-not-equal\"]},\n\t{id: \"<>\",value: webix.i18n.spreadsheet.labels[\"conditional-between\"]}\n];\n\nfunction getConditionStyle(data){\n\treturn data.map(item => {\n\t\titem.id = item.css;\n\t\treturn item;\n\t});\n}\n\nexport class DialogBox extends Dialog{\n\t_getCondition() {\n\t\tlet view = this.view;\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\tlet data = [];\n\n\t\tforms.forEach(form => {\n\t\t\tif (!form.getValues) return;\n\t\t\tlet values = form.getValues();\n\t\t\tlet item = [];\n\t\t\titem.push(values.condition);\n\n\t\t\tif(values.condition !== \"<>\"){\n\t\t\t\titem.push(this._normalizeValue(values.value));\n\t\t\t} else {\n\t\t\t\titem.push([this._normalizeValue(values.value), this._normalizeValue(values.value2)]);\n\t\t\t}\n\t\t\titem.push(values.style);\n\t\t\tfor(var i=0; i < item.length; i++){\n\t\t\t\tif(item[i] === \"\")\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdata.push(item);\n\t\t});\n\n\t\tview.callEvent(\"onConditionSet\", [data]);\n\t}\n\t_safeInt(a){\n\t\tvar num = parseFloat(a);\n\t\tif (num == a) return num;\n\t\treturn a;\n\t}\n\t_setCondition() {\n\t\tvar view = this.view;\n\t\tvar collection = view.conditions.get(this.cell.row, this.cell.column);\n\n\t\tif(collection){\n\t\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\t\tcollection.forEach((item, i) => {\n\t\t\t\tvar values = {};\n\t\t\t\tvalues.condition = item[0];\n\t\t\t\tif(webix.isArray(item[1])){\n\t\t\t\t\tvalues.value = this._formatValue(item[1][0]);\n\t\t\t\t\tvalues.value2 = this._formatValue(item[1][1]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tvalues.value = this._formatValue(item[1]);\n\n\t\t\t\tvalues.style = item[2];\n\t\t\t\tforms[i+1].setValues(values);\n\t\t\t});\n\t\t}\n\t}\n\n\t_formatValue(value){\n\t\tif(this.editFormat && value !== \"\" && value[0] != \"=\"){\n\t\t\tvalue = getJsDateFromExcel(value);\n\t\t\treturn this.editFormat(value);\n\t\t}\n\t\treturn value.toString();\n\t}\n\n\t_normalizeValue(value){\n\t\tif(this.editFormat){\n\t\t\tif(isNaN(value)){\n\t\t\t\tif(value[0] != \"=\"){\n\t\t\t\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\t\t\t\tvalue = parser(value);\n\t\t\t\t\tvalue = isNaN(value) ? \"\" : getExcelDateFromJs(value);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = isDateInvalid(value) ? \"\" : value;\n\t\t}\n\t\telse\n\t\t\tvalue = this._safeInt(value, 10);\n\n\t\treturn value;\n\t}\n\n\tapply(){\n\t\tthis._getCondition();\n\t\tthis.close();\n\t}\n\n\t_clean() {\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\tforms.forEach(form => {\n\t\t\tif (form.setValues) form.setValues({condition: \"\", value: \"\", value2: \"\", style: \"\"});\n\t\t});\n\t}\n\n\t$show(){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tconst item = this.view.getRow(this.cell.row);\n\t\tlet type = item.$cellType;\n\t\tif(type)\n\t\t\ttype = type[this.cell.column];\n\n\t\tif(type == \"date\")\n\t\t\tthis.editFormat = getDateEditFormat(item, this.cell.column);\n\n\t\tthis.$dialog.queryView(\"text\", \"all\").forEach(view => {\n\t\t\tview.define({placeholder: type == \"date\" ? this._formatValue(45000) : \"\"});\n\t\t\tview.refresh();\n\t\t});\n\n\t\tthis.view.$handleSelection = (st, end, a, b)=>{\n\t\t\tif (this.activeValue && a == b){\n\t\t\t\tthis.activeValue.setValue(\"=\"+a);\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis._setCondition();\n\t}\n\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t\tdelete this.editFormat;\n\t\tthis._clean();\n\t}\n\n\tgetRows(data, count){\n\t\tlet headers = {\n\t\t\theight: 36,\n\t\t\tpadding:{\n\t\t\t\tleft: 12\n\t\t\t},\n\t\t\tcols: [\n\t\t\t\t{ view:\"label\", width:131, label: webix.i18n.spreadsheet.labels.display },\n\t\t\t\t{ view:\"label\", width: 116, label: webix.i18n.spreadsheet.labels.condition },\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.value }\n\t\t\t]\n\t\t};\n\t\tlet arr = [headers];\n\n\t\tlet item = {\n\t\t\tview: \"form\",\n\t\t\tpadding: 0,\n\t\t\tborderless: true,\n\t\t\tcss:\"webix_ssheet_cformats\",\n\t\t\telements: [{\n\t\t\t\tmargin: 10,\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\tname: \"style\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-style\"],\n\t\t\t\t\t\tcss: \"webix_ssheet_cformat_select\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding:0,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\tcss: \"webix_ssheet_cformat_list\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\ttemplate(obj) {\n\t\t\t\t\t\t\t\t\tvar css = \"webix_ssheet_cformat \"+obj.css;\n\t\t\t\t\t\t\t\t\treturn `<div class=\"${css}\">${obj.name}</div>`;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\twidth: 105,\n\t\t\t\t\t\tname: \"condition\",\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-operator\"],\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: function(newv){\n\t\t\t\t\t\t\t\tif(newv === \"<>\"){\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.show();\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\tdata: condition\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonBlur: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tlet value = current_view.getValue();\n\t\t\t\t\t\t\t\t\t\tif(value !== \"\"){\n\t\t\t\t\t\t\t\t\t\t\tvalue = this._normalizeValue(value);\n\t\t\t\t\t\t\t\t\t\t\tcurrent_view.setValue(this._formatValue(value));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tname: \"value\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tname: \"value2\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonBlur: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tlet value = current_view.getValue();\n\t\t\t\t\t\t\t\t\t\tif(value !== \"\"){\n\t\t\t\t\t\t\t\t\t\t\tvalue = this._normalizeValue(value);\n\t\t\t\t\t\t\t\t\t\t\tcurrent_view.setValue(this._formatValue(value));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{ view:\"icon\", css:\"webix_ssheet_cformat_clear\", icon:\"wxi-trash\", click:clearRow }\n\t\t\t\t]}\n\t\t\t]};\n\n\t\twhile(count--){\n\t\t\tarr.push(item);\n\t\t}\n\t\treturn arr;\n\t}\n\n\t$init(){\n\t\t//[IMPROVE] can be optimized by using datalayout instead of nested forms\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"conditional-format\"],\n\t\t\tposition:\"center\",\n\t\t\twidth: 670,\n\t\t\tmove: true,\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview: \"form\",\n\t\t\t\tborderless: true,\n\t\t\t\trows: [\n\t\t\t\t\t{rows: this.getRows(getConditionStyle(this.view.config.conditionStyle), 3)},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{gravity:2},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\tvalue: webix.i18n.spreadsheet.labels.apply,\n\t\t\t\t\t\t\t\tclick: () => this.apply()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonHideClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\nfunction clearRow(){\n\t//this - clear icon\n\tvar form = this.getFormView();\n\tform.clear();\n}","import {Dialog} from \"./common\";\n\nexport const action = \"excel-export\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.sheets.setValue(this.getSheets());\n\t\tform.elements.filename.setValue(\"Data\");\n\t\tform.elements.filename.getInputNode().select();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"export-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"filename\",  placeholder:webix.i18n.spreadsheet.labels[\"export-name\"]},\n\t\t\t\t\t{ view:\"multicheckbox\", name:\"sheets\"}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tgetSheets(){\n\t\tconst view = this.view;\n\t\tconst sheets = view._sheets;\n\t\tlet value = [];\n\n\t\tfor(let i = 0; i < sheets.length; i++)\n\t\t\tvalue.push({\n\t\t\t\tname: sheets[i].name,\n\t\t\t\tactive: view._activeSheet === sheets[i].name ? 1 : 0\n\t\t\t});\n\n\t\treturn value;\n\t}\n}\n\nfunction okClick(dialog){\n\tconst values = dialog.$dialog.getBody().getValues();\n\twebix.toExcel(dialog.view, values);\n\tdialog.close();\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-link\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tvar cell = this.view.getSelectedId();\n\t\tif(!cell)\n\t\t\treturn false;\n\t\tif (!this.restoreValue(form))\n\t\t\tform.clear();\n\t\tform.elements.name.focus();\n\t}\n\trestoreValue(form){\n\t\tvar cell = this.view.getSelectedId();\n\t\tif (cell){\n\t\t\tvar item = this.view.getRow(cell.row);\n\t\t\tvar value = item[\"$\"+cell.column] || item[cell.column];\n\t\t\tif (value && value.indexOf(\"=HYPERLINK\") === 0){\n\t\t\t\tvar parts = value.split(\"\\\"\");\n\t\t\t\tform.setValues({\n\t\t\t\t\tname: (parts[3] || \"\"),\n\t\t\t\t\turl: (parts[1] || \"\")\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"link-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"name\",  placeholder:webix.i18n.spreadsheet.labels[\"link-name\"]},\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"link-url\"]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\nfunction okClick(dialog){\n\tvar cell = dialog.view.getSelectedId();\n\tvar data = dialog.$dialog.getBody().getValues();\n\n\tvar text = \"\";\n\tif (data.url){\n\t\tdata.name = data.name || data.url;\n\t\tif (!/^https?:\\/\\//i.test(data.url))\n\t\t\tdata.url = \"http://\" + data.url;\n\t\ttext = `=HYPERLINK(\"${data.url}\",\"${data.name}\")`;\n\t}\n\n\tdialog.view.setCellValue(cell.row, cell.column, text);\n\tdialog.view.refresh();\n\tdialog.close();\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"print\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tform.setValues({\n\t\t\tdata:\"current\",\n\t\t\tpaper:\"A4\",\n\t\t\tfit:\"page\",\n\t\t\tmode:\"landscape\",\n\t\t\tsheetnames:1,\n\t\t\tmargin:0\n\t\t});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"print-title\"],\n\t\t\tmove: true,\n\t\t\tmodal:true,\n\t\t\twidth:530, height:520,\n\t\t\tposition: \"center\",\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-settings\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ view:\"radio\", name:\"data\",vertical:true, options:[\n\t\t\t\t\t\t\t{ id:\"current\", value:webix.i18n.spreadsheet.labels[\"current-sheet\"]},\n\t\t\t\t\t\t\t{ id:\"all\", value:webix.i18n.spreadsheet.labels[\"all-sheets\"]},\n\t\t\t\t\t\t\t{ id:\"selection\", value:webix.i18n.spreadsheet.labels[\"selection\"]}\n\t\t\t\t\t\t], on:{\n\t\t\t\t\t\t\tonChange:function(newv){\n\t\t\t\t\t\t\t\tif(newv == \"all\"){\n\t\t\t\t\t\t\t\t\tvar form = this.getFormView();\n\t\t\t\t\t\t\t\t\tform.elements.sheetnames.setValue(1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ rows:[\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"sheetnames\", labelRight:webix.i18n.spreadsheet.labels[\"sheet-names\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"borderless\", labelRight:webix.i18n.spreadsheet.labels[\"borderless\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"skiprows\", labelRight:webix.i18n.spreadsheet.labels[\"skip-rows\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"margin\", labelRight:webix.i18n.spreadsheet.labels[\"margin\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-paper\"]},\n\t\t\t\t\t{ view:\"radio\", name:\"paper\", options:[\n\t\t\t\t\t\t{ id:\"letter\", value:webix.i18n.spreadsheet.labels[\"page-letter\"]},\n\t\t\t\t\t\t{ id:\"A4\", value:webix.i18n.spreadsheet.labels[\"page-a4\"]},\n\t\t\t\t\t\t{ id:\"A3\", value:webix.i18n.spreadsheet.labels[\"page-a3\"]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-layout\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{view:\"radio\", name:\"fit\", options:[\n\t\t\t\t\t\t\t{ id:\"page\", value:webix.i18n.spreadsheet.labels[\"page-width\"]},\n\t\t\t\t\t\t\t{ id:\"data\", value:webix.i18n.spreadsheet.labels[\"page-actual\"]}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ width:25},\n\t\t\t\t\t\t{ view:\"radio\", width:220, name:\"mode\", options:[\n\t\t\t\t\t\t\t{ id:\"portrait\", value:webix.i18n.spreadsheet.labels[\"page-portrait\"]},\n\t\t\t\t\t\t\t{ id:\"landscape\", value:webix.i18n.spreadsheet.labels[\"page-landscape\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{ },\n\t\t\t\t\t\t\t{ view: \"button\", css:\"ssheet_cancel_button\", value: webix.i18n.spreadsheet.labels.cancel, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.close()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view: \"button\", value: webix.i18n.spreadsheet.labels.print, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.apply(this)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonHideClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tapply(dialog){\n\t\tvar data = dialog.$dialog.getBody().getValues();\n\t\tdata.margin = data.margin?0:{};\n\t\tthis.close();\n\t\twebix.print(dialog.view, data);\n\t\t\n\t}\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-comment\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\t//we get cell only on hover commented cell\n\t\tthis.cell = action.cell ? action.cell : this.view.getSelectedId();\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked and in the edit mode\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column) && !action.viewonly) ||\n\t\t\t// action blocked by user's code\n\t\t\t!(this.view.callEvent(\"onBeforeCommentShow\", [this.cell.row, this.cell.column, !action.viewonly]))){\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.view.comments._activeComment = {editStatus: !action.viewonly, cell: this.cell};\n\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.view.comments.commentsView = this.$dialog;\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t\tthis.view.attachEvent(\"onCommentHide\", ()=>this.$dialog.hide());\n\t\t}\n\n\t\tvar form = this.$dialog.getBody();\n\n\t\tvar span = this.view.$$(\"cells\").getSpan(this.cell.row, this.cell.column);\n\t\tvar item = span ? {row: this.cell.row, column:(span[1]*1+span[2]-1)} : this.cell;\n\n\t\twebix.delay(()=>{\n\t\t\tthis.$dialog.show(this.view.$$(\"cells\").getItemNode(item));\n\t\t\tthis._setComment();\n\t\t});\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\t$show(){\n\t\tthis.textarea = this.$dialog.queryView({view:\"textarea\"});\n\t\tthis.template = this.$dialog.queryView({view:\"template\"});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tcss:\"ssheet_comments\",\n\t\t\tminWidth:250,\n\t\t\tminHeight:150,\n\t\t\trelative:\"right\",\n\t\t\tresize:true,\n\t\t\ton:{\n\t\t\t\tonViewResize:()=>{\n\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\tthis.$dialog.show();\n\t\t\t\t}\n\t\t\t},\n\t\t\tbody:{\n\t\t\t\tanimate:false,\n\t\t\t\tcells:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"template\",\n\t\t\t\t\t\tcss:\"ssheet_comment_view\",\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\tscroll:\"auto\",\n\t\t\t\t\t\tonClick:{\n\t\t\t\t\t\t\t\"ssheet_comment_view\":() => {\n\t\t\t\t\t\t\t\tif(!(this.view.config.readonly || this.view.isCellLocked(this.cell.row, this.cell.column)))\n\t\t\t\t\t\t\t\t\tthis.showInput(this.view.comments.get(this.cell.row, this.cell.column));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange:()=>{\n\t\t\t\t\t\t\t\tthis.addComment();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonFocus:()=>{\n\t\t\t\t\t\t\t\tthis.view.$$(\"cells\").select(this.cell.row, this.cell.column);\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {editStatus: true, cell: this.cell};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonBlur:()=>{\n\t\t\t\t\t\t\t\tthis.showTemplate(this.textarea.getValue());\n\t\t\t\t\t\t\t\tthis.changeTextarea();\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\t_setComment(){\n\t\tconst comment = this.view.comments.get(this.cell.row, this.cell.column);\n\t\tif(this.view.comments._activeComment.editStatus)\n\t\t\tthis.showInput(comment);\n\t\telse\n\t\t\tthis.showTemplate(comment);\n\t}\n\tshowTemplate(text){\n\t\tthis.template.show();\n\t\tthis.template.setHTML(text);\n\t}\n\tshowInput(text){\n\t\tthis.changeTextarea(text);\n\t\tthis.textarea.show();\n\t\tthis.textarea.focus();\n\t}\n\taddComment(){\n\t\tthis.view.comments.add(this.cell.row, this.cell.column, this.textarea.getValue());\n\t\tthis.$dialog.hide();\n\t}\n\tchangeTextarea(text){\n\t\tthis.textarea.blockEvent();\n\t\tthis.textarea.setValue(text||\"\");\n\t\tthis.textarea.unblockEvent();\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"resize\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.group = action.group;\n\t\tthis.header = action.value;\n\t\tDialog.prototype.open.apply(this, arguments);\n\t}\n\t$show(){\n\t\tconst sel = this.view.getSelectedId();\n\t\tif(!sel)\n\t\t\treturn false;\n\t\tthis.view.$handleSelection = ()=>{\n\t\t\treturn false;\n\t\t};\n\n\t\tconst elements = this.$dialog.getBody().elements;\n\t\tthis.type = elements[\"type\"];\n\t\tthis.size = elements[\"size\"];\n\n\t\tthis.$dialog.getHead().getChildViews()[0].setHTML(this.header);\n\t\tconst grid = this.view.$$(\"cells\");\n\n\t\tlet value;\n\t\tif(this.group == \"row\")\n\t\t\tvalue = grid.getItem(sel.row).$height || grid.config.rowHeight;\n\t\telse\n\t\t\tvalue = grid.getColumnConfig(sel.column).width || grid.config.columnWidth;\n\n\t\tthis.type.getOption(1).value = webix.i18n.spreadsheet.labels[this.group == \"row\" ? \"height\" : \"width\"];\n\t\tthis.type.setValue(1);\n\t\tthis.type.refresh();\n\n\t\tthis.size.setValue(value);\n\t\tthis.size.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tokClick(){\n\t\tconst size = this.size.isEnabled() ? this.size.getValue()*1 : \"auto\";\n\n\t\tif(this.group == \"row\")\n\t\t\tthis.view.setRowHeight(null, size);\n\t\telse\n\t\t\tthis.view.setColumnWidth(null, size);\n\n\t\tthis.close();\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth: 300,\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"radio\", name:\"type\", vertical:true, optionHeight:40,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange: id => {\n\t\t\t\t\t\t\t\tif(id == 2)\n\t\t\t\t\t\t\t\t\tthis.size.disable();\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tthis.size.enable();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t{id:1, value: \"\"},\n\t\t\t\t\t\t\t{id:2, value: locale[\"fit-content\"]}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{rows: [\n\t\t\t\t\t\t{view:\"text\", name: \"size\", width:120},\n\t\t\t\t\t]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\n\nexport const action = \"add-chart\";\n\nconst labels = webix.i18n.spreadsheet.labels;\n\nfunction getTypes(){\n\treturn [\n\t\t{id:\"line\", value:labels[\"line-chart\"]},\n\t\t{id:\"spline\", value:labels[\"spline-chart\"]},\n\t\t{id:\"splineArea\", value:labels[\"splinearea-chart\"]},\n\t\t{id:\"area\", value:labels[\"area-chart\"]},\n\t\t{id:\"bar\", value:labels[\"bar-chart\"]},\n\t\t{id:\"radar\", value:labels[\"radar-chart\"]},\n\t\t{id:\"pie\", value:labels[\"pie-chart\"]},\n\t\t{id:\"donut\", value:labels[\"donut-chart\"]}\n\t];\n}\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.config = action.config;\n\t\tthis.viewid = action.viewid;\n\t\tDialog.prototype.open.apply(this, arguments);\n\t}\n\t$show(box, form){\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tform.clear();\n\n\t\tconst values = this.config ? webix.extend(this.config.config, {\n\t\t\trange:this.config.data||\"\"\n\t\t}, true) : {type:\"line\", range:this.view.getSelectedRange()};\n\n\t\tform.setValues(this.inValues(values));\n\t\tform.elements.range.focus();\n\t}\n\t$hide(){\n\t\tthis.config = this.viewid = null;\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth:460,\n\t\t\thead: labels[\"chart-config\"],\n\t\t\tmove: true,\n\t\t\tbody:{ \n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view: \"richselect\", name:\"type\", value:\"line\", label:labels[\"chart-type\"], suggest:{\n\t\t\t\t\t\tview:  \"ssheet-form-suggest\",\n\t\t\t\t\t\tdata:getTypes()\n\t\t\t\t\t}, on:{\n\t\t\t\t\t\tonChange: (v) => this.toggleFields(v)\n\t\t\t\t\t}},\n\t\t\t\t\t{ view: \"checkbox\", label:labels[\"stacked-chart\"], name:\"stacked\"}, \n\t\t\t\t\t{ view: \"text\", \tlabel:labels[\"chart-range\"], name:\"range\"},\n\t\t\t\t\t{ view: \"checkbox\", label:labels[\"chart-col-axis\"], labelWidth:180, name:\"xAxis\"},\n\t\t\t\t\t{ view: \"checkbox\", label:labels[\"chart-pie-text\"], labelWidth:180, name:\"pieInnerText\", hidden:true},\n\t\t\t\t\t{ view: \"checkbox\", label:labels[\"chart-row-legend\"], labelWidth:180, name:\"legend\"}\n\t\t\t\t],\n\t\t\t\telementsConfig:{\n\t\t\t\t\tlabelWidth:100\n\t\t\t\t}\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tconst form = this.$dialog.queryView(\"form\");\n\t\tconst config = this.outValues(form.getValues());\n\n\t\tif(this.checkRange(config.range)){\n\t\t\tif(!this.viewid)\n\t\t\t\tthis.view.views.add(null,null,\"chart\", config.range, config);\n\t\t\telse if(form.isDirty())\n\t\t\t\tthis.view.views.update(this.viewid, config.range, config);\n\t\t\tthis.close();\n\t\t}\n\t}\n\tcheckRange(text){\n\t\tif(text && range(text, this.view))\n\t\t\treturn true;\n\t\tthis.view.alert({text:labels[\"error-range\"]});\n\t}\n\toutValues(values){\n\t\tif(values.stacked)\n\t\t\tvalues.type = \"stacked\"+values.type.charAt(0).toUpperCase()+values.type.substr(1);\n\t\treturn values;\n\t}\n\tinValues(values){\n\t\tif(values.type.indexOf(\"stacked\") !== -1)\n\t\t\tvalues.type = values.type.replace(\"stacked\", \"\").toLowerCase();\n\t\treturn values;\n\t}\n\ttoggleFields(v){\n\t\tconst f = this.$dialog.getBody().elements;\n\t\t\n\t\tif(v == \"area\" || v == \"bar\") f.stacked.show();\n\t\telse this.hideField(f.stacked);\n\n\t\tif(v == \"pie\" || v == \"donut\"){\n\t\t\tthis.hideField(f.xAxis);\n\t\t\tf.pieInnerText.show();\n\t\t\tf.legend.define(\"label\", labels[\"chart-col-legend\"]);\n\t\t}\n\t\telse{\n\t\t\tf.xAxis.show();\n\t\t\tthis.hideField(f.pieInnerText);\n\t\t\tf.legend.define(\"label\", labels[\"chart-row-legend\"]);\n\t\t}\n\t\tf.legend.refresh();\n\t}\n\thideField(f){\n\t\tf.setValue(0);\n\t\tf.hide();\n\t}\n}","import * as imc from \"./imagecell\";\nimport * as imt from \"./imagetop\";\nimport * as asw from \"./sparkline\";\nimport * as rgs from \"./ranges\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as fmt from \"./format\";\nimport * as cnd from \"./conditional\";\nimport * as exp from \"./export\";\nimport * as lnk from \"./link\";\nimport * as pnt from \"./print\";\nimport * as cmt from \"./comments\";\nimport * as siz from \"./sizing\";\nimport * as cht from \"./chart\";\n\nconst bases = [ imt, imc, asw, rgs, dpd, flt, fmt, cnd, exp, lnk, pnt, cmt, siz, cht ];\n\nexport function init(view){\n\tconst dialogs = {};\n\tconst viewBases = view.config.readonly ? [cmt] : bases;\n\n\tfor (let i = 0; i < viewBases.length; i++)\n\t\tdialogs[viewBases[i].action] = new viewBases[i].DialogBox(view);\n\n\tview.attachEvent(\"onCommand\", function(action){\n\t\tconst box = dialogs[action.id];\n\t\tif (box) box.open(action);\n\t});\n\n\tview.attachEvent(\"onAction\", function(id, values){\n\t\t//hide win when the external ui is removed\n\t\tif(id == \"add-view\" && !values.newValue){\n\t\t\tconst uiDialogs = [\"add-chart\", \"add-image-top\"];\n\t\t\tfor(let i = 0; i < uiDialogs.length; i++){\n\t\t\t\tconst box = dialogs[uiDialogs[i]];\n\t\t\t\tif(box && box.viewid == values.row){\n\t\t\t\t\tbox.close();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}","import {isCellLocked} from \"./lock_cell\";\nimport group from \"./undo_group\";\n\n\nvar ignoreUndoReset = false;\n\nexport function init(view){\n\treset(view);\n\tundoHandlers(view);\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\tview.attachEvent(\"onAfterSheetShow\", () => reset(view));\n\t// styles\n\tview.attachEvent(\"onBeforeStyleChange\", (row, column, nstyle, ostyle) =>{\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"style\", row:row, column: column, value: ostyle, newValue: nstyle, group: group.value});\n\t});\n\t// editing\n\tview.attachEvent(\"onBeforeValueChange\", (row, column, nvalue, ovalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"value\", row:row, column: column, value: ovalue, newValue: nvalue, group: group.value});\n\t});\n\t// merge cells\n\tview.attachEvent(\"onBeforeSpan\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"span\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// split cells\n\tview.attachEvent(\"onBeforeSplit\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"split\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// Any abstract undo actions\n\tview.attachEvent(\"onAction\", (action, obj) =>\n\t\taddToHistory(\n\t\t\tview,\n\t\t\t{\n\t\t\t\taction: action,\n\t\t\t\trow: obj.row || null,\n\t\t\t\tcolumn: obj.column || null,\n\t\t\t\tvalue: obj.value || null,\n\t\t\t\tnewValue: obj.newValue || null,\n\t\t\t\tgroup: group.value\n\t\t\t}\n\t\t)\n\t);\n\n\t// column resize\n\tview.$$(\"cells\").attachEvent(\"onColumnResize\", (column, nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"c-resize\", row:0, column:column, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\t// column hide\n\tview.attachEvent(\"onColumnOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:0, column:{ start, end } });\n\t});\n\t// row hide\n\tview.attachEvent(\"onRowOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:{ start, end }, column:0 });\n\t});\n\t// row resize\n\tview.$$(\"cells\").attachEvent(\"onRowResize\", (row,  nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"r-resize\", row: row, column:0, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\n\t// condition formats\n\tview.attachEvent(\"onBeforeConditionSet\", (row, column, value, nvalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\n\t\tvalue = value ? webix.copy(value) : null;\n\t\taddToHistory(view, {action: \"condition\", row: row, column: column, value: value, newValue: nvalue, group: group.value});\n\t});\n\tview.$skipHistory = 0;\n}\n\nexport function undo(view){\n\trestoreHistory(view,-1);\n}\n\nexport function redo(view){\n\trestoreHistory(view,1);\n}\n\nexport function reset(view){\n\tif(!ignoreUndoReset){\n\t\tview._ssUndoHistory = [];\n\t\tview._ssUndoCursor = -1;\n\t}\n}\n\nfunction addToHistory(view, data){\n\tif(!view.$skipHistory){\n\t\t// remove futher history\n\t\tview._ssUndoHistory.splice(view._ssUndoCursor+1);\n\t\t// add to an array and increase cursor\n\t\tview._ssUndoHistory.push(data);\n\t\tview._ssUndoCursor++;\n\t}\n}\n\nexport function ignoreUndo(func, view){\n\tview.$skipHistory++;\n\ttry{\n\t\tfunc.call(view);\n\t}\n\tfinally {\n\t\tview.$skipHistory--;\n\t}\n}\n\nexport function ignoreReset(func){\n\tignoreUndoReset = true;\n\tfunc();\n\tignoreUndoReset = false;\n}\n\nfunction restoreHistory(view, step){\n\tvar data = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\tif(data){\n\t\tvar value = step > 0 ? data.newValue : data.value;\n\t\tvar direction = step>0;\n\t\tvar params = [data.action, data.row, data.column, value, direction];\n\n\t\tview._ssUndoCursor += step;\n\n\t\t// group support\n\t\tvar group = data.group;\n\t\tvar prevData = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onUndo\", params);\n\t\t\tif (!group || !(prevData && group == prevData.group)){\n\t\t\t\tview.refresh();\n\t\t\t\tview.callEvent(\"onAfterUndo\", []);\n\t\t\t}\n\t\t},view);\n\n\t\tif(prevData && group && group == prevData.group){\n\t\t\trestoreHistory(view, step);\n\t\t}\n\t}\n}\n\nfunction undoHandlers(view){\n\tview.attachEvent(\"onUndo\", function(type, row, column, value) {\n\t\tswitch (type) {\n\t\t\tcase \"freeze-row\":\n\t\t\t\tview.freezeRows(value);\n\t\t\t\tbreak;\n\t\t\tcase \"freeze-column\":\n\t\t\t\tview.freezeColumns(value);\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import {updateMath}  from \"../math/updater\";\nimport {clearMathCache} from \"../math/cache\";\nimport {ignoreReset, ignoreUndo}  from \"../operations/undo\";\nimport group  from \"../operations/undo_group\";\nimport {adjustSpan}  from \"../operations/spans\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action, start, end) => {\n\t\tif (action.id == \"add\" || action.id == \"del\"){\n\t\t\tvar area = view._table.getSelectArea();\n\t\t\tif(area && !(start && end)){\n\t\t\t\tstart = area.start;\n\t\t\t\tend = area.end;\n\t\t\t}\n\n\t\t\tif (start && end){\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tprocess(action, start, end, view);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif(action == \"grid-change\"){\n\t\t\tclearMathCache(true);\n\t\t\tloadChangedData(view,value);\n\t\t}\n\t});\n}\n\nexport function process(action, start, end, view, e, r) {\n\tvar data, i, newData, oldData, values,\n\t\tcount=0, origin=0;\n\n\tvar select = view._table.getSelectArea();\n\tvar state = view._table.getScrollState();\n\n\tnewData = view.serialize({\n\t\tmath: true, viewIds:true\n\t});\n\n\toldData = webix.copy(newData);\n\n\tvar spans = newData.spans;\n\tfor (var s in spans){\n\t\tvar span = spans[s];\n\t\tspan = adjustSpan(span, action, start, end, newData.data);\n\t\tif(span[2] <= 0 || span[3] <= 0){\n\t\t\tspans.splice(s, 1);\n\t\t}\n\t}\n\n\tvalues = getUpdateValues(action, start, end);\n\n\tview.$handleSelection = null;\t\n\n\tif(!e)\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onAction\", [\"before-grid-change\", {\n\t\t\t\tname: values.name,\n\t\t\t\tinc: values.inc,\n\t\t\t\tdata:newData,\n\t\t\t\tstart: start\n\t\t\t}]);\n\t\t},view);\n\n\tdata = newData.data;\n\n\tif (action.group == \"column\") {\n\t\tcount = end.column - start.column + 1;\n\t\torigin = start.column;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addColumn(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delColumn(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t} else if (action.group == \"row\") {\n\t\tcount = end.row - start.row + 1;\n\t\torigin = start.row;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addRow(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delRow(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t}\n\n\t//update formulas\n\tvar update = { id:action.group, start:origin, count:count };\n\ti = data.length;\n\twhile (i--) {\n\t\tif (data[i][2] && typeof data[i][2] === \"string\" && data[i][2].substr(0, 1) == \"=\")\n\t\t\tdata[i][2] = updateMath(data[i][2], update);\n\t}\n\n\tview.callEvent(\"onAction\", [\"grid-change\",{value: oldData, newValue: newData} ]);\n\n\tignoreUndo(function() {\n\t\tloadChangedData(view, newData);\n\t\tview._table.scrollTo(state.x, state.y);\n\t},view);\n\n\tif (select){\n\t\tvar grid = view.$$(\"cells\");\n\t\tselect = fixSelectArea(select, grid);\n\t\tif (select)\n\t\t\tgrid.addSelectArea(select.start, select.end);\n\t}\n}\n\nfunction fixSelectArea(select, grid){\n\tvar rows = grid.count();\n\tvar cols = grid.config.columns.length;\n\tif (select.start.row*1 > rows) return null;\n\tif (select.end.row*1 > rows) return null;\n\tif (select.start.column*1 > cols) return null;\n\tif (select.end.column*1 > cols) return null;\n\t\n\treturn select;\n}\n\nfunction loadChangedData(view, data){\n\t// data loading resets undo history, and\n\t// we need to preserve it\n\tignoreReset(function(){\n\t\tview.$handleSelection = null;\n\t\tview.parse(data);\n\t});\n}\n\nfunction getUpdateValues( action, start, end){\n\tvar name = action.group,\n\t\tinc = action.id==\"add\"?1:(action.id==\"del\"?-1:0);\n\n\tif(inc) {\n\t\t// span support\n\t\tif (name == \"row\")\n\t\t\tinc += inc * (end.row - start.row);\n\t\tif (name == \"column\")\n\t\t\tinc += inc * (end.column - start.column);\n\t}\n\treturn {name: name, inc: inc};\n}\n\nfunction _addColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_column_count = end.column - start.column + 1;\n\tview.config.columnCount += add_column_count;\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column)\n\t\t\tdata[i][1] += add_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]); //add item to history\n\telse\n\t\tdata.push(...value); //recovering value which has been deleted\n}\n\nfunction _delColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_column_count = end.column - start.column + 1;\n\n\tif (view.config.columnCount === del_column_count){\n\t\tif (start.column == end.column)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.column--;\n\t\tdel_column_count--;\n\t}\n\n\tview.config.columnCount -= del_column_count;\n\n\n\tview.reset();\n\tlet deleted = []; // for history\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column && data[i][1] <= end.column)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][1] > end.column)\n\t\t\tdata[i][1] -= del_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, deleted]);\n}\n\nfunction _addRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_row_count = end.row - start.row + 1;\n\tview.config.rowCount += add_row_count;\n\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][0] >= start.row)\n\t\t\tdata[i][0] += add_row_count;\n\n\tif (!silent) {\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n\t} else {\n\t\tdata.push(...value);\n\t}\n}\n\nfunction _delRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_row_count = end.row - start.row + 1;\n\n\tif (view.config.rowCount === del_row_count){\n\t\tif (start.row == end.row)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.row--;\n\t\tdel_row_count--;\n\t}\n\n\tview.config.rowCount -= del_row_count;\n\n\tview.reset();\n\n\tlet deleted = [];\n\twhile (i--)\n\t\tif (data[i][0] >= start.row && data[i][0] <= end.row)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][0] > end.row)\n\t\t\tdata[i][0] -= del_row_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, deleted]);\n}","import {methods} from \"./methods\";\nimport * as rgs from \"./ranges\";\nimport * as psh from \"./placeholder\";\nimport {changeRange} from \"../helpers/column_names\";\nimport * as sheets from \"./sheet\";\nimport {_parse, clearMathCache} from \"./cache\";\n\nexport function init(view){\n\tvar triggers = [];\n\tvar backtrak = [];\n\tvar skip_math = false;\n\n\tview._mathSheetCache = {};\n\n\t//math operations object\n\tvar core = get_core(view);\n\n\t//init named ranges\n\tview.ranges = core.ranges = new rgs.Ranges(view);\n\t//init placeholders\n\tcore.p = psh.init(view);\n\n\tview.attachEvent(\"onReset\", () => {\n\t\ttriggers = [];\n\t\tbacktrak = [];\n\t\tskip_math = true;\t// will be reset in onDataParse\n\t\tview.ranges.clear();\n\t});\n\n\tview.attachEvent(\"onCellChange\", updateCell);\n\tview.attachEvent(\"onMathRefresh\", () => {\n\t\trecalckAll();\n\t\tview.$$(\"cells\").refresh();\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tview.ranges.parse(data.ranges);\n\t\tskip_math = false;\n\t\trecalckAll();\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\"){\n\t\t\tclearMathCache(true);\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t\t}\n\t});\n\n\tvar solvedMath;\n\tvar solvedCounter;\n\t//execute math handler\n\tfunction applyMath(r, c, handler){\n\t\tconst row = view.getRow(r);\n\t\tconst value = _execute(handler, core);\n\t\trow[c] = value;\n\n\t\tconst tkey = c*100000000+r;\n\t\tconst count = solvedCounter[tkey] = (solvedCounter[tkey] || 0) + 1;\n\n\t\tif (solvedMath[tkey] === value || count > 1000){\n\t\t\t//prevent infinity loops\n\t\t\t//if cell was already calculated with the same value, do not recaculate dependent cells\n\t\t\t//in some cases we have have non-stable loop, where value of math is different each time\n\t\t\t//counter limits calculation for 1000 itterations per cell\n\t\t\treturn;\n\t\t}\n\n\t\tsolvedMath[tkey] = value;\n\t\t//check if we have related cells, process their math as well\n\t\tcheck_trigger(r, c);\n\t}\n\n\t//check and run triggers\n\tfunction check_trigger(srow, scolumn){\n\t\t//triggers is a matrix[row][column]\n\t\t//store array of coordinates of related cells\n\n\t\tconst line = triggers[srow];\n\t\tif (line){\n\t\t\tconst block = line[scolumn];\n\t\t\tif (block){\n\t\t\t\tfor (var i = 0; i < block.length; i++){\n\t\t\t\t\tconst {row, column, handler} = block[i];\n\t\t\t\t\tif (row != srow || column != scolumn){\n\t\t\t\t\t\tapplyMath(row, column, handler);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction recalckAll(){\n\t\ttriggers = [];\n\t\tbacktrak = [];\n\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar state = grid.getState();\n\t\tvar columns = state.ids.concat(state.hidden);\n\n\t\tgrid.eachRow(function(obj){\n\t\t\tvar item = this.getItem(obj);\n\t\t\tfor (var i=1; i<columns.length; i++){\n\t\t\t\tvar key = columns[i];\n\t\t\t\tvar value = item[\"$\"+key];\n\t\t\t\tif (value)\n\t\t\t\t\trecalckCell(obj, key, value);\n\t\t\t}\n\t\t}, true);\n\t}\n\n\tfunction updateCell(r, c){\n\t\t//cell value can be updated in types module on cell change, so use getCellValue instead of value argument\n\t\trecalckCell(r, c, view.getCellValue(r, c));\n\t}\n\n\tfunction recalckCell(r,c,value){\n\t\t// shortcut processing during data loading\n\t\tif (skip_math && value && typeof value === \"string\" && value.indexOf(\"=\") === 0){\n\t\t\tview.getRow(r)[\"$\"+c] = value;\n\t\t\treturn;\n\t\t}\n\n\t\t//check if changed cell was a math cell, based on some other cells\n\t\t//clean triggers in such case\n\t\tvar line = backtrak[r];\n\t\tif (line && line[c])\n\t\t\tremove_triggers(triggers, backtrak, c, r);\n\n\t\t//if new value is a math, calculate it and store triggers\n\t\tif (value){\n\t\t\tvalue = value.toString();\n\t\t\tif(value.length > 1 && value.indexOf(\"=\") === 0){\n\t\t\t\tvar formula = _parse(value, core, \"\");\n\t\t\t\tvar row = view.getRow(r);\n\t\t\t\trow[c] = _execute(formula.handler, core);\n\t\t\t\trow[\"$\"+c] = formula.text;\n\n\t\t\t\tif (formula.triggers.length){\n\t\t\t\t\tadd_triggers(triggers, backtrak, formula.triggers, \n\t\t\t\t\t\t{ row: r, column: c, handler: formula.handler }, view.getActiveSheet());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//check if we have some other cells, related to the changed one\n\t\tsolvedMath = {};\n\t\tsolvedCounter = {};\n\t\tcheck_trigger(r, c);\n\t}\n\n\tsheets.init(view, core, { parse: _parse, execute: _execute });\n}\n\nexport function calculate(view, value){\n\tvar core = get_core(view);\n\tvar formula = _parse(value, core, \"\");\n\tvalue = _execute(formula.handler, core);\n\treturn value;\n}\n\n//add new triggers\nfunction add_triggers(trs, back, adds, cell, active){\n\t//trs - matrix of triggers\n\t//back - matrix of backlinks\n\t//adds - list of triggers\n\tvar blist = [];\n\tfor (var i = 0; i < adds.length; i++){\n\t\tvar line = adds[i];\n\t\t//line = [start_row, start_column, end_row, end_column, sheet]\n\n\t\t//ignore triggers from passive cells\n\t\tif (line[4] !== \"\" && line[4] !== active)\n\t\t\tcontinue;\n\n\t\tfor (var j = line[0]; j<=line[2]; j++){\n\t\t\tvar step = trs[j];\n\t\t\tif (!step) step = trs[j]=[];\n\t\t\tfor (var k = line[1]; k <= line[3]; k++){\n\t\t\t\tvar block = step[k];\n\t\t\t\tif (!block)\n\t\t\t\t\tblock = step[k] = [];\n\n\t\t\t\tblist.push([j, k]);\n\t\t\t\tblock.push(cell);\n\t\t\t}\n\t\t}\n\t}\n\n\t//store back-relations, for easy trigger removing \n\tadd_backtrack(back, cell.row, cell.column, blist);\n}\n\n//store backtrack relations as a matrix\nfunction add_backtrack(back, row, column, adds){\n\tvar line = back[row];\n\tif (!line)\n\t\tline = back[row] = [];\n\tline[column] = adds;\n}\n\n//remove unused triggers\nfunction remove_triggers(trs, back, c, r){\n\t//get list of triggers from backtrack structure\n\tvar adds = back[r][c];\n\tback[r][c] = null;\n\n\t//delete triggers\n\tfor (var i = adds.length - 1; i >= 0; i--) {\n\t\tvar cell = adds[i];\n\t\tvar block = trs[cell[0]][cell[1]];\n\n\t\tfor (var j = block.length-1; j >= 0; j--){\n\t\t\tvar bcell = block[j];\n\t\t\tif (bcell.row == r && bcell.column == c)\n\t\t\t\tblock.splice(j,1);\n\t\t}\n\t}\n}\n\n//run math function\nfunction _execute(formula, core){\n\tvar value;\n\tvar error = webix.i18n.spreadsheet.table[\"math-error\"];\n\ttry {\n\t\tvalue = formula.call(core);\t\n\t} catch(e){\n\t\t//some error in the math code\n\t\treturn error;\n\t}\n\n\tif (typeof value === \"number\"){\n\t\tif(!isFinite(value)) return error;\n\t\t//round values to fix math precision issue in JS\n\t\treturn Math.round(value*100000)/100000;\n\t} else if (typeof value !== \"string\"){\n\t\treturn value ? value.toString() : error;\n\t} else\n\t\treturn value;\n}\n\n//converts cell references to code\nfunction get_core(view){\n\tvar active = sheets.getAccessor(view);\n\n\treturn {\n\t\trs:function(sheet, r1, c1, r2, c2){\n\t\t\treturn sheets.getAccessor(view, sheet).getRange(r1,c1,r2,c2);\n\t\t},\n\t\tr:active.getRange,\n\t\tvs:function(sheet, r, c){\n\t\t\treturn sheets.getAccessor(view, sheet).getValue(r,c);\n\t\t},\n\t\tv:active.getValue,\n\t\tm:methods,\n\t\tp:{},\n\t\te:function(e){throw e;}\n\t};\n}\n\nfunction _serialize(view, obj){\n\tobj.ranges = view.ranges.serialize();\n}\n\nfunction updatePosition(name, inc, data, start){\n\tvar ranges = data.ranges;\n\tfor(let i=0; i < ranges.length; i++)\n\t\tranges[i][1] = changeRange(ranges[i][1],name,inc, start);\n}","export function init(view){\n\tvar holders = {};\n\n\tview.setPlaceholder = function(obj, value){\n\t\tif (typeof obj === \"object\")\n\t\t\tfor (var key in obj)\n\t\t\t\tholders[key.toLowerCase()] = obj[key];\n\t\telse\n\t\t\tholders[obj.toString().toLowerCase()] = value;\n\n\t\tview.callEvent(\"onMathRefresh\",[]);\n\t};\n\n\treturn holders;\n}","import group from \"./undo_group\";\nimport {calculate} from \"../math/math\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.conditions = {\n\t\t_empty:true,\n\t\t_pull: {},\n\t\thandlers: {\n\t\t\t\">\": function(a,b){\n\t\t\t\treturn a > getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<\": function(a,b){\n\t\t\t\treturn a < getCellValue(view, b);\n\t\t\t},\n\t\t\t\"=\": function(a,b){\n\t\t\t\treturn a == getCellValue(view, b);\n\t\t\t},\n\t\t\t\"!=\": function(a,b){\n\t\t\t\treturn a != getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<>\": function(a,b){\n\t\t\t\tvar first = b[0];\n\t\t\t\tvar second = b[1];\n\t\t\t\treturn webix.isArray(b) && a < getCellValue(view, second) && a > getCellValue(view, first);\n\t\t\t}\n\t\t},\n\t\tadd: add,\n\t\tremove: remove,\n\t\tupdate: update,\n\t\tget: get,\n\t\tparse: parse,\n\t\tserialize: serialize,\n\t\tclear: clear\n\t};\n\n\tview.attachEvent(\"onConditionSet\", (data) => _setCondition(view, data));\n\n\tview.attachEvent(\"onUndo\", (type_action, row, column, value) => {\n\t\tif(type_action == \"condition\")\n\t\t\t_undoCondition(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\n\tview.attachEvent(\"onColumnInit\", (column) => _setCssFormat(view, column));\n\n\tview.attachEvent(\"onReset\", () => view.conditions.clear() );\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\treset(view);\n}\n\nfunction getCellValue(view, value){\n\tif(isNaN(value*1)){\n\t\tif (value.charAt(0) == \"=\"){\n\t\t\tvalue = calculate(view, value);\n\t\t}\n\t}\n\telse {\n\t\tvalue = value*1;\n\t}\n\treturn value;\n}\n\nfunction reset(view){\n\tview.conditions.clear();\n}\n\nfunction _setCondition(view, data){\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => {\n\t\t\tvar collection = view.conditions.get(cell.row,cell.column);\n\t\t\t_changeCondition(\"update\", cell.row, cell.column, (collection||null), data, view);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _undoCondition(view, row, column, value){\n\tif(view.conditions.get(row, column))\n\t\tview.conditions.remove(row, column);\n\tif(value)\n\t\tview.conditions.update(row, column, value);\n}\n\nfunction _serialize(view, obj){\n\tobj.conditions = view.conditions.serialize();\n}\n\nfunction _parse(view, obj){\n\tview.conditions.parse(obj.conditions);\n}\n\nfunction _setCssFormat(view,column){\n\tcolumn.cssFormat = function (value, obj, row, column){\n\t\tif (view.conditions._empty) return \"\";\n\n\t\tvar collection, i;\n\t\tcollection = view.conditions.get(row, column);\n\t\tif(!collection)\n\t\t\treturn \"\";\n\n\t\ti = collection.length;\n\t\twhile(i--){\n\t\t\tvar handler = view.conditions.handlers[collection[i][0]];\n\t\t\tif(handler && handler(obj[column],collection[i][1]))\n\t\t\t\treturn collection[i][2];\n\t\t}\n\t\treturn \"\";\n\t};\n}\n\n\nfunction addEmptyCollection(pull, row, column, state){\n\tstate._empty = false;\n\tif(!pull[row])\n\t\tpull[row] = {};\n\tif(!pull[row][column])\n\t\tpull[row][column] = [];\n\treturn pull[row][column];\n}\n\n\nfunction parse(data){\n\tthis._empty = true;\n\tif (!data) return;\n\n\tlet i = data.length;\n\twhile(i--){\n\t\tvar c = data[i];\n\t\tvar collection = addEmptyCollection(this._pull,c[0],c[1],this);\n\t\tcollection.push([c[2],c[3],c[4]]);\n\t}\n}\n\nfunction clear(){\n\tthis._pull = {};\n}\n\nfunction update(row, column, newData){\n\tvar collection = this.get(row, column);\n\tif(!collection)\n\t\taddEmptyCollection(this._pull, row, column, this);\n\tthis._pull[row][column] = newData;\n}\n\nfunction get(rowId, columnId){\n\tif(!rowId)\n\t\treturn this._pull;\n\tif(!columnId)\n\t\treturn this._pull[rowId];\n\treturn this._pull[rowId]?this._pull[rowId][columnId]:null;\n}\n\nfunction add(rowId, columnId, condition, value, style){\n\tvar collection = addEmptyCollection(this._pull, rowId, columnId, this);\n\tcollection.push([condition, value, style]);\n}\n\nfunction remove(rowId, columnId){\n\tvar collection = this.get(rowId, columnId);\n\tif(collection)\n\t\tdelete this._pull[rowId][columnId];\n}\n\nfunction serialize(){\n\tvar column, condition, i, row,\n\t\tdata = [];\n\n\tfor( row in this._pull)\n\t\tfor( column in this._pull[row])\n\t\t\tfor(i=0; i < this._pull[row][column].length; i++){\n\t\t\t\tcondition = this._pull[row][column][i];\n\t\t\t\tdata.push([row,column, condition[0],condition[1],condition[2]]);\n\t\t\t}\n\n\treturn data;\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet conditions = data.conditions,\n\t\ti = conditions.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = conditions[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tconditions.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tconditions[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tconditions.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tconditions[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function clearConditionalFormats(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tvar condition = view.conditions.get(cell.row, cell.column);\n\t\t\tif(condition)\n\t\t\t\t_changeCondition(\"remove\", cell.row, cell.column, condition, null, view);\t\t\t\t\n\t\t});\n\t\tview.refresh();\n\t});\n}\n\nexport function pasteCondition(view, extra, row, col, cutted){\n\tvar condition = extra.condition;\n\tvar collection = view.conditions.get(row,col);\n\t_changeCondition(\"update\", row, col, (collection||null), condition, view);\n\tif(cutted === 1)\n\t\t_changeCondition(\"remove\", extra.row, extra.col, condition, null, view);\t\n\t\t\t\n}\n\nexport function _changeCondition(name, row, column, oldCondition, newCondition, view){\n\tif (view.callEvent(\"onBeforeConditionSet\", [row, column, oldCondition, newCondition])){\n\t\tview.conditions[name].apply(view.conditions, [row, column, newCondition]);\n\t\tview.callEvent(\"onAfterConditionSet\", [row, column, oldCondition, newCondition]);\n\t}\n}","import group from \"./undo_group\";\nimport {setSpanCss} from \"./spans\";\nimport {rangeOptions} from \"../math/ranges\";\nimport * as fmt from \"../operations/formats\";\nimport {changeRange, eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.attachEvent(\"onBeforeEditStart\", function(id){\n\t\tlet col = this.getColumnConfig(id.column);\n\t\tif (this._ssEditors[id.row]){\n\t\t\tlet ed = this._ssEditors[id.row][id.column];\n\t\t\tif (ed){\n\t\t\t\twebix.extend(col, ed, true);\n\t\t\t\twebix.extend(col, {row: view.getRow(id.row)}, true);\n\t\t\t\tif (ed.options){\n\t\t\t\t\tif (typeof ed.options == \"string\")\n\t\t\t\t\t\tcol.options = rangeOptions(view, ed.options, { unique:true, order:true, empty:true });\n\t\t\t\t\telse if (webix.isArray(ed.options))\n\t\t\t\t\t\tcol.options = rangeOptions(view, ed.options, { empty:true });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// update format if editor supports this feature\n\ttable.attachEvent(\"onBeforeEditStop\", function(state, editor, ignore){\n\t\tif (!ignore && editor.getFormat){\n\t\t\tconst value = editor.getValue();\n\t\t\tlet format = editor.getFormat(value);\n\n\t\t\tgroup.set(function(){\n\t\t\t\tview.setCellValue(editor.row, editor.column, value);\n\t\t\t\tif (format){\n\t\t\t\t\tfmt.addFormat(view, editor.row, editor.column, fmt.getFormatSource(format));\n\t\t\t\t} else\n\t\t\t\t\tfmt.removeFormat(view, editor.row, editor.column);\n\t\t\t});\n\n\t\t\tconst cell = view.getSelectedId();\n\t\t\tif (cell && cell.row == editor.row && cell.column == editor.column){\n\t\t\t\tformat = format || \"common\";\n\t\t\t\tformat = fmt.isCustom(format) ? \"custom\" : format;\n\t\t\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:format}]);\n\t\t\t}\n\t\t}\n\t});\n\n\ttable.attachEvent(\"onAfterEditStop\", function(state, editor){\n\t\tconst col = this.getColumnConfig(editor.column);\n\n\t\tcol.editor = \"text\";\n\t\tdelete col.popup; delete col.$popup; delete col.row;\n\t});\n\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"dropdown\")\n\t\t\tview.setCellEditor(row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"dropdown\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_editor\", p.newValue);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssEditors = {};\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\ttblEditors = view._table._ssEditors,\n\t\teditors = [];\n\n\tfor (row in tblEditors){\n\t\tfor (column in tblEditors[row])\n\t\t\teditors.push([row, column, tblEditors[row][column]]);\n\t}\n\tdata.editors = editors;\n}\n\nexport function load(view,data){\n\tconst editors = data.editors;\n\n\tif (editors)\n\t\tfor (let i=0; i<editors.length; i++)\n\t\t\tview.setCellEditor.apply(view, editors[i]);\n}\n\nexport function clearEditors(view, range){\n\tview._table.editStop();\n\teachRange(range, view, function(view, cell){\n\t\tlet editor = view._table._ssEditors[cell.row];\n\t\tif (editor){\n\t\t\tif (editor[cell.column]){\n\t\t\t\tdelete editor[cell.column];\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_editor\");\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_editor\", false);\n\t\t\t}\n\t\t}\n\t});\n}\n\nexport function isEditor(view, row, column){\n\tconst editor = view._table._ssEditors;\n\treturn editor[row] && !!editor[row][column];\n}\n\n// called on column/row add, delete, hide,show\nfunction updatePosition(name, inc, data, start){\n\tconst editors = data.editors;\n\n\tif (inc){\n\t\t// create new editors\n\t\tfor(let i=editors.length-1; i>=0; i--){\n\t\t\tlet [row,column,editor] = editors[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete editor mark if row was deleted\n\t\t\t\t\t\teditors.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\teditors[i][0] = row*1 + inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\teditors.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\teditors[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\teditor.options = changeRange(editor.options, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteDropdown(view, extra, row, col, cutted){\n\tconst editor = extra.dropdown;\n\n\tview.setCellEditor(row, col, editor);\n\tif (cutted === 1)\n\t\tview.setCellEditor(extra.row, extra.col, {});\n}","import group from \"./undo_group\";\nimport {updateMath} from \"../math/updater\";\nimport {pasteCondition} from \"../operations/conditional_formats\";\nimport {pasteDropdown} from \"../operations/dropdown\";\nimport {pasteFilter} from \"../operations/filter\";\nimport {pasteSpan} from \"../operations/spans\";\n\nvar styledata, clipdata, origin, cutted, updateFilters;\n\nexport function init(view){\n\tconst keyC = 67; //keyboard 'c' code\n\tconst keyX = 88; //keyboard 'x' code\n\tvar grid = view.$$(\"cells\");\n\t\n\tgrid.attachEvent(\"onKeyPress\", (code, e) => {\n\t\tif((code === keyC || code === keyX) && (e.ctrlKey || e.metaKey) && grid.getSelectedId()){\n\t\t\tstyledata = _get_sel_style(view, grid);\n\t\t\tclipdata = document.getElementsByClassName(\"webix_clipbuffer\")[0].value;\n\t\t\torigin = grid.getSelectArea();\n\t\t\tcutted = (code === keyX)*1;\n\t\t\tif(cutted && Object.keys(view._table._ssFilters).length !== 0)\n\t\t\t\tupdateFilters = allFiltersInZone(view._table._ssFilters, origin, view.config.columnCount);\n\t\t}\n\t});\n\n\tif (!view.config.readonly) {\n\t\tgrid.attachEvent(\"onPaste\", (text) => {\n\t\t\t_clip_to_sel(view, grid, text);\n\t\t});\n\t}\n}\n\nfunction _clip_to_sel(view, grid, text){\n\tvar leftTop = grid.getSelectArea();\n\tif (!leftTop) return;\n\tvar start = leftTop.start;\n\tvar fromSheet = text === clipdata;\n\n\tvar data = fromSheet ? styledata : webix.csv.parse(text, grid.config.delimiter);\n\tif(!fromSheet && view.config.clipboardDecimalDelimiter)\n\t\tdata = _changeDelimiter(data, view.config.clipboardDecimalDelimiter);\n\n\tvar translate = { id:\"move\", column:0, row: 0, cut:cutted };\n\tif (fromSheet){\n\t\ttranslate.column = start.column - origin.start.column;\n\t\ttranslate.row = start.row - origin.start.row;\n\t} else {\n\t\tcutted = 0;\n\t}\n\n\tgroup.set(function(){\n\t\tif (updateFilters)\n\t\t\tview.removeFilters();\n\n\t\t_add_row_col(view, start, data);\n\n\t\tif (cutted === 1) {\n\t\t\tfor (let row = origin.start.row; row <= origin.end.row; row++) {\n\t\t\t\tfor (let column = origin.start.column; column <= origin.end.column; column++) {\n\t\t\t\t\tview.setCellValue(row, column, null);\n\t\t\t\t\tview.setStyle(row, column, null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (data.length == 1 && data[0].length == 1 && !updateFilters) {\n\t\t\tview.eachSelectedCell(function(cell) {\n\t\t\t\tvar subtrans = {\n\t\t\t\t\tid: \"move\",\n\t\t\t\t\tcolumn: translate.column + cell.column * 1 - start.column,\n\t\t\t\t\trow: translate.row + cell.row * 1 - start.row,\n\t\t\t\t\tcut:cutted\n\t\t\t\t};\n\t\t\t\t_clipboardToTable(view, cell.row, cell.column, data[0][0], fromSheet, subtrans);\n\t\t\t});\n\t\t} else {\n\t\t\tgrid.mapCells(\n\t\t\t\tstart.row,\n\t\t\t\tstart.column,\n\t\t\t\tdata.length,\n\t\t\t\tnull,\n\t\t\t\tfunction(value, row, col, row_ind, col_ind) {\n\t\t\t\t\tif (data[row_ind] && data[row_ind].length > col_ind) {\n\t\t\t\t\t\tvar cdata = data[row_ind][col_ind];\n\t\t\t\t\t\t_clipboardToTable(view, row, col, cdata, fromSheet, translate);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tif (cutted === 1){\n\t\t\t//cut and cleared\n\t\t\tcutted = 2;\n\t\t\tupdateFilters = false;\n\t\t}\n\t});\n\t\n\tview.refresh();\n}\n\nfunction _clipboardToTable(view, row, col, cdata, fromSheet, translate){\n\tvar newValue = cdata;\n\n\tif (typeof cdata === \"object\"){\n\t\tif (cdata.math)\n\t\t\tnewValue = updateMath(cdata.math, translate, origin);\n\t\telse \n\t\t\tnewValue = cdata.text;\n\n\t\tif(cdata.style && cdata.style.props){\n\t\t\tconst style = view.addStyle(cdata.style.props);\n\t\t\tview.setStyle(row, col, style);\n\t\t}\n\n\t\tvar extra = cdata.extra;\n\t\tif(extra){\n\t\t\tif(extra.condition)\n\t\t\t\tpasteCondition(view, extra, row, col, cutted);\n\t\t\tif(extra.dropdown)\n\t\t\t\tpasteDropdown(view, extra, row, col, cutted, translate);\n\t\t\tif(extra.filter && updateFilters)\n\t\t\t\tpasteFilter(view, extra, row, col, cutted, translate);\n\t\t}\n\t\tpasteSpan(view, extra, row, col, cutted, translate);\n\t}\n\n\tview.setCellValue(row, col, newValue);\n}\n\nfunction _get_sel_style(view, grid){\n\tvar data = [];\n\tvar row, last;\n\n\tgrid.mapSelection(function(value, id, col) {\n\t\tif (id != last){\n\t\t\trow = []; data.push(row);\n\t\t\tlast = id;\n\t\t}\n\n\t\tvar item = grid.getItem(id);\n\t\tvar math = item[\"$\"+col];\n\t\tvar obj = { text:value, math:math, style:view.getStyle(id, col) };\n\n\t\tvar condition = view.conditions.get(id,col);\n\t\tvar editor = view.getCellEditor(id, col);\n\t\tvar filter = view.getCellFilter(id, col);\n\t\tvar span = view._table.getSpan(id, col);\n\n\t\tif (editor || filter || condition || span){\n\t\t\tvar extra = { row:id, col:col };\n\t\t\tif (condition) extra.condition = condition;\n\t\t\tif (editor) extra.dropdown = editor;\n\t\t\tif (filter) extra.filter = filter;\n\t\t\tif (span) extra.span = span;\n\t\t\tobj.extra = extra;\n\t\t}\n\t\t\n\t\trow.push(obj);\n\t\treturn value;\n\t});\n\n\treturn data;\n}\n\nfunction allFiltersInZone(extra, origin, columnCount){\n\tvar filters = Object.keys(extra);\n\tvar startRow = Math.min.apply(null, filters);\n\tvar endRow = Math.max.apply(null, filters);\n\tvar startCol = columnCount;\n\tvar endCol = 1;\n\n\tfor (var i = startRow; i <= endRow; i++){\n\t\tif(extra[i]){\n\t\t\tvar columns = Object.keys(extra[i]);\n\t\t\tstartCol = Math.min(startCol, Math.min.apply(null, columns));\n\t\t\tendCol = Math.max(endCol, Math.max.apply(null, columns));\n\t\t}\n\t}\n\n\tif(origin.start.row <= startRow && origin.end.row >= endRow && origin.start.column <= startCol && origin.end.column >= endCol)\n\t\treturn true;\n\telse\n\t\treturn false;\n}\n//dynamically increase rows and columns according to pasted data size\nfunction _add_row_col(view, start, data){\n\tvar maxRow = start.row + data.length - 1;\n\tvar maxCol = start.column + data[0].length - 1;\n\n\tif(maxRow > view.config.rowCount || maxCol > view.config.columnCount){\n\t\tvar action = { id:\"add\" };\n\t\tif (maxRow > view.config.rowCount) {\n\t\t\taction.group = \"row\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ row: view.config.rowCount + 1 }, \n\t\t\t\t{ row: maxRow }\n\t\t\t]);\n\t\t}\n\t\tif (maxCol > view.config.columnCount) {\n\t\t\taction.group = \"column\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ column: view.config.columnCount + 1 },\n\t\t\t\t{ column: maxCol }\n\t\t\t]);\n\t\t}\n\t}\n}\n\nfunction _changeDelimiter(data, clipboardDecimalDelimiter){\n\tfor(var i = 0; i < data.length; i++)\n\t\tfor(var k = 0; k < data[i].length; k++){\n\t\t\tvar record = data[i][k].toString().replace(clipboardDecimalDelimiter, \".\");\n\t\t\tif(webix.rules.isNumber(record))\n\t\t\t\tdata[i][k] = record;\n\t\t}\n\treturn data;\n}","import {getType} from \"./types\";\n\nexport function init(view){\n\t//parsing initial data\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\n\t// undo\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif(type == \"value\")\n\t\t\t_undoValue(view, row, column, value);\n\t});\n}\n\nfunction _serialize(view, obj, config){\n\tvar math = !config || config.math!==false;\n\tvar data = [];\n\tvar grid = view.$$(\"cells\");\n\tvar state = grid.getState();\n\tvar columns = state.ids.concat(state.hidden);\n\n\t// remove \"rowId\" column\n\tcolumns.splice(columns.indexOf(\"rowId\"), 1);\n\n\tgrid.eachRow(function(row){\n\t\tconst item = this.getItem(row);\n\t\tfor (var i=0; i<columns.length; i++){\n\t\t\tconst key = columns[i];\n\t\t\tlet value = item[key];\n\t\t\tconst css = item.$cellCss ? (item.$cellCss[key] || \"\") : \"\";\n\n\t\t\t//serialize instead of value if defined\n\t\t\tif (math && item[\"$\"+key])\n\t\t\t\tvalue = item[\"$\"+key];\n\n\t\t\t//put not empty values in serialization\n\t\t\tconst hasValue = value || value === 0;\n\t\t\tif (hasValue || css) {\n\t\t\t\tconst type = getType(view, row, key);\n\t\t\t\tdata.push([row*1, key*1, (hasValue ? value : \"\"), css, type]);\n\t\t\t}\n\t\t}\n\t}, true);\n\tobj.table = {\n\t\tfrozenColumns : (view._frozenColumns || 0),\n\t\tfrozenRows : (view._frozenRows || 0)\n\t};\n\n\tobj.data = data;\n}\n\nfunction _parse(view, obj){\n\tvar grid = view.$$(\"cells\");\n\n\tvar tconfig = obj.table || { frozenColumns : 0, frozenRows : 0 };\n\tview._frozenColumns = view._frozenRows = 0;\n\tif (tconfig){\n\t\tif (!webix.isUndefined(tconfig.frozenColumns) && (tconfig.frozenColumns+1) != grid.config.leftSplit)\n\t\t\tview.freezeColumns(tconfig.frozenColumns);\n\t\tif (!webix.isUndefined(tconfig.frozenRows) && tconfig.frozenRows != grid.config.topSplit)\n\t\t\tview.freezeRows(tconfig.frozenRows);\n\t}\n\n\tif(obj.sizes)\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\tfor (var i = 0; i < obj.data.length; i++){\n\t\tvar [ row, column, value, , type ] = obj.data[i];\n\n\t\tif(typeof value == \"string\")\n\t\t\tvalue = value.replace(/^=link\\(/i, \"=HYPERLINK(\"); // LINK is deprecated\n\n\t\tvar item = grid.getItem(row);\n\t\titem[column] = value;\n\n\t\t//cell value can be updated via types module\n\t\tview.ignoreUndo(()=>{\n\t\t\tview.callEvent(\"onCellChange\", [row, column, value, type]);\n\t\t});\n\t}\n}\n\nfunction _undoValue(view, row, column, value){\n\tview.setCellValue(row, column, value);\n}","export function init(view) {\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"show\" || action.id == \"hide\"){\n\t\t\tconst sel = view._table.getSelectArea();\n\t\t\tif (sel)\n\t\t\t\tprocess(action, sel.start, sel.end, view);\n\t\t}\n\t});\n\treset(view);\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value, direction) => {\n\t\tif ((action.id == \"hide\" || action.id == \"show\") && (action.group == \"column\" || action.group == \"row\")){\n\t\t\tlet type = action.id;\n\t\t\tif (!direction)\n\t\t\t\ttype = type == \"hide\" ? \"show\" : \"hide\";\n\t\t\tconst obj = (row || column);\n\t\t\tprocess({ id: type, group: action.group }, obj.start, obj.end, view, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\t_updatePosition(view, p.name,p.inc,p.data, p.start);\n\t});\n}\n\nexport function reset(view, mode) {\n\tif(mode) view[\"_hidden_\"+mode+\"_hash\"] = {};\n\telse{\n\t\tview._hidden_cols_hash = {};\n\t\tview._hidden_rows_hash = {};\n\t}\n}\n\nfunction getIds(id){\n\treturn webix.isArray(id) ? id : [id, id];\n}\n\nexport function isColumnVisible(view, column){\n\treturn !view._hidden_cols_hash[column];\n}\n\nexport function setState(view, indexes, state, type){\n\t// hide\n\tif(!indexes){\n\t\tconst sel = view.getSelectedId(true);\n\t\tconst action = {\n\t\t\tid: state === false ? \"show\" : \"hide\",\n\t\t\tgroup: type\n\t\t};\n\n\t\tif(sel.length)\n\t\t\tview.callEvent(\"onCommand\", [action, sel[0], sel[sel.length-1]]);\n\t}\n\telse {\n\t\tconst ids = getIds(indexes);\n\t\tconst hidden = type == \"row\" ? view._hidden_rows_hash : view._hidden_cols_hash;\n\n\t\tif (!hidden[ids[0]] && (webix.isUndefined(state) || state)){\n\t\t\t(type == \"row\" ? _hideRow : _hideColumn)({id: \"hide\", group: type}, {[type]: ids[0]}, {[type]: ids[1]}, view);\n\t\t}\n\t\t// show\n\t\telse if (hidden[ids[0]] && (webix.isUndefined(state) || !state)) {\n\t\t\tconst inc = ids[0] > 1 ? 1 : -1;\n\t\t\t(type == \"row\" ? _showRow : _showColumn)({id: \"hide\", group: type}, {[type]: ids[0] + inc}, {[type]: ids[1] + inc}, view);\n\t\t}\n\t}\n}\n\nexport function isRowVisible(view, row){\n\treturn !view._hidden_rows_hash[row];\n}\n\nexport function serialize(view, data){\n\tlet hrows  = []; let hcols = [];\n\tfor(let r in view._hidden_rows_hash) hrows.push(r);\n\tfor(let c in view._hidden_cols_hash) hcols.push(c);\n\n\tif(hrows.length || hcols.length)\t\n\t\tdata.table.hidden = {};\n\tif(hrows.length)\n\t\tdata.table.hidden.row = hrows;\n\tif(hcols.length)\n\t\tdata.table.hidden.column = hcols;\n}\n\nexport function load(view, data){\n\treset(view);\n\t\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.hidden)){\n\t\tconst hidden = data.table.hidden;\n\n\t\tif(hidden.row && hidden.row.length){\n\t\t\tfor(let r = 0; r < hidden.row.length; r++)\n\t\t\t\t_hideRow({id:\"hide\", group:\"row\"}, {row:hidden.row[r]}, {row:hidden.row[r]}, view, true);\n\t\t}\n\n\t\tif(hidden.column && hidden.column.length){\n\t\t\tfor(let c = 0; c < hidden.column.length; c++)\n\t\t\t\t_hideColumn({id:\"hide\", group:\"column\"}, {column:hidden.column[c]}, {column:hidden.column[c]}, view, true);\n\t\t}\n\t}\n}\n\nfunction process(action) {\n\tif (action.group == \"column\"){\n\t\tif (action.id == \"show\")\n\t\t\t_showColumn.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideColumn.apply(this, arguments);\n\t} else if (action.group == \"row\") {\n\t\tif (action.id == \"show\")\n\t\t\t_showRow.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideRow.apply(this, arguments);\n\t}\n}\n\nfunction _showColumn(action, start, end, view, silent) {\n\tlet i = end.column;\n\tconst grid = view.$$(\"cells\");\n\n\twhile (i >= start.column) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_cols_hash[i*1-1] || view._hidden_cols_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_cols_hash[id];\n\t\t\tlet cell = grid.getColumnConfig(id - 1 || \"rowId\").header[0];\n\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_column\", \"\");\n\t\t\tgrid.showColumn(id);\n\t\t\tstart.column = start.column < id ? start.column : id;\n\t\t\tend.column = end.column > id ? end.column : id;\n\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onColumnOperation\", [action, { column: id }, { column:id }, null]);\n\t\t}\n\t\ti--;\n\t}\n}\n\nfunction _showRow(action, start, end, view, silent) {\n\tlet i = end.row;\n\tconst grid = view.$$(\"cells\");\n\n\tconst split = view._frozenRows;\n\tif(split+1 >= start.row){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\twhile (i >= start.row) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_rows_hash[i*1-1] || view._hidden_rows_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_rows_hash[id];\n\t\t\tif (id - 1 === 0) {\n\t\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_row\", \"\");\n\t\t\t\tgrid.refreshColumns();\n\t\t\t} else {\n\t\t\t\tgrid.removeCellCss(id - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t\t}\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onRowOperation\", [action, { row: id }, { row: id }, null]);\n\t\t}\n\t\ti--;\n\t}\n\n\tview.filterSpreadSheet();\n\n\tif(split+1 >= start.row)\n\t\tview.freezeRows(split);\n}\n\nfunction _hideColumn(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.column;\n\tview.$handleSelection = null;\n\tgrid.unselect();\n\n\tif (end.column<1 || start.column<1){\n\t\tdelete view._hidden_cols_hash[start.column];\n\t\treturn;\n\t}\n\twhile (i >= start.column) {\n\t\tview._hidden_cols_hash[i] = i;\n\n\t\tlet cell = grid.getColumnConfig(i - 1 || \"rowId\").header[0];\n\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_column\";\n\n\t\tgrid.hideColumn(i);\n\t\ti--;\n\t}\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]);\n}\n\nfunction _hideRow(action, start, end, view, silent) {\n\tif (end.row<1 || start.row<1){\n\t\tdelete view._hidden_rows_hash[start.row];\n\t\treturn;\n\t}\n\n\tconst split = view._frozenRows;\n\tif(split >= start.row){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.row;\n\n\twhile (i >= start.row) {\n\t\tview._hidden_rows_hash[i] = i;\n\n\t\tif (i - 1 === 0) {\n\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\tgrid.refreshColumns();\n\t\t}\n\t\telse\n\t\t\tgrid.addCellCss(i - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\n\t\ti--;\n\t}\n\n\tview.filterSpreadSheet();\n\n\tif(split >= start.row)\n\t\tview.freezeRows(split);\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n}\n\nfunction _updatePosition(view, name, inc, data, start){\n\tif(data.table && data.table.hidden && data.table.hidden[name] && data.table.hidden[name].length){\n\t\tif(name ===\"column\") reset(view, \"cols\");\n\t\tif(name === \"row\") reset(view, \"rows\");\n\n\t\tlet s = start[name], e = s + inc;\n\t\tif(s > e) [s, e] = [e, s];\n\n\t\tfor(let i = s; i < e; i++){\n\t\t\tfor(let h = 0; h < data.table.hidden[name].length; h++){\n\t\t\t\tif(data.table.hidden[name][h] >= i)\n\t\t\t\t\tdata.table.hidden[name][h] = data.table.hidden[name][h]*1+(inc>0 ? 1: -1);\n\t\t\t}\n\t\t}\n\t}\n}","import {getStyle, getTextSize} from \"./styles\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\n\tif (view.config.resizeCell){\n\t\tvar grid = view.$$(\"cells\");\n\t\tgrid.define(\"resizeRow\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"resizeColumn\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\t\tgrid.attachEvent(\"onRowResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: id, column: 0, size: view.getRow(id).$height });\n\t\t});\n\t\tgrid.attachEvent(\"onColumnResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: 0, column: id, size: view.getColumn(id).width });\n\t\t});\n\n\t\t// undo\n\t\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\t\tif(type == \"c-resize\" || type == \"r-resize\")\n\t\t\t\t_undoResize(view, row, column, value);\n\t\t});\n\t}\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.sizes){\n\t\t\tfor (var i=0; i<data.sizes.length; i++){\n\t\t\t\tvar size = data.sizes[i];\n\t\t\t\tif (size[0]*1 !== 0){\n\t\t\t\t\tvar row = view.getRow(size[0]);\n\t\t\t\t\tif(row) row.$height = size[2]*1;\n\t\t\t\t} else {\n\t\t\t\t\tvar col = view.getColumn(size[1]);\n\t\t\t\t\tif(col) col.width = size[2]*1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (data.sizes.length)\n\t\t\t\tview.refresh(true);\n\t\t}\n\t});\n\n\t\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar sizes = [];\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar columns = grid.getState().order;\n\t\tvar order = grid.data.order;\n\n\t\tvar defWidth = grid.config.columnWidth;\n\t\tvar defHeight = grid.config.rowHeight;\n\n\t\tfor (let i = 1; i < columns.length; i++){\n\t\t\tvar width = grid.getColumnConfig(columns[i]).width;\n\t\t\tif (width && width != defWidth)\n\t\t\t\tsizes.push([0, i, width]);\n\t\t}\n\n\t\tfor (let i = 0; i < order.length; i++){\n\t\t\tvar height = grid.getItem(order[i]).$height;\n\t\t\tif (height && height != defHeight)\n\t\t\t\tsizes.push([order[i]*1, 0, height]);\n\t\t}\n\t\t\n\t\tdata.sizes = sizes;\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\tview.attachEvent(\"onBeforeStyleChange\", function(row, column, n, o){\n\t\tif (o && o.props.wrap === \"wrap\" && (!n || n.props.wrap != o.props.wrap)){\n\t\t\tdelete view._table.getItem(row).$height;\n\t\t}\n\t});\n\tview.attachEvent(\"onStyleChange\", _adjustRowHeight);\n\tview.attachEvent(\"onCellChange\",  _adjustRowHeight);\n}\n\nfunction _undoResize(view, row, column, value){\n\tif(row){\n\t\tview.$$(\"cells\").getItem(row).$height = value;\n\t\tsave(view, \"sizes\", { row:row, column: 0, size: value });\n\t}\n\telse{\n\t\tview._table.setColumnWidth(column, value);\n\t}\n\t// update area selection\n\tview._table.refreshSelectArea();\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet i,\n\t\tsizes = data.sizes,\n\t\tnsizes = [];\n\n\tif(inc){\n\t\tfor(i = sizes.length-1;i >=0;i--){\n\t\t\tlet [row,column,size] = sizes[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\t//moving row|column index\n\t\t\t\trow =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tcolumn = name == \"column\"?column*1 + inc:column;\n\t\t\t\tif((name == \"row\" && row>0) || (name == \"column\" && column >0))\n\t\t\t\t\tnsizes.push([row, column, size]);\n\t\t\t} else //row, column not affected by resize\n\t\t\t\tnsizes.push(sizes[i]);\n\t\t}\n\t\tdata.sizes = nsizes;\n\t}\n}\n\nfunction _adjustRowHeight(row, column){\n\tconst view = this;\n\tlet style = getStyle(view, {row:row, column:column});\n\n\t//changing styles or content of wrapped cell -> resize the related row\n\tif (style && style.props.wrap){\n\t\tlet item = view._table.getItem(row);\n\t\tlet height = item.$height || view._table.config.rowHeight;\n\n\t\tview._table.eachColumn(function(col, config){\n\t\t\tlet style = getStyle(view, {row:row, column:col});\n\t\t\t//include only cells with active wrap into calculation \n\t\t\tif(style && style.props && style.props.wrap === \"wrap\"){\n\t\t\t\tlet text = this.getText(row, col);\n\t\t\t\tlet baseWidth = config.width;\n\n\t\t\t\tconst span = view._table.getSpan(row, col);\n\t\t\t\tif(span)\n\t\t\t\t\tbaseWidth = view._table.getSpanNode({row:span[0], column:span[1]}).offsetWidth;\n\n\t\t\t\tif(view.getCellEditor(row, col) || view.getCellFilter(row, col))\n\t\t\t\t\tbaseWidth += 20;\n\n\t\t\t\theight = Math.max(height, getTextSize(view, text, style.id, baseWidth).height);\n\t\t\t}\n\t\t});\n\n\t\titem.$height  = height;\n\t}\n}\n","import {encode} from \"../helpers/column_names\";\n\nexport function init(view){\n\tvar table = view._table;\n\n\tvar bs = 0;\n\ttable.attachEvent(\"onAreaDrag\", () => bs = new Date());\n\ttable.attachEvent(\"onBeforeAreaRemove\", function(){\n\t\t//[FIXME] currently we don't have enough info to know\n\t\t//is user selects new area, and removing need to be blocked\n\t\t//or is it some API which attempts to remove the area\n\t\tif (view.$handleSelection && (new Date() - bs)<500) return false;\n\t});\n\n\ttable.attachEvent(\"onBeforeAreaAdd\", (area) => {\n\t\t//[FIXME] \n\t\t//block selection of row-id column\n\t\t//temporary fix, we need to fire onBeforeBlockSelect when selection moves\n\t\t//so the common onBeforeBlockSelect handler will block rowId selection\n\t\tif (area.start.column == \"rowId\") return false;\n\n\t\t//if we have an active editor, we need to close it on block selection\n\t\t//ignore, when selecting the editor's cell\n\t\tvar editor = table.getEditor();\n\t\tif (editor && (\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ||\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ))\n\t\t\ttable.editStop();\n\n\t\tif (!view.$handleSelection) return true;\n\t\t\n\n\t\tlet blockStart = encode[area.start.column] + area.start.row;\n\t\tlet blockEnd = encode[area.end.column] + area.end.row;\n\n\t\tvar res = view.$handleSelection(area.start, area.end, blockStart, blockEnd);\n\n\t\tif (res !== false){\n\t\t\tview.$handleSelection = null;\n\t\t\ttable.removeSelectArea();\n\t\t}\n\n\t\treturn res;\n\t});\n\n\twebix.event(table.$view, \"mousedown\", function(e){\n\t\tif (view.$handleSelection)\n\t\t\treturn webix.html.preventEvent(e);\n\t});\n}\n","export function expandSelection(r, view){\n\tlet maxY = view.config.rowCount;\n\tlet maxX = view.config.columnCount;\n\tlet table = view._table;\n\n\tlet nr1 = r.start.row, nr2 = r.end.row, nc1 = r.start.column, nc2 = r.end.column;\n\n\tfor (let i=nr1-1; i>0; i--){\n\t\tif (getValue(i, r.start.column, table))\n\t\t\tnr1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nr2+1; i<maxY; i++){\n\t\tif (getValue(i, r.end.column, table))\n\t\t\tnr2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc1-1; i>0; i--){\n\t\tif (getValue(r.start.row, i, table))\n\t\t\tnc1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc2+1; i<maxX; i++){\n\t\tif (getValue(r.end.row, i, table))\n\t\t\tnc2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tlet newrange = { start:{ row:nr1, column:nc1 } , end:{ row: nr2, column: nc2 }};\n\tif (nr1 != r.start.row || nr2 != r.end.row || nc1 != r.start.column || nc2 != r.end.column){\n\t\tview._table.addSelectArea(newrange.start, newrange.end);\n\t}\n\n\treturn newrange;\n}\n\nfunction getValue(r,c, table){\n\tvar value = table.getItem(r)[c];\n\tif(value === undefined || value === \"\"){\n\t\treturn false;\n\t} else {\n\t\treturn true;\n\t}\n}","import {expandSelection} from \"../helpers/expand_selection\";\nimport {updateMath} from \"../math/updater\";\nimport {rangeObj} from \"../helpers/column_names\";\nimport group from \"./undo_group\";\nimport {_changeCondition} from \"./conditional_formats\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"sort-asc\" || cm.id === \"sort-desc\")\n\t\t\tsortRange(view, null, cm.id.replace(\"sort-\",\"\"));\n\t});\n}\n\nconst sorters = {\n\t\"int\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = parseFloat(a[key]) || -Infinity;\n\t\t\tlet d = parseFloat(b[key]) || -Infinity;\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;\n\t\t};\n\t},\n\t\"str\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = (a[key] || \"\").toString().toLowerCase();\n\t\t\tlet d = (b[key] || \"\").toString().toLowerCase();\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;  \n\t\t};\n\t}\n};\n\nexport function sortRange(view, range, dir, type){\n\trange = range || view._table.getSelectArea();\n\n\tif (range){\n\t\trange = rangeObj(range, view);\n\t\tlet fullrange = range;\n\t\tif (range.start.row === range.end.row)\n\t\t\tfullrange = expandSelection(range, view);\n\n\t\tlet key = view.getRow(range.start.row)[range.start.column];\n\t\ttype = type || (isNaN(parseFloat(key)) ? \"str\" : \"int\");\n\t\tdir = (!dir || dir === \"asc\") ? 1 : -1;\n\t\tgroup.set(()=>\n\t\t\tsort(fullrange, range.start.column, type, dir, view)\n\t\t);\n\t}\n}\n\nfunction sort(range, by, type, dir, view){\n\tfor (let column = range.start.column; column <= range.end.column; column++){\n\t\t//get all selected column values\n\t\tconst values = [];\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst fullRow = view.getRow(row);\n\t\t\t\tlet value = fullRow[column];\n\t\t\t\tlet style = view.getStyle(row, column);\n\t\t\t\tlet math = fullRow[\"$\"+column];\n\t\t\t\tlet conditions = view.conditions.get(row,column);\n\t\t\t\tif(conditions)\n\t\t\t\t\t_changeCondition(\"remove\", row, column, conditions, null, view);\n\n\t\t\t\tvalues.push({\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tstyle: style,\n\t\t\t\t\tmath: math,\n\t\t\t\t\trow: row,\n\t\t\t\t\tconditions: conditions\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//sort them\n\t\tvalues.sort(sorters[type](dir, \"value\"));\n\n\t\t//set new values to original column\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst element = values.shift();\n\t\t\t\t\n\t\t\t\tview.setStyle(row, column, (element.style || null));\n\t\t\t\tif(element.conditions)\n\t\t\t\t\t_changeCondition(\"update\", row, column, null, element.conditions, view);\n\n\t\t\t\tif (!element.math) view.setCellValue(row, column, element.value);\n\t\t\t\telse {\n\t\t\t\t\tconst translate = {\n\t\t\t\t\t\tid: \"move\",\n\t\t\t\t\t\trow: row - element.row,\n\t\t\t\t\t\tcolumn: 0\n\t\t\t\t\t};\n\t\t\t\t\tconst newMath = updateMath(element.math, translate);\n\n\t\t\t\t\tview.setCellValue(row, column, newMath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tview.refresh();\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"gridlines-hide\"){\n\t\t\thideGridlines(view, value);\n\t\t}\n\t});\n}\n\nexport function hideGridlines(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tvar borderless = grid.$view.className.indexOf(\"webix_borderless\") !=-1;\n\tif (state === \"toggle\")\n\t\tstate = !borderless;\n\n\tif(!borderless && state){\n\t\twebix.html.addCss( grid.$view, \"webix_borderless\", true);\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-gridlines\", value:true}]);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:true, value: false}]);\n\t}\n\telse if(borderless && !state){\n\t\twebix.html.removeCss( grid.$view, \"webix_borderless\");\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-gridlines\", value:false}]);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:false, value: true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.gridlines = view.$$(\"cells\").$view.className.indexOf(\"webix_borderless\") !=-1?0:1;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.gridlines))\n\t\tmode = !data.table.gridlines;\n\thideGridlines(view, mode);\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"header-hide\"){\n\t\t\thideHeaders(view, value);\n\t\t}\n\t});\n}\n\nexport function hideHeaders(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tif (state === \"toggle\")\n\t\tstate = grid.config.header;\n\n\tif(grid.config.header && state){\n\t\tgrid.config.header = false;\n\t\tif (grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.hideColumn(\"rowId\", {}, true, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-headers\", value:true}]);\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:true, value:false}]);\n\t}\n\telse if(!grid.config.header && !state){\n\t\tgrid.config.header = true;\n\t\tif (!grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.showColumn(\"rowId\", {}, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-headers\", value:false}]);\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:false, value:true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.headers = view.$$(\"cells\").config.header?1:0;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(data.table && !webix.isUndefined(data.table.headers))\n\t\tmode = !data.table.headers;\n\thideHeaders(view, mode);\n}","import group from \"./undo_group\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.comments = {\n\t\tget: function(row, column){\n\t\t\treturn getComment(view, row, column);\n\t\t},\n\t\tadd: function(row, column, comment){\n\t\t\tcommentCell(view, row, column, comment);\n\t\t},\n\t\tremove: function(row, column){\n\t\t\tremoveComment(view, row, column);\n\t\t},\n\t\t_activeComment: {},\n\t\t_pull:{}\n\t};\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"comment\")\n\t\t\t_undoComment(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction _undoComment(view, row, column, value){\n\tif(getComment(view, row, column))\n\t\tremoveComment(view, row, column, true);\n\tif(value)\n\t\tcommentCell(view, row, column, value, true);\n}\n\nfunction reset(view){\n\tview.comments._pull = {};\n}\n\nfunction removeComment(view, row, column, silent){\n\tif(getComment(view, row, column)){\n\t\tif (!silent)\n\t\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue: null, value: view.comments._pull[row][column]}]);\n\t\tdelete view.comments._pull[row][column];\n\t}\n\tview.$$(\"cells\").updateItem(row,column);\n}\n\nexport function removeCommentsRange(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tif(getComment(view, cell.row, cell.column))\n\t\t\t\tremoveComment(view, cell.row, cell.column);\n\t\t});\n\t\tview.$$(\"cells\").refresh();\n\t});\n}\n\nfunction commentCell(view, row, column, comment, silent){\n\tvar oldValue = getComment(view, row, column) ? view.comments._pull[row][column] : null;\n\tvar table = view.$$(\"cells\");\n\n\tif(typeof comment == \"string\")\n\t\tcomment = comment.trim() ? comment : \"\";\n\tview.comments._pull[row] = view.comments._pull[row] ? view.comments._pull[row] : {};\n\tview.comments._pull[row][column] = comment;\n\n\ttable.addCellCss(row, column, \"ssheet_commented_cell\");\n\n\tif (!silent)\n\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue:comment, value:oldValue}]);\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tcomments = [];\n\tfor(row in view.comments._pull){\n\t\tfor(column in view.comments._pull[row])\n\t\t\tif(view.comments._pull[row][column])\n\t\t\t\tcomments.push([row, column, view.comments._pull[row][column]]);\n\t}\n\tdata.comments = comments;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tcomments = data.comments;\n\n\tif(comments)\n\t\tfor(i = 0; i < comments.length; i++)\n\t\t\tcommentCell(view, comments[i][0], comments[i][1], comments[i][2], true);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet comments = data.comments,\n\t\ti = comments.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = comments[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete comment if row was deleted\n\t\t\t\t\t\tcomments.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tcomments[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tcomments.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tcomments[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getComment(view, row, column){\n\treturn view.comments._pull[row] && view.comments._pull[row][column] ? view.comments._pull[row][column] : \"\";\n}","import * as m1  from \"./hide_gridlines\";\nimport * as m2  from \"./hide_headers\";\nimport * as m3  from \"./lock_cell\";\nimport * as m4  from \"./dropdown\";\nimport * as m5  from \"./filter\";\nimport * as m6  from \"./hide_row_col\";\nimport * as m7  from \"./comments\";\n\nexport function init(view){\n\tvar modules = [m1,m2,m3,m4,m5,m6,m7];\n\tview.attachEvent(\"onDataSerialize\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].serialize)\n\t\t\t\tmodules[i].serialize(view,data);\n\t\t}\n\n\t});\n\tview.attachEvent(\"onDataParse\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].load)\n\t\t\t\tmodules[i].load(view,data);\n\t\t}\n\t});\n}","const types = [\".xls\",\".xlt\",\".xla\",\".xlsx\",\".xlsm\",\".xltx\",\".xltm\",\".xlam\",\".xlsb\"];\n\nexport function init(view){\n\tlet uploader;\n\tif (window.XMLHttpRequest && (new XMLHttpRequest()).upload){\n\t\tuploader = webix.ui({\n\t\t\tview:\"uploader\",\n\t\t\tapiOnly:true,\n\t\t\taccept: types.join()\n\t\t});\n\n\t\tuploader.attachEvent(\"onBeforeFileAdd\",webix.bind(function(upload){\n\t\t\tif(types.indexOf(\".\"+upload.type.toLowerCase())>-1){\n\t\t\t\tview.reset();\n\t\t\t\tview.parse(upload.file, \"excel\");\n\t\t\t}\n\t\t\treturn false;\n\t\t},this));\n\n\t\tview._destroy_with_me.push(uploader);\n\t}\n\n\tview.attachEvent(\"onCommand\", (obj) => {\n\t\tif (obj.id === \"excel-import\")\n\t\t\tstartImport(view, uploader);\n\t});\n}\n\nfunction startImport(view, uploader){\n\tif (!uploader)\n\t\tview.alert(webix.i18n.spreadsheet.labels[\"import-not-support\"]);\n\telse\n\t\twebix.delay(() => uploader.fileDialog());\n}","export function print(view, options){\n\tlet active = view._activeSheet;\n\n\tlet html = _buildHtml(view, options, active);\n\twebix.html.insertBefore(html, options.docFooter, document.body);\n\twindow.print();\n\t_cleanHtml(view, html);\n\n\tview.showSheet(active);\n}\n\nexport function init(view){\n\tview.$customPrint = function(options){\n\t\tprint(view, options);\n\t};\n}\n\nfunction _cleanHtml(view, html){\n\twebix.html.remove(html);\n\n\tview._sheets.forEach((sheet, i) => {\n\t\twebix.html.removeStyle(\".wss_\"+view.$index+\"_\"+i);\n\t});\n}\nfunction _buildHtml(view, options, active){\n\tlet doc = webix.html.create(\"div\", { \"class\":\"webix_ssheet_print\"});\n\n\toptions.xCorrection = 1;\n\toptions.header = options.header || false;\n\toptions.trim = webix.isUndefined(options.trim) ? true : options.trim;\n\toptions.sheetnames = webix.isUndefined(options.sheetnames) ? true : options.sheetnames;\n\tconst baseIndex = view.$index;\n\n\tview._sheets.forEach((sheet, i) => {\n\t\tview.$index = baseIndex+\"_\"+i;\n\t\tif(options.data ===\"all\" || (options.data !== \"all\" && sheet.name === active)){\n\t\t\tview.showSheet(sheet.name);\n\t\t\tlet prefix = \"wss_\"+view.$index;\n\n\t\t\tif(options.sheetnames){\n\t\t\t\tlet sheetname = webix.html.create(\"div\", { \"class\":\"webix_view webix_ssheet_sheetname\"}, sheet.name+\":\");\n\t\t\t\tdoc.appendChild(sheetname);\n\t\t\t}\n\n\t\t\tlet table = view._table.$customPrint(options, true);\n\n\t\t\t//for empty sheet we don't have any HTML\n\t\t\tif (table.firstChild)\n\t\t\t\ttable.firstChild.className += \" \"+prefix;\n\t\t\tdoc.appendChild(table);\n\t\t\t\n\t\t\tif(options.data == \"all\" && i+1 < view._sheets.length){\n\t\t\t\tvar br = webix.html.create(\"DIV\", {\"class\":\"webix_print_pagebreak\"});\n\t\t\t\tdoc.appendChild(br);\n\t\t\t}\n\t\t}\n\t});\n\tview.$index = baseIndex;\n\t\n\treturn doc;\n}","import { style_names } from \"../operations/styles\";\nimport { getType } from \"../operations/types\";\nimport { defaultStyles} from \"../toolbar/defaults\";\nimport { getFormatSource } from \"../operations/formats\";\n\nexport function init(view){\n\tview.$exportView = function(options){\n\t\twebix.extend(options, { header: false, rawValues: true, spans: true, styles:true, math:true, xCorrection:1, ignore:{rowId:true}});\n\t\tif(options.export_mode ==\"excel\")\n\t\t\treturn _exportExcel(view, options);\n\t\telse\n\t\t\treturn view._table;\n\t};\n}\n\nfunction _exportExcel(view, options){\n\tif(options.sheets === true) \n\t\toptions.sheets  = view._sheets.map(function(s){ return s.name;});\n\telse if(!options.sheets || !options.sheets.length)\n\t\toptions.sheets = [view._activeSheet];\n\telse if(typeof options.sheets == \"string\")\n\t\toptions.sheets = [options.sheets];\n\n\toptions.dataOnly = true;\n\n\tlet data = [];\n\tlet active = view._activeSheet;\n\n\tfor(let i = 0; i<options.sheets.length; i++){\n\t\tconst sheet = options.sheets[i];\n\t\tconst id = sheet.id || sheet;\n\n\t\tview.showSheet(id);\n\t\toptions.xCorrection = view.$$(\"cells\").config.header ? 1 : 0;\n\n\t\tconst sheetOptions = sheet.options ? webix.extend(sheet.options, options) : webix.copy(options);\n\t\tif(!sheetOptions.name)\n\t\t\tsheetOptions.name = id;\n\n\t\tdata = data.concat(webix.toExcel(view._table, sheetOptions));\n\t\tdata[i].ranges = [];\n\n\t\tlet ranges = view.ranges.getRanges();\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\tdata[i].ranges.push({\n\t\t\t\tSheet:i,\n\t\t\t\tName:ranges[r].name,\n\t\t\t\tRef:sheetOptions.name+\"!\"+ranges[r].range.replace(/(\\w)/gi, function(match){ return \"$\"+match; })\n\t\t\t});\n\t\t}\n\t\tif(sheetOptions.styles)\n\t\t\tdata[i].styles = _getStyles(view, sheetOptions);\n\t}\n\tview.showSheet(active);\n\n\tdelete options.dataOnly;\n\treturn data;\n}\n\nfunction _safeColor(str){\n\tstr = str.substring(1);\n\tif(str.length === 3) str = str+str;\n\treturn str;\n}\n\nfunction _getDefaults(){\n\tlet d = defaultStyles;\n\treturn {\n\t\tfont:{\n\t\t\tsz:d[\"font-size\"].replace(\"px\", \"\")*0.75,\n\t\t\tname:d[\"font-family\"].replace(/'|,.*$/g, \"\"),\n\t\t\t//we do not export default color, but it is the right place to do it\n\t\t},\n\t\talignment:{\n\t\t\thorizontal:d[\"text-align\"],\n\t\t\tvertical:d[\"vertical-align\"]==\"middle\"?\"center\":d[\"vertical-align\"],\n\t\t\twrapText:d[\"white-space\"]!=\"nowrap\"\n\t\t}\n\t};\n}\n\nfunction _getStyles(view, options){\n\n\tview.compactStyles();\n\n\tlet result = [];\n\tlet cached = {};\n\tconst defaults = _getDefaults();\n\n\tif(options.docHeader) result  = result.concat([{0:_getDocStyle(options.docHeader.css, defaults)}, {}]);\n\tif(options.header) result.push({});\n\n\tconst delta = result.length;\n\n\tconst grid = view.$$(\"cells\");\n\tconst columns = grid.config.columns;\n\n\tlet rIndex = delta;\n\tgrid.eachRow((row) =>{\n\t\tfor (let cIndex = options.xCorrection; cIndex < columns.length; cIndex++){\n\t\t\tconst css = view.getStyle(row, columns[cIndex].id);\n\t\t\tconst index = cIndex - options.xCorrection;\n\n\t\t\tresult[rIndex] = result[rIndex] || {};\n\n\t\t\tlet styles;\n\t\t\tif(css){\n\t\t\t\tif(cached[css.id])\n\t\t\t\t\tstyles = cached[css.id];\n\t\t\t\telse{\n\t\t\t\t\tstyles = _getCellStyle(css.text);\n\t\t\t\t\tfor(let name in defaults)\n\t\t\t\t\t\twebix.extend(styles[name], defaults[name]);\n\t\t\t\t\tcached[css.id] = styles;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tstyles = defaults;\n\n\t\t\tresult[rIndex][index] = webix.copy(styles);\n\t\t\tresult[rIndex][index].type = getType(view, row, columns[cIndex].id);\n\t\t}\n\t\trIndex++;\n\t});\n\n\tif(options.docFooter) result  = result.concat([{},{0:_getDocStyle(options.docFooter.css, defaults)}]);\n\n\treturn result;\n}\n\nfunction _getCellStyle(styles){\n\tlet str = styles.split(\";\"), stl = { font:{}, alignment:{}, border:{}};\n\n\tfor(let s = 0; s<str.length; s++){\n\t\tif(str[s]){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstl.font.color = {rgb:_safeColor(str[s])};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":{\n\t\t\t\t\tlet fill = _safeColor(str[s]);\n\t\t\t\t\tif(fill && fill.toLowerCase() !==\"ffffff\")\n\t\t\t\t\t\tstl.fill = { fgColor:{ rgb:fill}};\n\t\t\t\t\tbreak;\n\t\t\t\t}\t\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstl.alignment.horizontal = str[s];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstl.font.name = str[s].replace(/'|,.*$/g, \"\"); // cut off fallback font\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstl.font.sz = str[s].replace(\"px\", \"\")*0.75; //px to pt conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstl.font.italic = str[s] == \"italic\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstl.font.underline = str[s] == \"underline\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstl.font.bold = str[s] == \"bold\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tstl.alignment.vertical = str[s] == \"middle\"?\"center\":str[s];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstl.alignment.wrapText = str[s] == \"wrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstl.format = getFormatSource(str[s], true) || \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\t\tstl.border.right = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\t\tstl.border.bottom = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-left\":\n\t\t\t\t\tstl.border.left = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstl.border.top = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn stl;\n}\n\nfunction _getDocStyle(css){\n\tif(!css) return {};\n\tvar str = [];\n\tfor(let i =0; i<style_names.length; i++)\n\t\tstr.push(css[style_names[i]]||\"\");\n\treturn _getCellStyle(str.join(\";\"));\n}\n\n","import { style_names } from \"../operations/styles\";\nimport { fontFamily} from \"../toolbar/buttons\";\nimport { defaultStyles} from \"../toolbar/defaults\";\n\nexport function init(view){\n\tview._parseExcel = function(obj, driver){\n\t\tvar options = obj.options || {};\n\t\toptions.math = view.config.math;\n\n\t\tvar full = { sheets:[]};\n\t\tfor(let i  = 0; i< obj.names.length; i++){\n\t\t\toptions.name = obj.names[i];\n\t\t\tfull.sheets.push({\n\t\t\t\tname:options.name,\n\t\t\t\tcontent:_excel_to_data(driver.getSheet(obj, options), obj.ranges, i)\n\t\t\t});\n\t\t}\n\t\treturn full;\n\t};\n\tview._parseCsv = function(obj, driver){\n\t\tobj = driver.getRecords(obj);\n\n\t\tvar dataObj = webix.copy(obj);\n\t\tvar data = [];\n\n\t\tfor(let i = 0; i<dataObj.length; i++){\n\t\t\tlet item = dataObj[i].split(driver.cell);\n\t\t\tfor(let c  = 0; c<item.length; c++){\n\t\t\t\tvar row = i+1, column = c+1;\n\t\t\t\tdata.push([row, column, item[c]]);\n\t\t\t}\n\t\t}\n\t\treturn { data:data };\n\t};\n}\n\n\nfunction _excel_to_data(obj, ranges, index){\n\tvar dataObj = webix.copy(obj.data);\n\tvar data =  [];\n\n\tfor (let i = 0; i < dataObj.length; i++){\n\t\tfor(let c = 0; c<dataObj[0].length; c++){\n\t\t\tvar row = i+1, column = c+1;\n\t\t\tdata.push([row, column, dataObj[i][c]]);\n\t\t}\n\t}\n\tobj.data = data;\n\n\t//merged cells\n\tif(obj.spans){\n\t\tfor(let i = 0; i<obj.spans.length; i++){\n\t\t\tobj.spans[i][0]++;\n\t\t\tobj.spans[i][1]++;\n\t\t}\n\t}\n\n\t//named ranges\n\tif(ranges){\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\t//we don't support global named ranges, so import only sheet-based :(\n\t\t\tif(ranges[r].Sheet === index){\n\t\t\t\tobj.ranges = obj.ranges || [];\n\t\t\t\tobj.ranges.push([ranges[r].Name.toUpperCase(), ranges[r].Ref.substring(ranges[r].Ref.indexOf(\"!\")+1).replace(/\\$/g, \"\")]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//cell styles\n\tif(obj.styles)\n\t\t_getStyles(obj);\n\n\tif(obj.types)\n\t\t_getTypes(obj);\n\n\t//column width and row height\n\tif(obj.sizes){\n\t\tfor(let i = 0; i<obj.sizes.length; i++){\n\t\t\tif(obj.sizes[i][0] == \"column\")\n\t\t\t\tobj.sizes[i] = [0, obj.sizes[i][1]+1, obj.sizes[i][2]];\n\t\t\telse\n\t\t\t\tobj.sizes[i] = [obj.sizes[i][1]+1, 0, obj.sizes[i][2]];\n\t\t}\n\t}\n\n\treturn obj; \n}\n\n//ARGB conversion\nfunction _safeColor(str){\n\tstr = str || \"000000\";\n\tif(str.length === 8) str = str.substring(2);\n\treturn \"#\"+str;\n}\n\n//only fonts that we support can be imported\nfunction _safeFont(str){\n\tlet safe = defaultStyles[\"font-family\"];\n\tfor(let i = 0; i<fontFamily.length; i++){\n\t\tif(fontFamily[i].value == str) { safe = fontFamily[i].id; break; }\n\t}\n\treturn safe;\n}\n\nfunction _getTypes(obj){\n\tobj.types.forEach(type => {\n\t\tfor(let i = 0; i < obj.data.length; i++){\n\t\t\tif(obj.data[i][0] === type[0]+1 && obj.data[i][1] === type[1]+1){\n\t\t\t\tobj.data[i][4] = type[2];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction _getStyles(obj){\n\tlet styleshash = {}, styles = [], stylescount = 1;\n\tfor(let i = 0; i<obj.styles.length; i++){\n\t\tlet str = [], stl = obj.styles[i][2], css;\n\n\t\tfor(let s  = 0; s<style_names.length; s++){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstr[s] = stl.font && stl.font.color?(_safeColor(stl.font.color.rgb)||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":\n\t\t\t\t\tstr[s] = stl.fill && stl.fill.fgColor?(_safeColor(stl.fill.fgColor.rgb) ||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstr[s] = (stl.alignment ?stl.alignment.horizontal:\"\") || defaultStyles[\"text-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.name?_safeFont(stl.font.name):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.sz?((stl.font.sz/0.75)+\"px\" ||\"\"):\"\"; //pt to px conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.italic?\"italic\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.underline?\"underline\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.bold?\"bold\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tvar va = stl.alignment ? (stl.alignment.vertical || \"\"):\"\";\n\t\t\t\t\tstr[s] = (va ==\"center\"?\"middle\":va) || defaultStyles[\"vertical-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstr[s] = stl.alignment && stl.alignment.wrapText?\"wrap\":\"nowrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tstr[s] = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstr[s] = \"\"; //stl.numFmt\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.right? (_safeColor(stl.border.right.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.bottom? (_safeColor(stl.border.bottom.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-left\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.left? (_safeColor(stl.border.left.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.top? (_safeColor(stl.border.top.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tstr = str.join(\";\");\n\t\tcss = styleshash[str] || \"wss\"+stylescount;\n\n\t\tfor(let d = 0; d<obj.data.length; d++){\n\t\t\tif(obj.data[d][0] === obj.styles[i][0]+1 && obj.data[d][1] === obj.styles[i][1]+1){\n\t\t\t\tobj.data[d][3] = css;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!styleshash[str]){\n\t\t\tstyles.push([css, str]);\n\t\t\tstyleshash[str] = css;\n\t\t\tstylescount++;\n\t\t}\n\t}\n\tobj.styles = styles;\n}","import {range, changeRange} from \"../helpers/column_names\";\nimport {getAccessor} from \"../math/sheet\";\nimport {ignoreUndo} from \"./undo\";\n\nexport function init(view){\n\t\n\tconst grid = view._table.$view.querySelector(\".webix_ss_center\");\n\n\tview.views = {\n\t\tregister:function(type, render, track){\n\t\t\tif(!this._types[type])\n\t\t\t\tthis._types[type] = { render:render, track:track };\n\t\t},\n\t\tadd: function(x, y, type, data, config, id){\n\t\t\tconfig = config || {};\n\t\t\tif(type == \"chart\" && !config.type) config.type = \"line\";\n\n\t\t\tconst height =  config.height || 300;\n\t\t\tconst width = config.width || 500;\n\n\t\t\tconst win = webix.ui({ \n\t\t\t\tid:id || \"$ssheet-ui\"+webix.uid(), // fixed id is for undo only\n\t\t\t\tview: \"ssheet-ui\",\n\t\t\t\tcontainer:grid, master:view._table.config.id,\n\t\t\t\twidth:width, height:height\n\t\t\t});\n\t\t\t\n\t\t\twin.attachEvent(\"onViewMoveEnd\", (x, y) => {\n\t\t\t\tconst state = view._table.getScrollState();\n\t\t\t\tthis._pull[id].x = _correctPos(view, win, x, \"x\");\n\t\t\t\tthis._pull[id].y = _correctPos(view, win, y+state.y, \"y\");\n\t\t\t\t_showOne(view, win, this._pull[id]);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewEdit\", () => {\n\t\t\t\tconst config = this._pull[id];\n\t\t\t\tconst command = this._commands[config.type] || config.type;\n\t\t\t\tview.callEvent(\"onCommand\", [{ id:command, viewid:id, config }]);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewRemove\", () => this.remove(id));\n\n\t\t\tid = win.config.id;\n\n\t\t\tconfig.width = config.height = 0;\n\t\t\tx = _correctPos(view, win, x, \"x\");\n\t\t\ty = _correctPos(view, win, y, \"y\");\n\t\t\t\n\t\t\tthis._pull[id] = { x, y, type, data, config };\n\t\t\tthis.update(id, data, config, true);\n\t\t\t_showOne(view, win, this._pull[id]);\n\n\t\t\treturn id; \n\t\t},\n\t\tremove: function(id){\n\t\t\tconst old = this._pull[id];\n\t\t\twebix.$$(id).close();\n\t\t\tdelete this._pull[id];\n\t\t\t\n\t\t\tview.callEvent(\"onAction\", [\"add-view\", { row:id, newValue:null, value:old } ]);\n\t\t},\n\t\tget:function(id){\n\t\t\treturn webix.$$(id).getBody();\n\t\t},\n\t\tupdate:function(id, data, config, inner){\n\t\t\tconst old = inner ? null : webix.copy(this._pull[id]);\n\t\t\tconst conf = this._pull[id];\n\t\t\tconst actions = this._types[conf.type];\n\n\t\t\tdata = data || config.data || [];\n\t\t\tif(config) delete config.data;\n\n\t\t\tconf.data = data;\n\t\t\tconf.config = config;\n\n\t\t\tlet node = this.get(id);\n\n\t\t\tdata = _fromRange(view, conf);\n\n\t\t\tif(actions.render){\n\t\t\t\tnode = actions.render(node, conf, data);\n\t\t\t\t_processTables(node);\n\t\t\t}\n\t\t\t\n\t\t\tif(actions.track)\n\t\t\t\t_trackOne(view, node, actions.track, conf);\n\n\t\t\tview.callEvent(\"onAction\", [\"add-view\", { row:id, newValue:webix.copy(this._pull[id]), value:old} ]);\n\t\t},\n\t\t_commands:{\n\t\t\t\"image\":\"add-image-top\",\n\t\t\t\"chart\":\"add-chart\"\n\t\t},\n\t\t_types:{},\n\t\t_pull:{}\n\t};\n\n\t// handle events\n\tview._table.attachEvent(\"onResize\", () => _showAll(view) );\n\tview._table.attachEvent(\"onScrollY\", () => _showAll(view) );\n\tview._table.attachEvent(\"onScrollX\", () => _showAll(view) );\n\n\tview.attachEvent(\"onReset\", () => _reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"add-view\")\n\t\t\t_undoUI(view, row, value);\n\t});\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif(action == \"header-hide\")\n\t\t\t_showAll(view);\n\t\telse if(action == \"before-grid-change\")\n\t\t\t_updateData(view, p.name, p.inc, p.data, p.start);\n\t});\n\tview.attachEvent(\"onColumnOperation\", () =>  _showAll(view, true));\n\tview.attachEvent(\"onRowOperation\", () => _showAll(view, true));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\tview.attachEvent(\"onCellChange\", () => _trackAll(view));\n\tview.attachEvent(\"onMathRefresh\", () => _trackAll(view));\n\n\tview.attachEvent(\"onDestruct\", () => {\n\t\tfor(let i in view.views._pull) webix.$$(i).destructor();\n\t});\n\n\t// set default views\n\tview.views.register(\"chart\", (node, conf, data) => {\n\t\tconst config = _genChartConfig(conf, data);\n\t\treturn webix.ui(config, node);\n\t}, (view, data) => {\n\t\tview.clearAll();\n\t\tview.parse(data);\n\t});\n\n\tview.views.register(\"image\", (node, conf, data) => {\n\t\tconst config = webix.extend({ css:\"webix_ssheet_bgimage\", template:`<img src=\"${data}\"/>` }, conf.config||{}, true );\n\t\treturn webix.ui(config, node);\n\t});\n}\n\nfunction _parse(view, data){\n\twebix.delay(function(){ //[fixme] wait for dom, otherwise legend is misplaced https://tracker.webix.io/issue/WS-1318\n\t\tconst views = data.views;\n\t\tif(views){\n\t\t\tignoreUndo(function(){\n\t\t\t\tviews.forEach(obj => view.views.add.apply(view.views, obj));\n\t\t\t}, view);\n\t\t}\n\t});\n}\n\nfunction _serialize(view, data, config){\n\tdata.views = [];\n\tfor(let i in view.views._pull){\n\t\tconst conf = view.views._pull[i];\n\t\tconst one = [conf.x, conf.y, conf.type, conf.data, conf.config];\n\t\tif(config && config.viewIds)\n\t\t\tone.push(i);\n\t\tdata.views.push(one);\n\t}\n}\n\nlet thread;\nfunction _trackAll(view){\n\tclearTimeout(thread);\n\tthread = webix.delay(() => {\n\t\tconst ui = view.views;\n\t\tfor(let id in ui._pull){\n\t\t\tconst track = ui._types[ui._pull[id].type].track;\n\t\t\tif(track){\n\t\t\t\t_trackOne(view, ui.get(id), track, ui._pull[id]);\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction _trackOne(view, node, track, conf){\n\tconst data = _fromRange(view, conf, true);\n\ttrack(node, data);\n}\n\nfunction _updateData(view, name, inc, data, start){\n\tconst views = data.views;\n\tfor(let i = 0; i < views.length; i++){\n\t\tif(_isRange(views[i][3]))\n\t\t\tviews[i][3] = changeRange(views[i][3], name, inc, start);\n\t}\n} \n\nfunction _showAll(view, pos){\n\tfor(let id in view.views._pull){\n\t\tconst win = webix.$$(id);\n\t\tconst conf = view.views._pull[id];\n\t\tif(pos){\n\t\t\tconf.x = _correctPos(view, win, conf.x, \"x\");\n\t\t\tconf.y = _correctPos(view, win, conf.y, \"y\");\n\t\t}\n\t\t_showOne(view, win, conf);\n\t}\n}\n\nfunction _showOne(view, win, conf){\n\tconst state = view._table.getScrollState();\n\n\twin.show({\n\t\tx:conf.x,\n\t\ty:conf.y-state.y\n\t});\n}\n\nfunction _correctPos(view, win, v, type){\n\tif(!v && v !==0 )\n\t\tv = view._table.getScrollState()[type]+50;\n\telse{\n\t\tconst size = type == \"x\" ? _getWidth(view)-win.$width : _getHeight(view)-win.$height;\n\t\tv = Math.min(Math.max(v, 0), size);\n\t}\t\n\treturn v;\n}\n\nfunction _reset(view){\n\tignoreUndo(function(){\n\t\tfor(let id in view.views._pull)\n\t\t\tview.views.remove(id);\n\t}, view);\n}\n\nfunction _undoUI(view, id, value){\n\tif(value){\n\t\tconst {x, y, type, data, config} = value;\n\t\tif(view.views._pull[id])\n\t\t\tview.views.update(id, data, config);\n\t\telse\n\t\t\tview.views.add(x, y, type, data, config, id);\n\t}\n\telse\n\t\tview.views.remove(id);\n}\n\nfunction _getWidth(view){\n\tlet width = 0;\n\tview._table.eachColumn(function(id){\n\t\tif(id !== \"rowId\")\n\t\t\twidth += this.getColumnConfig(id).width;\n\t});\n\treturn width;\n}\n\nfunction _getHeight(view){\n\tlet height = 0;\n\tview._table.data.each(function(obj){\n\t\theight += obj.$height || webix.skin.$active.rowHeight;\n\t});\n\treturn height;\n}\n\n//disable datatables not to interfere with ss table events\nfunction _processTables(node){\n\tconst query = function(view){\n\t\treturn view.name == \"datatable\" || view.name == \"treetable\";\n\t};\n\tlet tables = node.queryView(query, \"self\");\n\tif(tables) tables = [tables];\n\telse tables = node.queryView(query, \"all\");\n\ttables.forEach((dt) => dt.disable());\n}\n\n/* chart-specific helpers */\n\nconst _defColors = [\n\t[\"#f55b50\",\"#ff6d3f\",\"#ffa521\"],\n\t[\"#ffc927\",\"#ffee54\",\"#d3e153\"],\n\t[\"#9acb61\",\"#63b967\", \"#21a497\"],\n\t[\"#21c5da\",\"#3ea4f5\",\"#5868bf\"],\n\t[\"#7b53c0\",\"#a943ba\",\"#ec3b77\"]\n];\nlet _defCursor = 0;\n\nfunction _getDefColor(){\n\tconst group = _defColors[_defCursor];\n\tconst index = Math.floor(Math.random()*group.length);\n\t_defCursor++;\n\tif(_defCursor == _defColors.length)\n\t\t_defCursor = 0;\n\treturn group[index];\n}\n\nfunction _genChartConfig(conf, data){\n\tconst config = webix.copy(conf.config);\n\tconst type = config.type;\n\n\tconst legend = { align:\"center\", valign:\"bottom\", layout:\"x\"};\n\tif(_isPie(type))\n\t\t_pieConfig(data, config, legend);\n\telse{\n\t\tlegend.values = [];\n\t\tconst series = [];\t\n\n\t\tfor(var i in data[0]){\n\t\t\tif(i != \"data0\" || !config.xAxis){ //can be xAxis value\n\t\t\t\tconst color = _getDefColor();\n\t\t\t\tconst s = { value:`#${i}#`};\n\n\t\t\t\tif(type == \"radar\" || type ==\"line\" || type == \"spline\"){\n\t\t\t\t\ts.line = { color:color };\n\t\t\t\t\ts.item = { borderColor:color };\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\ts.color = color;\n\t\t\t\tif(type == \"area\" || type == \"splineArea\")\n\t\t\t\t\ts.alpha = 0.7;\n\t\t\t\tseries.push(s);\n\n\t\t\t\tlegend.values.push({text:data[0][i], color:color});\n\t\t\t}\n\t\t}\n\n\t\tif(config.xAxis)\n\t\t\tconfig.xAxis = { template:\"#data0#\"};\n\t\tif(config.legend)\n\t\t\tconfig.legend = legend;\n\t\tconfig.series = series;\n\t}\n\n\treturn webix.extend({\n\t\tview:\"chart\",\n\t\tyAxis:{},\n\t\t\n\t}, config || {}, true );\n}\n\nfunction _isPie(type){\n\treturn type == \"pie\" || type == \"donut\";\n}\n\nfunction _pieConfig(data, config, legend){\n\tfor(var i in data[0]){\n\t\tif(config.legend){\n\t\t\tlegend.template = `#${i}#`; //data0\n\t\t\tconfig.value = `#${i.replace(\"0\", \"1\")}#`; //data1\n\t\t}\n\t\telse \n\t\t\tconfig.value = `#${i}#`;\n\t\tbreak; \n\t}\n\tif(config.legend)\n\t\tconfig.legend = legend;\n\tif(config.pieInnerText)\n\t\tconfig.pieInnerText = config.value;\n}\n\nfunction _isRange(data){\n\treturn typeof data == \"string\" && data.indexOf(\"data:image\") === -1;\n}\n\nfunction _fromRange(view, conf, parse){\n\tlet data = conf.data;\n\tconst coords = _isRange(data) ? range(data, view) : null;\n\tif(coords){\n\t\tconst page = getAccessor(view, coords[4]);\n\t\tdata = page ? page.getRangeCols.apply(page, coords) : [];\n\t}\n\tconst config = conf.config;\n\tif(webix.isArray(data) && parse && config && config.legend && !_isPie(config.type))\n\t\tdata.shift();\n\t\n\treturn data;\n}","import group from \"../operations/undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tswitch (action.id) {\n\t\t\tcase \"clear-value\":\n\t\t\t\tview.clearRange(null,{values: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-style\":\n\t\t\t\tview.clearRange(null,{styles: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-conditional-formats\":\n\t\t\t\tview.clearRange(null,{conditions: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-dropdown-editors\":\n\t\t\t\tview.clearRange(null,{editors: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-all\":\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tview.clearRange(null,null);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-comments\":\n\t\t\t\tview.clearRange(null,{comments: true});\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import group from \"../operations/undo_group\";\nimport {adjustRow, adjustColumn} from \"../operations/column_operations\";\n\n/* row operations */\n\nexport function insertRow(row){\n\tcallCommand(this, \"add\", \"row\", row);\n}\n\nexport function deleteRow(row){\n\tcallCommand(this, \"del\", \"row\", row);\n}\n\nexport function setRowHeight(row, height){\n\tsetSize(this, \"row\", row, height);\n}\n\n/* col operations */\n\nexport function insertColumn(column){\n\tcallCommand(this, \"add\", \"column\", column);\n}\n\nexport function deleteColumn(column){\n\tcallCommand(this, \"del\", \"column\", column);\n}\n\nexport function setColumnWidth(column, width){\n\tsetSize(this, \"column\", column, width);\n}\n\n/* helpers */\n\nfunction getCells(view, id, group){\n\tif(!id){\n\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\tif(area)\n\t\t\tid = [area.start[group],area.end[group]];\n\t}\n\telse if(!webix.isArray(id)){\n\t\tid =  [id,id];\n\t}\n\treturn id;\n}\n\nfunction callCommand(view, name, group, id){\n\tlet start = {}, end = {};\n\tid = getCells(view, id, group);\n\tif(!id)\n\t\treturn;\n\tstart[group] = id[0];\n\tend[group] = id[1];\n\tview.callEvent(\"onCommand\", [{id:name,  group:group}, start, end]);\n}\n\nfunction setSize(view, type, id, size){\n\tid = getCells(view, id, type);\n\tif(!id)\n\t\treturn;\n\tgroup.set(()=>{\n\t\tfor (let i = id[0]; i <= id[1]; i++){\n\t\t\tif(size != \"auto\")\n\t\t\t\tview.$$(\"cells\")[type == \"row\" ? \"setRowHeight\" : \"setColumnWidth\"](i, size);\n\t\t\telse\n\t\t\t\t(type == \"row\" ? adjustRow : adjustColumn)(i, view);\n\t\t}\n\t});\n}","import * as lock from \"../operations/lock_cell\";\n\nexport function lockCell(row, column, state){\n\tlock.lockCell(this, row, column, state);\n}\n\nexport function isCellLocked(row, column){\n\treturn lock.isCellLocked(this, row, column);\n}","import group from \"../operations/undo_group\";\n\nexport function freezeColumns(column){\n\tconst grid = this.$$(\"cells\");\n\t\n\tif( webix.isUndefined(column) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\tcolumn = sel.length?sel[0].column:0;\n\t}\n\n\tconst base = grid.config.columns[0].id == \"rowId\" ? 1 : 0;\n\tlet index = base;\n\tif (column && column != this._frozenColumns)\n\t\tindex = grid.getColumnIndex(column*1+1);\n\tif (index<base) index = base;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"column\", column);\n\t\tgrid.unselect();\n\t\tgrid.define(\"leftSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-column\", { value: (this._frozenColumns || 0), newValue: column}]);\n\t\tthis._frozenColumns = index > base ? column : 0;\n\t},this);\n}\n\nexport function freezeRows(row){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(row) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\trow = sel.length?sel[0].row:0;\n\t}\n\n\tlet index = 0;\n\tif (row && row != this._frozenRows)\n\t\tindex = grid.getIndexById(row*1+1);\n\tif (index < 0) index = 0;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"row\", row);\n\t\tgrid.unselect();\n\t\tgrid.define(\"topSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-row\", { value: this._frozenRows, newValue: row}]);\n\t\tthis._frozenRows = index ? row : 0;\n\t},this);\n}\n\nfunction checkSpans(view, type, num){\n\tconst grid = view.$$(\"cells\");\n\n\tif(type == \"row\"){\n\t\tlet start = 1;\n\t\tlet end = view.config.columnCount;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(num, i);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[0]*1) + span[3] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, span[2], num-span[1]+1);\n\t\t\t}\n\t\t}\n\t}\n\telse{//column\n\t\tlet start = grid.data.order[0];\n\t\tlet end = grid.data.order.length;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(i, num);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[1]*1) + span[2] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, num-span[0]+1, span[3]);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction changeSpan(view, span, x, y){\n\tview.splitCell(span[0], span[1]);\n\tview.combineCells({\n\t\tcell:{\n\t\t\trow:span[0],\n\t\t\tcolumn:span[1]\n\t\t},\n\t\tx:x,\n\t\ty:y\n\t});\n}","import * as gridlines from \"../operations/hide_gridlines\";\n\nexport function hideGridlines(state){\n\tgridlines.hideGridlines(this,state);\n}","import * as headers from \"../operations/hide_headers\";\n\nexport function hideHeaders(state){\n\theaders.hideHeaders(this,state);\n}","import * as hrows from \"../operations/hide_row_col\";\n\nexport function hideColumn(column,state){\n\throws.setState(this, column, state, \"column\");\n}\nexport function isColumnVisible(column){\n\treturn hrows.isColumnVisible(this, column);\n}\nexport function hideRow(row,state){\n\throws.setState(this, row, state, \"row\");\n}\nexport function isRowVisible(row){\n\treturn hrows.isRowVisible(this, row);\n}","import {addMethod} from \"../math/methods\";\nimport {image, chart} from \"../math/writer\";\nimport {getAccessor} from \"../math/sheet\";\n\nexport function addImage(row, column, url){\n\tthis.setCellValue(row, column, image(url));\n\tthis.refresh();\n}\n\nexport function addSparkline(row, column, config){\n\tlet value = chart(config);\n\tthis.setCellValue(row, column, value);\n\tthis.refresh();\n}\n\nexport function getSheetData(name){\n\treturn getAccessor(this, name);\n}\n\nexport function recalculate(){\n\tthis.callEvent(\"onMathRefresh\",[]);\n}\n\nexport function registerMathMethod(name, handler){\n\tname = name.toUpperCase();\n\taddMethod(name, handler);\n\tif(this.$$(\"liveEditor\")){\n\t\tconst sid = this.$$(\"liveEditor\").config.suggest;\n\t\tconst list = webix.$$(sid).getList();\n\t\tif(!list.exists(name))\n\t\t\tlist.add({id:name, value:name});\n\t}\n}","import * as sheets from \"../sheets\";\nimport * as spn from \"../operations/spans\";\nimport * as und from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\nimport * as stl from \"../operations/styles\";\nimport * as srt from \"../operations/sorting\";\nimport {removeCommentsRange} from \"../operations/comments\";\nimport {clearConditionalFormats} from \"../operations/conditional_formats\";\nimport {clearEditors} from \"../operations/dropdown\";\nimport {clearFilters} from \"../operations/filter\";\n\n//spans\nexport function combineCells(range){\n\tif(!range){\n\t\tvar sel = this.getSelectedId(true);\n\t\tif (sel.length>1){\n\t\t\trange = spn.getRange(sel);\n\t\t}\n\t}\n\tgroup.set(()=> {\n\t\tif (range)\n\t\t\tspn.addSpan(this, range.cell, range.x, range.y);\n\t});\n\tthis.refresh();\n}\n\nexport function splitCell(row, column){\n\tif (row && column) {\n\t\tspn.removeSpan(this, {row: row, column: column});\n\t}\n\telse{\n\t\tgroup.set(function(){\n\t\t\tthis.eachSelectedCell(function(cell){\n\t\t\t\tspn.removeSpan(this, cell);\n\t\t\t});\n\t\t},this);\n\n\t}\n\n\tthis.refresh();\n}\n\n//styles\nexport function addStyle(prop, origin){\n\treturn stl.addStyle(this, prop, origin);\n}\n\nexport function getStyle(row, column){\n\treturn stl.getStyle(this, {row:row, column:column});\n}\n\nexport function setStyle(row, column, style){\n\treturn stl.setStyle(this, {row: row, column: column}, style);\n}\n\nexport function setRangeStyle(rangeStr, style){\n\tgroup.set(function() {\n\t\tstl.setRangeStyle(this, rangeStr, style);\n\t},this);\n}\n\nexport function clearRange(rangeStr, type) {\n\tif (!rangeStr){\n\t\trangeStr = this._table.getSelectArea();\n\t\tif (!rangeStr) return;\n\t}\n\n\tif (!type) type = {styles: true, values: true, editors:true, conditions:true, comments:true };\n\t\n\tif (type.styles)\n\t\tstl.clearRangeStyle(this,rangeStr);\n\n\tif (type.conditions)\n\t\tclearConditionalFormats(this,rangeStr);\n\t\n\tif (type.values)\n\t\tthis.setRangeValue(rangeStr, null);\n\n\tif (type.editors){\n\t\tclearEditors(this, rangeStr);\n\t\tclearFilters(this, rangeStr);\n\t}\n\n\tif (type.comments)\n\t\tremoveCommentsRange(this, rangeStr);\n\n\tthis.refresh();\n}\n\nexport function compactStyles(){\n\treturn stl.compactStyles(this);\n}\n\n// serialize\nexport function serialize(config){\n\tvar obj = {};\n\tthis.callEvent(\"onDataSerialize\",[obj, config]);\n\n\tif (config && config.sheets)\n\t\treturn sheets.serialize(this, obj);\n\treturn obj;\n}\n\n//sheets\nexport function showSheet(name){\n\tsheets.show(this,name);\n}\nexport function getActiveSheet(){\n\treturn this._activeSheet;\n}\nexport function addSheet(content){\n\tsheets.add(this, content);\n}\nexport function clearSheet(){\n\tthis.reset();\n}\nexport function renameSheet(name,newName){\n\tsheets.rename(this,name,newName);\n}\nexport function editSheet(name){\n\tsheets.edit(this,name);\n}\nexport function removeSheet(name){\n\tsheets.remove(this,name);\n}\n\n\n//undo\nexport function undo(){\n\tund.undo(this);\n}\nexport function redo(){\n\tund.redo(this);\n}\n\n// sort\nexport function sortRange(range, dir){\n\tsrt.sortRange(this, range, dir);\n}","import {toRange,rangeObj} from \"../helpers/column_names\";\nimport * as tbl from \"../table\";\nimport group from \"../operations/undo_group\";\nimport {newSheet} from \"../sheets\";\n\nexport function refresh(all){\n\tif (all)\n\t\tthis._table.refreshColumns();\n\telse\n\t\tthis._table.refresh();\n}\nexport function eachSelectedCell(cb){\n\tvar cells = this.getSelectedId(true);\n\tfor (var i=0; i<cells.length; i++)\n\t\tcb.call(this, cells[i]);\n}\nexport function getSelectedRange(sheet){\n\tvar area = this._table.getSelectArea();\n\tif (area){\n\t\tif (sheet)\n\t\t\tsheet = this.getActiveSheet();\n\t\treturn toRange(area.start.row,area.start.column,area.end.row,area.end.column,sheet);\n\t}\n\treturn \"\";\n}\nexport function getSelectedId(all){\n\tvar area = this._table.getSelectArea();\n\tif(!all)\n\t\treturn area && area.start.row ? area.start : null;\n\n\tvar selection = [];\n\tif(area){\n\t\tvar c0 = area.start;\n\t\tvar c1 = area.end;\n\n\t\tfor(var i = c0.row; i<= c1.row; i++){\n\t\t\tfor(var j = c0.column; j <= c1.column; j++){\n\t\t\t\tselection.push({row: i,column:j});\n\t\t\t}\n\t\t}\n\t}\n\n\treturn selection;\n\t//return this._table.getSelectedId(all)\n}\nexport function getCellValue(row, column){\n\tvar item = this.getRow(row);\n\tvar value = item[\"$\"+column] || item[column];\n\t\n\tif (typeof value === \"undefined\") return \"\";\n\treturn value;\n}\nexport function setCellValue(row, column, value){\n\tif(this.getCellValue(row, column) !== value){\n\t\tvar item = this.getRow(row);\n\t\tvar old = item[\"$\"+column]||item[column];\n\n\t\t//onCellChange can change item (via types module)\n\t\tgroup.set(()=>{\n\t\t\tif (this.callEvent(\"onBeforeValueChange\",[row, column, value, old])){\n\t\t\t\titem[column] = value;\n\t\t\t\tdelete item[\"$\"+column];\n\n\t\t\t\tthis.callEvent(\"onCellChange\", [row, column, value]);\n\t\t\t\tthis.saveCell(row, column);\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport function setRangeValue(range, value){\n\tgroup.set(function(){\n\t\tvar pos = rangeObj(range, this);\n\t\tfor (let row = pos.start.row; row <= pos.end.row; row++) {\n\t\t\tfor (let column = pos.start.column; column <=  pos.end.column; column++) {\n\t\t\t\tthis.setCellValue(row, column, value);\n\t\t\t}\n\t\t}\n\t},this);\n\n}\n\nexport function getRow(id){\n\treturn this._table.getItem(id);\n}\nexport function getColumn(id){\n\treturn this._table.getColumnConfig(id);\n}\nexport function reset(mode){\n\tvar obj = { data:[] };\n\tif (mode && mode.sheets){\n\t\tobj = newSheet(obj);\n\t}\n\t\n\tthis.parse(obj);\n}\n\nexport function _resetTable(){\n\ttbl.reset(this);\n}\n","import {save} from \"../operations/save\";\n\nexport function saveCell(row, column){\n\tvar style = this.getStyle(row, column);\n\n\tsave(this, \"data\", {\n\t\trow: row,\n\t\tcolumn: column,\n\t\tvalue: this.getCellValue(row, column),\n\t\tstyle: (style ? style.id : \"\")\n\t});\n}","export function getRow(id){\n\treturn this._table.getItem(id);\n}\n\nexport function setCellEditor(row, column, editor) {\n\tconst line = this._table._ssEditors[row] = this._table._ssEditors[row] || {};\n\tconst value = line[column] || this.getRow(row)[column];\n\tline[column] = editor;\n\n\tif (editor && editor.editor){\n\t\tif (this.getCellFilter(row, column))\n\t\t\tthis.setCellFilter(row, column, null);\n\t\tthis._table.addCellCss(row,column, \"ss_editor\");\n\t} else {\n\t\tdelete this._table._ssEditors[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_editor\");\n\t}\n\tthis.callEvent(\"onAction\", [\"dropdown\", { row, column, value, newValue:editor }]);\n}\n\nexport function getCellEditor(row, column){\n\tlet line = this._table._ssEditors[row] || {};\n\treturn line[column] || null;\n}","import * as flt from \"../operations/filter\";\n\nexport function setCellFilter(row, column, filter){\n\tconst line = this._table._ssFilters[row] = this._table._ssFilters[row] || {};\n\tconst value = line[column] || this.getRow(row)[column];\n\n\tif (filter && (webix.isArray(filter) || typeof filter == \"string\"))\n\t\tfilter = { options:filter };\n\tline[column] = filter;\n\n\tif (filter && typeof filter == \"object\"){\n\t\tif (this.getCellEditor(row, column))\n\t\t\tthis.setCellEditor(row, column, null);\n\n\t\tthis._table.addCellCss(row,column, \"ss_filter\");\n\t\tif (filter.value && flt.isValueActive(filter.value))\n\t\t\tthis._table.addCellCss(row,column, \"ss_filter_active\");\n\n\t\twebix.extend(filter, {row, column}, true);\n\t\tfilter.options = flt.calibrateRange(this, row, column, filter.options);\n\n\t\tif (!filter.handler && filter.value && filter.value.condition){\n\t\t\tconst mode = filter.mode || flt.getFilterMode(this, row, column);\n\t\t\tfilter.handler = flt.getFilterFunction(mode, filter.value);\n\t\t}\n\t} else {\n\t\tdelete this._table._ssFilters[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_filter\");\n\t\tthis._table.removeCellCss(row,column, \"ss_filter_active\");\n\t}\n\tthis.callEvent(\"onAction\", [\"filter\", { row, column, value, newValue:filter }]);\n}\n\nexport function getCellFilter(row, column){\n\tlet line = this._table._ssFilters[row] || {};\n\treturn line[column] || null;\n}\n\nexport function removeFilters(){\n\tconst filters = flt.getFilters(this._table);\n\n\tfor\t(let i=0; i<filters.length; i++){\n\t\tconst {row, column} = filters[i];\n\t\tthis.setCellFilter(row, column, null);\n\t}\n\n\tthis._table._ssFilters = {};\n\tthis._table.data.filter((obj) => {\n\t\treturn this.isRowVisible(obj.id);\n\t});\n}\n\n\nexport function filterSpreadSheet(){\n\tthis._table.data.silent(function(){\n\t\tconst filters = flt.getFilters(this._table);\n\n\t\t// hidden rows\n\t\tthis._table.data.filter((obj) => {\n\t\t\treturn this.isRowVisible(obj.id);\n\t\t});\n\n\t\tfor (let i=0; i<filters.length; i++){\n\t\t\tconst {row, column, handler} = filters[i];\n\n\t\t\tlet all = false;\n\t\t\tthis._table.data.filter(function(obj){\n\t\t\t\tif (all || obj.id*1 <= row*1) return true;\n\t\t\t\tif (!obj[column] && obj[column] !== \"\") return all = true;\n\t\t\t\treturn (typeof handler == \"function\") ? handler( String(obj[column]) ) : true;\n\t\t\t}, 1, true);\n\t\t}\n\t}, this);\n\n\tthis._table.callEvent(\"onAfterFilter\", []);\n\tthis._table.refresh();\n}\n","export function confirm(config){\n\treturn webix.confirm({\n\t\tcss:\"webix_ssheet_confirm\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok,\n\t\tcancel: webix.i18n.spreadsheet.labels.cancel\n\t});\n}\n\nexport function alert(config){\n\treturn webix.alert({\n\t\tcss: \"webix_ssheet_alert\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok\n\t});\n}","import * as undo from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\n\nexport function resetUndo(){\n\tundo.reset(this);\n}\n\nexport function groupUndo(func){\n\tgroup.set(func, this);\n}\n\nexport function ignoreUndo(func){\n\tundo.ignoreUndo(func, this);\n}","import * as fmt from \"../operations/formats\";\n\nexport function setFormat(row, column, format){\n\tfmt.addFormat(this, row, column, format);\n}\n\nexport function changeDecimals(row, column, inc){\n\t//row and column may be obj\n\tfmt.changeAreaDecimals(this, inc, row, column);\n}","const defaultMenu = [\n\t{ id:\"file\", submenu:[\n\t\t{id: \"sheet\", submenu: [\n\t\t\t{id: \"new-sheet\"},\n\t\t\t{id: \"copy-sheet\"},\n\t\t\t{id: \"remove-sheet\"}\n\t\t]},\n\t\t{id: \"excel-import\"},\n\t\t{id: \"excel-export\"}\n\t]},\n\t{ id:\"edit\", submenu:[\n\t\t{id: \"add-range\"},\n\t\t{id: \"add-dropdown\"},\n\t\t{id: \"add-link\"},\n\t\t{id: \"lock-cell\"},\n\t\t{id: \"conditional-format\"},\n\t\t{id: \"clear\", submenu:[\n\t\t\t{id: \"clear-value\"},\n\t\t\t{id: \"clear-style\"},\n\t\t\t{id: \"clear-conditional-formats\"},\n\t\t\t{id: \"clear-dropdown-editors\"},\n\t\t\t{id: \"clear-comments\"},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"clear-all\"}\n\t\t]}\n\t]},\n\t{ id:\"insert\", submenu:[\n\t\t{id: \"image\", submenu:[\n\t\t\t{ id: \"add-image-cell\"},\n\t\t\t{ id: \"add-image-top\"}\n\t\t]},\n\t\t{id: \"graph\", submenu:[\n\t\t\t{ id: \"add-sparkline\"},\n\t\t\t{ id: \"add-chart\"}\n\t\t]},\n\t\t{id: \"add-comment\"}\n\t]},\n\t{ id:\"data\", submenu:[\n\t\t{id: \"sort\", submenu: [\n\t\t\t{id: \"sort-asc\"},\n\t\t\t{id: \"sort-desc\"}\n\t\t]},\n\t\t{id: \"create-filter\"}\n\t]},\n\t{ id: \"view\", submenu:[\n\t\t{id: \"columns\", submenu: [\n\t\t\t{id: \"insert-column\"},\n\t\t\t{id: \"delete-column\"},\n\t\t\t{id: \"show-column\"},\n\t\t\t{id: \"hide-column\"},\n\t\t\t{id: \"resize-column\"}\n\t\t]},\n\t\t{id: \"rows\", submenu: [\n\t\t\t{id: \"insert-row\"},\n\t\t\t{id: \"delete-row\"},\n\t\t\t{id: \"show-row\"},\n\t\t\t{id: \"hide-row\"},\n\t\t\t{id: \"resize-row\"}\n\t\t]},\n\t\t{ $template:\"Separator\" },\n\t\t{id: \"freeze-columns\"},\n\t\t{id: \"freeze-rows\"},\n\t\t{id: \"hide-gridlines\"},\n\t\t{id: \"hide-headers\"}\n\t]}\n];\n\nconst ui = {\n\tgetMenuData: function(menu, config){\n\t\tvar i;\n\t\tfor(i=0; i < menu.length; i++){\n\t\t\tif(typeof menu[i] == \"string\")\n\t\t\t\tmenu[i] = {id: menu[i]};\n\t\t\tif((menu[i].id == \"resize-column\" || menu[i].id == \"resize-row\") && !config.resizeCell){\n\t\t\t\tmenu.splice(i,1);\n\t\t\t\ti--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!menu[i].value)\n\t\t\t\tmenu[i].value = webix.i18n.spreadsheet.menus[menu[i].id];\n\t\t\tif(menu[i].submenu)\n\t\t\t\tmenu[i].submenu = this.getMenuData(menu[i].submenu, config);\n\t\t}\n\n\t\treturn menu;\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar config = view.config,\n\t\tmenu = {\n\t\t\tview: \"menu\",\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_ssheet_menu\",\n\t\t\tid: \"menu\",\n\t\t\tautowidth: true,\n\t\t\ttype:{\n\t\t\t\theight: 40\n\t\t\t},\n\t\t\tdata: ui.getMenuData(webix.isArray(config.menu)?config.menu : webix.copy(defaultMenu), view.config)\n\t\t};\n\n\tview.callEvent(\"onViewInit\", [\"menu\", menu]);\n\treturn menu;\n}\n\n\nfunction ready(view){\n\tif(view.$$(\"menu\"))\n\t\tview.$$(\"menu\").attachEvent(\"onMenuItemClick\",(id) => callAction(view,id));\n}\n\nconst actionMap = {\n\t\"undo\": function (view) {\n\t\tview.undo();\n\t},\n\t\"redo\": function (view) {\n\t\tview.redo();\n\t},\n\t\"insert-column\": function (view) {\n\t\tview.insertColumn();\n\t},\n\t\"delete-column\": function (view) {\n\t\tview.deleteColumn();\n\t},\n\t\"show-column\": function (view) {\n\t\tview.hideColumn(null,false);\n\t},\n\t\"hide-column\": function (view) {\n\t\tview.hideColumn(null,true);\n\t},\n\t\"resize-column\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"column\", value: webix.i18n.spreadsheet.menus[\"resize-column\"]}]);\n\t},\n\t\"insert-row\": function (view) {\n\t\tview.insertRow();\n\t},\n\t\"delete-row\": function (view) {\n\t\tview.deleteRow();\n\t},\n\t\"show-row\": function (view) {\n\t\tview.hideRow(null,false);\n\t},\n\t\"hide-row\": function (view) {\n\t\tview.hideRow(null,true);\n\t},\n\t\"resize-row\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"row\", value: webix.i18n.spreadsheet.menus[\"resize-row\"]}]);\n\t},\n\t\"freeze-columns\": function(view){\n\t\tview.freezeColumns();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t}\n};\n\nfunction callAction(view,id){\n\tif(view.callEvent(\"onMenuItemClick\",[id])){\n\t\tif(actionMap[id])\n\t\t\tactionMap[id](view);\n\t\telse\n\t\t\tview.callEvent(\"onCommand\",[{id: id}]);\n\t}\n}","function getText(text){\n\tvar locale = webix.i18n.spreadsheet.labels;\n\treturn locale[text] || text;\n}\nexport function getDefaultStyles(){\n\treturn [\n\t\t{name: getText(\"normal\"), css: \"webix_ssheet_condition_regular\"},\n\t\t{name: getText(\"neutral\"), css: \"webix_ssheet_condition_neutral\"},\n\t\t{name: getText(\"bad\"), css: \"webix_ssheet_condition_bad\"},\n\t\t{name: getText(\"good\"), css: \"webix_ssheet_condition_good\"}\n\t];\n}","//global definitions\nimport \"./locale\";\nimport \"./views/index\";\n\n//special content for non-production builds\nimport \"./init\";\n\nimport \"./editors/index\";\n\n//modules\nimport * as bar from \"./toolbar\";\nimport * as tbl from \"./table\";\nimport * as key from \"./hotkeys\";\nimport * as editor from \"./editor\";\nimport * as sheets from \"./sheets\";\nimport * as dialogs from \"./dialogs/index\";\nimport * as context from \"./context\";\n\nimport {setDefaultFormats} from \"./operations/formats\";\nimport {operations} from \"./operations/index\";\nimport {api} from \"./api/index\";\n\n//styling\nimport * as menu from \"./menu\";\nimport {getDefaultStyles} from \"./helpers/conditional\";\nimport {setSkinDefaults} from \"./toolbar/defaults\";\n\n\nvar component = {\n\tname:\"spreadsheet\",\n\t_base_index:{ count:1 },\n\tdefaults:{\n\t\tspans: true,\n\t\trowCount:50,\n\t\tmath:true,\n\t\tcolumnCount:20,\n\t\tresizeCell: true,\n\t\tsheetTabWidth: 90,\n\t\tconditionStyle: getDefaultStyles()\n\t},\n\t$init:function(){\n\t\tthis.$index = (this._base_index.count++);\n\t\tthis.$view.className += \" webix_ssheet\";\n\n\t\tthis.$ready.unshift(this._sub_init);\n\t\tthis.$ready.unshift(setDefaultFormats);\n\t\tthis.$ready.push(this._set_handlers);\n\n\t\tthis._destroy_with_me = [];\n\t\tthis.attachEvent(\"onDestruct\", () => {\n\t\t\tthis._destroy_with_me.forEach(view => view.destructor());\n\t\t});\n\t},\n\t$skin:function(){\n\t\tsetSkinDefaults();\n\t},\n\t_sub_init:function(){\n\t\tconst obj = this.config;\n\t\tconst rows = [];\n\n\t\t//toolbars\n\t\tif(!obj.readonly && obj.menu)\n\t\t\trows.push(menu.init(this));\n\t\tif(!obj.readonly && obj.toolbar !== false)\n\t\t\trows.push(bar.init(this));\n\t\tif (obj.subbar)\n\t\t\trows.push(obj.subbar);\n\t\tif(!obj.readonly && obj.liveEditor)\n\t\t\trows.push(editor.init(this));\n\n\t\t//data part\n\t\tconst tblObj = {\n\t\t\teditable : !obj.readonly,\n\t\t\tclipboard : obj.clipboard,\n\t\t\tliveEditor: obj.liveEditor,\n\t\t\tclipboardDecimalDelimiter : obj.clipboardDecimalDelimiter\n\t\t};\n\t\tif(obj.rowHeight)\n\t\t\ttblObj.rowHeight = obj.rowHeight;\n\t\tif(obj.columnWidth)\n\t\t\ttblObj.columnWidth = obj.columnWidth;\n\n\t\trows.push(tbl.init(this, tblObj));\n\n\t\tconst bottom = obj.bottombar === true ? sheets.defaultBottom(this) : obj.bottombar;\n\t\tif (bottom)\n\t\t\trows.push(bottom);\n\n\t\tsheets.init(this);\n\n\t\tif(!obj.readonly)\n\t\t\tcontext.init(this);\n\n\t\tdialogs.init(this);\n\n\t\tthis.rows_setter(rows);\n\t},\n\t_set_handlers:function(){\n\t\t//prevent double init\n\t\tif (this._table) return;\n\t\tthis._table = this.$$(\"cells\");\n\n\t\t//init all sub modules\n\t\toperations(this);\n\n\t\t//set sizes for the table\n\t\ttbl.reset(this, this.config.columnCount, this.config.rowCount);\n\t\tkey.init(this); //keyboard shortcuts\n\t\t\n\t\tthis._table.attachEvent(\"onAfterAreaAdd\", () =>\n\t\t\tthis.callEvent(\"onAfterSelect\", [ this.getSelectedId(true) ]));\n\n\t\tthis.callEvent(\"onComponentInit\", []);\n\t},\n\t$onLoad:function(obj, driver){\n\t\t//when loading data by data:, we can get $onLoad before _set_handlers call\n\t\tthis._set_handlers();\n\n\t\tif (obj.excel)\n\t\t\tobj = this._parseExcel(obj, driver);\n\t\telse if(!obj.data && typeof obj == \"string\" && (driver.cell || driver.row))\n\t\t\tobj = this._parseCsv(obj, driver);\n\n\t\tsheets.load(this, obj);\n\t}\n};\napi(component);\nwebix.protoUI(component, webix.AtomDataLoader, webix.IdSpace, webix.ui.layout);\n","import {isCellSelected, isColSelected,isRowSelected,selectRow,selectColumn} from \"./operations/column_operations\";\nimport {getColumnOperation, getRowOperation, getClearOperation} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => view.$$(\"context\").attachTo(view._table.$view));\n\n\tvar locale = webix.i18n.spreadsheet.menus;\n\tconst lists = {\n\t\tdata:[\n\t\t\t{ id:\"clear\",\t\tvalue: locale[\"clear\"], submenu: getClearOperation()},\n\t\t\t{ id:\"lock-cell\",\t\tvalue: locale[\"lock-cell\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"sort\",\tvalue: locale.sort, submenu:[\n\t\t\t\t{id: \"sort-asc\", value: locale[\"sort-asc\"]},\n\t\t\t\t{id: \"sort-desc\", value: locale[\"sort-desc\"]}\n\t\t\t]},\n\t\t\t{id:\"create-filter\",\t\tvalue: locale[\"create-filter\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"add-range\",\t\tvalue: locale[\"add-range\"]},\n\t\t\t{ id:\"add-link\",\t\tvalue: locale[\"add-link\"]},\n\t\t\t{ id:\"add-comment\",\t\tvalue: locale[\"add-comment\"]}\n\t\t],\n\t\tcolumn: getColumnOperation(view),\n\t\trow: getRowOperation(view)\n\t};\n\n\n\tvar context = {\n\t\tview: \"contextmenu\",\n\t\tid: \"context\",\n\t\tpadding:0,\n\t\tsubmenuConfig:{\n\t\t\tpadding:0,\n\t\t\ton:{\n\t\t\t\tonBeforeShow:function(){\n\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdata:[],\n\t\ton:{\n\t\t\tonMenuItemClick(id) {\n\t\t\t\tview.callEvent(\"onCommand\", [this.getMenuItem(id)]);\n\t\t\t},\n\t\t\tonBeforeShow(pos) {\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\tvar mode, trg;\n\n\t\t\t\ttrg = view._table.locate(pos);\n\t\t\t\tif (!trg) return false;\n\n\t\t\t\tmode = \"\";\n\t\t\t\tif (trg.header && trg.column !== \"rowId\"){\n\t\t\t\t\tif (!isColSelected(trg.column, view))\n\t\t\t\t\t\tselectColumn(trg.column, view);\n\t\t\t\t\tmode = \"column\";\n\t\t\t\t} else if (trg.row){\n\t\t\t\t\tif (trg.column === \"rowId\"){\n\t\t\t\t\t\tif (!isRowSelected(trg.row, view))\n\t\t\t\t\t\t\tselectRow(trg.row, view);\n\t\t\t\t\t\tmode = \"row\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!isCellSelected(trg.row, trg.column, view))\n\t\t\t\t\t\t\tview._table.addSelectArea(trg, trg);\n\t\t\t\t\t\tmode = \"data\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (mode){\n\t\t\t\t\tvar data = getMenuData(view, mode, lists[mode]);\n\t\t\t\t\tif (data){\n\t\t\t\t\t\tthis.clearAll();\n\t\t\t\t\t\tthis.parse(data);\n\t\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t\t\twebix.html.preventEvent(pos);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"context\", context]);\n\tconst contextMenu = view.ui(context);\n\n\tview._destroy_with_me.push(contextMenu);\n}\n\nexport function getMenuData(view, name, data){\n\tvar ev = { area:name, data:data };\n\tif (view.callEvent(\"onContextMenuConfig\", [ev]))\n\t\treturn ev && ev.data;\n\treturn null;\n}","import * as m1  from \"./add_row_col\";\nimport * as m6  from \"./clipboard\";\nimport * as m12 from \"./column_operations\";\nimport * as m2  from \"./conditional_formats\";\nimport * as m4 from \"./types\";\nimport * as m8 from \"./formats\";\nimport * as m16a from \"../math/math\";\nimport * as m17 from \"./data\";\nimport * as m18 from \"./dropdown\";\nimport * as m7  from \"./formats\";\nimport * as m13 from \"./hide_row_col\";\nimport * as m14 from \"./lock_cell\";\nimport * as m3  from \"./resize\";\nimport * as m9  from \"./selection\";\nimport * as m10 from \"./sorting\";\nimport * as m16 from \"./spans\";\nimport * as m19 from \"./states\";\nimport * as m5  from \"./styles\";\nimport * as m11 from \"./undo\";\nimport * as m20 from \"./import\";\nimport * as m21 from \"./filter\";\nimport * as m22 from \"./print\";\nimport * as m23 from \"./export\";\nimport * as m24 from \"./load\";\nimport * as m25 from \"./clear_styles\";\nimport * as m26 from \"./comments\";\nimport * as m27 from \"./save\";\nimport * as m28 from \"./hide_headers\";\nimport * as m29 from \"./hide_gridlines\";\nimport * as m30 from \"./views\";\n\nexport function operations(view){\n\t//order in some cases does matter\n\t//resize must be applied after math, to size data by the result of math calculation\n\t//types must be applied after state and data \n\tvar all = [m1,m2,m5,m6,m7,m9,m10,m11,m12,m13,m14,m16,m3,m8,m17,m16a,m18,m19,m4,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30];\n\tfor (var i = 0; i < all.length; i++){\n\t\tif (all[i].init)\n\t\t\tall[i].init(view);\n\t}\n}","import * as rco from \"./row_col_operations\";\nimport * as lcl from \"./lock_cell\";\nimport * as fcl from \"./freeze\";\nimport * as hbr from \"./hide_gridlines\";\nimport * as hhd from \"./hide_headers\";\nimport * as hrc from \"./hide_rows\";\nimport * as mat from \"./math\";\nimport * as ops from \"./operations\";\nimport * as cor from \"./core\";\nimport * as sav from \"./save\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as cfm from \"./confirm\";\nimport * as und from \"./undo\";\nimport * as fmt from \"./number_formats\";\n\nexport function api(view){\n\tvar all = [rco, lcl, fcl, hbr, hhd, hrc, mat, ops, cor, sav, dpd, flt, cfm, und, fmt];\n\tfor (var i = 0; i < all.length; i++)\n\t\twebix.extend(view, all[i]);\n}"],"names":["dayOfTheYear","date","start","Date","getFullYear","diff","getTimezoneOffset","Math","floor","getJsDateFromExcel","excelDate","round","getTime","getExcelDateFromJs","jsDate","toString","_to_number","v","isNaN","_combine","data","arr","i","length","concat","getJsDate","value","getExcelDate","webix","i18n","spreadsheet","labels","tooltips","menus","table","liveEditor","formats","protoUI","name","$cssName","$init","config","options","view","body","tooltip","template","xCount","yCount","ui","richselect","defaults","width","margin","cols","scroll","select","obj","id","on","onAfterSelect","this","getParentView","updateMasterValue","rows","css","title","onChange","hide","getValue","$$","master","setValue","getList","getColorView","getSelectedId","getBody","getChildViews","getItemText","suggest","fitMaster","$ready","push","bind","getPopup","isArray","callEvent","join","palette","colorboard","icon","borderless","height","onSelect","setMasterValue","$view","className","$renderInput","divStart","color","renderColor","call","replace","match","p1","p2","p3","colorpicker","prototype","$setValue","popup","getColorNode","style","backgroundColor","firstChild","childNodes","$renderIcon","text","apply","arguments","datepicker","$prepareValue","copy","end","daterangepicker","buttons","getHeaderConfig","label","paddingX","paddingY","click","getTopParentView","getBodyConfig","content","elements","getFormElements","cancel","autowidth","save","body_setter","_typeof","window","head_setter","padding","move","head","autofocus","IdSpace","headerRowHeight","datatable","a","setHTML","type","dataview","contextmenu","filter","item","editor","cursor","getInputNode","selectionStart","val","charAt","str1","substring","str2","search","toLowerCase","indexOf","attachEvent","node","tagName","_this","sizes","html","offset","textWidth","getTextSize","y","x","show","refresh","setValueHere","$enterKey","isVisible","group","set","method","uid","url","all","serialize","sheets","proxy","$parse","$proxy","ajax","headers","post","init","thread","events","handler","newName","params","_loading_data","getActiveSheet","clearTimeout","delay","decode","encode","alpha","prefixIndex","parseInt","str","adress","size","charCodeAt","col","substr","range","nind","sheet","parts","split","ranges","getCode","d1","d2","notAlphaNum","escapeSheet","test","toRange","x2","y2","rangeObj","row","column","eachRange","callback","rangeTest","isRange","changeRange","inc","updated","r1","c1","r2","c2","toolbarSizes","sectorPadding","sectorMargin","defaultStyles","sizeEl","style_names","_style_map","left","center","right","top","middle","bottom","wrap","border_checks","cell","area","mode","_style_handlers","getSelectArea","modes","_updateStyle","reset","_styles","_styles_cache","_styles_max","prefix","$index","removeStyle","getStyle","styles","getRow","$cellCss","styleid","addStyle","props","origin","_styleFromText","key","_styleToText","cache","_addStyle","_parse","styleObj","update_style_data","nstyle","$cellFormat","format","setStyle","_setStyle","setRangeStyle","baseWidth","innerHTML","_table","appendChild","max","offsetWidth","offsetHeight","removeChild","old","oldFormat","formatChanged","saveCell","silent","_buildCssString","clearRangeStyle","compactStyles","used","newStyles","_applyStyles","eachSelectedCell","_applyCellStyles","ostyle","_serialize","_undoStyle","create","formatsCount","formatSources","formatCache","formatHelpers","setDefaultFormats","formatsLocale","price","getFormat","extra","priceFormat","values","extend","zeros","priceSettings","decimalSize","symbol","separator","negative","getDelimiters","numberFormat","percent","format2code","dateFormat","string","serializeFormat","formToValues","groupSign","groupDelimiter","decimalSign","decimalDelimiter","getFormatSource","toexcel","parseFormat","createFormatName","addFormat","nev","removeFormat","splitFormat","conditional","delimiters","errorMessage","code","separated","separateFmt","genCode","condition","fmt","Function","check","line","ind","isAbs","genFormatCode","isQuote","comma","numberPlaceholder","textPlaceholder","multiply","lastDateType","betweenPlaceholders","placeholder","isUndefined","datePart","excelDateToWebix","undefined","map","decimal","getParts","reverse","lzeros","lfills","rzeros","rfills","rmax","dateTypes","timeTypes","dateOrder","Object","keys","sort","b","timeOrder","typesOrder","order","types","j","changeAreaDecimals","cells","getCells","r","c","getItem","firstValue","firstStyle","rules","isNumber","changeCellDecimals","isCustom","updateDecimals","parsed","decimals","placeholders","Array","slice","withoutText","withoutPlaceholders","hasOwnProperty","formValues","toExcel","leftPlaceholders","fmtParts","sepFmtParts","getFmtPartValues","leftText","rightText","fmtPart","firstPlaceholder","index","Infinity","k","checkFormat","checkTime","quot","getFormatName","isDateInvalid","getDateEditFormat","formatName","locale","isTime","dateToStr","load","defaultFormats","isChar","char","getWord","formula","passive","quotes","operand","isPosition","position","word","sum","flags","chars","errorCode","e","namedRangeCode","deps","sheetInd","rangeCode","t","crosssheet","lines","ph","escaped","next","pushLine","getPopupConfig","onItemClick","button","suggestData","highlight","_highlightedCells","_update_range","_last_value_set","showActiveSheet","updateCellValue","moveSelection","preventEvent","eventRemove","keydownEv","event","_this2","endEdit","escapeText","escape","changeCellCss","_ranges","colorIndex","crossheet","cellSheet","prepareSheet","activeMath","_activeMath","activeSheet","cellText","rangeName","repeatedColor","nextCell","nextCellText","setColor","document","activeElement","paintValue","activeCell","define","showSheet","_this3","remove","which","keyCode","dir","getItemNode","newv","getCellValue","setCellValue","$handleSelection","$setValueHere","setSelectionRange","expectRange","trim","expectOperator","setRange","pos","len","lastPos","prepareArea","first","second","min","row1","col1","row2","col2","coloredArea","texthighlight","layout","drag","dragscroll","EditAbility","list","toggle","onValue","offValue","common","inp","awidth","aheight","$allowsClear","blockEvent","unblockEvent","arrow","elementsConfig","labelWidth","_initOnChange","$eventSource","_getCheckboxes","count","$all","_count","base","forEach","labelRight","active","baseHeight","skin","$active","inputHeight","checkboxes","output","scrollview","queryView","form","onSelectChange","focus","resize","toFront","minWidth","minHeight","escHide","autofit","setAttribute","getMenu","UIManager","addHotKey","_removeView","_clickEv","_menu","destructor","move_setter","DragControl","addDrag","$dragPos","$dragCreate","object","trg","target","getAttribute","elOffset","elPos","pOffset","parentNode","state","getScrollState","toNode","$dragDestroy","_menuActions","dots","editors","excel_date","createPopup","icons","timepicker","_last_input_target","onEnter","render","showPopup","input","updateCalendar","calendar","afterRender","ss_richselect","exists","popupInit","$value","actions","span","isMerged","c0","getSpan","splitCell","confirm","then","combineCells","undo","redo","hideGridlines","hideHeaders","freezeColumns","freezeRows","fontFamily","getColumnOperation","colOperations","resizeCell","getRowOperation","rowOperations","getClearOperation","getLocaleClear","$template","borders","styleFormats","colorButton","toggleButton","iconButton","btn","segmented","popupWidth","popupTemplate","popupEvents","titleHeight","align","condFormat","buttonsMap","getFontSize","numbers","fontSize","px","getCellFormats","currency","example","number","getText","getAllElements","calcButtons","groups","result","$button","insert","ready","selected","setValues","barStyles","action","updateValue","element","toolbar","allElements","elm","bottombar","toolbarButtons","structure","checkButtons","getButtons","columns","block","blockColumns","bar","source","viewId","innerId","selectRow","endRow","last","_selectRange","selectAll","firstColumn","selectColumn","endColumn","isColSelected","selectedArea","isCellSelected","isRowSelected","selectColumns","addSelectArea","adjustColumn","columnWidth","getColumnConfig","eachRow","getCellEditor","getCellFilter","setColumnWidth","adjustRow","eachColumn","getSpanNode","setRowHeight","highlightColRow","header","sr","er","sc","ec","removeCellCss","addCellCss","getHeaderNode","removeCss","addCss","dragStartColumn","dragEndColumn","grid","showCommentHandler","comments","_activeComment","editStatus","locate","visible","commentsView","get","viewonly","contains","math","editMath","highlightHeaders","ids","cop","st","ed","ev","getEditor","isCellLocked","finalStep","resizeColumn","cind","dx","posRelative","columnId","selectColumnHandler","lastHeaderClick","headerClick","dblClick","shiftKey","lastClickedRow","editStop","getFocus","need_focus","setFocus","setDefaultCss","$name","spans","leftSplit","areaselect","minColumnWidth","editable","editaction","minRowHeight","navigation","clipboard","clipboardDecimalDelimiter","templateCopy","cell_template","valueOnly","invalidDate","helper","newValue","clearAll","columnCount","rowCount","el","nms","refreshColumns","parse","env","isMac","readonly","sel","$anyKey","edit","del","styleHotKey","ctrlU","ctrlP","attr","elementOn","SUM","AVERAGE","COUNT","COUNTA","COUNTBLANK","MAX","MIN","PRODUCT","product","SUMPRODUCT","sets","sp","s","SUMSQ","sq","pow","VARP","avg","STDEVP","sqrt","POWER","num","n","p","QUOTIENT","div","d","SQRT","ABS","abs","RAND","random","PI","INT","ROUND","digits","parseFloat","toFixed","ROUNDDOWN","ROUNDUP","ceil","TRUNC","EVEN","ODD","CONCATENATE","LEFT","MID","RIGHT","LOWER","UPPER","toUpperCase","PROPER","temp","idx","TRIM","LEN","DATE","year","month","day","TIME","hour","minute","DAY","getDate","MONTH","getMonth","YEAR","NOW","DATEDIF","unit","startDateDays","months","IMAGE","SPARKLINE","color1","color2","negativeColor","Sparklines","getTemplate","HYPERLINK","IF","neg","methods","dateToExcel","getFormatType","formatType","getType","$cellType","setType","_setType","isFormula","parseDate","mathFormat","getMathFormat","blockLevel","level","part","expectType","getExpectType","parser","strToDate","parseDateTime","ignoreUndo","updateCell","cellEditor","setFormat","timeFormat","setCellEditor","checkType","strings","other","methodsName","updateEditor","fillEditor","startEdit","clear","disableEditor","disabled","disable","enable","en","pasteRange","updateRange","isEnabled","clearEditor","isActiveCell","find","func","findIndex","actionMap","_activeSheet","add","prepare","selectSheet","showItem","command","changePagerVisability","sheetTabWidth","showBatch","changePagerStatus","scrollPos","tabWidth","context","dataOrder","_sheets","splice","rename","defaultBottom","hidden","editValue","onClick","webix_ssheet_sheet_arrow","initSheetMenu","$sheetMenu","menuInit","menu","_destroy_with_me","callAction","getMark","disableItem","enableItem","batch","scrollSheets","direction","scrollTo","newIndex","getNewTitle","getSheet","newSheet","changeId","tabs","getActive","getDimension","_resetTable","Dialog","$dialog","$hide","$show","close","unescape","DialogBox","box","preview","parseImage","server","images","image","showPreview","upload","startLoad","endLoad","onSaveClick","okClick","onHideClick","onCancelClick","fillUrl","addImage","file","reader","FileReader","onload","getFormView","readAsDataURL","response","imageURL","viewid","open","views","update","actives","passives","core","struct","pair","pairsheet","rawword","triggers","_build_function","error_function","clearMathCache","activeOnly","updateMath","stack","isRowFix","isColumnFix","checkRange","cut","isRow","updateSheetNames","oldName","thisSheet","multiSheet","getAccessor","_mathSheetCache","helpers","passiveAccessor","page","formulas","_mathSheetHelpers","_mathSheetCore","getRangeCode","getCell","execute","getRange","getRangeCols","rind","activeAccessor","SheetAccessor","getRangeValue","rangeOptions","unique","empty","String","objA","objB","sorters","sorting","as","int","unshift","nullFilter","$empty","Ranges","_master","accessor","els","parseChart","color_def","color_pos","color_neg","renderPreview","visibleBatch","labelPosition","getTypes","typesChangeHandler","dialog","sparkConfig","getValues","addSparkline","alert","rangeValues","clearValidation","getSelectedRange","getRanges","toSheetRange","validate","updateItem","theform","removeRange","editRange","correct","gravity","saveClick","autoheight","lockCss","lockCell","_mapCellsCalls","_locks","cm","lock","updatePosition","locked","addSpan","extraCss","getExtraCss","setSpanValue","isEmpty","removeSpan","lx","ly","rx","ry","cx","cy","setSpanCss","borderChecks","adjustSpan","checkSpan","selection","isFirstCell","oldValue","pasteSpan","cutted","translate","mapCells","rid","cid","pull","isUndo","undoSpan","checkSpanBorders","_ssFilters","markBarFilter","getFilters","filters","clearFilters","refilter","filterSpreadSheet","calibrateRange","getFilterRange","isValueActive","includes","isFilterExists","getFilterMode","pasteFilter","setCellFilter","getSingleOption","conditions","getConditions","getFilterFunction","opt","isDate","lastIndexOf","on_click","ssheet_filter_sign","on_dblclick","toggleFilters","removeFilters","isFilter","$mode","$filter","syncScroll","_getTargetNode","getFilter","flt","importData","relative","field","inputs","applyFilter","setCellStyle","isHidden","nodeOffset","tableOffset","getElementsByClassName","ydiff","xdiff","scrollSize","fillForm","labelsLocale","commonConfig","customConfig","dateConfig","fullDateFormat","longDateFormat","getFormats","updateForm","closeWin","isText","forms","_normalizeValue","value2","collection","_formatValue","editFormat","_safeInt","_getCondition","activeValue","_setCondition","_clean","display","onFocus","current_view","_this4","onBlur","clearRow","getRows","getConditionStyle","conditionStyle","_this5","getSheets","filename","restoreValue","paper","fit","sheetnames","modal","vertical","print","_setComment","textarea","onViewResize","animate","showInput","addComment","showTemplate","changeTextarea","comment","getHead","$height","rowHeight","getOption","optionHeight","inValues","toggleFields","outValues","isDirty","stacked","f","hideField","xAxis","pieInnerText","legend","bases","imt","imc","asw","rgs","dpd","cnd","exp","lnk","pnt","cmt","siz","ignoreUndoReset","restoreHistory","_ssUndoHistory","_ssUndoCursor","addToHistory","$skipHistory","ignoreReset","step","prevData","undoHandlers","nvalue","ovalue","process","newData","oldData","viewIds","getUpdateValues","_addColumn","add_column_count","_delColumn","del_column_count","deleted","_addRow","add_row_count","_delRow","del_row_count","loadChangedData","fixSelectArea","calculate","get_core","_execute","error","isFinite","rs","vs","m","backtrak","skip_math","solvedMath","solvedCounter","applyMath","tkey","check_trigger","srow","scolumn","recalckAll","getState","recalckCell","remove_triggers","trs","back","adds","bcell","add_triggers","blist","add_backtrack","holders","setPlaceholder","psh","param","option","addEmptyCollection","_empty","_pull","rowId","clearConditionalFormats","_changeCondition","pasteCondition","oldCondition","newCondition","handlers","type_action","_undoCondition","_setCssFormat","cssFormat","_ssEditors","clearEditors","pasteDropdown","dropdown","styledata","clipdata","updateFilters","ignore","$popup","tblEditors","isEditor","_clipboardToTable","cdata","fromSheet","ctrlKey","metaKey","_get_sel_style","mapSelection","allFiltersInZone","startRow","startCol","endCol","_clip_to_sel","leftTop","csv","delimiter","_changeDelimiter","record","_add_row_col","maxRow","maxCol","row_ind","col_ind","subtrans","tconfig","frozenColumns","frozenRows","_frozenColumns","_frozenRows","topSplit","hasValue","_undoValue","_hidden_cols_hash","_hidden_rows_hash","isColumnVisible","setState","indexes","getIds","_showRow","_showColumn","_hideRow","_hideColumn","isRowVisible","showColumn","unselect","hideColumn","_updatePosition","h","hrows","hcols","_adjustRowHeight","headerOnly","refreshSelectArea","getColumn","_undoResize","defWidth","defHeight","nsizes","o","bs","blockStart","blockEnd","res","removeSelectArea","sortRange","fullrange","expandSelection","maxY","maxX","nr1","nr2","nc1","nc2","newrange","by","fullRow","shift","newMath","gridlines","removeComment","getComment","removeCommentsRange","commentCell","_undoComment","modules","m1","m2","m3","m4","m5","m6","m7","uploader","XMLHttpRequest","apiOnly","accept","startImport","fileDialog","_buildHtml","doc","xCorrection","baseIndex","sheetname","$customPrint","br","insertBefore","docFooter","_cleanHtml","_safeColor","_getStyles","cached","_getDefaults","font","sz","alignment","horizontal","wrapText","docHeader","_getDocStyle","delta","rIndex","cIndex","_getCellStyle","stl","border","rgb","fill","fgColor","italic","underline","bold","$exportView","rawValues","export_mode","_exportExcel","dataOnly","sheetOptions","Sheet","Name","Ref","_excel_to_data","dataObj","styleshash","stylescount","_safeFont","va","_getTypes","safe","_parseExcel","driver","full","names","_parseCsv","getRecords","clearRange","_trackAll","track","_types","_trackOne","conf","_fromRange","_showAll","win","_correctPos","_showOne","_getWidth","$width","_getHeight","each","_defColors","_defCursor","_isPie","_isRange","coords","querySelector","register","container","_commands","inner","_processTables","query","tables","dt","_reset","_undoUI","_updateData","one","_genChartConfig","valign","_pieConfig","series","borderColor","yAxis","callCommand","setSize","insertRow","deleteRow","insertColumn","deleteColumn","checkSpans","changeSpan","getColumnIndex","getIndexById","hideRow","chart","getSheetData","recalculate","registerMathMethod","addMethod","sid","spn","prop","rangeStr","setRangeValue","addSheet","clearSheet","renameSheet","editSheet","removeSheet","und","srt","cb","tbl","ok","resetUndo","groupUndo","changeDecimals","defaultMenu","submenu","getMenuData","component","_base_index","getDefaultStyles","_sub_init","_set_handlers","$skin","setSkinDefaults","material","subbar","tblObj","attachTo","lists","submenuConfig","onBeforeShow","sizeToContent","onMenuItemClick","getMenuItem","contextMenu","dialogs","viewBases","uiDialogs","rows_setter","operations","m9","m10","m11","m12","m13","m14","m16","m8","m17","m16a","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","m30","$onLoad","excel","api","rco","lcl","fcl","hbr","hhd","hrc","mat","ops","cor","sav","cfm","AtomDataLoader"],"mappings":";;;;;;;;uJAAO,SAASA,EAAaC,OACtBC,EAAQ,IAAIC,KAAKF,EAAKG,cAAe,EAAG,GACxCC,EAAQJ,EAAOC,EAAmE,IAAxDA,EAAMI,oBAAsBL,EAAKK,qBAA4B,WACtFC,KAAKC,MAAMH,SAGZ,SAASI,EAAmBC,OAC5BT,EAAO,IAAIE,KAAKI,KAAKI,MAA4B,OAArBD,EAAY,OAAiB,aACxD,IAAIP,KAAKF,EAAKW,UAAuC,IAA3BX,EAAKK,qBAGhC,SAASO,EAAmBC,UACX,OAAUA,EAAOF,UAA0C,IAA7BE,EAAOR,4BACtCS,WAGhB,SAASC,EAAWC,YACvBA,GAAW,IAANA,IACPA,GAAM,EACFC,MAAMD,MAAWA,EAKhB,SAASE,EAASC,WACpBC,EAAM,GACDC,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAChCD,EAAMA,EAAIG,OAAOJ,EAAKE,WAEhBD,EC3BR,SAASI,EAAUC,UACbA,GAAmB,IAAVA,GAAkBA,aAAiBvB,MAAUe,MAAMQ,KAChEA,EAAQjB,EAAmBiB,IAErBA,EAGR,SAASC,EAAaD,UACjBA,GAASA,aAAiBvB,OAC7BuB,EAAQb,EAAmBa,IAErBA,6hECZRE,MAAMC,KAAKC,YCDI,CACdC,OAAO,QAEI,kBACE,kBACF,iBACC,eACH,cACE,uBACO,0BACA,2BACL,2BACD,gCACG,4BACA,qCAED,iBACL,YACA,YACA,aACC,eACC,gBACA,iBACC,aACL,WACG,eAEC,cACF,aAEC,6BAEa,+BACT,gCACQ,+BACG,iCACF,kCACE,kBAEf,sBACM,4BACD,qBACC,mBAEH,mBACG,2BACC,qCACH,wCAEM,iCACD,yBACC,0BACA,6BACG,gCACA,0BAEN,8BACE,kCAEA,+BACA,gCACA,WAEZ,oBAEU;qBACM,6DACN,uBACD,wCACK,iCAEN,uBACD,kBACD,YAEH,yBACQ,8BACD,wBAEP,wBACO,0BACJ,0BAEA,gBACF,+BAEc,gFACA,8EACH,6EACN,gCAEP,sBACM,sCACG,iCACH,4BACC,yBACC,6BACH,uBACD,4BACC,+BACC,+BACF,yBACH,6BACK,mBACJ,2BACA,8BACG,2BACC,8BACE,4BACC,oBAEP,gBAEF,eACC,uBACM,6BAEH,qBACE,sBACD,oBACA,mBACD,oBACE,oBACF,oBACE,uBACC,4BACI,8BACH,wBACF,qBACD,sBACE,6BACE,8CACE,2CACA,6CACF,sBAElBC,SAAU,OACA,wBACK,iCACC,0BACF,yBACC,oCACI,yBACP,uBACG,+BACE,4BACD,6BACE,gCACC,8BACH,8BACE,qCACK,yCACL,4BACH,4BACE,6BACD,0BACF,2BACG,8BACA,oBACR,aACA,iBACA,YACA,cACE,oCACU,8CACA,wCACL,oBACD,2BACK,6BACD,qCACF,oCACC,yCACE,sCACN,8CACE,qCACF,wBACA,yBACJ,mBACG,eACL,cACG,gBACD,oBACI,wBACI,sBACF,WAEhBC,MAAM,gBACW,8BACA,oBACR,aACD,kBACM,2BACG,mCACA,wBACP,sBACK,yBACN,YACA,YACA,eACG,0BACM,gCACA,8BACF,4BACA,8BACE,qBACT,oBACM,0BACA,wBACF,sBACA,wBACE,oBACJ,8BACY,2BACb,sBACK,uBACA,qCACc,+CACH,yCACR,uBACL,YACH,yBACQ,8BACD,wBACP,wBACO;YACJ,uBACJ,kBACI,uBACC,oBACL,kBACI,0BACC,mBACL,wBACU,wCACH,wCACG,qCACF,oCACC,uCACD,2BACH,yBACJ,sBACK,WAEfC,MAAM,cACQ,uBACE,oBAEhBC,WAAW,MACH,SAERC,QAAQ,YACO,wBACA,6BACI,8BACA,uCACD,8BACJ,aChQfR,MAAMS,QAAQ,CACbC,KAAM,eACNC,SAAS,aACTC,MAAO,SAASC,GACfA,EAAOC,QAAW,CACjBC,KAAK,cACLC,KAAK,CACJD,KAAM,eACNE,QAAS,CACRC,SAAS,aAEVC,OAAO,EAAGC,OAAO,GAElB5B,KAAMqB,EAAOrB,QAGdQ,MAAMqB,GAAGC,YChBXtB,MAAMS,QAAQ,CACbC,KAAM,yBACNa,SAAS,CACRC,MAAO,KAERZ,MAAO,SAASC,GACfA,EAAOG,KAAO,CACbS,OAAQ,EACRC,KAAK,CACJ,CAAEX,KAAM,eAAgBY,QAAQ,EAAOC,QAAQ,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"}